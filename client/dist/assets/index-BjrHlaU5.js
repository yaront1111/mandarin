var Rw=Object.defineProperty;var Mw=(t,e,i)=>e in t?Rw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var _c=(t,e,i)=>Mw(t,typeof e!="symbol"?e+"":e,i);import{a as Lw,b as Ow,p as qo,g as Rv,r as b,u as In,c as $h,N as Dw,L as _n,R as ba,d as Bw,e as Mv,f as zw,h as ks,B as Pw}from"./vendor-C1jkx_oC.js";import{y as ne,G as Fe,L as $w}from"./ui-CrHIGQ-2.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function i(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(c){if(c.ep)return;c.ep=!0;const u=i(c);fetch(c.href,u)}})();var jf={exports:{}},Ao={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0;function Uw(){if(f0)return Ao;f0=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(a,c,u){var d=null;if(u!==void 0&&(d=""+u),c.key!==void 0&&(d=""+c.key),"key"in c){u={};for(var h in c)h!=="key"&&(u[h]=c[h])}else u=c;return c=u.ref,{$$typeof:t,type:a,key:d,ref:c!==void 0?c:null,props:u}}return Ao.Fragment=e,Ao.jsx=i,Ao.jsxs=i,Ao}var h0;function Iw(){return h0||(h0=1,jf.exports=Uw()),jf.exports}var o=Iw(),Cf={exports:{}},Ro={},Nf={exports:{}},Tf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m0;function Fw(){return m0||(m0=1,function(t){function e(K,q){var J=K.length;K.push(q);e:for(;0<J;){var re=J-1>>>1,Ne=K[re];if(0<c(Ne,q))K[re]=q,K[J]=Ne,J=re;else break e}}function i(K){return K.length===0?null:K[0]}function a(K){if(K.length===0)return null;var q=K[0],J=K.pop();if(J!==q){K[0]=J;e:for(var re=0,Ne=K.length,Se=Ne>>>1;re<Se;){var Ve=2*(re+1)-1,ge=K[Ve],ee=Ve+1,Re=K[ee];if(0>c(ge,J))ee<Ne&&0>c(Re,ge)?(K[re]=Re,K[ee]=J,re=ee):(K[re]=ge,K[Ve]=J,re=Ve);else if(ee<Ne&&0>c(Re,J))K[re]=Re,K[ee]=J,re=ee;else break e}}return q}function c(K,q){var J=K.sortIndex-q.sortIndex;return J!==0?J:K.id-q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var u=performance;t.unstable_now=function(){return u.now()}}else{var d=Date,h=d.now();t.unstable_now=function(){return d.now()-h}}var p=[],y=[],g=1,w=null,C=3,j=!1,N=!1,M=!1,D=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,V=typeof setImmediate<"u"?setImmediate:null;function F(K){for(var q=i(y);q!==null;){if(q.callback===null)a(y);else if(q.startTime<=K)a(y),q.sortIndex=q.expirationTime,e(p,q);else break;q=i(y)}}function O(K){if(M=!1,F(K),!N)if(i(p)!==null)N=!0,Pe();else{var q=i(y);q!==null&&Ee(O,q.startTime-K)}}var A=!1,H=-1,E=5,L=-1;function P(){return!(t.unstable_now()-L<E)}function G(){if(A){var K=t.unstable_now();L=K;var q=!0;try{e:{N=!1,M&&(M=!1,I(H),H=-1),j=!0;var J=C;try{t:{for(F(K),w=i(p);w!==null&&!(w.expirationTime>K&&P());){var re=w.callback;if(typeof re=="function"){w.callback=null,C=w.priorityLevel;var Ne=re(w.expirationTime<=K);if(K=t.unstable_now(),typeof Ne=="function"){w.callback=Ne,F(K),q=!0;break t}w===i(p)&&a(p),F(K)}else a(p);w=i(p)}if(w!==null)q=!0;else{var Se=i(y);Se!==null&&Ee(O,Se.startTime-K),q=!1}}break e}finally{w=null,C=J,j=!1}q=void 0}}finally{q?Q():A=!1}}}var Q;if(typeof V=="function")Q=function(){V(G)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,ae=z.port2;z.port1.onmessage=G,Q=function(){ae.postMessage(null)}}else Q=function(){D(G,0)};function Pe(){A||(A=!0,Q())}function Ee(K,q){H=D(function(){K(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){N||j||(N=!0,Pe())},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return i(p)},t.unstable_next=function(K){switch(C){case 1:case 2:case 3:var q=3;break;default:q=C}var J=C;C=q;try{return K()}finally{C=J}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,q){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var J=C;C=K;try{return q()}finally{C=J}},t.unstable_scheduleCallback=function(K,q,J){var re=t.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?re+J:re):J=re,K){case 1:var Ne=-1;break;case 2:Ne=250;break;case 5:Ne=1073741823;break;case 4:Ne=1e4;break;default:Ne=5e3}return Ne=J+Ne,K={id:g++,callback:q,priorityLevel:K,startTime:J,expirationTime:Ne,sortIndex:-1},J>re?(K.sortIndex=J,e(y,K),i(p)===null&&K===i(y)&&(M?(I(H),H=-1):M=!0,Ee(O,J-re))):(K.sortIndex=Ne,e(p,K),N||j||(N=!0,Pe())),K},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(K){var q=C;return function(){var J=C;C=q;try{return K.apply(this,arguments)}finally{C=J}}}}(Tf)),Tf}var g0;function qw(){return g0||(g0=1,Nf.exports=Fw()),Nf.exports}var p0;function Vw(){if(p0)return Ro;p0=1;/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t=qw(),e=Lw(),i=Ow();function a(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}var u=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),C=Symbol.for("react.consumer"),j=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),F=Symbol.for("react.offscreen"),O=Symbol.for("react.memo_cache_sentinel"),A=Symbol.iterator;function H(n){return n===null||typeof n!="object"?null:(n=A&&n[A]||n["@@iterator"],typeof n=="function"?n:null)}var E=Symbol.for("react.client.reference");function L(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===E?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case p:return"Fragment";case h:return"Portal";case g:return"Profiler";case y:return"StrictMode";case M:return"Suspense";case D:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case j:return(n.displayName||"Context")+".Provider";case C:return(n._context.displayName||"Context")+".Consumer";case N:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case I:return s=n.displayName||null,s!==null?s:L(n.type)||"Memo";case V:s=n._payload,n=n._init;try{return L(n(s))}catch{}}return null}var P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=Object.assign,Q,z;function ae(n){if(Q===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);Q=s&&s[1]||"",z=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Q+n+z}var Pe=!1;function Ee(n,s){if(!n||Pe)return"";Pe=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(s){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(be){var ue=be}Reflect.construct(n,[],De)}else{try{De.call()}catch(be){ue=be}n.call(De.prototype)}}else{try{throw Error()}catch(be){ue=be}(De=n())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(be){if(be&&ue&&typeof be.stack=="string")return[be.stack,ue.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=l.DetermineComponentFrameRoot(),S=m[0],k=m[1];if(S&&k){var $=S.split(`
`),Z=k.split(`
`);for(f=l=0;l<$.length&&!$[l].includes("DetermineComponentFrameRoot");)l++;for(;f<Z.length&&!Z[f].includes("DetermineComponentFrameRoot");)f++;if(l===$.length||f===Z.length)for(l=$.length-1,f=Z.length-1;1<=l&&0<=f&&$[l]!==Z[f];)f--;for(;1<=l&&0<=f;l--,f--)if($[l]!==Z[f]){if(l!==1||f!==1)do if(l--,f--,0>f||$[l]!==Z[f]){var xe=`
`+$[l].replace(" at new "," at ");return n.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",n.displayName)),xe}while(1<=l&&0<=f);break}}}finally{Pe=!1,Error.prepareStackTrace=r}return(r=n?n.displayName||n.name:"")?ae(r):""}function K(n){switch(n.tag){case 26:case 27:case 5:return ae(n.type);case 16:return ae("Lazy");case 13:return ae("Suspense");case 19:return ae("SuspenseList");case 0:case 15:return n=Ee(n.type,!1),n;case 11:return n=Ee(n.type.render,!1),n;case 1:return n=Ee(n.type,!0),n;default:return""}}function q(n){try{var s="";do s+=K(n),n=n.return;while(n);return s}catch(r){return`
Error generating stack: `+r.message+`
`+r.stack}}function J(n){var s=n,r=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(r=s.return),n=s.return;while(n)}return s.tag===3?r:null}function re(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function Ne(n){if(J(n)!==n)throw Error(a(188))}function Se(n){var s=n.alternate;if(!s){if(s=J(n),s===null)throw Error(a(188));return s!==n?null:n}for(var r=n,l=s;;){var f=r.return;if(f===null)break;var m=f.alternate;if(m===null){if(l=f.return,l!==null){r=l;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===r)return Ne(f),n;if(m===l)return Ne(f),s;m=m.sibling}throw Error(a(188))}if(r.return!==l.return)r=f,l=m;else{for(var S=!1,k=f.child;k;){if(k===r){S=!0,r=f,l=m;break}if(k===l){S=!0,l=f,r=m;break}k=k.sibling}if(!S){for(k=m.child;k;){if(k===r){S=!0,r=m,l=f;break}if(k===l){S=!0,l=m,r=f;break}k=k.sibling}if(!S)throw Error(a(189))}}if(r.alternate!==l)throw Error(a(190))}if(r.tag!==3)throw Error(a(188));return r.stateNode.current===r?n:s}function Ve(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=Ve(n),s!==null)return s;n=n.sibling}return null}var ge=Array.isArray,ee=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},he=[],Ue=-1;function ze(n){return{current:n}}function Xe(n){0>Ue||(n.current=he[Ue],he[Ue]=null,Ue--)}function Qe(n,s){Ue++,he[Ue]=n.current,n.current=s}var Ge=ze(null),at=ze(null),yt=ze(null),mt=ze(null);function Ie(n,s){switch(Qe(yt,s),Qe(at,n),Qe(Ge,null),n=s.nodeType,n){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?I1(s):0;break;default:if(n=n===8?s.parentNode:s,s=n.tagName,n=n.namespaceURI)n=I1(n),s=F1(n,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Xe(Ge),Qe(Ge,s)}function qe(){Xe(Ge),Xe(at),Xe(yt)}function jt(n){n.memoizedState!==null&&Qe(mt,n);var s=Ge.current,r=F1(s,n.type);s!==r&&(Qe(at,n),Qe(Ge,r))}function Ct(n){at.current===n&&(Xe(Ge),Xe(at)),mt.current===n&&(Xe(mt),Co._currentValue=Re)}var Rt=Object.prototype.hasOwnProperty,pe=t.unstable_scheduleCallback,je=t.unstable_cancelCallback,Je=t.unstable_shouldYield,_t=t.unstable_requestPaint,ke=t.unstable_now,Ke=t.unstable_getCurrentPriorityLevel,ht=t.unstable_ImmediatePriority,B=t.unstable_UserBlockingPriority,R=t.unstable_NormalPriority,Y=t.unstable_LowPriority,_=t.unstable_IdlePriority,v=t.log,x=t.unstable_setDisableYieldValue,T=null,U=null;function X(n){if(U&&typeof U.onCommitFiberRoot=="function")try{U.onCommitFiberRoot(T,n,void 0,(n.current.flags&128)===128)}catch{}}function le(n){if(typeof v=="function"&&x(n),U&&typeof U.setStrictMode=="function")try{U.setStrictMode(T,n)}catch{}}var Ze=Math.clz32?Math.clz32:Le,we=Math.log,_e=Math.LN2;function Le(n){return n>>>=0,n===0?32:31-(we(n)/_e|0)|0}var Ye=128,Bt=4194304;function xt(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Ht(n,s){var r=n.pendingLanes;if(r===0)return 0;var l=0,f=n.suspendedLanes,m=n.pingedLanes,S=n.warmLanes;n=n.finishedLanes!==0;var k=r&134217727;return k!==0?(r=k&~f,r!==0?l=xt(r):(m&=k,m!==0?l=xt(m):n||(S=k&~S,S!==0&&(l=xt(S))))):(k=r&~f,k!==0?l=xt(k):m!==0?l=xt(m):n||(S=r&~S,S!==0&&(l=xt(S)))),l===0?0:s!==0&&s!==l&&(s&f)===0&&(f=l&-l,S=s&-s,f>=S||f===32&&(S&4194176)!==0)?s:l}function mn(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function is(n,s){switch(n){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ds(){var n=Ye;return Ye<<=1,(Ye&4194176)===0&&(Ye=128),n}function fe(){var n=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),n}function Me(n){for(var s=[],r=0;31>r;r++)s.push(n);return s}function He(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function dt(n,s,r,l,f,m){var S=n.pendingLanes;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=r,n.entangledLanes&=r,n.errorRecoveryDisabledLanes&=r,n.shellSuspendCounter=0;var k=n.entanglements,$=n.expirationTimes,Z=n.hiddenUpdates;for(r=S&~r;0<r;){var xe=31-Ze(r),De=1<<xe;k[xe]=0,$[xe]=-1;var ue=Z[xe];if(ue!==null)for(Z[xe]=null,xe=0;xe<ue.length;xe++){var be=ue[xe];be!==null&&(be.lane&=-536870913)}r&=~De}l!==0&&Et(n,l,0),m!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=m&~(S&~s))}function Et(n,s,r){n.pendingLanes|=s,n.suspendedLanes&=~s;var l=31-Ze(s);n.entangledLanes|=s,n.entanglements[l]=n.entanglements[l]|1073741824|r&4194218}function oe(n,s){var r=n.entangledLanes|=s;for(n=n.entanglements;r;){var l=31-Ze(r),f=1<<l;f&s|n[l]&s&&(n[l]|=s),r&=~f}}function We(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function bt(){var n=ee.p;return n!==0?n:(n=window.event,n===void 0?32:r0(n.type))}function vt(n,s){var r=ee.p;try{return ee.p=n,s()}finally{ee.p=r}}var ft=Math.random().toString(36).slice(2),rt="__reactFiber$"+ft,sn="__reactProps$"+ft,Gn="__reactContainer$"+ft,Oe="__reactEvents$"+ft,nt="__reactListeners$"+ft,wt="__reactHandles$"+ft,an="__reactResources$"+ft,Wt="__reactMarker$"+ft;function Wn(n){delete n[rt],delete n[sn],delete n[Oe],delete n[nt],delete n[wt]}function Js(n){var s=n[rt];if(s)return s;for(var r=n.parentNode;r;){if(s=r[Gn]||r[rt]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(n=H1(n);n!==null;){if(r=n[rt])return r;n=H1(n)}return s}n=r,r=n.parentNode}return null}function Aa(n){if(n=n[rt]||n[Gn]){var s=n.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return n}return null}function zr(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(a(33))}function Ra(n){var s=n[an];return s||(s=n[an]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function jn(n){n[Wt]=!0}var Um=new Set,Im={};function Ki(n,s){Ma(n,s),Ma(n+"Capture",s)}function Ma(n,s){for(Im[n]=s,n=0;n<s.length;n++)Um.add(s[n])}var ei=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),j4=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fm={},qm={};function C4(n){return Rt.call(qm,n)?!0:Rt.call(Fm,n)?!1:j4.test(n)?qm[n]=!0:(Fm[n]=!0,!1)}function gl(n,s,r){if(C4(s))if(r===null)n.removeAttribute(s);else{switch(typeof r){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var l=s.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+r)}}function pl(n,s,r){if(r===null)n.removeAttribute(s);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+r)}}function ti(n,s,r,l){if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttributeNS(s,r,""+l)}}function as(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Vm(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function N4(n){var s=Vm(n)?"checked":"value",r=Object.getOwnPropertyDescriptor(n.constructor.prototype,s),l=""+n[s];if(!n.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var f=r.get,m=r.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return f.call(this)},set:function(S){l=""+S,m.call(this,S)}}),Object.defineProperty(n,s,{enumerable:r.enumerable}),{getValue:function(){return l},setValue:function(S){l=""+S},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function yl(n){n._valueTracker||(n._valueTracker=N4(n))}function Hm(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var r=s.getValue(),l="";return n&&(l=Vm(n)?n.checked?"true":"false":n.value),n=l,n!==r?(s.setValue(n),!0):!1}function vl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var T4=/[\n"\\]/g;function rs(n){return n.replace(T4,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function wu(n,s,r,l,f,m,S,k){n.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.type=S:n.removeAttribute("type"),s!=null?S==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+as(s)):n.value!==""+as(s)&&(n.value=""+as(s)):S!=="submit"&&S!=="reset"||n.removeAttribute("value"),s!=null?_u(n,S,as(s)):r!=null?_u(n,S,as(r)):l!=null&&n.removeAttribute("value"),f==null&&m!=null&&(n.defaultChecked=!!m),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.name=""+as(k):n.removeAttribute("name")}function Gm(n,s,r,l,f,m,S,k){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),s!=null||r!=null){if(!(m!=="submit"&&m!=="reset"||s!=null))return;r=r!=null?""+as(r):"",s=s!=null?""+as(s):r,k||s===n.value||(n.value=s),n.defaultValue=s}l=l??f,l=typeof l!="function"&&typeof l!="symbol"&&!!l,n.checked=k?n.checked:!!l,n.defaultChecked=!!l,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(n.name=S)}function _u(n,s,r){s==="number"&&vl(n.ownerDocument)===n||n.defaultValue===""+r||(n.defaultValue=""+r)}function La(n,s,r,l){if(n=n.options,s){s={};for(var f=0;f<r.length;f++)s["$"+r[f]]=!0;for(r=0;r<n.length;r++)f=s.hasOwnProperty("$"+n[r].value),n[r].selected!==f&&(n[r].selected=f),f&&l&&(n[r].defaultSelected=!0)}else{for(r=""+as(r),s=null,f=0;f<n.length;f++){if(n[f].value===r){n[f].selected=!0,l&&(n[f].defaultSelected=!0);return}s!==null||n[f].disabled||(s=n[f])}s!==null&&(s.selected=!0)}}function Ym(n,s,r){if(s!=null&&(s=""+as(s),s!==n.value&&(n.value=s),r==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=r!=null?""+as(r):""}function Xm(n,s,r,l){if(s==null){if(l!=null){if(r!=null)throw Error(a(92));if(ge(l)){if(1<l.length)throw Error(a(93));l=l[0]}r=l}r==null&&(r=""),s=r}r=as(s),n.defaultValue=r,l=n.textContent,l===r&&l!==""&&l!==null&&(n.value=l)}function Oa(n,s){if(s){var r=n.firstChild;if(r&&r===n.lastChild&&r.nodeType===3){r.nodeValue=s;return}}n.textContent=s}var k4=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Km(n,s,r){var l=s.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?l?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":l?n.setProperty(s,r):typeof r!="number"||r===0||k4.has(s)?s==="float"?n.cssFloat=r:n[s]=(""+r).trim():n[s]=r+"px"}function Qm(n,s,r){if(s!=null&&typeof s!="object")throw Error(a(62));if(n=n.style,r!=null){for(var l in r)!r.hasOwnProperty(l)||s!=null&&s.hasOwnProperty(l)||(l.indexOf("--")===0?n.setProperty(l,""):l==="float"?n.cssFloat="":n[l]="");for(var f in s)l=s[f],s.hasOwnProperty(f)&&r[f]!==l&&Km(n,f,l)}else for(var m in s)s.hasOwnProperty(m)&&Km(n,m,s[m])}function Su(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var E4=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),A4=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function bl(n){return A4.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var ju=null;function Cu(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Da=null,Ba=null;function Wm(n){var s=Aa(n);if(s&&(n=s.stateNode)){var r=n[sn]||null;e:switch(n=s.stateNode,s.type){case"input":if(wu(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),s=r.name,r.type==="radio"&&s!=null){for(r=n;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+rs(""+s)+'"][type="radio"]'),s=0;s<r.length;s++){var l=r[s];if(l!==n&&l.form===n.form){var f=l[sn]||null;if(!f)throw Error(a(90));wu(l,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(s=0;s<r.length;s++)l=r[s],l.form===n.form&&Hm(l)}break e;case"textarea":Ym(n,r.value,r.defaultValue);break e;case"select":s=r.value,s!=null&&La(n,!!r.multiple,s,!1)}}}var Nu=!1;function Zm(n,s,r){if(Nu)return n(s,r);Nu=!0;try{var l=n(s);return l}finally{if(Nu=!1,(Da!==null||Ba!==null)&&(nc(),Da&&(s=Da,n=Ba,Ba=Da=null,Wm(s),n)))for(s=0;s<n.length;s++)Wm(n[s])}}function Pr(n,s){var r=n.stateNode;if(r===null)return null;var l=r[sn]||null;if(l===null)return null;r=l[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(n=n.type,l=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!l;break e;default:n=!1}if(n)return null;if(r&&typeof r!="function")throw Error(a(231,s,typeof r));return r}var Tu=!1;if(ei)try{var $r={};Object.defineProperty($r,"passive",{get:function(){Tu=!0}}),window.addEventListener("test",$r,$r),window.removeEventListener("test",$r,$r)}catch{Tu=!1}var bi=null,ku=null,xl=null;function Jm(){if(xl)return xl;var n,s=ku,r=s.length,l,f="value"in bi?bi.value:bi.textContent,m=f.length;for(n=0;n<r&&s[n]===f[n];n++);var S=r-n;for(l=1;l<=S&&s[r-l]===f[m-l];l++);return xl=f.slice(n,1<l?1-l:void 0)}function wl(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function _l(){return!0}function eg(){return!1}function Yn(n){function s(r,l,f,m,S){this._reactName=r,this._targetInst=f,this.type=l,this.nativeEvent=m,this.target=S,this.currentTarget=null;for(var k in n)n.hasOwnProperty(k)&&(r=n[k],this[k]=r?r(m):m[k]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?_l:eg,this.isPropagationStopped=eg,this}return G(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=_l)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=_l)},persist:function(){},isPersistent:_l}),s}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sl=Yn(Qi),Ur=G({},Qi,{view:0,detail:0}),R4=Yn(Ur),Eu,Au,Ir,jl=G({},Ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mu,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ir&&(Ir&&n.type==="mousemove"?(Eu=n.screenX-Ir.screenX,Au=n.screenY-Ir.screenY):Au=Eu=0,Ir=n),Eu)},movementY:function(n){return"movementY"in n?n.movementY:Au}}),tg=Yn(jl),M4=G({},jl,{dataTransfer:0}),L4=Yn(M4),O4=G({},Ur,{relatedTarget:0}),Ru=Yn(O4),D4=G({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),B4=Yn(D4),z4=G({},Qi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),P4=Yn(z4),$4=G({},Qi,{data:0}),ng=Yn($4),U4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},F4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q4(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=F4[n])?!!s[n]:!1}function Mu(){return q4}var V4=G({},Ur,{key:function(n){if(n.key){var s=U4[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=wl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?I4[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mu,charCode:function(n){return n.type==="keypress"?wl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?wl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),H4=Yn(V4),G4=G({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sg=Yn(G4),Y4=G({},Ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mu}),X4=Yn(Y4),K4=G({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q4=Yn(K4),W4=G({},jl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Z4=Yn(W4),J4=G({},Qi,{newState:0,oldState:0}),ex=Yn(J4),tx=[9,13,27,32],Lu=ei&&"CompositionEvent"in window,Fr=null;ei&&"documentMode"in document&&(Fr=document.documentMode);var nx=ei&&"TextEvent"in window&&!Fr,ig=ei&&(!Lu||Fr&&8<Fr&&11>=Fr),ag=" ",rg=!1;function og(n,s){switch(n){case"keyup":return tx.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function lg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var za=!1;function sx(n,s){switch(n){case"compositionend":return lg(s);case"keypress":return s.which!==32?null:(rg=!0,ag);case"textInput":return n=s.data,n===ag&&rg?null:n;default:return null}}function ix(n,s){if(za)return n==="compositionend"||!Lu&&og(n,s)?(n=Jm(),xl=ku=bi=null,za=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ig&&s.locale!=="ko"?null:s.data;default:return null}}var ax={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!ax[n.type]:s==="textarea"}function ug(n,s,r,l){Da?Ba?Ba.push(l):Ba=[l]:Da=l,s=oc(s,"onChange"),0<s.length&&(r=new Sl("onChange","change",null,r,l),n.push({event:r,listeners:s}))}var qr=null,Vr=null;function rx(n){B1(n,0)}function Cl(n){var s=zr(n);if(Hm(s))return n}function dg(n,s){if(n==="change")return s}var fg=!1;if(ei){var Ou;if(ei){var Du="oninput"in document;if(!Du){var hg=document.createElement("div");hg.setAttribute("oninput","return;"),Du=typeof hg.oninput=="function"}Ou=Du}else Ou=!1;fg=Ou&&(!document.documentMode||9<document.documentMode)}function mg(){qr&&(qr.detachEvent("onpropertychange",gg),Vr=qr=null)}function gg(n){if(n.propertyName==="value"&&Cl(Vr)){var s=[];ug(s,Vr,n,Cu(n)),Zm(rx,s)}}function ox(n,s,r){n==="focusin"?(mg(),qr=s,Vr=r,qr.attachEvent("onpropertychange",gg)):n==="focusout"&&mg()}function lx(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Cl(Vr)}function cx(n,s){if(n==="click")return Cl(s)}function ux(n,s){if(n==="input"||n==="change")return Cl(s)}function dx(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var Zn=typeof Object.is=="function"?Object.is:dx;function Hr(n,s){if(Zn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var r=Object.keys(n),l=Object.keys(s);if(r.length!==l.length)return!1;for(l=0;l<r.length;l++){var f=r[l];if(!Rt.call(s,f)||!Zn(n[f],s[f]))return!1}return!0}function pg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yg(n,s){var r=pg(n);n=0;for(var l;r;){if(r.nodeType===3){if(l=n+r.textContent.length,n<=s&&l>=s)return{node:r,offset:s-n};n=l}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=pg(r)}}function vg(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?vg(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function bg(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=vl(n.document);s instanceof n.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)n=s.contentWindow;else break;s=vl(n.document)}return s}function Bu(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}function fx(n,s){var r=bg(s);s=n.focusedElem;var l=n.selectionRange;if(r!==s&&s&&s.ownerDocument&&vg(s.ownerDocument.documentElement,s)){if(l!==null&&Bu(s)){if(n=l.start,r=l.end,r===void 0&&(r=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(r,s.value.length);else if(r=(n=s.ownerDocument||document)&&n.defaultView||window,r.getSelection){r=r.getSelection();var f=s.textContent.length,m=Math.min(l.start,f);l=l.end===void 0?m:Math.min(l.end,f),!r.extend&&m>l&&(f=l,l=m,m=f),f=yg(s,m);var S=yg(s,l);f&&S&&(r.rangeCount!==1||r.anchorNode!==f.node||r.anchorOffset!==f.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(n=n.createRange(),n.setStart(f.node,f.offset),r.removeAllRanges(),m>l?(r.addRange(n),r.extend(S.node,S.offset)):(n.setEnd(S.node,S.offset),r.addRange(n)))}}for(n=[],r=s;r=r.parentNode;)r.nodeType===1&&n.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)r=n[s],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var hx=ei&&"documentMode"in document&&11>=document.documentMode,Pa=null,zu=null,Gr=null,Pu=!1;function xg(n,s,r){var l=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Pu||Pa==null||Pa!==vl(l)||(l=Pa,"selectionStart"in l&&Bu(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),Gr&&Hr(Gr,l)||(Gr=l,l=oc(zu,"onSelect"),0<l.length&&(s=new Sl("onSelect","select",null,s,r),n.push({event:s,listeners:l}),s.target=Pa)))}function Wi(n,s){var r={};return r[n.toLowerCase()]=s.toLowerCase(),r["Webkit"+n]="webkit"+s,r["Moz"+n]="moz"+s,r}var $a={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionrun:Wi("Transition","TransitionRun"),transitionstart:Wi("Transition","TransitionStart"),transitioncancel:Wi("Transition","TransitionCancel"),transitionend:Wi("Transition","TransitionEnd")},$u={},wg={};ei&&(wg=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function Zi(n){if($u[n])return $u[n];if(!$a[n])return n;var s=$a[n],r;for(r in s)if(s.hasOwnProperty(r)&&r in wg)return $u[n]=s[r];return n}var _g=Zi("animationend"),Sg=Zi("animationiteration"),jg=Zi("animationstart"),mx=Zi("transitionrun"),gx=Zi("transitionstart"),px=Zi("transitioncancel"),Cg=Zi("transitionend"),Ng=new Map,Tg="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function js(n,s){Ng.set(n,s),Ki(s,[n])}var os=[],Ua=0,Uu=0;function Nl(){for(var n=Ua,s=Uu=Ua=0;s<n;){var r=os[s];os[s++]=null;var l=os[s];os[s++]=null;var f=os[s];os[s++]=null;var m=os[s];if(os[s++]=null,l!==null&&f!==null){var S=l.pending;S===null?f.next=f:(f.next=S.next,S.next=f),l.pending=f}m!==0&&kg(r,f,m)}}function Tl(n,s,r,l){os[Ua++]=n,os[Ua++]=s,os[Ua++]=r,os[Ua++]=l,Uu|=l,n.lanes|=l,n=n.alternate,n!==null&&(n.lanes|=l)}function Iu(n,s,r,l){return Tl(n,s,r,l),kl(n)}function xi(n,s){return Tl(n,null,null,s),kl(n)}function kg(n,s,r){n.lanes|=r;var l=n.alternate;l!==null&&(l.lanes|=r);for(var f=!1,m=n.return;m!==null;)m.childLanes|=r,l=m.alternate,l!==null&&(l.childLanes|=r),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(f=!0)),n=m,m=m.return;f&&s!==null&&n.tag===3&&(m=n.stateNode,f=31-Ze(r),m=m.hiddenUpdates,n=m[f],n===null?m[f]=[s]:n.push(s),s.lane=r|536870912)}function kl(n){if(50<vo)throw vo=0,Yd=null,Error(a(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Ia={},Eg=new WeakMap;function ls(n,s){if(typeof n=="object"&&n!==null){var r=Eg.get(n);return r!==void 0?r:(s={value:n,source:s,stack:q(s)},Eg.set(n,s),s)}return{value:n,source:s,stack:q(s)}}var Fa=[],qa=0,El=null,Al=0,cs=[],us=0,Ji=null,ni=1,si="";function ea(n,s){Fa[qa++]=Al,Fa[qa++]=El,El=n,Al=s}function Ag(n,s,r){cs[us++]=ni,cs[us++]=si,cs[us++]=Ji,Ji=n;var l=ni;n=si;var f=32-Ze(l)-1;l&=~(1<<f),r+=1;var m=32-Ze(s)+f;if(30<m){var S=f-f%5;m=(l&(1<<S)-1).toString(32),l>>=S,f-=S,ni=1<<32-Ze(s)+f|r<<f|l,si=m+n}else ni=1<<m|r<<f|l,si=n}function Fu(n){n.return!==null&&(ea(n,1),Ag(n,1,0))}function qu(n){for(;n===El;)El=Fa[--qa],Fa[qa]=null,Al=Fa[--qa],Fa[qa]=null;for(;n===Ji;)Ji=cs[--us],cs[us]=null,si=cs[--us],cs[us]=null,ni=cs[--us],cs[us]=null}var Fn=null,Rn=null,Pt=!1,Cs=null,Bs=!1,Vu=Error(a(519));function ta(n){var s=Error(a(418,""));throw Kr(ls(s,n)),Vu}function Rg(n){var s=n.stateNode,r=n.type,l=n.memoizedProps;switch(s[rt]=n,s[sn]=l,r){case"dialog":Ot("cancel",s),Ot("close",s);break;case"iframe":case"object":case"embed":Ot("load",s);break;case"video":case"audio":for(r=0;r<xo.length;r++)Ot(xo[r],s);break;case"source":Ot("error",s);break;case"img":case"image":case"link":Ot("error",s),Ot("load",s);break;case"details":Ot("toggle",s);break;case"input":Ot("invalid",s),Gm(s,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0),yl(s);break;case"select":Ot("invalid",s);break;case"textarea":Ot("invalid",s),Xm(s,l.value,l.defaultValue,l.children),yl(s)}r=l.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||s.textContent===""+r||l.suppressHydrationWarning===!0||U1(s.textContent,r)?(l.popover!=null&&(Ot("beforetoggle",s),Ot("toggle",s)),l.onScroll!=null&&Ot("scroll",s),l.onScrollEnd!=null&&Ot("scrollend",s),l.onClick!=null&&(s.onclick=lc),s=!0):s=!1,s||ta(n)}function Mg(n){for(Fn=n.return;Fn;)switch(Fn.tag){case 3:case 27:Bs=!0;return;case 5:case 13:Bs=!1;return;default:Fn=Fn.return}}function Yr(n){if(n!==Fn)return!1;if(!Pt)return Mg(n),Pt=!0,!1;var s=!1,r;if((r=n.tag!==3&&n.tag!==27)&&((r=n.tag===5)&&(r=n.type,r=!(r!=="form"&&r!=="button")||df(n.type,n.memoizedProps)),r=!r),r&&(s=!0),s&&Rn&&ta(n),Mg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));e:{for(n=n.nextSibling,s=0;n;){if(n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){Rn=Ts(n.nextSibling);break e}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++;n=n.nextSibling}Rn=null}}else Rn=Fn?Ts(n.stateNode.nextSibling):null;return!0}function Xr(){Rn=Fn=null,Pt=!1}function Kr(n){Cs===null?Cs=[n]:Cs.push(n)}var Qr=Error(a(460)),Lg=Error(a(474)),Hu={then:function(){}};function Og(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Rl(){}function Dg(n,s,r){switch(r=n[r],r===void 0?n.push(s):r!==s&&(s.then(Rl,Rl),s=r),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,n===Qr?Error(a(483)):n;default:if(typeof s.status=="string")s.then(Rl,Rl);else{if(n=Yt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=s,n.status="pending",n.then(function(l){if(s.status==="pending"){var f=s;f.status="fulfilled",f.value=l}},function(l){if(s.status==="pending"){var f=s;f.status="rejected",f.reason=l}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,n===Qr?Error(a(483)):n}throw Wr=s,Qr}}var Wr=null;function Bg(){if(Wr===null)throw Error(a(459));var n=Wr;return Wr=null,n}var Va=null,Zr=0;function Ml(n){var s=Zr;return Zr+=1,Va===null&&(Va=[]),Dg(Va,n,s)}function Jr(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Ll(n,s){throw s.$$typeof===u?Error(a(525)):(n=Object.prototype.toString.call(s),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function zg(n){var s=n._init;return s(n._payload)}function Pg(n){function s(se,W){if(n){var ce=se.deletions;ce===null?(se.deletions=[W],se.flags|=16):ce.push(W)}}function r(se,W){if(!n)return null;for(;W!==null;)s(se,W),W=W.sibling;return null}function l(se){for(var W=new Map;se!==null;)se.key!==null?W.set(se.key,se):W.set(se.index,se),se=se.sibling;return W}function f(se,W){return se=Mi(se,W),se.index=0,se.sibling=null,se}function m(se,W,ce){return se.index=ce,n?(ce=se.alternate,ce!==null?(ce=ce.index,ce<W?(se.flags|=33554434,W):ce):(se.flags|=33554434,W)):(se.flags|=1048576,W)}function S(se){return n&&se.alternate===null&&(se.flags|=33554434),se}function k(se,W,ce,Te){return W===null||W.tag!==6?(W=$d(ce,se.mode,Te),W.return=se,W):(W=f(W,ce),W.return=se,W)}function $(se,W,ce,Te){var tt=ce.type;return tt===p?xe(se,W,ce.props.children,Te,ce.key):W!==null&&(W.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===V&&zg(tt)===W.type)?(W=f(W,ce.props),Jr(W,ce),W.return=se,W):(W=Wl(ce.type,ce.key,ce.props,null,se.mode,Te),Jr(W,ce),W.return=se,W)}function Z(se,W,ce,Te){return W===null||W.tag!==4||W.stateNode.containerInfo!==ce.containerInfo||W.stateNode.implementation!==ce.implementation?(W=Ud(ce,se.mode,Te),W.return=se,W):(W=f(W,ce.children||[]),W.return=se,W)}function xe(se,W,ce,Te,tt){return W===null||W.tag!==7?(W=da(ce,se.mode,Te,tt),W.return=se,W):(W=f(W,ce),W.return=se,W)}function De(se,W,ce){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=$d(""+W,se.mode,ce),W.return=se,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case d:return ce=Wl(W.type,W.key,W.props,null,se.mode,ce),Jr(ce,W),ce.return=se,ce;case h:return W=Ud(W,se.mode,ce),W.return=se,W;case V:var Te=W._init;return W=Te(W._payload),De(se,W,ce)}if(ge(W)||H(W))return W=da(W,se.mode,ce,null),W.return=se,W;if(typeof W.then=="function")return De(se,Ml(W),ce);if(W.$$typeof===j)return De(se,Xl(se,W),ce);Ll(se,W)}return null}function ue(se,W,ce,Te){var tt=W!==null?W.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return tt!==null?null:k(se,W,""+ce,Te);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case d:return ce.key===tt?$(se,W,ce,Te):null;case h:return ce.key===tt?Z(se,W,ce,Te):null;case V:return tt=ce._init,ce=tt(ce._payload),ue(se,W,ce,Te)}if(ge(ce)||H(ce))return tt!==null?null:xe(se,W,ce,Te,null);if(typeof ce.then=="function")return ue(se,W,Ml(ce),Te);if(ce.$$typeof===j)return ue(se,W,Xl(se,ce),Te);Ll(se,ce)}return null}function be(se,W,ce,Te,tt){if(typeof Te=="string"&&Te!==""||typeof Te=="number"||typeof Te=="bigint")return se=se.get(ce)||null,k(W,se,""+Te,tt);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case d:return se=se.get(Te.key===null?ce:Te.key)||null,$(W,se,Te,tt);case h:return se=se.get(Te.key===null?ce:Te.key)||null,Z(W,se,Te,tt);case V:var kt=Te._init;return Te=kt(Te._payload),be(se,W,ce,Te,tt)}if(ge(Te)||H(Te))return se=se.get(ce)||null,xe(W,se,Te,tt,null);if(typeof Te.then=="function")return be(se,W,ce,Ml(Te),tt);if(Te.$$typeof===j)return be(se,W,ce,Xl(W,Te),tt);Ll(W,Te)}return null}function it(se,W,ce,Te){for(var tt=null,kt=null,ot=W,gt=W=0,Tn=null;ot!==null&&gt<ce.length;gt++){ot.index>gt?(Tn=ot,ot=null):Tn=ot.sibling;var $t=ue(se,ot,ce[gt],Te);if($t===null){ot===null&&(ot=Tn);break}n&&ot&&$t.alternate===null&&s(se,ot),W=m($t,W,gt),kt===null?tt=$t:kt.sibling=$t,kt=$t,ot=Tn}if(gt===ce.length)return r(se,ot),Pt&&ea(se,gt),tt;if(ot===null){for(;gt<ce.length;gt++)ot=De(se,ce[gt],Te),ot!==null&&(W=m(ot,W,gt),kt===null?tt=ot:kt.sibling=ot,kt=ot);return Pt&&ea(se,gt),tt}for(ot=l(ot);gt<ce.length;gt++)Tn=be(ot,se,gt,ce[gt],Te),Tn!==null&&(n&&Tn.alternate!==null&&ot.delete(Tn.key===null?gt:Tn.key),W=m(Tn,W,gt),kt===null?tt=Tn:kt.sibling=Tn,kt=Tn);return n&&ot.forEach(function($i){return s(se,$i)}),Pt&&ea(se,gt),tt}function St(se,W,ce,Te){if(ce==null)throw Error(a(151));for(var tt=null,kt=null,ot=W,gt=W=0,Tn=null,$t=ce.next();ot!==null&&!$t.done;gt++,$t=ce.next()){ot.index>gt?(Tn=ot,ot=null):Tn=ot.sibling;var $i=ue(se,ot,$t.value,Te);if($i===null){ot===null&&(ot=Tn);break}n&&ot&&$i.alternate===null&&s(se,ot),W=m($i,W,gt),kt===null?tt=$i:kt.sibling=$i,kt=$i,ot=Tn}if($t.done)return r(se,ot),Pt&&ea(se,gt),tt;if(ot===null){for(;!$t.done;gt++,$t=ce.next())$t=De(se,$t.value,Te),$t!==null&&(W=m($t,W,gt),kt===null?tt=$t:kt.sibling=$t,kt=$t);return Pt&&ea(se,gt),tt}for(ot=l(ot);!$t.done;gt++,$t=ce.next())$t=be(ot,se,gt,$t.value,Te),$t!==null&&(n&&$t.alternate!==null&&ot.delete($t.key===null?gt:$t.key),W=m($t,W,gt),kt===null?tt=$t:kt.sibling=$t,kt=$t);return n&&ot.forEach(function(Aw){return s(se,Aw)}),Pt&&ea(se,gt),tt}function ln(se,W,ce,Te){if(typeof ce=="object"&&ce!==null&&ce.type===p&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case d:e:{for(var tt=ce.key;W!==null;){if(W.key===tt){if(tt=ce.type,tt===p){if(W.tag===7){r(se,W.sibling),Te=f(W,ce.props.children),Te.return=se,se=Te;break e}}else if(W.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===V&&zg(tt)===W.type){r(se,W.sibling),Te=f(W,ce.props),Jr(Te,ce),Te.return=se,se=Te;break e}r(se,W);break}else s(se,W);W=W.sibling}ce.type===p?(Te=da(ce.props.children,se.mode,Te,ce.key),Te.return=se,se=Te):(Te=Wl(ce.type,ce.key,ce.props,null,se.mode,Te),Jr(Te,ce),Te.return=se,se=Te)}return S(se);case h:e:{for(tt=ce.key;W!==null;){if(W.key===tt)if(W.tag===4&&W.stateNode.containerInfo===ce.containerInfo&&W.stateNode.implementation===ce.implementation){r(se,W.sibling),Te=f(W,ce.children||[]),Te.return=se,se=Te;break e}else{r(se,W);break}else s(se,W);W=W.sibling}Te=Ud(ce,se.mode,Te),Te.return=se,se=Te}return S(se);case V:return tt=ce._init,ce=tt(ce._payload),ln(se,W,ce,Te)}if(ge(ce))return it(se,W,ce,Te);if(H(ce)){if(tt=H(ce),typeof tt!="function")throw Error(a(150));return ce=tt.call(ce),St(se,W,ce,Te)}if(typeof ce.then=="function")return ln(se,W,Ml(ce),Te);if(ce.$$typeof===j)return ln(se,W,Xl(se,ce),Te);Ll(se,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,W!==null&&W.tag===6?(r(se,W.sibling),Te=f(W,ce),Te.return=se,se=Te):(r(se,W),Te=$d(ce,se.mode,Te),Te.return=se,se=Te),S(se)):r(se,W)}return function(se,W,ce,Te){try{Zr=0;var tt=ln(se,W,ce,Te);return Va=null,tt}catch(ot){if(ot===Qr)throw ot;var kt=ms(29,ot,null,se.mode);return kt.lanes=Te,kt.return=se,kt}finally{}}}var na=Pg(!0),$g=Pg(!1),Ha=ze(null),Ol=ze(0);function Ug(n,s){n=mi,Qe(Ol,n),Qe(Ha,s),mi=n|s.baseLanes}function Gu(){Qe(Ol,mi),Qe(Ha,Ha.current)}function Yu(){mi=Ol.current,Xe(Ha),Xe(Ol)}var ds=ze(null),zs=null;function wi(n){var s=n.alternate;Qe(bn,bn.current&1),Qe(ds,n),zs===null&&(s===null||Ha.current!==null||s.memoizedState!==null)&&(zs=n)}function Ig(n){if(n.tag===22){if(Qe(bn,bn.current),Qe(ds,n),zs===null){var s=n.alternate;s!==null&&s.memoizedState!==null&&(zs=n)}}else _i()}function _i(){Qe(bn,bn.current),Qe(ds,ds.current)}function ii(n){Xe(ds),zs===n&&(zs=null),Xe(bn)}var bn=ze(0);function Dl(n){for(var s=n;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var yx=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(r,l){n.push(l)}};this.abort=function(){s.aborted=!0,n.forEach(function(r){return r()})}},vx=t.unstable_scheduleCallback,bx=t.unstable_NormalPriority,xn={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xu(){return{controller:new yx,data:new Map,refCount:0}}function eo(n){n.refCount--,n.refCount===0&&vx(bx,function(){n.controller.abort()})}var to=null,Ku=0,Ga=0,Ya=null;function xx(n,s){if(to===null){var r=to=[];Ku=0,Ga=tf(),Ya={status:"pending",value:void 0,then:function(l){r.push(l)}}}return Ku++,s.then(Fg,Fg),s}function Fg(){if(--Ku===0&&to!==null){Ya!==null&&(Ya.status="fulfilled");var n=to;to=null,Ga=0,Ya=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function wx(n,s){var r=[],l={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return n.then(function(){l.status="fulfilled",l.value=s;for(var f=0;f<r.length;f++)(0,r[f])(s)},function(f){for(l.status="rejected",l.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),l}var qg=P.S;P.S=function(n,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&xx(n,s),qg!==null&&qg(n,s)};var sa=ze(null);function Qu(){var n=sa.current;return n!==null?n:Yt.pooledCache}function Bl(n,s){s===null?Qe(sa,sa.current):Qe(sa,s.pool)}function Vg(){var n=Qu();return n===null?null:{parent:xn._currentValue,pool:n}}var Si=0,Tt=null,qt=null,gn=null,zl=!1,Xa=!1,ia=!1,Pl=0,no=0,Ka=null,_x=0;function dn(){throw Error(a(321))}function Wu(n,s){if(s===null)return!1;for(var r=0;r<s.length&&r<n.length;r++)if(!Zn(n[r],s[r]))return!1;return!0}function Zu(n,s,r,l,f,m){return Si=m,Tt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,P.H=n===null||n.memoizedState===null?aa:ji,ia=!1,m=r(l,f),ia=!1,Xa&&(m=Gg(s,r,l,f)),Hg(n),m}function Hg(n){P.H=Ps;var s=qt!==null&&qt.next!==null;if(Si=0,gn=qt=Tt=null,zl=!1,no=0,Ka=null,s)throw Error(a(300));n===null||Cn||(n=n.dependencies,n!==null&&Yl(n)&&(Cn=!0))}function Gg(n,s,r,l){Tt=n;var f=0;do{if(Xa&&(Ka=null),no=0,Xa=!1,25<=f)throw Error(a(301));if(f+=1,gn=qt=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}P.H=ra,m=s(r,l)}while(Xa);return m}function Sx(){var n=P.H,s=n.useState()[0];return s=typeof s.then=="function"?so(s):s,n=n.useState()[0],(qt!==null?qt.memoizedState:null)!==n&&(Tt.flags|=1024),s}function Ju(){var n=Pl!==0;return Pl=0,n}function ed(n,s,r){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~r}function td(n){if(zl){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}zl=!1}Si=0,gn=qt=Tt=null,Xa=!1,no=Pl=0,Ka=null}function Xn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gn===null?Tt.memoizedState=gn=n:gn=gn.next=n,gn}function pn(){if(qt===null){var n=Tt.alternate;n=n!==null?n.memoizedState:null}else n=qt.next;var s=gn===null?Tt.memoizedState:gn.next;if(s!==null)gn=s,qt=n;else{if(n===null)throw Tt.alternate===null?Error(a(467)):Error(a(310));qt=n,n={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},gn===null?Tt.memoizedState=gn=n:gn=gn.next=n}return gn}var $l;$l=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function so(n){var s=no;return no+=1,Ka===null&&(Ka=[]),n=Dg(Ka,n,s),s=Tt,(gn===null?s.memoizedState:gn.next)===null&&(s=s.alternate,P.H=s===null||s.memoizedState===null?aa:ji),n}function Ul(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return so(n);if(n.$$typeof===j)return Dn(n)}throw Error(a(438,String(n)))}function nd(n){var s=null,r=Tt.updateQueue;if(r!==null&&(s=r.memoCache),s==null){var l=Tt.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(s={data:l.data.map(function(f){return f.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),r===null&&(r=$l(),Tt.updateQueue=r),r.memoCache=s,r=s.data[s.index],r===void 0)for(r=s.data[s.index]=Array(n),l=0;l<n;l++)r[l]=O;return s.index++,r}function ai(n,s){return typeof s=="function"?s(n):s}function Il(n){var s=pn();return sd(s,qt,n)}function sd(n,s,r){var l=n.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=r;var f=n.baseQueue,m=l.pending;if(m!==null){if(f!==null){var S=f.next;f.next=m.next,m.next=S}s.baseQueue=f=m,l.pending=null}if(m=n.baseState,f===null)n.memoizedState=m;else{s=f.next;var k=S=null,$=null,Z=s,xe=!1;do{var De=Z.lane&-536870913;if(De!==Z.lane?(zt&De)===De:(Si&De)===De){var ue=Z.revertLane;if(ue===0)$!==null&&($=$.next={lane:0,revertLane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),De===Ga&&(xe=!0);else if((Si&ue)===ue){Z=Z.next,ue===Ga&&(xe=!0);continue}else De={lane:0,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},$===null?(k=$=De,S=m):$=$.next=De,Tt.lanes|=ue,Li|=ue;De=Z.action,ia&&r(m,De),m=Z.hasEagerState?Z.eagerState:r(m,De)}else ue={lane:De,revertLane:Z.revertLane,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},$===null?(k=$=ue,S=m):$=$.next=ue,Tt.lanes|=De,Li|=De;Z=Z.next}while(Z!==null&&Z!==s);if($===null?S=m:$.next=k,!Zn(m,n.memoizedState)&&(Cn=!0,xe&&(r=Ya,r!==null)))throw r;n.memoizedState=m,n.baseState=S,n.baseQueue=$,l.lastRenderedState=m}return f===null&&(l.lanes=0),[n.memoizedState,l.dispatch]}function id(n){var s=pn(),r=s.queue;if(r===null)throw Error(a(311));r.lastRenderedReducer=n;var l=r.dispatch,f=r.pending,m=s.memoizedState;if(f!==null){r.pending=null;var S=f=f.next;do m=n(m,S.action),S=S.next;while(S!==f);Zn(m,s.memoizedState)||(Cn=!0),s.memoizedState=m,s.baseQueue===null&&(s.baseState=m),r.lastRenderedState=m}return[m,l]}function Yg(n,s,r){var l=Tt,f=pn(),m=Pt;if(m){if(r===void 0)throw Error(a(407));r=r()}else r=s();var S=!Zn((qt||f).memoizedState,r);if(S&&(f.memoizedState=r,Cn=!0),f=f.queue,od(Qg.bind(null,l,f,n),[n]),f.getSnapshot!==s||S||gn!==null&&gn.memoizedState.tag&1){if(l.flags|=2048,Qa(9,Kg.bind(null,l,f,r,s),{destroy:void 0},null),Yt===null)throw Error(a(349));m||(Si&60)!==0||Xg(l,s,r)}return r}function Xg(n,s,r){n.flags|=16384,n={getSnapshot:s,value:r},s=Tt.updateQueue,s===null?(s=$l(),Tt.updateQueue=s,s.stores=[n]):(r=s.stores,r===null?s.stores=[n]:r.push(n))}function Kg(n,s,r,l){s.value=r,s.getSnapshot=l,Wg(s)&&Zg(n)}function Qg(n,s,r){return r(function(){Wg(s)&&Zg(n)})}function Wg(n){var s=n.getSnapshot;n=n.value;try{var r=s();return!Zn(n,r)}catch{return!0}}function Zg(n){var s=xi(n,2);s!==null&&qn(s,n,2)}function ad(n){var s=Xn();if(typeof n=="function"){var r=n;if(n=r(),ia){le(!0);try{r()}finally{le(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:n},s}function Jg(n,s,r,l){return n.baseState=r,sd(n,qt,typeof l=="function"?l:ai)}function jx(n,s,r,l,f){if(Vl(n))throw Error(a(485));if(n=s.action,n!==null){var m={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){m.listeners.push(S)}};P.T!==null?r(!0):m.isTransition=!1,l(m),r=s.pending,r===null?(m.next=s.pending=m,ep(s,m)):(m.next=r.next,s.pending=r.next=m)}}function ep(n,s){var r=s.action,l=s.payload,f=n.state;if(s.isTransition){var m=P.T,S={};P.T=S;try{var k=r(f,l),$=P.S;$!==null&&$(S,k),tp(n,s,k)}catch(Z){rd(n,s,Z)}finally{P.T=m}}else try{m=r(f,l),tp(n,s,m)}catch(Z){rd(n,s,Z)}}function tp(n,s,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(l){np(n,s,l)},function(l){return rd(n,s,l)}):np(n,s,r)}function np(n,s,r){s.status="fulfilled",s.value=r,sp(s),n.state=r,s=n.pending,s!==null&&(r=s.next,r===s?n.pending=null:(r=r.next,s.next=r,ep(n,r)))}function rd(n,s,r){var l=n.pending;if(n.pending=null,l!==null){l=l.next;do s.status="rejected",s.reason=r,sp(s),s=s.next;while(s!==l)}n.action=null}function sp(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function ip(n,s){return s}function ap(n,s){if(Pt){var r=Yt.formState;if(r!==null){e:{var l=Tt;if(Pt){if(Rn){t:{for(var f=Rn,m=Bs;f.nodeType!==8;){if(!m){f=null;break t}if(f=Ts(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Rn=Ts(f.nextSibling),l=f.data==="F!";break e}}ta(l)}l=!1}l&&(s=r[0])}}return r=Xn(),r.memoizedState=r.baseState=s,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ip,lastRenderedState:s},r.queue=l,r=Sp.bind(null,Tt,l),l.dispatch=r,l=ad(!1),m=fd.bind(null,Tt,!1,l.queue),l=Xn(),f={state:s,dispatch:null,action:n,pending:null},l.queue=f,r=jx.bind(null,Tt,f,m,r),f.dispatch=r,l.memoizedState=n,[s,r,!1]}function rp(n){var s=pn();return op(s,qt,n)}function op(n,s,r){s=sd(n,s,ip)[0],n=Il(ai)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?so(s):s;var l=pn(),f=l.queue,m=f.dispatch;return r!==l.memoizedState&&(Tt.flags|=2048,Qa(9,Cx.bind(null,f,r),{destroy:void 0},null)),[s,m,n]}function Cx(n,s){n.action=s}function lp(n){var s=pn(),r=qt;if(r!==null)return op(s,r,n);pn(),s=s.memoizedState,r=pn();var l=r.queue.dispatch;return r.memoizedState=n,[s,l,!1]}function Qa(n,s,r,l){return n={tag:n,create:s,inst:r,deps:l,next:null},s=Tt.updateQueue,s===null&&(s=$l(),Tt.updateQueue=s),r=s.lastEffect,r===null?s.lastEffect=n.next=n:(l=r.next,r.next=n,n.next=l,s.lastEffect=n),n}function cp(){return pn().memoizedState}function Fl(n,s,r,l){var f=Xn();Tt.flags|=n,f.memoizedState=Qa(1|s,r,{destroy:void 0},l===void 0?null:l)}function ql(n,s,r,l){var f=pn();l=l===void 0?null:l;var m=f.memoizedState.inst;qt!==null&&l!==null&&Wu(l,qt.memoizedState.deps)?f.memoizedState=Qa(s,r,m,l):(Tt.flags|=n,f.memoizedState=Qa(1|s,r,m,l))}function up(n,s){Fl(8390656,8,n,s)}function od(n,s){ql(2048,8,n,s)}function dp(n,s){return ql(4,2,n,s)}function fp(n,s){return ql(4,4,n,s)}function hp(n,s){if(typeof s=="function"){n=n();var r=s(n);return function(){typeof r=="function"?r():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function mp(n,s,r){r=r!=null?r.concat([n]):null,ql(4,4,hp.bind(null,s,n),r)}function ld(){}function gp(n,s){var r=pn();s=s===void 0?null:s;var l=r.memoizedState;return s!==null&&Wu(s,l[1])?l[0]:(r.memoizedState=[n,s],n)}function pp(n,s){var r=pn();s=s===void 0?null:s;var l=r.memoizedState;if(s!==null&&Wu(s,l[1]))return l[0];if(l=n(),ia){le(!0);try{n()}finally{le(!1)}}return r.memoizedState=[l,s],l}function cd(n,s,r){return r===void 0||(Si&1073741824)!==0?n.memoizedState=s:(n.memoizedState=r,n=v1(),Tt.lanes|=n,Li|=n,r)}function yp(n,s,r,l){return Zn(r,s)?r:Ha.current!==null?(n=cd(n,r,l),Zn(n,s)||(Cn=!0),n):(Si&42)===0?(Cn=!0,n.memoizedState=r):(n=v1(),Tt.lanes|=n,Li|=n,s)}function vp(n,s,r,l,f){var m=ee.p;ee.p=m!==0&&8>m?m:8;var S=P.T,k={};P.T=k,fd(n,!1,s,r);try{var $=f(),Z=P.S;if(Z!==null&&Z(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var xe=wx($,l);io(n,s,xe,ns(n))}else io(n,s,l,ns(n))}catch(De){io(n,s,{then:function(){},status:"rejected",reason:De},ns())}finally{ee.p=m,P.T=S}}function Nx(){}function ud(n,s,r,l){if(n.tag!==5)throw Error(a(476));var f=bp(n).queue;vp(n,f,s,Re,r===null?Nx:function(){return xp(n),r(l)})}function bp(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:Re},next:null};var r={};return s.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ai,lastRenderedState:r},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function xp(n){var s=bp(n).next.queue;io(n,s,{},ns())}function dd(){return Dn(Co)}function wp(){return pn().memoizedState}function _p(){return pn().memoizedState}function Tx(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var r=ns();n=Ti(r);var l=ki(s,n,r);l!==null&&(qn(l,s,r),oo(l,s,r)),s={cache:Xu()},n.payload=s;return}s=s.return}}function kx(n,s,r){var l=ns();r={lane:l,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null},Vl(n)?jp(s,r):(r=Iu(n,s,r,l),r!==null&&(qn(r,n,l),Cp(r,s,l)))}function Sp(n,s,r){var l=ns();io(n,s,r,l)}function io(n,s,r,l){var f={lane:l,revertLane:0,action:r,hasEagerState:!1,eagerState:null,next:null};if(Vl(n))jp(s,f);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=s.lastRenderedReducer,m!==null))try{var S=s.lastRenderedState,k=m(S,r);if(f.hasEagerState=!0,f.eagerState=k,Zn(k,S))return Tl(n,s,f,0),Yt===null&&Nl(),!1}catch{}finally{}if(r=Iu(n,s,f,l),r!==null)return qn(r,n,l),Cp(r,s,l),!0}return!1}function fd(n,s,r,l){if(l={lane:2,revertLane:tf(),action:l,hasEagerState:!1,eagerState:null,next:null},Vl(n)){if(s)throw Error(a(479))}else s=Iu(n,r,l,2),s!==null&&qn(s,n,2)}function Vl(n){var s=n.alternate;return n===Tt||s!==null&&s===Tt}function jp(n,s){Xa=zl=!0;var r=n.pending;r===null?s.next=s:(s.next=r.next,r.next=s),n.pending=s}function Cp(n,s,r){if((r&4194176)!==0){var l=s.lanes;l&=n.pendingLanes,r|=l,s.lanes=r,oe(n,r)}}var Ps={readContext:Dn,use:Ul,useCallback:dn,useContext:dn,useEffect:dn,useImperativeHandle:dn,useLayoutEffect:dn,useInsertionEffect:dn,useMemo:dn,useReducer:dn,useRef:dn,useState:dn,useDebugValue:dn,useDeferredValue:dn,useTransition:dn,useSyncExternalStore:dn,useId:dn};Ps.useCacheRefresh=dn,Ps.useMemoCache=dn,Ps.useHostTransitionStatus=dn,Ps.useFormState=dn,Ps.useActionState=dn,Ps.useOptimistic=dn;var aa={readContext:Dn,use:Ul,useCallback:function(n,s){return Xn().memoizedState=[n,s===void 0?null:s],n},useContext:Dn,useEffect:up,useImperativeHandle:function(n,s,r){r=r!=null?r.concat([n]):null,Fl(4194308,4,hp.bind(null,s,n),r)},useLayoutEffect:function(n,s){return Fl(4194308,4,n,s)},useInsertionEffect:function(n,s){Fl(4,2,n,s)},useMemo:function(n,s){var r=Xn();s=s===void 0?null:s;var l=n();if(ia){le(!0);try{n()}finally{le(!1)}}return r.memoizedState=[l,s],l},useReducer:function(n,s,r){var l=Xn();if(r!==void 0){var f=r(s);if(ia){le(!0);try{r(s)}finally{le(!1)}}}else f=s;return l.memoizedState=l.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},l.queue=n,n=n.dispatch=kx.bind(null,Tt,n),[l.memoizedState,n]},useRef:function(n){var s=Xn();return n={current:n},s.memoizedState=n},useState:function(n){n=ad(n);var s=n.queue,r=Sp.bind(null,Tt,s);return s.dispatch=r,[n.memoizedState,r]},useDebugValue:ld,useDeferredValue:function(n,s){var r=Xn();return cd(r,n,s)},useTransition:function(){var n=ad(!1);return n=vp.bind(null,Tt,n.queue,!0,!1),Xn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,r){var l=Tt,f=Xn();if(Pt){if(r===void 0)throw Error(a(407));r=r()}else{if(r=s(),Yt===null)throw Error(a(349));(zt&60)!==0||Xg(l,s,r)}f.memoizedState=r;var m={value:r,getSnapshot:s};return f.queue=m,up(Qg.bind(null,l,m,n),[n]),l.flags|=2048,Qa(9,Kg.bind(null,l,m,r,s),{destroy:void 0},null),r},useId:function(){var n=Xn(),s=Yt.identifierPrefix;if(Pt){var r=si,l=ni;r=(l&~(1<<32-Ze(l)-1)).toString(32)+r,s=":"+s+"R"+r,r=Pl++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=_x++,s=":"+s+"r"+r.toString(32)+":";return n.memoizedState=s},useCacheRefresh:function(){return Xn().memoizedState=Tx.bind(null,Tt)}};aa.useMemoCache=nd,aa.useHostTransitionStatus=dd,aa.useFormState=ap,aa.useActionState=ap,aa.useOptimistic=function(n){var s=Xn();s.memoizedState=s.baseState=n;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=r,s=fd.bind(null,Tt,!0,r),r.dispatch=s,[n,s]};var ji={readContext:Dn,use:Ul,useCallback:gp,useContext:Dn,useEffect:od,useImperativeHandle:mp,useInsertionEffect:dp,useLayoutEffect:fp,useMemo:pp,useReducer:Il,useRef:cp,useState:function(){return Il(ai)},useDebugValue:ld,useDeferredValue:function(n,s){var r=pn();return yp(r,qt.memoizedState,n,s)},useTransition:function(){var n=Il(ai)[0],s=pn().memoizedState;return[typeof n=="boolean"?n:so(n),s]},useSyncExternalStore:Yg,useId:wp};ji.useCacheRefresh=_p,ji.useMemoCache=nd,ji.useHostTransitionStatus=dd,ji.useFormState=rp,ji.useActionState=rp,ji.useOptimistic=function(n,s){var r=pn();return Jg(r,qt,n,s)};var ra={readContext:Dn,use:Ul,useCallback:gp,useContext:Dn,useEffect:od,useImperativeHandle:mp,useInsertionEffect:dp,useLayoutEffect:fp,useMemo:pp,useReducer:id,useRef:cp,useState:function(){return id(ai)},useDebugValue:ld,useDeferredValue:function(n,s){var r=pn();return qt===null?cd(r,n,s):yp(r,qt.memoizedState,n,s)},useTransition:function(){var n=id(ai)[0],s=pn().memoizedState;return[typeof n=="boolean"?n:so(n),s]},useSyncExternalStore:Yg,useId:wp};ra.useCacheRefresh=_p,ra.useMemoCache=nd,ra.useHostTransitionStatus=dd,ra.useFormState=lp,ra.useActionState=lp,ra.useOptimistic=function(n,s){var r=pn();return qt!==null?Jg(r,qt,n,s):(r.baseState=n,[n,r.queue.dispatch])};function hd(n,s,r,l){s=n.memoizedState,r=r(l,s),r=r==null?s:G({},s,r),n.memoizedState=r,n.lanes===0&&(n.updateQueue.baseState=r)}var md={isMounted:function(n){return(n=n._reactInternals)?J(n)===n:!1},enqueueSetState:function(n,s,r){n=n._reactInternals;var l=ns(),f=Ti(l);f.payload=s,r!=null&&(f.callback=r),s=ki(n,f,l),s!==null&&(qn(s,n,l),oo(s,n,l))},enqueueReplaceState:function(n,s,r){n=n._reactInternals;var l=ns(),f=Ti(l);f.tag=1,f.payload=s,r!=null&&(f.callback=r),s=ki(n,f,l),s!==null&&(qn(s,n,l),oo(s,n,l))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var r=ns(),l=Ti(r);l.tag=2,s!=null&&(l.callback=s),s=ki(n,l,r),s!==null&&(qn(s,n,r),oo(s,n,r))}};function Np(n,s,r,l,f,m,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(l,m,S):s.prototype&&s.prototype.isPureReactComponent?!Hr(r,l)||!Hr(f,m):!0}function Tp(n,s,r,l){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,l),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,l),s.state!==n&&md.enqueueReplaceState(s,s.state,null)}function oa(n,s){var r=s;if("ref"in s){r={};for(var l in s)l!=="ref"&&(r[l]=s[l])}if(n=n.defaultProps){r===s&&(r=G({},r));for(var f in n)r[f]===void 0&&(r[f]=n[f])}return r}var Hl=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof qo=="object"&&typeof qo.emit=="function"){qo.emit("uncaughtException",n);return}console.error(n)};function kp(n){Hl(n)}function Ep(n){console.error(n)}function Ap(n){Hl(n)}function Gl(n,s){try{var r=n.onUncaughtError;r(s.value,{componentStack:s.stack})}catch(l){setTimeout(function(){throw l})}}function Rp(n,s,r){try{var l=n.onCaughtError;l(r.value,{componentStack:r.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function gd(n,s,r){return r=Ti(r),r.tag=3,r.payload={element:null},r.callback=function(){Gl(n,s)},r}function Mp(n){return n=Ti(n),n.tag=3,n}function Lp(n,s,r,l){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var m=l.value;n.payload=function(){return f(m)},n.callback=function(){Rp(s,r,l)}}var S=r.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(n.callback=function(){Rp(s,r,l),typeof f!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var k=l.stack;this.componentDidCatch(l.value,{componentStack:k!==null?k:""})})}function Ex(n,s,r,l,f){if(r.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(s=r.alternate,s!==null&&ro(s,r,f,!0),r=ds.current,r!==null){switch(r.tag){case 13:return zs===null?Qd():r.alternate===null&&on===0&&(on=3),r.flags&=-257,r.flags|=65536,r.lanes=f,l===Hu?r.flags|=16384:(s=r.updateQueue,s===null?r.updateQueue=new Set([l]):s.add(l),Zd(n,l,f)),!1;case 22:return r.flags|=65536,l===Hu?r.flags|=16384:(s=r.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([l])},r.updateQueue=s):(r=s.retryQueue,r===null?s.retryQueue=new Set([l]):r.add(l)),Zd(n,l,f)),!1}throw Error(a(435,r.tag))}return Zd(n,l,f),Qd(),!1}if(Pt)return s=ds.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=f,l!==Vu&&(n=Error(a(422),{cause:l}),Kr(ls(n,r)))):(l!==Vu&&(s=Error(a(423),{cause:l}),Kr(ls(s,r))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,l=ls(l,r),f=gd(n.stateNode,l,f),Ad(n,f),on!==4&&(on=2)),!1;var m=Error(a(520),{cause:l});if(m=ls(m,r),po===null?po=[m]:po.push(m),on!==4&&(on=2),s===null)return!0;l=ls(l,r),r=s;do{switch(r.tag){case 3:return r.flags|=65536,n=f&-f,r.lanes|=n,n=gd(r.stateNode,l,n),Ad(r,n),!1;case 1:if(s=r.type,m=r.stateNode,(r.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Oi===null||!Oi.has(m))))return r.flags|=65536,f&=-f,r.lanes|=f,f=Mp(f),Lp(f,n,r,l),Ad(r,f),!1}r=r.return}while(r!==null);return!1}var Op=Error(a(461)),Cn=!1;function Mn(n,s,r,l){s.child=n===null?$g(s,null,r,l):na(s,n.child,r,l)}function Dp(n,s,r,l,f){r=r.render;var m=s.ref;if("ref"in l){var S={};for(var k in l)k!=="ref"&&(S[k]=l[k])}else S=l;return ca(s),l=Zu(n,s,r,S,m,f),k=Ju(),n!==null&&!Cn?(ed(n,s,f),ri(n,s,f)):(Pt&&k&&Fu(s),s.flags|=1,Mn(n,s,l,f),s.child)}function Bp(n,s,r,l,f){if(n===null){var m=r.type;return typeof m=="function"&&!Pd(m)&&m.defaultProps===void 0&&r.compare===null?(s.tag=15,s.type=m,zp(n,s,m,l,f)):(n=Wl(r.type,null,l,s,s.mode,f),n.ref=s.ref,n.return=s,s.child=n)}if(m=n.child,!jd(n,f)){var S=m.memoizedProps;if(r=r.compare,r=r!==null?r:Hr,r(S,l)&&n.ref===s.ref)return ri(n,s,f)}return s.flags|=1,n=Mi(m,l),n.ref=s.ref,n.return=s,s.child=n}function zp(n,s,r,l,f){if(n!==null){var m=n.memoizedProps;if(Hr(m,l)&&n.ref===s.ref)if(Cn=!1,s.pendingProps=l=m,jd(n,f))(n.flags&131072)!==0&&(Cn=!0);else return s.lanes=n.lanes,ri(n,s,f)}return pd(n,s,r,l,f)}function Pp(n,s,r){var l=s.pendingProps,f=l.children,m=(s.stateNode._pendingVisibility&2)!==0,S=n!==null?n.memoizedState:null;if(ao(n,s),l.mode==="hidden"||m){if((s.flags&128)!==0){if(l=S!==null?S.baseLanes|r:r,n!==null){for(f=s.child=n.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;s.childLanes=m&~l}else s.childLanes=0,s.child=null;return $p(n,s,l,r)}if((r&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&Bl(s,S!==null?S.cachePool:null),S!==null?Ug(s,S):Gu(),Ig(s);else return s.lanes=s.childLanes=536870912,$p(n,s,S!==null?S.baseLanes|r:r,r)}else S!==null?(Bl(s,S.cachePool),Ug(s,S),_i(),s.memoizedState=null):(n!==null&&Bl(s,null),Gu(),_i());return Mn(n,s,f,r),s.child}function $p(n,s,r,l){var f=Qu();return f=f===null?null:{parent:xn._currentValue,pool:f},s.memoizedState={baseLanes:r,cachePool:f},n!==null&&Bl(s,null),Gu(),Ig(s),n!==null&&ro(n,s,l,!0),null}function ao(n,s){var r=s.ref;if(r===null)n!==null&&n.ref!==null&&(s.flags|=2097664);else{if(typeof r!="function"&&typeof r!="object")throw Error(a(284));(n===null||n.ref!==r)&&(s.flags|=2097664)}}function pd(n,s,r,l,f){return ca(s),r=Zu(n,s,r,l,void 0,f),l=Ju(),n!==null&&!Cn?(ed(n,s,f),ri(n,s,f)):(Pt&&l&&Fu(s),s.flags|=1,Mn(n,s,r,f),s.child)}function Up(n,s,r,l,f,m){return ca(s),s.updateQueue=null,r=Gg(s,l,r,f),Hg(n),l=Ju(),n!==null&&!Cn?(ed(n,s,m),ri(n,s,m)):(Pt&&l&&Fu(s),s.flags|=1,Mn(n,s,r,m),s.child)}function Ip(n,s,r,l,f){if(ca(s),s.stateNode===null){var m=Ia,S=r.contextType;typeof S=="object"&&S!==null&&(m=Dn(S)),m=new r(l,m),s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=md,s.stateNode=m,m._reactInternals=s,m=s.stateNode,m.props=l,m.state=s.memoizedState,m.refs={},kd(s),S=r.contextType,m.context=typeof S=="object"&&S!==null?Dn(S):Ia,m.state=s.memoizedState,S=r.getDerivedStateFromProps,typeof S=="function"&&(hd(s,r,S,l),m.state=s.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(S=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),S!==m.state&&md.enqueueReplaceState(m,m.state,null),co(s,l,m,f),lo(),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308),l=!0}else if(n===null){m=s.stateNode;var k=s.memoizedProps,$=oa(r,k);m.props=$;var Z=m.context,xe=r.contextType;S=Ia,typeof xe=="object"&&xe!==null&&(S=Dn(xe));var De=r.getDerivedStateFromProps;xe=typeof De=="function"||typeof m.getSnapshotBeforeUpdate=="function",k=s.pendingProps!==k,xe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(k||Z!==S)&&Tp(s,m,l,S),Ni=!1;var ue=s.memoizedState;m.state=ue,co(s,l,m,f),lo(),Z=s.memoizedState,k||ue!==Z||Ni?(typeof De=="function"&&(hd(s,r,De,l),Z=s.memoizedState),($=Ni||Np(s,r,$,l,ue,Z,S))?(xe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(s.flags|=4194308)):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=l,s.memoizedState=Z),m.props=l,m.state=Z,m.context=S,l=$):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),l=!1)}else{m=s.stateNode,Ed(n,s),S=s.memoizedProps,xe=oa(r,S),m.props=xe,De=s.pendingProps,ue=m.context,Z=r.contextType,$=Ia,typeof Z=="object"&&Z!==null&&($=Dn(Z)),k=r.getDerivedStateFromProps,(Z=typeof k=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S!==De||ue!==$)&&Tp(s,m,l,$),Ni=!1,ue=s.memoizedState,m.state=ue,co(s,l,m,f),lo();var be=s.memoizedState;S!==De||ue!==be||Ni||n!==null&&n.dependencies!==null&&Yl(n.dependencies)?(typeof k=="function"&&(hd(s,r,k,l),be=s.memoizedState),(xe=Ni||Np(s,r,xe,l,ue,be,$)||n!==null&&n.dependencies!==null&&Yl(n.dependencies))?(Z||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(l,be,$),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(l,be,$)),typeof m.componentDidUpdate=="function"&&(s.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof m.componentDidUpdate!="function"||S===n.memoizedProps&&ue===n.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&ue===n.memoizedState||(s.flags|=1024),s.memoizedProps=l,s.memoizedState=be),m.props=l,m.state=be,m.context=$,l=xe):(typeof m.componentDidUpdate!="function"||S===n.memoizedProps&&ue===n.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&ue===n.memoizedState||(s.flags|=1024),l=!1)}return m=l,ao(n,s),l=(s.flags&128)!==0,m||l?(m=s.stateNode,r=l&&typeof r.getDerivedStateFromError!="function"?null:m.render(),s.flags|=1,n!==null&&l?(s.child=na(s,n.child,null,f),s.child=na(s,null,r,f)):Mn(n,s,r,f),s.memoizedState=m.state,n=s.child):n=ri(n,s,f),n}function Fp(n,s,r,l){return Xr(),s.flags|=256,Mn(n,s,r,l),s.child}var yd={dehydrated:null,treeContext:null,retryLane:0};function vd(n){return{baseLanes:n,cachePool:Vg()}}function bd(n,s,r){return n=n!==null?n.childLanes&~r:0,s&&(n|=gs),n}function qp(n,s,r){var l=s.pendingProps,f=!1,m=(s.flags&128)!==0,S;if((S=m)||(S=n!==null&&n.memoizedState===null?!1:(bn.current&2)!==0),S&&(f=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,n===null){if(Pt){if(f?wi(s):_i(),Pt){var k=Rn,$;if($=k){e:{for($=k,k=Bs;$.nodeType!==8;){if(!k){k=null;break e}if($=Ts($.nextSibling),$===null){k=null;break e}}k=$}k!==null?(s.memoizedState={dehydrated:k,treeContext:Ji!==null?{id:ni,overflow:si}:null,retryLane:536870912},$=ms(18,null,null,0),$.stateNode=k,$.return=s,s.child=$,Fn=s,Rn=null,$=!0):$=!1}$||ta(s)}if(k=s.memoizedState,k!==null&&(k=k.dehydrated,k!==null))return k.data==="$!"?s.lanes=16:s.lanes=536870912,null;ii(s)}return k=l.children,l=l.fallback,f?(_i(),f=s.mode,k=wd({mode:"hidden",children:k},f),l=da(l,f,r,null),k.return=s,l.return=s,k.sibling=l,s.child=k,f=s.child,f.memoizedState=vd(r),f.childLanes=bd(n,S,r),s.memoizedState=yd,l):(wi(s),xd(s,k))}if($=n.memoizedState,$!==null&&(k=$.dehydrated,k!==null)){if(m)s.flags&256?(wi(s),s.flags&=-257,s=_d(n,s,r)):s.memoizedState!==null?(_i(),s.child=n.child,s.flags|=128,s=null):(_i(),f=l.fallback,k=s.mode,l=wd({mode:"visible",children:l.children},k),f=da(f,k,r,null),f.flags|=2,l.return=s,f.return=s,l.sibling=f,s.child=l,na(s,n.child,null,r),l=s.child,l.memoizedState=vd(r),l.childLanes=bd(n,S,r),s.memoizedState=yd,s=f);else if(wi(s),k.data==="$!"){if(S=k.nextSibling&&k.nextSibling.dataset,S)var Z=S.dgst;S=Z,l=Error(a(419)),l.stack="",l.digest=S,Kr({value:l,source:null,stack:null}),s=_d(n,s,r)}else if(Cn||ro(n,s,r,!1),S=(r&n.childLanes)!==0,Cn||S){if(S=Yt,S!==null){if(l=r&-r,(l&42)!==0)l=1;else switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=64;break;case 268435456:l=134217728;break;default:l=0}if(l=(l&(S.suspendedLanes|r))!==0?0:l,l!==0&&l!==$.retryLane)throw $.retryLane=l,xi(n,l),qn(S,n,l),Op}k.data==="$?"||Qd(),s=_d(n,s,r)}else k.data==="$?"?(s.flags|=128,s.child=n.child,s=Vx.bind(null,n),k._reactRetry=s,s=null):(n=$.treeContext,Rn=Ts(k.nextSibling),Fn=s,Pt=!0,Cs=null,Bs=!1,n!==null&&(cs[us++]=ni,cs[us++]=si,cs[us++]=Ji,ni=n.id,si=n.overflow,Ji=s),s=xd(s,l.children),s.flags|=4096);return s}return f?(_i(),f=l.fallback,k=s.mode,$=n.child,Z=$.sibling,l=Mi($,{mode:"hidden",children:l.children}),l.subtreeFlags=$.subtreeFlags&31457280,Z!==null?f=Mi(Z,f):(f=da(f,k,r,null),f.flags|=2),f.return=s,l.return=s,l.sibling=f,s.child=l,l=f,f=s.child,k=n.child.memoizedState,k===null?k=vd(r):($=k.cachePool,$!==null?(Z=xn._currentValue,$=$.parent!==Z?{parent:Z,pool:Z}:$):$=Vg(),k={baseLanes:k.baseLanes|r,cachePool:$}),f.memoizedState=k,f.childLanes=bd(n,S,r),s.memoizedState=yd,l):(wi(s),r=n.child,n=r.sibling,r=Mi(r,{mode:"visible",children:l.children}),r.return=s,r.sibling=null,n!==null&&(S=s.deletions,S===null?(s.deletions=[n],s.flags|=16):S.push(n)),s.child=r,s.memoizedState=null,r)}function xd(n,s){return s=wd({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function wd(n,s){return g1(n,s,0,null)}function _d(n,s,r){return na(s,n.child,null,r),n=xd(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function Vp(n,s,r){n.lanes|=s;var l=n.alternate;l!==null&&(l.lanes|=s),Nd(n.return,s,r)}function Sd(n,s,r,l,f){var m=n.memoizedState;m===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:l,tail:r,tailMode:f}:(m.isBackwards=s,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=r,m.tailMode=f)}function Hp(n,s,r){var l=s.pendingProps,f=l.revealOrder,m=l.tail;if(Mn(n,s,l.children,r),l=bn.current,(l&2)!==0)l=l&1|2,s.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Vp(n,r,s);else if(n.tag===19)Vp(n,r,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}l&=1}switch(Qe(bn,l),f){case"forwards":for(r=s.child,f=null;r!==null;)n=r.alternate,n!==null&&Dl(n)===null&&(f=r),r=r.sibling;r=f,r===null?(f=s.child,s.child=null):(f=r.sibling,r.sibling=null),Sd(s,!1,f,r,m);break;case"backwards":for(r=null,f=s.child,s.child=null;f!==null;){if(n=f.alternate,n!==null&&Dl(n)===null){s.child=f;break}n=f.sibling,f.sibling=r,r=f,f=n}Sd(s,!0,r,null,m);break;case"together":Sd(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ri(n,s,r){if(n!==null&&(s.dependencies=n.dependencies),Li|=s.lanes,(r&s.childLanes)===0)if(n!==null){if(ro(n,s,r,!1),(r&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(a(153));if(s.child!==null){for(n=s.child,r=Mi(n,n.pendingProps),s.child=r,r.return=s;n.sibling!==null;)n=n.sibling,r=r.sibling=Mi(n,n.pendingProps),r.return=s;r.sibling=null}return s.child}function jd(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Yl(n)))}function Ax(n,s,r){switch(s.tag){case 3:Ie(s,s.stateNode.containerInfo),Ci(s,xn,n.memoizedState.cache),Xr();break;case 27:case 5:jt(s);break;case 4:Ie(s,s.stateNode.containerInfo);break;case 10:Ci(s,s.type,s.memoizedProps.value);break;case 13:var l=s.memoizedState;if(l!==null)return l.dehydrated!==null?(wi(s),s.flags|=128,null):(r&s.child.childLanes)!==0?qp(n,s,r):(wi(s),n=ri(n,s,r),n!==null?n.sibling:null);wi(s);break;case 19:var f=(n.flags&128)!==0;if(l=(r&s.childLanes)!==0,l||(ro(n,s,r,!1),l=(r&s.childLanes)!==0),f){if(l)return Hp(n,s,r);s.flags|=128}if(f=s.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Qe(bn,bn.current),l)break;return null;case 22:case 23:return s.lanes=0,Pp(n,s,r);case 24:Ci(s,xn,n.memoizedState.cache)}return ri(n,s,r)}function Gp(n,s,r){if(n!==null)if(n.memoizedProps!==s.pendingProps)Cn=!0;else{if(!jd(n,r)&&(s.flags&128)===0)return Cn=!1,Ax(n,s,r);Cn=(n.flags&131072)!==0}else Cn=!1,Pt&&(s.flags&1048576)!==0&&Ag(s,Al,s.index);switch(s.lanes=0,s.tag){case 16:e:{n=s.pendingProps;var l=s.elementType,f=l._init;if(l=f(l._payload),s.type=l,typeof l=="function")Pd(l)?(n=oa(l,n),s.tag=1,s=Ip(null,s,l,n,r)):(s.tag=0,s=pd(null,s,l,n,r));else{if(l!=null){if(f=l.$$typeof,f===N){s.tag=11,s=Dp(null,s,l,n,r);break e}else if(f===I){s.tag=14,s=Bp(null,s,l,n,r);break e}}throw s=L(l)||l,Error(a(306,s,""))}}return s;case 0:return pd(n,s,s.type,s.pendingProps,r);case 1:return l=s.type,f=oa(l,s.pendingProps),Ip(n,s,l,f,r);case 3:e:{if(Ie(s,s.stateNode.containerInfo),n===null)throw Error(a(387));var m=s.pendingProps;f=s.memoizedState,l=f.element,Ed(n,s),co(s,m,null,r);var S=s.memoizedState;if(m=S.cache,Ci(s,xn,m),m!==f.cache&&Td(s,[xn],r,!0),lo(),m=S.element,f.isDehydrated)if(f={element:m,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=f,s.memoizedState=f,s.flags&256){s=Fp(n,s,m,r);break e}else if(m!==l){l=ls(Error(a(424)),s),Kr(l),s=Fp(n,s,m,r);break e}else for(Rn=Ts(s.stateNode.containerInfo.firstChild),Fn=s,Pt=!0,Cs=null,Bs=!0,r=$g(s,null,m,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xr(),m===l){s=ri(n,s,r);break e}Mn(n,s,m,r)}s=s.child}return s;case 26:return ao(n,s),n===null?(r=K1(s.type,null,s.pendingProps,null))?s.memoizedState=r:Pt||(r=s.type,n=s.pendingProps,l=cc(yt.current).createElement(r),l[rt]=s,l[sn]=n,Ln(l,r,n),jn(l),s.stateNode=l):s.memoizedState=K1(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return jt(s),n===null&&Pt&&(l=s.stateNode=G1(s.type,s.pendingProps,yt.current),Fn=s,Bs=!0,Rn=Ts(l.firstChild)),l=s.pendingProps.children,n!==null||Pt?Mn(n,s,l,r):s.child=na(s,null,l,r),ao(n,s),s.child;case 5:return n===null&&Pt&&((f=l=Rn)&&(l=rw(l,s.type,s.pendingProps,Bs),l!==null?(s.stateNode=l,Fn=s,Rn=Ts(l.firstChild),Bs=!1,f=!0):f=!1),f||ta(s)),jt(s),f=s.type,m=s.pendingProps,S=n!==null?n.memoizedProps:null,l=m.children,df(f,m)?l=null:S!==null&&df(f,S)&&(s.flags|=32),s.memoizedState!==null&&(f=Zu(n,s,Sx,null,null,r),Co._currentValue=f),ao(n,s),Mn(n,s,l,r),s.child;case 6:return n===null&&Pt&&((n=r=Rn)&&(r=ow(r,s.pendingProps,Bs),r!==null?(s.stateNode=r,Fn=s,Rn=null,n=!0):n=!1),n||ta(s)),null;case 13:return qp(n,s,r);case 4:return Ie(s,s.stateNode.containerInfo),l=s.pendingProps,n===null?s.child=na(s,null,l,r):Mn(n,s,l,r),s.child;case 11:return Dp(n,s,s.type,s.pendingProps,r);case 7:return Mn(n,s,s.pendingProps,r),s.child;case 8:return Mn(n,s,s.pendingProps.children,r),s.child;case 12:return Mn(n,s,s.pendingProps.children,r),s.child;case 10:return l=s.pendingProps,Ci(s,s.type,l.value),Mn(n,s,l.children,r),s.child;case 9:return f=s.type._context,l=s.pendingProps.children,ca(s),f=Dn(f),l=l(f),s.flags|=1,Mn(n,s,l,r),s.child;case 14:return Bp(n,s,s.type,s.pendingProps,r);case 15:return zp(n,s,s.type,s.pendingProps,r);case 19:return Hp(n,s,r);case 22:return Pp(n,s,r);case 24:return ca(s),l=Dn(xn),n===null?(f=Qu(),f===null&&(f=Yt,m=Xu(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=r),f=m),s.memoizedState={parent:l,cache:f},kd(s),Ci(s,xn,f)):((n.lanes&r)!==0&&(Ed(n,s),co(s,null,null,r),lo()),f=n.memoizedState,m=s.memoizedState,f.parent!==l?(f={parent:l,cache:l},s.memoizedState=f,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=f),Ci(s,xn,l)):(l=m.cache,Ci(s,xn,l),l!==f.cache&&Td(s,[xn],r,!0))),Mn(n,s,s.pendingProps.children,r),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}var Cd=ze(null),la=null,oi=null;function Ci(n,s,r){Qe(Cd,s._currentValue),s._currentValue=r}function li(n){n._currentValue=Cd.current,Xe(Cd)}function Nd(n,s,r){for(;n!==null;){var l=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,l!==null&&(l.childLanes|=s)):l!==null&&(l.childLanes&s)!==s&&(l.childLanes|=s),n===r)break;n=n.return}}function Td(n,s,r,l){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var m=f.dependencies;if(m!==null){var S=f.child;m=m.firstContext;e:for(;m!==null;){var k=m;m=f;for(var $=0;$<s.length;$++)if(k.context===s[$]){m.lanes|=r,k=m.alternate,k!==null&&(k.lanes|=r),Nd(m.return,r,n),l||(S=null);break e}m=k.next}}else if(f.tag===18){if(S=f.return,S===null)throw Error(a(341));S.lanes|=r,m=S.alternate,m!==null&&(m.lanes|=r),Nd(S,r,n),S=null}else S=f.child;if(S!==null)S.return=f;else for(S=f;S!==null;){if(S===n){S=null;break}if(f=S.sibling,f!==null){f.return=S.return,S=f;break}S=S.return}f=S}}function ro(n,s,r,l){n=null;for(var f=s,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var S=f.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var k=f.type;Zn(f.pendingProps.value,S.value)||(n!==null?n.push(k):n=[k])}}else if(f===mt.current){if(S=f.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(Co):n=[Co])}f=f.return}n!==null&&Td(s,n,r,l),s.flags|=262144}function Yl(n){for(n=n.firstContext;n!==null;){if(!Zn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function ca(n){la=n,oi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Dn(n){return Yp(la,n)}function Xl(n,s){return la===null&&ca(n),Yp(n,s)}function Yp(n,s){var r=s._currentValue;if(s={context:s,memoizedValue:r,next:null},oi===null){if(n===null)throw Error(a(308));oi=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else oi=oi.next=s;return r}var Ni=!1;function kd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ed(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ti(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ki(n,s,r){var l=n.updateQueue;if(l===null)return null;if(l=l.shared,(en&2)!==0){var f=l.pending;return f===null?s.next=s:(s.next=f.next,f.next=s),l.pending=s,s=kl(n),kg(n,null,r),s}return Tl(n,l,s,r),kl(n)}function oo(n,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194176)!==0)){var l=s.lanes;l&=n.pendingLanes,r|=l,s.lanes=r,oe(n,r)}}function Ad(n,s){var r=n.updateQueue,l=n.alternate;if(l!==null&&(l=l.updateQueue,r===l)){var f=null,m=null;if(r=r.firstBaseUpdate,r!==null){do{var S={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};m===null?f=m=S:m=m.next=S,r=r.next}while(r!==null);m===null?f=m=s:m=m.next=s}else f=m=s;r={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:l.shared,callbacks:l.callbacks},n.updateQueue=r;return}n=r.lastBaseUpdate,n===null?r.firstBaseUpdate=s:n.next=s,r.lastBaseUpdate=s}var Rd=!1;function lo(){if(Rd){var n=Ya;if(n!==null)throw n}}function co(n,s,r,l){Rd=!1;var f=n.updateQueue;Ni=!1;var m=f.firstBaseUpdate,S=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var $=k,Z=$.next;$.next=null,S===null?m=Z:S.next=Z,S=$;var xe=n.alternate;xe!==null&&(xe=xe.updateQueue,k=xe.lastBaseUpdate,k!==S&&(k===null?xe.firstBaseUpdate=Z:k.next=Z,xe.lastBaseUpdate=$))}if(m!==null){var De=f.baseState;S=0,xe=Z=$=null,k=m;do{var ue=k.lane&-536870913,be=ue!==k.lane;if(be?(zt&ue)===ue:(l&ue)===ue){ue!==0&&ue===Ga&&(Rd=!0),xe!==null&&(xe=xe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var it=n,St=k;ue=s;var ln=r;switch(St.tag){case 1:if(it=St.payload,typeof it=="function"){De=it.call(ln,De,ue);break e}De=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=St.payload,ue=typeof it=="function"?it.call(ln,De,ue):it,ue==null)break e;De=G({},De,ue);break e;case 2:Ni=!0}}ue=k.callback,ue!==null&&(n.flags|=64,be&&(n.flags|=8192),be=f.callbacks,be===null?f.callbacks=[ue]:be.push(ue))}else be={lane:ue,tag:k.tag,payload:k.payload,callback:k.callback,next:null},xe===null?(Z=xe=be,$=De):xe=xe.next=be,S|=ue;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;be=k,k=be.next,be.next=null,f.lastBaseUpdate=be,f.shared.pending=null}}while(!0);xe===null&&($=De),f.baseState=$,f.firstBaseUpdate=Z,f.lastBaseUpdate=xe,m===null&&(f.shared.lanes=0),Li|=S,n.lanes=S,n.memoizedState=De}}function Xp(n,s){if(typeof n!="function")throw Error(a(191,n));n.call(s)}function Kp(n,s){var r=n.callbacks;if(r!==null)for(n.callbacks=null,n=0;n<r.length;n++)Xp(r[n],s)}function uo(n,s){try{var r=s.updateQueue,l=r!==null?r.lastEffect:null;if(l!==null){var f=l.next;r=f;do{if((r.tag&n)===n){l=void 0;var m=r.create,S=r.inst;l=m(),S.destroy=l}r=r.next}while(r!==f)}}catch(k){Gt(s,s.return,k)}}function Ei(n,s,r){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var m=f.next;l=m;do{if((l.tag&n)===n){var S=l.inst,k=S.destroy;if(k!==void 0){S.destroy=void 0,f=s;var $=r;try{k()}catch(Z){Gt(f,$,Z)}}}l=l.next}while(l!==m)}}catch(Z){Gt(s,s.return,Z)}}function Qp(n){var s=n.updateQueue;if(s!==null){var r=n.stateNode;try{Kp(s,r)}catch(l){Gt(n,n.return,l)}}}function Wp(n,s,r){r.props=oa(n.type,n.memoizedProps),r.state=n.memoizedState;try{r.componentWillUnmount()}catch(l){Gt(n,s,l)}}function ua(n,s){try{var r=n.ref;if(r!==null){var l=n.stateNode;switch(n.tag){case 26:case 27:case 5:var f=l;break;default:f=l}typeof r=="function"?n.refCleanup=r(f):r.current=f}}catch(m){Gt(n,s,m)}}function Jn(n,s){var r=n.ref,l=n.refCleanup;if(r!==null)if(typeof l=="function")try{l()}catch(f){Gt(n,s,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){Gt(n,s,f)}else r.current=null}function Zp(n){var s=n.type,r=n.memoizedProps,l=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":r.autoFocus&&l.focus();break e;case"img":r.src?l.src=r.src:r.srcSet&&(l.srcset=r.srcSet)}}catch(f){Gt(n,n.return,f)}}function Jp(n,s,r){try{var l=n.stateNode;tw(l,n.type,r,s),l[sn]=s}catch(f){Gt(n,n.return,f)}}function e1(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27||n.tag===4}function Md(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||e1(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==27&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Ld(n,s,r){var l=n.tag;if(l===5||l===6)n=n.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(n,s):r.insertBefore(n,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(n,r)):(s=r,s.appendChild(n)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=lc));else if(l!==4&&l!==27&&(n=n.child,n!==null))for(Ld(n,s,r),n=n.sibling;n!==null;)Ld(n,s,r),n=n.sibling}function Kl(n,s,r){var l=n.tag;if(l===5||l===6)n=n.stateNode,s?r.insertBefore(n,s):r.appendChild(n);else if(l!==4&&l!==27&&(n=n.child,n!==null))for(Kl(n,s,r),n=n.sibling;n!==null;)Kl(n,s,r),n=n.sibling}var ci=!1,rn=!1,Od=!1,t1=typeof WeakSet=="function"?WeakSet:Set,Nn=null,n1=!1;function Rx(n,s){if(n=n.containerInfo,cf=gc,n=bg(n),Bu(n)){if("selectionStart"in n)var r={start:n.selectionStart,end:n.selectionEnd};else e:{r=(r=n.ownerDocument)&&r.defaultView||window;var l=r.getSelection&&r.getSelection();if(l&&l.rangeCount!==0){r=l.anchorNode;var f=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{r.nodeType,m.nodeType}catch{r=null;break e}var S=0,k=-1,$=-1,Z=0,xe=0,De=n,ue=null;t:for(;;){for(var be;De!==r||f!==0&&De.nodeType!==3||(k=S+f),De!==m||l!==0&&De.nodeType!==3||($=S+l),De.nodeType===3&&(S+=De.nodeValue.length),(be=De.firstChild)!==null;)ue=De,De=be;for(;;){if(De===n)break t;if(ue===r&&++Z===f&&(k=S),ue===m&&++xe===l&&($=S),(be=De.nextSibling)!==null)break;De=ue,ue=De.parentNode}De=be}r=k===-1||$===-1?null:{start:k,end:$}}else r=null}r=r||{start:0,end:0}}else r=null;for(uf={focusedElem:n,selectionRange:r},gc=!1,Nn=s;Nn!==null;)if(s=Nn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Nn=n;else for(;Nn!==null;){switch(s=Nn,m=s.alternate,n=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,r=s,f=m.memoizedProps,m=m.memoizedState,l=r.stateNode;try{var it=oa(r.type,f,r.elementType===r.type);n=l.getSnapshotBeforeUpdate(it,m),l.__reactInternalSnapshotBeforeUpdate=n}catch(St){Gt(r,r.return,St)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,r=n.nodeType,r===9)mf(n);else if(r===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":mf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=s.sibling,n!==null){n.return=s.return,Nn=n;break}Nn=s.return}return it=n1,n1=!1,it}function s1(n,s,r){var l=r.flags;switch(r.tag){case 0:case 11:case 15:di(n,r),l&4&&uo(5,r);break;case 1:if(di(n,r),l&4)if(n=r.stateNode,s===null)try{n.componentDidMount()}catch(k){Gt(r,r.return,k)}else{var f=oa(r.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(f,s,n.__reactInternalSnapshotBeforeUpdate)}catch(k){Gt(r,r.return,k)}}l&64&&Qp(r),l&512&&ua(r,r.return);break;case 3:if(di(n,r),l&64&&(l=r.updateQueue,l!==null)){if(n=null,r.child!==null)switch(r.child.tag){case 27:case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}try{Kp(l,n)}catch(k){Gt(r,r.return,k)}}break;case 26:di(n,r),l&512&&ua(r,r.return);break;case 27:case 5:di(n,r),s===null&&l&4&&Zp(r),l&512&&ua(r,r.return);break;case 12:di(n,r);break;case 13:di(n,r),l&4&&r1(n,r);break;case 22:if(f=r.memoizedState!==null||ci,!f){s=s!==null&&s.memoizedState!==null||rn;var m=ci,S=rn;ci=f,(rn=s)&&!S?Ai(n,r,(r.subtreeFlags&8772)!==0):di(n,r),ci=m,rn=S}l&512&&(r.memoizedProps.mode==="manual"?ua(r,r.return):Jn(r,r.return));break;default:di(n,r)}}function i1(n){var s=n.alternate;s!==null&&(n.alternate=null,i1(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Wn(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var yn=null,es=!1;function ui(n,s,r){for(r=r.child;r!==null;)a1(n,s,r),r=r.sibling}function a1(n,s,r){if(U&&typeof U.onCommitFiberUnmount=="function")try{U.onCommitFiberUnmount(T,r)}catch{}switch(r.tag){case 26:rn||Jn(r,s),ui(n,s,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:rn||Jn(r,s);var l=yn,f=es;for(yn=r.stateNode,ui(n,s,r),r=r.stateNode,s=r.attributes;s.length;)r.removeAttributeNode(s[0]);Wn(r),yn=l,es=f;break;case 5:rn||Jn(r,s);case 6:f=yn;var m=es;if(yn=null,ui(n,s,r),yn=f,es=m,yn!==null)if(es)try{n=yn,l=r.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)}catch(S){Gt(r,s,S)}else try{yn.removeChild(r.stateNode)}catch(S){Gt(r,s,S)}break;case 18:yn!==null&&(es?(s=yn,r=r.stateNode,s.nodeType===8?hf(s.parentNode,r):s.nodeType===1&&hf(s,r),Eo(s)):hf(yn,r.stateNode));break;case 4:l=yn,f=es,yn=r.stateNode.containerInfo,es=!0,ui(n,s,r),yn=l,es=f;break;case 0:case 11:case 14:case 15:rn||Ei(2,r,s),rn||Ei(4,r,s),ui(n,s,r);break;case 1:rn||(Jn(r,s),l=r.stateNode,typeof l.componentWillUnmount=="function"&&Wp(r,s,l)),ui(n,s,r);break;case 21:ui(n,s,r);break;case 22:rn||Jn(r,s),rn=(l=rn)||r.memoizedState!==null,ui(n,s,r),rn=l;break;default:ui(n,s,r)}}function r1(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Eo(n)}catch(r){Gt(s,s.return,r)}}function Mx(n){switch(n.tag){case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new t1),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new t1),s;default:throw Error(a(435,n.tag))}}function Dd(n,s){var r=Mx(n);s.forEach(function(l){var f=Hx.bind(null,n,l);r.has(l)||(r.add(l),l.then(f,f))})}function fs(n,s){var r=s.deletions;if(r!==null)for(var l=0;l<r.length;l++){var f=r[l],m=n,S=s,k=S;e:for(;k!==null;){switch(k.tag){case 27:case 5:yn=k.stateNode,es=!1;break e;case 3:yn=k.stateNode.containerInfo,es=!0;break e;case 4:yn=k.stateNode.containerInfo,es=!0;break e}k=k.return}if(yn===null)throw Error(a(160));a1(m,S,f),yn=null,es=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)o1(s,n),s=s.sibling}var Ns=null;function o1(n,s){var r=n.alternate,l=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:fs(s,n),hs(n),l&4&&(Ei(3,n,n.return),uo(3,n),Ei(5,n,n.return));break;case 1:fs(s,n),hs(n),l&512&&(rn||r===null||Jn(r,r.return)),l&64&&ci&&(n=n.updateQueue,n!==null&&(l=n.callbacks,l!==null&&(r=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=r===null?l:r.concat(l))));break;case 26:var f=Ns;if(fs(s,n),hs(n),l&512&&(rn||r===null||Jn(r,r.return)),l&4){var m=r!==null?r.memoizedState:null;if(l=n.memoizedState,r===null)if(l===null)if(n.stateNode===null){e:{l=n.type,r=n.memoizedProps,f=f.ownerDocument||f;t:switch(l){case"title":m=f.getElementsByTagName("title")[0],(!m||m[Wt]||m[rt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(l),f.head.insertBefore(m,f.querySelector("head > title"))),Ln(m,l,r),m[rt]=n,jn(m),l=m;break e;case"link":var S=Z1("link","href",f).get(l+(r.href||""));if(S){for(var k=0;k<S.length;k++)if(m=S[k],m.getAttribute("href")===(r.href==null?null:r.href)&&m.getAttribute("rel")===(r.rel==null?null:r.rel)&&m.getAttribute("title")===(r.title==null?null:r.title)&&m.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){S.splice(k,1);break t}}m=f.createElement(l),Ln(m,l,r),f.head.appendChild(m);break;case"meta":if(S=Z1("meta","content",f).get(l+(r.content||""))){for(k=0;k<S.length;k++)if(m=S[k],m.getAttribute("content")===(r.content==null?null:""+r.content)&&m.getAttribute("name")===(r.name==null?null:r.name)&&m.getAttribute("property")===(r.property==null?null:r.property)&&m.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&m.getAttribute("charset")===(r.charSet==null?null:r.charSet)){S.splice(k,1);break t}}m=f.createElement(l),Ln(m,l,r),f.head.appendChild(m);break;default:throw Error(a(468,l))}m[rt]=n,jn(m),l=m}n.stateNode=l}else J1(f,n.type,n.stateNode);else n.stateNode=W1(f,l,n.memoizedProps);else m!==l?(m===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):m.count--,l===null?J1(f,n.type,n.stateNode):W1(f,l,n.memoizedProps)):l===null&&n.stateNode!==null&&Jp(n,n.memoizedProps,r.memoizedProps)}break;case 27:if(l&4&&n.alternate===null){f=n.stateNode,m=n.memoizedProps;try{for(var $=f.firstChild;$;){var Z=$.nextSibling,xe=$.nodeName;$[Wt]||xe==="HEAD"||xe==="BODY"||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&$.rel.toLowerCase()==="stylesheet"||f.removeChild($),$=Z}for(var De=n.type,ue=f.attributes;ue.length;)f.removeAttributeNode(ue[0]);Ln(f,De,m),f[rt]=n,f[sn]=m}catch(it){Gt(n,n.return,it)}}case 5:if(fs(s,n),hs(n),l&512&&(rn||r===null||Jn(r,r.return)),n.flags&32){f=n.stateNode;try{Oa(f,"")}catch(it){Gt(n,n.return,it)}}l&4&&n.stateNode!=null&&(f=n.memoizedProps,Jp(n,f,r!==null?r.memoizedProps:f)),l&1024&&(Od=!0);break;case 6:if(fs(s,n),hs(n),l&4){if(n.stateNode===null)throw Error(a(162));l=n.memoizedProps,r=n.stateNode;try{r.nodeValue=l}catch(it){Gt(n,n.return,it)}}break;case 3:if(fc=null,f=Ns,Ns=uc(s.containerInfo),fs(s,n),Ns=f,hs(n),l&4&&r!==null&&r.memoizedState.isDehydrated)try{Eo(s.containerInfo)}catch(it){Gt(n,n.return,it)}Od&&(Od=!1,l1(n));break;case 4:l=Ns,Ns=uc(n.stateNode.containerInfo),fs(s,n),hs(n),Ns=l;break;case 12:fs(s,n),hs(n);break;case 13:fs(s,n),hs(n),n.child.flags&8192&&n.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(Vd=ke()),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,Dd(n,l)));break;case 22:if(l&512&&(rn||r===null||Jn(r,r.return)),$=n.memoizedState!==null,Z=r!==null&&r.memoizedState!==null,xe=ci,De=rn,ci=xe||$,rn=De||Z,fs(s,n),rn=De,ci=xe,hs(n),s=n.stateNode,s._current=n,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,l&8192&&(s._visibility=$?s._visibility&-2:s._visibility|1,$&&(s=ci||rn,r===null||Z||s||Wa(n)),n.memoizedProps===null||n.memoizedProps.mode!=="manual"))e:for(r=null,s=n;;){if(s.tag===5||s.tag===26||s.tag===27){if(r===null){Z=r=s;try{if(f=Z.stateNode,$)m=f.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{S=Z.stateNode,k=Z.memoizedProps.style;var be=k!=null&&k.hasOwnProperty("display")?k.display:null;S.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch(it){Gt(Z,Z.return,it)}}}else if(s.tag===6){if(r===null){Z=s;try{Z.stateNode.nodeValue=$?"":Z.memoizedProps}catch(it){Gt(Z,Z.return,it)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;r===s&&(r=null),s=s.return}r===s&&(r=null),s.sibling.return=s.return,s=s.sibling}l&4&&(l=n.updateQueue,l!==null&&(r=l.retryQueue,r!==null&&(l.retryQueue=null,Dd(n,r))));break;case 19:fs(s,n),hs(n),l&4&&(l=n.updateQueue,l!==null&&(n.updateQueue=null,Dd(n,l)));break;case 21:break;default:fs(s,n),hs(n)}}function hs(n){var s=n.flags;if(s&2){try{if(n.tag!==27){e:{for(var r=n.return;r!==null;){if(e1(r)){var l=r;break e}r=r.return}throw Error(a(160))}switch(l.tag){case 27:var f=l.stateNode,m=Md(n);Kl(n,m,f);break;case 5:var S=l.stateNode;l.flags&32&&(Oa(S,""),l.flags&=-33);var k=Md(n);Kl(n,k,S);break;case 3:case 4:var $=l.stateNode.containerInfo,Z=Md(n);Ld(n,Z,$);break;default:throw Error(a(161))}}}catch(xe){Gt(n,n.return,xe)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function l1(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;l1(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function di(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)s1(n,s.alternate,s),s=s.sibling}function Wa(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:Ei(4,s,s.return),Wa(s);break;case 1:Jn(s,s.return);var r=s.stateNode;typeof r.componentWillUnmount=="function"&&Wp(s,s.return,r),Wa(s);break;case 26:case 27:case 5:Jn(s,s.return),Wa(s);break;case 22:Jn(s,s.return),s.memoizedState===null&&Wa(s);break;default:Wa(s)}n=n.sibling}}function Ai(n,s,r){for(r=r&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var l=s.alternate,f=n,m=s,S=m.flags;switch(m.tag){case 0:case 11:case 15:Ai(f,m,r),uo(4,m);break;case 1:if(Ai(f,m,r),l=m,f=l.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(Z){Gt(l,l.return,Z)}if(l=m,f=l.updateQueue,f!==null){var k=l.stateNode;try{var $=f.shared.hiddenCallbacks;if($!==null)for(f.shared.hiddenCallbacks=null,f=0;f<$.length;f++)Xp($[f],k)}catch(Z){Gt(l,l.return,Z)}}r&&S&64&&Qp(m),ua(m,m.return);break;case 26:case 27:case 5:Ai(f,m,r),r&&l===null&&S&4&&Zp(m),ua(m,m.return);break;case 12:Ai(f,m,r);break;case 13:Ai(f,m,r),r&&S&4&&r1(f,m);break;case 22:m.memoizedState===null&&Ai(f,m,r),ua(m,m.return);break;default:Ai(f,m,r)}s=s.sibling}}function Bd(n,s){var r=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==r&&(n!=null&&n.refCount++,r!=null&&eo(r))}function zd(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&eo(n))}function Ri(n,s,r,l){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)c1(n,s,r,l),s=s.sibling}function c1(n,s,r,l){var f=s.flags;switch(s.tag){case 0:case 11:case 15:Ri(n,s,r,l),f&2048&&uo(9,s);break;case 3:Ri(n,s,r,l),f&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&eo(n)));break;case 12:if(f&2048){Ri(n,s,r,l),n=s.stateNode;try{var m=s.memoizedProps,S=m.id,k=m.onPostCommit;typeof k=="function"&&k(S,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch($){Gt(s,s.return,$)}}else Ri(n,s,r,l);break;case 23:break;case 22:m=s.stateNode,s.memoizedState!==null?m._visibility&4?Ri(n,s,r,l):fo(n,s):m._visibility&4?Ri(n,s,r,l):(m._visibility|=4,Za(n,s,r,l,(s.subtreeFlags&10256)!==0)),f&2048&&Bd(s.alternate,s);break;case 24:Ri(n,s,r,l),f&2048&&zd(s.alternate,s);break;default:Ri(n,s,r,l)}}function Za(n,s,r,l,f){for(f=f&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var m=n,S=s,k=r,$=l,Z=S.flags;switch(S.tag){case 0:case 11:case 15:Za(m,S,k,$,f),uo(8,S);break;case 23:break;case 22:var xe=S.stateNode;S.memoizedState!==null?xe._visibility&4?Za(m,S,k,$,f):fo(m,S):(xe._visibility|=4,Za(m,S,k,$,f)),f&&Z&2048&&Bd(S.alternate,S);break;case 24:Za(m,S,k,$,f),f&&Z&2048&&zd(S.alternate,S);break;default:Za(m,S,k,$,f)}s=s.sibling}}function fo(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var r=n,l=s,f=l.flags;switch(l.tag){case 22:fo(r,l),f&2048&&Bd(l.alternate,l);break;case 24:fo(r,l),f&2048&&zd(l.alternate,l);break;default:fo(r,l)}s=s.sibling}}var ho=8192;function Ja(n){if(n.subtreeFlags&ho)for(n=n.child;n!==null;)u1(n),n=n.sibling}function u1(n){switch(n.tag){case 26:Ja(n),n.flags&ho&&n.memoizedState!==null&&xw(Ns,n.memoizedState,n.memoizedProps);break;case 5:Ja(n);break;case 3:case 4:var s=Ns;Ns=uc(n.stateNode.containerInfo),Ja(n),Ns=s;break;case 22:n.memoizedState===null&&(s=n.alternate,s!==null&&s.memoizedState!==null?(s=ho,ho=16777216,Ja(n),ho=s):Ja(n));break;default:Ja(n)}}function d1(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function mo(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var r=0;r<s.length;r++){var l=s[r];Nn=l,h1(l,n)}d1(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)f1(n),n=n.sibling}function f1(n){switch(n.tag){case 0:case 11:case 15:mo(n),n.flags&2048&&Ei(9,n,n.return);break;case 3:mo(n);break;case 12:mo(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&4&&(n.return===null||n.return.tag!==13)?(s._visibility&=-5,Ql(n)):mo(n);break;default:mo(n)}}function Ql(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var r=0;r<s.length;r++){var l=s[r];Nn=l,h1(l,n)}d1(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:Ei(8,s,s.return),Ql(s);break;case 22:r=s.stateNode,r._visibility&4&&(r._visibility&=-5,Ql(s));break;default:Ql(s)}n=n.sibling}}function h1(n,s){for(;Nn!==null;){var r=Nn;switch(r.tag){case 0:case 11:case 15:Ei(8,r,s);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var l=r.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:eo(r.memoizedState.cache)}if(l=r.child,l!==null)l.return=r,Nn=l;else e:for(r=n;Nn!==null;){l=Nn;var f=l.sibling,m=l.return;if(i1(l),l===r){Nn=null;break e}if(f!==null){f.return=m,Nn=f;break e}Nn=m}}}function Lx(n,s,r,l){this.tag=n,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(n,s,r,l){return new Lx(n,s,r,l)}function Pd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Mi(n,s){var r=n.alternate;return r===null?(r=ms(n.tag,s,n.key,n.mode),r.elementType=n.elementType,r.type=n.type,r.stateNode=n.stateNode,r.alternate=n,n.alternate=r):(r.pendingProps=s,r.type=n.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=n.flags&31457280,r.childLanes=n.childLanes,r.lanes=n.lanes,r.child=n.child,r.memoizedProps=n.memoizedProps,r.memoizedState=n.memoizedState,r.updateQueue=n.updateQueue,s=n.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=n.sibling,r.index=n.index,r.ref=n.ref,r.refCleanup=n.refCleanup,r}function m1(n,s){n.flags&=31457282;var r=n.alternate;return r===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,s=r.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function Wl(n,s,r,l,f,m){var S=0;if(l=n,typeof n=="function")Pd(n)&&(S=1);else if(typeof n=="string")S=vw(n,r,Ge.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case p:return da(r.children,f,m,s);case y:S=8,f|=24;break;case g:return n=ms(12,r,s,f|2),n.elementType=g,n.lanes=m,n;case M:return n=ms(13,r,s,f),n.elementType=M,n.lanes=m,n;case D:return n=ms(19,r,s,f),n.elementType=D,n.lanes=m,n;case F:return g1(r,f,m,s);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case w:case j:S=10;break e;case C:S=9;break e;case N:S=11;break e;case I:S=14;break e;case V:S=16,l=null;break e}S=29,r=Error(a(130,n===null?"null":typeof n,"")),l=null}return s=ms(S,r,s,f),s.elementType=n,s.type=l,s.lanes=m,s}function da(n,s,r,l){return n=ms(7,n,l,s),n.lanes=r,n}function g1(n,s,r,l){n=ms(22,n,l,s),n.elementType=F,n.lanes=r;var f={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var m=f._current;if(m===null)throw Error(a(456));if((f._pendingVisibility&2)===0){var S=xi(m,2);S!==null&&(f._pendingVisibility|=2,qn(S,m,2))}},attach:function(){var m=f._current;if(m===null)throw Error(a(456));if((f._pendingVisibility&2)!==0){var S=xi(m,2);S!==null&&(f._pendingVisibility&=-3,qn(S,m,2))}}};return n.stateNode=f,n}function $d(n,s,r){return n=ms(6,n,null,s),n.lanes=r,n}function Ud(n,s,r){return s=ms(4,n.children!==null?n.children:[],n.key,s),s.lanes=r,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}function fi(n){n.flags|=4}function p1(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!e0(s)){if(s=ds.current,s!==null&&((zt&4194176)===zt?zs!==null:(zt&62914560)!==zt&&(zt&536870912)===0||s!==zs))throw Wr=Hu,Lg;n.flags|=8192}}function Zl(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?fe():536870912,n.lanes|=s,tr|=s)}function go(n,s){if(!Pt)switch(n.tailMode){case"hidden":s=n.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?n.tail=null:r.sibling=null;break;case"collapsed":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:l.sibling=null}}function Jt(n){var s=n.alternate!==null&&n.alternate.child===n.child,r=0,l=0;if(s)for(var f=n.child;f!==null;)r|=f.lanes|f.childLanes,l|=f.subtreeFlags&31457280,l|=f.flags&31457280,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)r|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=l,n.childLanes=r,s}function Ox(n,s,r){var l=s.pendingProps;switch(qu(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(s),null;case 1:return Jt(s),null;case 3:return r=s.stateNode,l=null,n!==null&&(l=n.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),li(xn),qe(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Yr(s)?fi(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Cs!==null&&(Xd(Cs),Cs=null))),Jt(s),null;case 26:return r=s.memoizedState,n===null?(fi(s),r!==null?(Jt(s),p1(s,r)):(Jt(s),s.flags&=-16777217)):r?r!==n.memoizedState?(fi(s),Jt(s),p1(s,r)):(Jt(s),s.flags&=-16777217):(n.memoizedProps!==l&&fi(s),Jt(s),s.flags&=-16777217),null;case 27:Ct(s),r=yt.current;var f=s.type;if(n!==null&&s.stateNode!=null)n.memoizedProps!==l&&fi(s);else{if(!l){if(s.stateNode===null)throw Error(a(166));return Jt(s),null}n=Ge.current,Yr(s)?Rg(s):(n=G1(f,l,r),s.stateNode=n,fi(s))}return Jt(s),null;case 5:if(Ct(s),r=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==l&&fi(s);else{if(!l){if(s.stateNode===null)throw Error(a(166));return Jt(s),null}if(n=Ge.current,Yr(s))Rg(s);else{switch(f=cc(yt.current),n){case 1:n=f.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:n=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":n=f.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":n=f.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":n=f.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof l.is=="string"?f.createElement("select",{is:l.is}):f.createElement("select"),l.multiple?n.multiple=!0:l.size&&(n.size=l.size);break;default:n=typeof l.is=="string"?f.createElement(r,{is:l.is}):f.createElement(r)}}n[rt]=s,n[sn]=l;e:for(f=s.child;f!==null;){if(f.tag===5||f.tag===6)n.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===s)break e;for(;f.sibling===null;){if(f.return===null||f.return===s)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}s.stateNode=n;e:switch(Ln(n,r,l),r){case"button":case"input":case"select":case"textarea":n=!!l.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&fi(s)}}return Jt(s),s.flags&=-16777217,null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==l&&fi(s);else{if(typeof l!="string"&&s.stateNode===null)throw Error(a(166));if(n=yt.current,Yr(s)){if(n=s.stateNode,r=s.memoizedProps,l=null,f=Fn,f!==null)switch(f.tag){case 27:case 5:l=f.memoizedProps}n[rt]=s,n=!!(n.nodeValue===r||l!==null&&l.suppressHydrationWarning===!0||U1(n.nodeValue,r)),n||ta(s)}else n=cc(n).createTextNode(l),n[rt]=s,s.stateNode=n}return Jt(s),null;case 13:if(l=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Yr(s),l!==null&&l.dehydrated!==null){if(n===null){if(!f)throw Error(a(318));if(f=s.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[rt]=s}else Xr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Jt(s),f=!1}else Cs!==null&&(Xd(Cs),Cs=null),f=!0;if(!f)return s.flags&256?(ii(s),s):(ii(s),null)}if(ii(s),(s.flags&128)!==0)return s.lanes=r,s;if(r=l!==null,n=n!==null&&n.memoizedState!==null,r){l=s.child,f=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(f=l.alternate.memoizedState.cachePool.pool);var m=null;l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==f&&(l.flags|=2048)}return r!==n&&r&&(s.child.flags|=8192),Zl(s,s.updateQueue),Jt(s),null;case 4:return qe(),n===null&&rf(s.stateNode.containerInfo),Jt(s),null;case 10:return li(s.type),Jt(s),null;case 19:if(Xe(bn),f=s.memoizedState,f===null)return Jt(s),null;if(l=(s.flags&128)!==0,m=f.rendering,m===null)if(l)go(f,!1);else{if(on!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(m=Dl(n),m!==null){for(s.flags|=128,go(f,!1),n=m.updateQueue,s.updateQueue=n,Zl(s,n),s.subtreeFlags=0,n=r,r=s.child;r!==null;)m1(r,n),r=r.sibling;return Qe(bn,bn.current&1|2),s.child}n=n.sibling}f.tail!==null&&ke()>Jl&&(s.flags|=128,l=!0,go(f,!1),s.lanes=4194304)}else{if(!l)if(n=Dl(m),n!==null){if(s.flags|=128,l=!0,n=n.updateQueue,s.updateQueue=n,Zl(s,n),go(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!Pt)return Jt(s),null}else 2*ke()-f.renderingStartTime>Jl&&r!==536870912&&(s.flags|=128,l=!0,go(f,!1),s.lanes=4194304);f.isBackwards?(m.sibling=s.child,s.child=m):(n=f.last,n!==null?n.sibling=m:s.child=m,f.last=m)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=ke(),s.sibling=null,n=bn.current,Qe(bn,l?n&1|2:n&1),s):(Jt(s),null);case 22:case 23:return ii(s),Yu(),l=s.memoizedState!==null,n!==null?n.memoizedState!==null!==l&&(s.flags|=8192):l&&(s.flags|=8192),l?(r&536870912)!==0&&(s.flags&128)===0&&(Jt(s),s.subtreeFlags&6&&(s.flags|=8192)):Jt(s),r=s.updateQueue,r!==null&&Zl(s,r.retryQueue),r=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),l=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(l=s.memoizedState.cachePool.pool),l!==r&&(s.flags|=2048),n!==null&&Xe(sa),null;case 24:return r=null,n!==null&&(r=n.memoizedState.cache),s.memoizedState.cache!==r&&(s.flags|=2048),li(xn),Jt(s),null;case 25:return null}throw Error(a(156,s.tag))}function Dx(n,s){switch(qu(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return li(xn),qe(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return Ct(s),null;case 13:if(ii(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(a(340));Xr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return Xe(bn),null;case 4:return qe(),null;case 10:return li(s.type),null;case 22:case 23:return ii(s),Yu(),n!==null&&Xe(sa),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return li(xn),null;case 25:return null;default:return null}}function y1(n,s){switch(qu(s),s.tag){case 3:li(xn),qe();break;case 26:case 27:case 5:Ct(s);break;case 4:qe();break;case 13:ii(s);break;case 19:Xe(bn);break;case 10:li(s.type);break;case 22:case 23:ii(s),Yu(),n!==null&&Xe(sa);break;case 24:li(xn)}}var Bx={getCacheForType:function(n){var s=Dn(xn),r=s.data.get(n);return r===void 0&&(r=n(),s.data.set(n,r)),r}},zx=typeof WeakMap=="function"?WeakMap:Map,en=0,Yt=null,At=null,zt=0,Xt=0,ts=null,hi=!1,er=!1,Id=!1,mi=0,on=0,Li=0,fa=0,Fd=0,gs=0,tr=0,po=null,$s=null,qd=!1,Vd=0,Jl=1/0,ec=null,Oi=null,tc=!1,ha=null,yo=0,Hd=0,Gd=null,vo=0,Yd=null;function ns(){if((en&2)!==0&&zt!==0)return zt&-zt;if(P.T!==null){var n=Ga;return n!==0?n:tf()}return bt()}function v1(){gs===0&&(gs=(zt&536870912)===0||Pt?Ds():536870912);var n=ds.current;return n!==null&&(n.flags|=32),gs}function qn(n,s,r){(n===Yt&&Xt===2||n.cancelPendingCommit!==null)&&(nr(n,0),gi(n,zt,gs,!1)),He(n,r),((en&2)===0||n!==Yt)&&(n===Yt&&((en&2)===0&&(fa|=r),on===4&&gi(n,zt,gs,!1)),Us(n))}function b1(n,s,r){if((en&6)!==0)throw Error(a(327));var l=!r&&(s&60)===0&&(s&n.expiredLanes)===0||mn(n,s),f=l?Ux(n,s):Wd(n,s,!0),m=l;do{if(f===0){er&&!l&&gi(n,s,0,!1);break}else if(f===6)gi(n,s,0,!hi);else{if(r=n.current.alternate,m&&!Px(r)){f=Wd(n,s,!1),m=!1;continue}if(f===2){if(m=s,n.errorRecoveryDisabledLanes&m)var S=0;else S=n.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var k=n;f=po;var $=k.current.memoizedState.isDehydrated;if($&&(nr(k,S).flags|=256),S=Wd(k,S,!1),S!==2){if(Id&&!$){k.errorRecoveryDisabledLanes|=m,fa|=m,f=4;break e}m=$s,$s=f,m!==null&&Xd(m)}f=S}if(m=!1,f!==2)continue}}if(f===1){nr(n,0),gi(n,s,0,!0);break}e:{switch(l=n,f){case 0:case 1:throw Error(a(345));case 4:if((s&4194176)===s){gi(l,s,gs,!hi);break e}break;case 2:$s=null;break;case 3:case 5:break;default:throw Error(a(329))}if(l.finishedWork=r,l.finishedLanes=s,(s&62914560)===s&&(m=Vd+300-ke(),10<m)){if(gi(l,s,gs,!hi),Ht(l,0)!==0)break e;l.timeoutHandle=q1(x1.bind(null,l,r,$s,ec,qd,s,gs,fa,tr,hi,2,-0,0),m);break e}x1(l,r,$s,ec,qd,s,gs,fa,tr,hi,0,-0,0)}}break}while(!0);Us(n)}function Xd(n){$s===null?$s=n:$s.push.apply($s,n)}function x1(n,s,r,l,f,m,S,k,$,Z,xe,De,ue){var be=s.subtreeFlags;if((be&8192||(be&16785408)===16785408)&&(jo={stylesheets:null,count:0,unsuspend:bw},u1(s),s=ww(),s!==null)){n.cancelPendingCommit=s(T1.bind(null,n,r,l,f,S,k,$,1,De,ue)),gi(n,m,S,!Z);return}T1(n,r,l,f,S,k,$,xe,De,ue)}function Px(n){for(var s=n;;){var r=s.tag;if((r===0||r===11||r===15)&&s.flags&16384&&(r=s.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var l=0;l<r.length;l++){var f=r[l],m=f.getSnapshot;f=f.value;try{if(!Zn(m(),f))return!1}catch{return!1}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function gi(n,s,r,l){s&=~Fd,s&=~fa,n.suspendedLanes|=s,n.pingedLanes&=~s,l&&(n.warmLanes|=s),l=n.expirationTimes;for(var f=s;0<f;){var m=31-Ze(f),S=1<<m;l[m]=-1,f&=~S}r!==0&&Et(n,r,s)}function nc(){return(en&6)===0?(bo(0),!1):!0}function Kd(){if(At!==null){if(Xt===0)var n=At.return;else n=At,oi=la=null,td(n),Va=null,Zr=0,n=At;for(;n!==null;)y1(n.alternate,n),n=n.return;At=null}}function nr(n,s){n.finishedWork=null,n.finishedLanes=0;var r=n.timeoutHandle;r!==-1&&(n.timeoutHandle=-1,sw(r)),r=n.cancelPendingCommit,r!==null&&(n.cancelPendingCommit=null,r()),Kd(),Yt=n,At=r=Mi(n.current,null),zt=s,Xt=0,ts=null,hi=!1,er=mn(n,s),Id=!1,tr=gs=Fd=fa=Li=on=0,$s=po=null,qd=!1,(s&8)!==0&&(s|=s&32);var l=n.entangledLanes;if(l!==0)for(n=n.entanglements,l&=s;0<l;){var f=31-Ze(l),m=1<<f;s|=n[f],l&=~m}return mi=s,Nl(),r}function w1(n,s){Tt=null,P.H=Ps,s===Qr?(s=Bg(),Xt=3):s===Lg?(s=Bg(),Xt=4):Xt=s===Op?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,ts=s,At===null&&(on=1,Gl(n,ls(s,n.current)))}function _1(){var n=P.H;return P.H=Ps,n===null?Ps:n}function S1(){var n=P.A;return P.A=Bx,n}function Qd(){on=4,hi||(zt&4194176)!==zt&&ds.current!==null||(er=!0),(Li&134217727)===0&&(fa&134217727)===0||Yt===null||gi(Yt,zt,gs,!1)}function Wd(n,s,r){var l=en;en|=2;var f=_1(),m=S1();(Yt!==n||zt!==s)&&(ec=null,nr(n,s)),s=!1;var S=on;e:do try{if(Xt!==0&&At!==null){var k=At,$=ts;switch(Xt){case 8:Kd(),S=6;break e;case 3:case 2:case 6:ds.current===null&&(s=!0);var Z=Xt;if(Xt=0,ts=null,sr(n,k,$,Z),r&&er){S=0;break e}break;default:Z=Xt,Xt=0,ts=null,sr(n,k,$,Z)}}$x(),S=on;break}catch(xe){w1(n,xe)}while(!0);return s&&n.shellSuspendCounter++,oi=la=null,en=l,P.H=f,P.A=m,At===null&&(Yt=null,zt=0,Nl()),S}function $x(){for(;At!==null;)j1(At)}function Ux(n,s){var r=en;en|=2;var l=_1(),f=S1();Yt!==n||zt!==s?(ec=null,Jl=ke()+500,nr(n,s)):er=mn(n,s);e:do try{if(Xt!==0&&At!==null){s=At;var m=ts;t:switch(Xt){case 1:Xt=0,ts=null,sr(n,s,m,1);break;case 2:if(Og(m)){Xt=0,ts=null,C1(s);break}s=function(){Xt===2&&Yt===n&&(Xt=7),Us(n)},m.then(s,s);break e;case 3:Xt=7;break e;case 4:Xt=5;break e;case 7:Og(m)?(Xt=0,ts=null,C1(s)):(Xt=0,ts=null,sr(n,s,m,7));break;case 5:var S=null;switch(At.tag){case 26:S=At.memoizedState;case 5:case 27:var k=At;if(!S||e0(S)){Xt=0,ts=null;var $=k.sibling;if($!==null)At=$;else{var Z=k.return;Z!==null?(At=Z,sc(Z)):At=null}break t}}Xt=0,ts=null,sr(n,s,m,5);break;case 6:Xt=0,ts=null,sr(n,s,m,6);break;case 8:Kd(),on=6;break e;default:throw Error(a(462))}}Ix();break}catch(xe){w1(n,xe)}while(!0);return oi=la=null,P.H=l,P.A=f,en=r,At!==null?0:(Yt=null,zt=0,Nl(),on)}function Ix(){for(;At!==null&&!Je();)j1(At)}function j1(n){var s=Gp(n.alternate,n,mi);n.memoizedProps=n.pendingProps,s===null?sc(n):At=s}function C1(n){var s=n,r=s.alternate;switch(s.tag){case 15:case 0:s=Up(r,s,s.pendingProps,s.type,void 0,zt);break;case 11:s=Up(r,s,s.pendingProps,s.type.render,s.ref,zt);break;case 5:td(s);default:y1(r,s),s=At=m1(s,mi),s=Gp(r,s,mi)}n.memoizedProps=n.pendingProps,s===null?sc(n):At=s}function sr(n,s,r,l){oi=la=null,td(s),Va=null,Zr=0;var f=s.return;try{if(Ex(n,f,s,r,zt)){on=1,Gl(n,ls(r,n.current)),At=null;return}}catch(m){if(f!==null)throw At=f,m;on=1,Gl(n,ls(r,n.current)),At=null;return}s.flags&32768?(Pt||l===1?n=!0:er||(zt&536870912)!==0?n=!1:(hi=n=!0,(l===2||l===3||l===6)&&(l=ds.current,l!==null&&l.tag===13&&(l.flags|=16384))),N1(s,n)):sc(s)}function sc(n){var s=n;do{if((s.flags&32768)!==0){N1(s,hi);return}n=s.return;var r=Ox(s.alternate,s,mi);if(r!==null){At=r;return}if(s=s.sibling,s!==null){At=s;return}At=s=n}while(s!==null);on===0&&(on=5)}function N1(n,s){do{var r=Dx(n.alternate,n);if(r!==null){r.flags&=32767,At=r;return}if(r=n.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!s&&(n=n.sibling,n!==null)){At=n;return}At=n=r}while(n!==null);on=6,At=null}function T1(n,s,r,l,f,m,S,k,$,Z){var xe=P.T,De=ee.p;try{ee.p=2,P.T=null,Fx(n,s,r,l,De,f,m,S,k,$,Z)}finally{P.T=xe,ee.p=De}}function Fx(n,s,r,l,f,m,S,k){do ir();while(ha!==null);if((en&6)!==0)throw Error(a(327));var $=n.finishedWork;if(l=n.finishedLanes,$===null)return null;if(n.finishedWork=null,n.finishedLanes=0,$===n.current)throw Error(a(177));n.callbackNode=null,n.callbackPriority=0,n.cancelPendingCommit=null;var Z=$.lanes|$.childLanes;if(Z|=Uu,dt(n,l,Z,m,S,k),n===Yt&&(At=Yt=null,zt=0),($.subtreeFlags&10256)===0&&($.flags&10256)===0||tc||(tc=!0,Hd=Z,Gd=r,Gx(R,function(){return ir(),null})),r=($.flags&15990)!==0,($.subtreeFlags&15990)!==0||r?(r=P.T,P.T=null,m=ee.p,ee.p=2,S=en,en|=4,Rx(n,$),o1($,n),fx(uf,n.containerInfo),gc=!!cf,uf=cf=null,n.current=$,s1(n,$.alternate,$),_t(),en=S,ee.p=m,P.T=r):n.current=$,tc?(tc=!1,ha=n,yo=l):k1(n,Z),Z=n.pendingLanes,Z===0&&(Oi=null),X($.stateNode),Us(n),s!==null)for(f=n.onRecoverableError,$=0;$<s.length;$++)Z=s[$],f(Z.value,{componentStack:Z.stack});return(yo&3)!==0&&ir(),Z=n.pendingLanes,(l&4194218)!==0&&(Z&42)!==0?n===Yd?vo++:(vo=0,Yd=n):vo=0,bo(0),null}function k1(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,eo(s)))}function ir(){if(ha!==null){var n=ha,s=Hd;Hd=0;var r=We(yo),l=P.T,f=ee.p;try{if(ee.p=32>r?32:r,P.T=null,ha===null)var m=!1;else{r=Gd,Gd=null;var S=ha,k=yo;if(ha=null,yo=0,(en&6)!==0)throw Error(a(331));var $=en;if(en|=4,f1(S.current),c1(S,S.current,k,r),en=$,bo(0,!1),U&&typeof U.onPostCommitFiberRoot=="function")try{U.onPostCommitFiberRoot(T,S)}catch{}m=!0}return m}finally{ee.p=f,P.T=l,k1(n,s)}}return!1}function E1(n,s,r){s=ls(r,s),s=gd(n.stateNode,s,2),n=ki(n,s,2),n!==null&&(He(n,2),Us(n))}function Gt(n,s,r){if(n.tag===3)E1(n,n,r);else for(;s!==null;){if(s.tag===3){E1(s,n,r);break}else if(s.tag===1){var l=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Oi===null||!Oi.has(l))){n=ls(r,n),r=Mp(2),l=ki(s,r,2),l!==null&&(Lp(r,l,s,n),He(l,2),Us(l));break}}s=s.return}}function Zd(n,s,r){var l=n.pingCache;if(l===null){l=n.pingCache=new zx;var f=new Set;l.set(s,f)}else f=l.get(s),f===void 0&&(f=new Set,l.set(s,f));f.has(r)||(Id=!0,f.add(r),n=qx.bind(null,n,s,r),s.then(n,n))}function qx(n,s,r){var l=n.pingCache;l!==null&&l.delete(s),n.pingedLanes|=n.suspendedLanes&r,n.warmLanes&=~r,Yt===n&&(zt&r)===r&&(on===4||on===3&&(zt&62914560)===zt&&300>ke()-Vd?(en&2)===0&&nr(n,0):Fd|=r,tr===zt&&(tr=0)),Us(n)}function A1(n,s){s===0&&(s=fe()),n=xi(n,s),n!==null&&(He(n,s),Us(n))}function Vx(n){var s=n.memoizedState,r=0;s!==null&&(r=s.retryLane),A1(n,r)}function Hx(n,s){var r=0;switch(n.tag){case 13:var l=n.stateNode,f=n.memoizedState;f!==null&&(r=f.retryLane);break;case 19:l=n.stateNode;break;case 22:l=n.stateNode._retryCache;break;default:throw Error(a(314))}l!==null&&l.delete(s),A1(n,r)}function Gx(n,s){return pe(n,s)}var ic=null,ar=null,Jd=!1,ac=!1,ef=!1,ma=0;function Us(n){n!==ar&&n.next===null&&(ar===null?ic=ar=n:ar=ar.next=n),ac=!0,Jd||(Jd=!0,Xx(Yx))}function bo(n,s){if(!ef&&ac){ef=!0;do for(var r=!1,l=ic;l!==null;){if(n!==0){var f=l.pendingLanes;if(f===0)var m=0;else{var S=l.suspendedLanes,k=l.pingedLanes;m=(1<<31-Ze(42|n)+1)-1,m&=f&~(S&~k),m=m&201326677?m&201326677|1:m?m|2:0}m!==0&&(r=!0,L1(l,m))}else m=zt,m=Ht(l,l===Yt?m:0),(m&3)===0||mn(l,m)||(r=!0,L1(l,m));l=l.next}while(r);ef=!1}}function Yx(){ac=Jd=!1;var n=0;ma!==0&&(nw()&&(n=ma),ma=0);for(var s=ke(),r=null,l=ic;l!==null;){var f=l.next,m=R1(l,s);m===0?(l.next=null,r===null?ic=f:r.next=f,f===null&&(ar=r)):(r=l,(n!==0||(m&3)!==0)&&(ac=!0)),l=f}bo(n)}function R1(n,s){for(var r=n.suspendedLanes,l=n.pingedLanes,f=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var S=31-Ze(m),k=1<<S,$=f[S];$===-1?((k&r)===0||(k&l)!==0)&&(f[S]=is(k,s)):$<=s&&(n.expiredLanes|=k),m&=~k}if(s=Yt,r=zt,r=Ht(n,n===s?r:0),l=n.callbackNode,r===0||n===s&&Xt===2||n.cancelPendingCommit!==null)return l!==null&&l!==null&&je(l),n.callbackNode=null,n.callbackPriority=0;if((r&3)===0||mn(n,r)){if(s=r&-r,s===n.callbackPriority)return s;switch(l!==null&&je(l),We(r)){case 2:case 8:r=B;break;case 32:r=R;break;case 268435456:r=_;break;default:r=R}return l=M1.bind(null,n),r=pe(r,l),n.callbackPriority=s,n.callbackNode=r,s}return l!==null&&l!==null&&je(l),n.callbackPriority=2,n.callbackNode=null,2}function M1(n,s){var r=n.callbackNode;if(ir()&&n.callbackNode!==r)return null;var l=zt;return l=Ht(n,n===Yt?l:0),l===0?null:(b1(n,l,s),R1(n,ke()),n.callbackNode!=null&&n.callbackNode===r?M1.bind(null,n):null)}function L1(n,s){if(ir())return null;b1(n,s,!0)}function Xx(n){iw(function(){(en&6)!==0?pe(ht,n):n()})}function tf(){return ma===0&&(ma=Ds()),ma}function O1(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:bl(""+n)}function D1(n,s){var r=s.ownerDocument.createElement("input");return r.name=s.name,r.value=s.value,n.id&&r.setAttribute("form",n.id),s.parentNode.insertBefore(r,s),n=new FormData(n),r.parentNode.removeChild(r),n}function Kx(n,s,r,l,f){if(s==="submit"&&r&&r.stateNode===f){var m=O1((f[sn]||null).action),S=l.submitter;S&&(s=(s=S[sn]||null)?O1(s.formAction):S.getAttribute("formAction"),s!==null&&(m=s,S=null));var k=new Sl("action","action",null,l,f);n.push({event:k,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(ma!==0){var $=S?D1(f,S):new FormData(f);ud(r,{pending:!0,data:$,method:f.method,action:m},null,$)}}else typeof m=="function"&&(k.preventDefault(),$=S?D1(f,S):new FormData(f),ud(r,{pending:!0,data:$,method:f.method,action:m},m,$))},currentTarget:f}]})}}for(var nf=0;nf<Tg.length;nf++){var sf=Tg[nf],Qx=sf.toLowerCase(),Wx=sf[0].toUpperCase()+sf.slice(1);js(Qx,"on"+Wx)}js(_g,"onAnimationEnd"),js(Sg,"onAnimationIteration"),js(jg,"onAnimationStart"),js("dblclick","onDoubleClick"),js("focusin","onFocus"),js("focusout","onBlur"),js(mx,"onTransitionRun"),js(gx,"onTransitionStart"),js(px,"onTransitionCancel"),js(Cg,"onTransitionEnd"),Ma("onMouseEnter",["mouseout","mouseover"]),Ma("onMouseLeave",["mouseout","mouseover"]),Ma("onPointerEnter",["pointerout","pointerover"]),Ma("onPointerLeave",["pointerout","pointerover"]),Ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ki("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(xo));function B1(n,s){s=(s&4)!==0;for(var r=0;r<n.length;r++){var l=n[r],f=l.event;l=l.listeners;e:{var m=void 0;if(s)for(var S=l.length-1;0<=S;S--){var k=l[S],$=k.instance,Z=k.currentTarget;if(k=k.listener,$!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=Z;try{m(f)}catch(xe){Hl(xe)}f.currentTarget=null,m=$}else for(S=0;S<l.length;S++){if(k=l[S],$=k.instance,Z=k.currentTarget,k=k.listener,$!==m&&f.isPropagationStopped())break e;m=k,f.currentTarget=Z;try{m(f)}catch(xe){Hl(xe)}f.currentTarget=null,m=$}}}}function Ot(n,s){var r=s[Oe];r===void 0&&(r=s[Oe]=new Set);var l=n+"__bubble";r.has(l)||(z1(s,n,2,!1),r.add(l))}function af(n,s,r){var l=0;s&&(l|=4),z1(r,n,l,s)}var rc="_reactListening"+Math.random().toString(36).slice(2);function rf(n){if(!n[rc]){n[rc]=!0,Um.forEach(function(r){r!=="selectionchange"&&(Zx.has(r)||af(r,!1,n),af(r,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[rc]||(s[rc]=!0,af("selectionchange",!1,s))}}function z1(n,s,r,l){switch(r0(s)){case 2:var f=jw;break;case 8:f=Cw;break;default:f=bf}r=f.bind(null,s,r,n),f=void 0,!Tu||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(f=!0),l?f!==void 0?n.addEventListener(s,r,{capture:!0,passive:f}):n.addEventListener(s,r,!0):f!==void 0?n.addEventListener(s,r,{passive:f}):n.addEventListener(s,r,!1)}function of(n,s,r,l,f){var m=l;if((s&1)===0&&(s&2)===0&&l!==null)e:for(;;){if(l===null)return;var S=l.tag;if(S===3||S===4){var k=l.stateNode.containerInfo;if(k===f||k.nodeType===8&&k.parentNode===f)break;if(S===4)for(S=l.return;S!==null;){var $=S.tag;if(($===3||$===4)&&($=S.stateNode.containerInfo,$===f||$.nodeType===8&&$.parentNode===f))return;S=S.return}for(;k!==null;){if(S=Js(k),S===null)return;if($=S.tag,$===5||$===6||$===26||$===27){l=m=S;continue e}k=k.parentNode}}l=l.return}Zm(function(){var Z=m,xe=Cu(r),De=[];e:{var ue=Ng.get(n);if(ue!==void 0){var be=Sl,it=n;switch(n){case"keypress":if(wl(r)===0)break e;case"keydown":case"keyup":be=H4;break;case"focusin":it="focus",be=Ru;break;case"focusout":it="blur",be=Ru;break;case"beforeblur":case"afterblur":be=Ru;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=tg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=L4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=X4;break;case _g:case Sg:case jg:be=B4;break;case Cg:be=Q4;break;case"scroll":case"scrollend":be=R4;break;case"wheel":be=Z4;break;case"copy":case"cut":case"paste":be=P4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=sg;break;case"toggle":case"beforetoggle":be=ex}var St=(s&4)!==0,ln=!St&&(n==="scroll"||n==="scrollend"),se=St?ue!==null?ue+"Capture":null:ue;St=[];for(var W=Z,ce;W!==null;){var Te=W;if(ce=Te.stateNode,Te=Te.tag,Te!==5&&Te!==26&&Te!==27||ce===null||se===null||(Te=Pr(W,se),Te!=null&&St.push(wo(W,Te,ce))),ln)break;W=W.return}0<St.length&&(ue=new be(ue,it,null,r,xe),De.push({event:ue,listeners:St}))}}if((s&7)===0){e:{if(ue=n==="mouseover"||n==="pointerover",be=n==="mouseout"||n==="pointerout",ue&&r!==ju&&(it=r.relatedTarget||r.fromElement)&&(Js(it)||it[Gn]))break e;if((be||ue)&&(ue=xe.window===xe?xe:(ue=xe.ownerDocument)?ue.defaultView||ue.parentWindow:window,be?(it=r.relatedTarget||r.toElement,be=Z,it=it?Js(it):null,it!==null&&(ln=J(it),St=it.tag,it!==ln||St!==5&&St!==27&&St!==6)&&(it=null)):(be=null,it=Z),be!==it)){if(St=tg,Te="onMouseLeave",se="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(St=sg,Te="onPointerLeave",se="onPointerEnter",W="pointer"),ln=be==null?ue:zr(be),ce=it==null?ue:zr(it),ue=new St(Te,W+"leave",be,r,xe),ue.target=ln,ue.relatedTarget=ce,Te=null,Js(xe)===Z&&(St=new St(se,W+"enter",it,r,xe),St.target=ce,St.relatedTarget=ln,Te=St),ln=Te,be&&it)t:{for(St=be,se=it,W=0,ce=St;ce;ce=rr(ce))W++;for(ce=0,Te=se;Te;Te=rr(Te))ce++;for(;0<W-ce;)St=rr(St),W--;for(;0<ce-W;)se=rr(se),ce--;for(;W--;){if(St===se||se!==null&&St===se.alternate)break t;St=rr(St),se=rr(se)}St=null}else St=null;be!==null&&P1(De,ue,be,St,!1),it!==null&&ln!==null&&P1(De,ln,it,St,!0)}}e:{if(ue=Z?zr(Z):window,be=ue.nodeName&&ue.nodeName.toLowerCase(),be==="select"||be==="input"&&ue.type==="file")var tt=dg;else if(cg(ue))if(fg)tt=ux;else{tt=lx;var kt=ox}else be=ue.nodeName,!be||be.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?Z&&Su(Z.elementType)&&(tt=dg):tt=cx;if(tt&&(tt=tt(n,Z))){ug(De,tt,r,xe);break e}kt&&kt(n,ue,Z),n==="focusout"&&Z&&ue.type==="number"&&Z.memoizedProps.value!=null&&_u(ue,"number",ue.value)}switch(kt=Z?zr(Z):window,n){case"focusin":(cg(kt)||kt.contentEditable==="true")&&(Pa=kt,zu=Z,Gr=null);break;case"focusout":Gr=zu=Pa=null;break;case"mousedown":Pu=!0;break;case"contextmenu":case"mouseup":case"dragend":Pu=!1,xg(De,r,xe);break;case"selectionchange":if(hx)break;case"keydown":case"keyup":xg(De,r,xe)}var ot;if(Lu)e:{switch(n){case"compositionstart":var gt="onCompositionStart";break e;case"compositionend":gt="onCompositionEnd";break e;case"compositionupdate":gt="onCompositionUpdate";break e}gt=void 0}else za?og(n,r)&&(gt="onCompositionEnd"):n==="keydown"&&r.keyCode===229&&(gt="onCompositionStart");gt&&(ig&&r.locale!=="ko"&&(za||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&za&&(ot=Jm()):(bi=xe,ku="value"in bi?bi.value:bi.textContent,za=!0)),kt=oc(Z,gt),0<kt.length&&(gt=new ng(gt,n,null,r,xe),De.push({event:gt,listeners:kt}),ot?gt.data=ot:(ot=lg(r),ot!==null&&(gt.data=ot)))),(ot=nx?sx(n,r):ix(n,r))&&(gt=oc(Z,"onBeforeInput"),0<gt.length&&(kt=new ng("onBeforeInput","beforeinput",null,r,xe),De.push({event:kt,listeners:gt}),kt.data=ot)),Kx(De,n,Z,r,xe)}B1(De,s)})}function wo(n,s,r){return{instance:n,listener:s,currentTarget:r}}function oc(n,s){for(var r=s+"Capture",l=[];n!==null;){var f=n,m=f.stateNode;f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Pr(n,r),f!=null&&l.unshift(wo(n,f,m)),f=Pr(n,s),f!=null&&l.push(wo(n,f,m))),n=n.return}return l}function rr(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function P1(n,s,r,l,f){for(var m=s._reactName,S=[];r!==null&&r!==l;){var k=r,$=k.alternate,Z=k.stateNode;if(k=k.tag,$!==null&&$===l)break;k!==5&&k!==26&&k!==27||Z===null||($=Z,f?(Z=Pr(r,m),Z!=null&&S.unshift(wo(r,Z,$))):f||(Z=Pr(r,m),Z!=null&&S.push(wo(r,Z,$)))),r=r.return}S.length!==0&&n.push({event:s,listeners:S})}var Jx=/\r\n?/g,ew=/\u0000|\uFFFD/g;function $1(n){return(typeof n=="string"?n:""+n).replace(Jx,`
`).replace(ew,"")}function U1(n,s){return s=$1(s),$1(n)===s}function lc(){}function Vt(n,s,r,l,f,m){switch(r){case"children":typeof l=="string"?s==="body"||s==="textarea"&&l===""||Oa(n,l):(typeof l=="number"||typeof l=="bigint")&&s!=="body"&&Oa(n,""+l);break;case"className":pl(n,"class",l);break;case"tabIndex":pl(n,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":pl(n,r,l);break;case"style":Qm(n,l,m);break;case"data":if(s!=="object"){pl(n,"data",l);break}case"src":case"href":if(l===""&&(s!=="a"||r!=="href")){n.removeAttribute(r);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(r);break}l=bl(""+l),n.setAttribute(r,l);break;case"action":case"formAction":if(typeof l=="function"){n.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(r==="formAction"?(s!=="input"&&Vt(n,s,"name",f.name,f,null),Vt(n,s,"formEncType",f.formEncType,f,null),Vt(n,s,"formMethod",f.formMethod,f,null),Vt(n,s,"formTarget",f.formTarget,f,null)):(Vt(n,s,"encType",f.encType,f,null),Vt(n,s,"method",f.method,f,null),Vt(n,s,"target",f.target,f,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){n.removeAttribute(r);break}l=bl(""+l),n.setAttribute(r,l);break;case"onClick":l!=null&&(n.onclick=lc);break;case"onScroll":l!=null&&Ot("scroll",n);break;case"onScrollEnd":l!=null&&Ot("scrollend",n);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(a(61));if(r=l.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"multiple":n.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":n.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){n.removeAttribute("xlink:href");break}r=bl(""+l),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(r,""+l):n.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(r,""):n.removeAttribute(r);break;case"capture":case"download":l===!0?n.setAttribute(r,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?n.setAttribute(r,l):n.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?n.setAttribute(r,l):n.removeAttribute(r);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?n.removeAttribute(r):n.setAttribute(r,l);break;case"popover":Ot("beforetoggle",n),Ot("toggle",n),gl(n,"popover",l);break;case"xlinkActuate":ti(n,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":ti(n,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":ti(n,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":ti(n,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":ti(n,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":ti(n,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":ti(n,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":ti(n,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":ti(n,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":gl(n,"is",l);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=E4.get(r)||r,gl(n,r,l))}}function lf(n,s,r,l,f,m){switch(r){case"style":Qm(n,l,m);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(a(61));if(r=l.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"children":typeof l=="string"?Oa(n,l):(typeof l=="number"||typeof l=="bigint")&&Oa(n,""+l);break;case"onScroll":l!=null&&Ot("scroll",n);break;case"onScrollEnd":l!=null&&Ot("scrollend",n);break;case"onClick":l!=null&&(n.onclick=lc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Im.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),s=r.slice(2,f?r.length-7:void 0),m=n[sn]||null,m=m!=null?m[r]:null,typeof m=="function"&&n.removeEventListener(s,m,f),typeof l=="function")){typeof m!="function"&&m!==null&&(r in n?n[r]=null:n.hasAttribute(r)&&n.removeAttribute(r)),n.addEventListener(s,l,f);break e}r in n?n[r]=l:l===!0?n.setAttribute(r,""):gl(n,r,l)}}}function Ln(n,s,r){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",n),Ot("load",n);var l=!1,f=!1,m;for(m in r)if(r.hasOwnProperty(m)){var S=r[m];if(S!=null)switch(m){case"src":l=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Vt(n,s,m,S,r,null)}}f&&Vt(n,s,"srcSet",r.srcSet,r,null),l&&Vt(n,s,"src",r.src,r,null);return;case"input":Ot("invalid",n);var k=m=S=f=null,$=null,Z=null;for(l in r)if(r.hasOwnProperty(l)){var xe=r[l];if(xe!=null)switch(l){case"name":f=xe;break;case"type":S=xe;break;case"checked":$=xe;break;case"defaultChecked":Z=xe;break;case"value":m=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,s));break;default:Vt(n,s,l,xe,r,null)}}Gm(n,m,k,$,Z,S,f,!1),yl(n);return;case"select":Ot("invalid",n),l=S=m=null;for(f in r)if(r.hasOwnProperty(f)&&(k=r[f],k!=null))switch(f){case"value":m=k;break;case"defaultValue":S=k;break;case"multiple":l=k;default:Vt(n,s,f,k,r,null)}s=m,r=S,n.multiple=!!l,s!=null?La(n,!!l,s,!1):r!=null&&La(n,!!l,r,!0);return;case"textarea":Ot("invalid",n),m=f=l=null;for(S in r)if(r.hasOwnProperty(S)&&(k=r[S],k!=null))switch(S){case"value":l=k;break;case"defaultValue":f=k;break;case"children":m=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(a(91));break;default:Vt(n,s,S,k,r,null)}Xm(n,l,f,m),yl(n);return;case"option":for($ in r)if(r.hasOwnProperty($)&&(l=r[$],l!=null))switch($){case"selected":n.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Vt(n,s,$,l,r,null)}return;case"dialog":Ot("cancel",n),Ot("close",n);break;case"iframe":case"object":Ot("load",n);break;case"video":case"audio":for(l=0;l<xo.length;l++)Ot(xo[l],n);break;case"image":Ot("error",n),Ot("load",n);break;case"details":Ot("toggle",n);break;case"embed":case"source":case"link":Ot("error",n),Ot("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in r)if(r.hasOwnProperty(Z)&&(l=r[Z],l!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:Vt(n,s,Z,l,r,null)}return;default:if(Su(s)){for(xe in r)r.hasOwnProperty(xe)&&(l=r[xe],l!==void 0&&lf(n,s,xe,l,r,void 0));return}}for(k in r)r.hasOwnProperty(k)&&(l=r[k],l!=null&&Vt(n,s,k,l,r,null))}function tw(n,s,r,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,S=null,k=null,$=null,Z=null,xe=null;for(be in r){var De=r[be];if(r.hasOwnProperty(be)&&De!=null)switch(be){case"checked":break;case"value":break;case"defaultValue":$=De;default:l.hasOwnProperty(be)||Vt(n,s,be,null,l,De)}}for(var ue in l){var be=l[ue];if(De=r[ue],l.hasOwnProperty(ue)&&(be!=null||De!=null))switch(ue){case"type":m=be;break;case"name":f=be;break;case"checked":Z=be;break;case"defaultChecked":xe=be;break;case"value":S=be;break;case"defaultValue":k=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(a(137,s));break;default:be!==De&&Vt(n,s,ue,be,l,De)}}wu(n,S,k,$,Z,xe,m,f);return;case"select":be=S=k=ue=null;for(m in r)if($=r[m],r.hasOwnProperty(m)&&$!=null)switch(m){case"value":break;case"multiple":be=$;default:l.hasOwnProperty(m)||Vt(n,s,m,null,l,$)}for(f in l)if(m=l[f],$=r[f],l.hasOwnProperty(f)&&(m!=null||$!=null))switch(f){case"value":ue=m;break;case"defaultValue":k=m;break;case"multiple":S=m;default:m!==$&&Vt(n,s,f,m,l,$)}s=k,r=S,l=be,ue!=null?La(n,!!r,ue,!1):!!l!=!!r&&(s!=null?La(n,!!r,s,!0):La(n,!!r,r?[]:"",!1));return;case"textarea":be=ue=null;for(k in r)if(f=r[k],r.hasOwnProperty(k)&&f!=null&&!l.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Vt(n,s,k,null,l,f)}for(S in l)if(f=l[S],m=r[S],l.hasOwnProperty(S)&&(f!=null||m!=null))switch(S){case"value":ue=f;break;case"defaultValue":be=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==m&&Vt(n,s,S,f,l,m)}Ym(n,ue,be);return;case"option":for(var it in r)if(ue=r[it],r.hasOwnProperty(it)&&ue!=null&&!l.hasOwnProperty(it))switch(it){case"selected":n.selected=!1;break;default:Vt(n,s,it,null,l,ue)}for($ in l)if(ue=l[$],be=r[$],l.hasOwnProperty($)&&ue!==be&&(ue!=null||be!=null))switch($){case"selected":n.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:Vt(n,s,$,ue,l,be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var St in r)ue=r[St],r.hasOwnProperty(St)&&ue!=null&&!l.hasOwnProperty(St)&&Vt(n,s,St,null,l,ue);for(Z in l)if(ue=l[Z],be=r[Z],l.hasOwnProperty(Z)&&ue!==be&&(ue!=null||be!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(a(137,s));break;default:Vt(n,s,Z,ue,l,be)}return;default:if(Su(s)){for(var ln in r)ue=r[ln],r.hasOwnProperty(ln)&&ue!==void 0&&!l.hasOwnProperty(ln)&&lf(n,s,ln,void 0,l,ue);for(xe in l)ue=l[xe],be=r[xe],!l.hasOwnProperty(xe)||ue===be||ue===void 0&&be===void 0||lf(n,s,xe,ue,l,be);return}}for(var se in r)ue=r[se],r.hasOwnProperty(se)&&ue!=null&&!l.hasOwnProperty(se)&&Vt(n,s,se,null,l,ue);for(De in l)ue=l[De],be=r[De],!l.hasOwnProperty(De)||ue===be||ue==null&&be==null||Vt(n,s,De,ue,l,be)}var cf=null,uf=null;function cc(n){return n.nodeType===9?n:n.ownerDocument}function I1(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function F1(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function df(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ff=null;function nw(){var n=window.event;return n&&n.type==="popstate"?n===ff?!1:(ff=n,!0):(ff=null,!1)}var q1=typeof setTimeout=="function"?setTimeout:void 0,sw=typeof clearTimeout=="function"?clearTimeout:void 0,V1=typeof Promise=="function"?Promise:void 0,iw=typeof queueMicrotask=="function"?queueMicrotask:typeof V1<"u"?function(n){return V1.resolve(null).then(n).catch(aw)}:q1;function aw(n){setTimeout(function(){throw n})}function hf(n,s){var r=s,l=0;do{var f=r.nextSibling;if(n.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"){if(l===0){n.removeChild(f),Eo(s);return}l--}else r!=="$"&&r!=="$?"&&r!=="$!"||l++;r=f}while(r);Eo(s)}function mf(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var r=s;switch(s=s.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":mf(r),Wn(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}n.removeChild(r)}}function rw(n,s,r,l){for(;n.nodeType===1;){var f=r;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!l&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(l){if(!n[Wt])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==f.rel||n.getAttribute("href")!==(f.href==null?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Ts(n.nextSibling),n===null)break}return null}function ow(n,s,r){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Ts(n.nextSibling),n===null))return null;return n}function Ts(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return n}function H1(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var r=n.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return n;s--}else r==="/$"&&s++}n=n.previousSibling}return null}function G1(n,s,r){switch(s=cc(r),n){case"html":if(n=s.documentElement,!n)throw Error(a(452));return n;case"head":if(n=s.head,!n)throw Error(a(453));return n;case"body":if(n=s.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}var ps=new Map,Y1=new Set;function uc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.ownerDocument}var pi=ee.d;ee.d={f:lw,r:cw,D:uw,C:dw,L:fw,m:hw,X:gw,S:mw,M:pw};function lw(){var n=pi.f(),s=nc();return n||s}function cw(n){var s=Aa(n);s!==null&&s.tag===5&&s.type==="form"?xp(s):pi.r(n)}var or=typeof document>"u"?null:document;function X1(n,s,r){var l=or;if(l&&typeof s=="string"&&s){var f=rs(s);f='link[rel="'+n+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),Y1.has(f)||(Y1.add(f),n={rel:n,crossOrigin:r,href:s},l.querySelector(f)===null&&(s=l.createElement("link"),Ln(s,"link",n),jn(s),l.head.appendChild(s)))}}function uw(n){pi.D(n),X1("dns-prefetch",n,null)}function dw(n,s){pi.C(n,s),X1("preconnect",n,s)}function fw(n,s,r){pi.L(n,s,r);var l=or;if(l&&n&&s){var f='link[rel="preload"][as="'+rs(s)+'"]';s==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+rs(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+rs(r.imageSizes)+'"]')):f+='[href="'+rs(n)+'"]';var m=f;switch(s){case"style":m=lr(n);break;case"script":m=cr(n)}ps.has(m)||(n=G({rel:"preload",href:s==="image"&&r&&r.imageSrcSet?void 0:n,as:s},r),ps.set(m,n),l.querySelector(f)!==null||s==="style"&&l.querySelector(_o(m))||s==="script"&&l.querySelector(So(m))||(s=l.createElement("link"),Ln(s,"link",n),jn(s),l.head.appendChild(s)))}}function hw(n,s){pi.m(n,s);var r=or;if(r&&n){var l=s&&typeof s.as=="string"?s.as:"script",f='link[rel="modulepreload"][as="'+rs(l)+'"][href="'+rs(n)+'"]',m=f;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=cr(n)}if(!ps.has(m)&&(n=G({rel:"modulepreload",href:n},s),ps.set(m,n),r.querySelector(f)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(So(m)))return}l=r.createElement("link"),Ln(l,"link",n),jn(l),r.head.appendChild(l)}}}function mw(n,s,r){pi.S(n,s,r);var l=or;if(l&&n){var f=Ra(l).hoistableStyles,m=lr(n);s=s||"default";var S=f.get(m);if(!S){var k={loading:0,preload:null};if(S=l.querySelector(_o(m)))k.loading=5;else{n=G({rel:"stylesheet",href:n,"data-precedence":s},r),(r=ps.get(m))&&gf(n,r);var $=S=l.createElement("link");jn($),Ln($,"link",n),$._p=new Promise(function(Z,xe){$.onload=Z,$.onerror=xe}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,dc(S,s,l)}S={type:"stylesheet",instance:S,count:1,state:k},f.set(m,S)}}}function gw(n,s){pi.X(n,s);var r=or;if(r&&n){var l=Ra(r).hoistableScripts,f=cr(n),m=l.get(f);m||(m=r.querySelector(So(f)),m||(n=G({src:n,async:!0},s),(s=ps.get(f))&&pf(n,s),m=r.createElement("script"),jn(m),Ln(m,"link",n),r.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},l.set(f,m))}}function pw(n,s){pi.M(n,s);var r=or;if(r&&n){var l=Ra(r).hoistableScripts,f=cr(n),m=l.get(f);m||(m=r.querySelector(So(f)),m||(n=G({src:n,async:!0,type:"module"},s),(s=ps.get(f))&&pf(n,s),m=r.createElement("script"),jn(m),Ln(m,"link",n),r.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},l.set(f,m))}}function K1(n,s,r,l){var f=(f=yt.current)?uc(f):null;if(!f)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(s=lr(r.href),r=Ra(f).hoistableStyles,l=r.get(s),l||(l={type:"style",instance:null,count:0,state:null},r.set(s,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){n=lr(r.href);var m=Ra(f).hoistableStyles,S=m.get(n);if(S||(f=f.ownerDocument||f,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,S),(m=f.querySelector(_o(n)))&&!m._p&&(S.instance=m,S.state.loading=5),ps.has(n)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},ps.set(n,r),m||yw(f,n,r,S.state))),s&&l===null)throw Error(a(528,""));return S}if(s&&l!==null)throw Error(a(529,""));return null;case"script":return s=r.async,r=r.src,typeof r=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=cr(r),r=Ra(f).hoistableScripts,l=r.get(s),l||(l={type:"script",instance:null,count:0,state:null},r.set(s,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function lr(n){return'href="'+rs(n)+'"'}function _o(n){return'link[rel="stylesheet"]['+n+"]"}function Q1(n){return G({},n,{"data-precedence":n.precedence,precedence:null})}function yw(n,s,r,l){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?l.loading=1:(s=n.createElement("link"),l.preload=s,s.addEventListener("load",function(){return l.loading|=1}),s.addEventListener("error",function(){return l.loading|=2}),Ln(s,"link",r),jn(s),n.head.appendChild(s))}function cr(n){return'[src="'+rs(n)+'"]'}function So(n){return"script[async]"+n}function W1(n,s,r){if(s.count++,s.instance===null)switch(s.type){case"style":var l=n.querySelector('style[data-href~="'+rs(r.href)+'"]');if(l)return s.instance=l,jn(l),l;var f=G({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return l=(n.ownerDocument||n).createElement("style"),jn(l),Ln(l,"style",f),dc(l,r.precedence,n),s.instance=l;case"stylesheet":f=lr(r.href);var m=n.querySelector(_o(f));if(m)return s.state.loading|=4,s.instance=m,jn(m),m;l=Q1(r),(f=ps.get(f))&&gf(l,f),m=(n.ownerDocument||n).createElement("link"),jn(m);var S=m;return S._p=new Promise(function(k,$){S.onload=k,S.onerror=$}),Ln(m,"link",l),s.state.loading|=4,dc(m,r.precedence,n),s.instance=m;case"script":return m=cr(r.src),(f=n.querySelector(So(m)))?(s.instance=f,jn(f),f):(l=r,(f=ps.get(m))&&(l=G({},r),pf(l,f)),n=n.ownerDocument||n,f=n.createElement("script"),jn(f),Ln(f,"link",l),n.head.appendChild(f),s.instance=f);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(l=s.instance,s.state.loading|=4,dc(l,r.precedence,n));return s.instance}function dc(n,s,r){for(var l=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=l.length?l[l.length-1]:null,m=f,S=0;S<l.length;S++){var k=l[S];if(k.dataset.precedence===s)m=k;else if(m!==f)break}m?m.parentNode.insertBefore(n,m.nextSibling):(s=r.nodeType===9?r.head:r,s.insertBefore(n,s.firstChild))}function gf(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function pf(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var fc=null;function Z1(n,s,r){if(fc===null){var l=new Map,f=fc=new Map;f.set(r,l)}else f=fc,l=f.get(r),l||(l=new Map,f.set(r,l));if(l.has(n))return l;for(l.set(n,null),r=r.getElementsByTagName(n),f=0;f<r.length;f++){var m=r[f];if(!(m[Wt]||m[rt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var S=m.getAttribute(s)||"";S=n+S;var k=l.get(S);k?k.push(m):l.set(S,[m])}}return l}function J1(n,s,r){n=n.ownerDocument||n,n.head.insertBefore(r,s==="title"?n.querySelector("head > title"):null)}function vw(n,s,r){if(r===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return n=s.disabled,typeof s.precedence=="string"&&n==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function e0(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var jo=null;function bw(){}function xw(n,s,r){if(jo===null)throw Error(a(475));var l=jo;if(s.type==="stylesheet"&&(typeof r.media!="string"||matchMedia(r.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var f=lr(r.href),m=n.querySelector(_o(f));if(m){n=m._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(l.count++,l=hc.bind(l),n.then(l,l)),s.state.loading|=4,s.instance=m,jn(m);return}m=n.ownerDocument||n,r=Q1(r),(f=ps.get(f))&&gf(r,f),m=m.createElement("link"),jn(m);var S=m;S._p=new Promise(function(k,$){S.onload=k,S.onerror=$}),Ln(m,"link",r),s.instance=m}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(s,n),(n=s.state.preload)&&(s.state.loading&3)===0&&(l.count++,s=hc.bind(l),n.addEventListener("load",s),n.addEventListener("error",s))}}function ww(){if(jo===null)throw Error(a(475));var n=jo;return n.stylesheets&&n.count===0&&yf(n,n.stylesheets),0<n.count?function(s){var r=setTimeout(function(){if(n.stylesheets&&yf(n,n.stylesheets),n.unsuspend){var l=n.unsuspend;n.unsuspend=null,l()}},6e4);return n.unsuspend=s,function(){n.unsuspend=null,clearTimeout(r)}}:null}function hc(){if(this.count--,this.count===0){if(this.stylesheets)yf(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var mc=null;function yf(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,mc=new Map,s.forEach(_w,n),mc=null,hc.call(n))}function _w(n,s){if(!(s.state.loading&4)){var r=mc.get(n);if(r)var l=r.get(null);else{r=new Map,mc.set(n,r);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var S=f[m];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(r.set(S.dataset.precedence,S),l=S)}l&&r.set(null,l)}f=s.instance,S=f.getAttribute("data-precedence"),m=r.get(S)||l,m===l&&r.set(null,f),r.set(S,f),this.count++,l=hc.bind(this),f.addEventListener("load",l),f.addEventListener("error",l),m?m.parentNode.insertBefore(f,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),s.state.loading|=4}}var Co={$$typeof:j,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function Sw(n,s,r,l,f,m,S,k){this.tag=1,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Me(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Me(0),this.hiddenUpdates=Me(null),this.identifierPrefix=l,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=k,this.incompleteTransitions=new Map}function t0(n,s,r,l,f,m,S,k,$,Z,xe,De){return n=new Sw(n,s,r,S,k,$,Z,De),s=1,m===!0&&(s|=24),m=ms(3,null,null,s),n.current=m,m.stateNode=n,s=Xu(),s.refCount++,n.pooledCache=s,s.refCount++,m.memoizedState={element:l,isDehydrated:r,cache:s},kd(m),n}function n0(n){return n?(n=Ia,n):Ia}function s0(n,s,r,l,f,m){f=n0(f),l.context===null?l.context=f:l.pendingContext=f,l=Ti(s),l.payload={element:r},m=m===void 0?null:m,m!==null&&(l.callback=m),r=ki(n,l,s),r!==null&&(qn(r,n,s),oo(r,n,s))}function i0(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var r=n.retryLane;n.retryLane=r!==0&&r<s?r:s}}function vf(n,s){i0(n,s),(n=n.alternate)&&i0(n,s)}function a0(n){if(n.tag===13){var s=xi(n,67108864);s!==null&&qn(s,n,67108864),vf(n,67108864)}}var gc=!0;function jw(n,s,r,l){var f=P.T;P.T=null;var m=ee.p;try{ee.p=2,bf(n,s,r,l)}finally{ee.p=m,P.T=f}}function Cw(n,s,r,l){var f=P.T;P.T=null;var m=ee.p;try{ee.p=8,bf(n,s,r,l)}finally{ee.p=m,P.T=f}}function bf(n,s,r,l){if(gc){var f=xf(l);if(f===null)of(n,s,l,pc,r),o0(n,l);else if(Tw(f,n,s,r,l))l.stopPropagation();else if(o0(n,l),s&4&&-1<Nw.indexOf(n)){for(;f!==null;){var m=Aa(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var S=xt(m.pendingLanes);if(S!==0){var k=m;for(k.pendingLanes|=2,k.entangledLanes|=2;S;){var $=1<<31-Ze(S);k.entanglements[1]|=$,S&=~$}Us(m),(en&6)===0&&(Jl=ke()+500,bo(0))}}break;case 13:k=xi(m,2),k!==null&&qn(k,m,2),nc(),vf(m,2)}if(m=xf(l),m===null&&of(n,s,l,pc,r),m===f)break;f=m}f!==null&&l.stopPropagation()}else of(n,s,l,null,r)}}function xf(n){return n=Cu(n),wf(n)}var pc=null;function wf(n){if(pc=null,n=Js(n),n!==null){var s=J(n);if(s===null)n=null;else{var r=s.tag;if(r===13){if(n=re(s),n!==null)return n;n=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return pc=n,null}function r0(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ke()){case ht:return 2;case B:return 8;case R:case Y:return 32;case _:return 268435456;default:return 32}default:return 32}}var _f=!1,Di=null,Bi=null,zi=null,No=new Map,To=new Map,Pi=[],Nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function o0(n,s){switch(n){case"focusin":case"focusout":Di=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":No.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":To.delete(s.pointerId)}}function ko(n,s,r,l,f,m){return n===null||n.nativeEvent!==m?(n={blockedOn:s,domEventName:r,eventSystemFlags:l,nativeEvent:m,targetContainers:[f]},s!==null&&(s=Aa(s),s!==null&&a0(s)),n):(n.eventSystemFlags|=l,s=n.targetContainers,f!==null&&s.indexOf(f)===-1&&s.push(f),n)}function Tw(n,s,r,l,f){switch(s){case"focusin":return Di=ko(Di,n,s,r,l,f),!0;case"dragenter":return Bi=ko(Bi,n,s,r,l,f),!0;case"mouseover":return zi=ko(zi,n,s,r,l,f),!0;case"pointerover":var m=f.pointerId;return No.set(m,ko(No.get(m)||null,n,s,r,l,f)),!0;case"gotpointercapture":return m=f.pointerId,To.set(m,ko(To.get(m)||null,n,s,r,l,f)),!0}return!1}function l0(n){var s=Js(n.target);if(s!==null){var r=J(s);if(r!==null){if(s=r.tag,s===13){if(s=re(r),s!==null){n.blockedOn=s,vt(n.priority,function(){if(r.tag===13){var l=ns(),f=xi(r,l);f!==null&&qn(f,r,l),vf(r,l)}});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){n.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}n.blockedOn=null}function yc(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var r=xf(n.nativeEvent);if(r===null){r=n.nativeEvent;var l=new r.constructor(r.type,r);ju=l,r.target.dispatchEvent(l),ju=null}else return s=Aa(r),s!==null&&a0(s),n.blockedOn=r,!1;s.shift()}return!0}function c0(n,s,r){yc(n)&&r.delete(s)}function kw(){_f=!1,Di!==null&&yc(Di)&&(Di=null),Bi!==null&&yc(Bi)&&(Bi=null),zi!==null&&yc(zi)&&(zi=null),No.forEach(c0),To.forEach(c0)}function vc(n,s){n.blockedOn===s&&(n.blockedOn=null,_f||(_f=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,kw)))}var bc=null;function u0(n){bc!==n&&(bc=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){bc===n&&(bc=null);for(var s=0;s<n.length;s+=3){var r=n[s],l=n[s+1],f=n[s+2];if(typeof l!="function"){if(wf(l||r)===null)continue;break}var m=Aa(r);m!==null&&(n.splice(s,3),s-=3,ud(m,{pending:!0,data:f,method:r.method,action:l},l,f))}}))}function Eo(n){function s($){return vc($,n)}Di!==null&&vc(Di,n),Bi!==null&&vc(Bi,n),zi!==null&&vc(zi,n),No.forEach(s),To.forEach(s);for(var r=0;r<Pi.length;r++){var l=Pi[r];l.blockedOn===n&&(l.blockedOn=null)}for(;0<Pi.length&&(r=Pi[0],r.blockedOn===null);)l0(r),r.blockedOn===null&&Pi.shift();if(r=(n.ownerDocument||n).$$reactFormReplay,r!=null)for(l=0;l<r.length;l+=3){var f=r[l],m=r[l+1],S=f[sn]||null;if(typeof m=="function")S||u0(r);else if(S){var k=null;if(m&&m.hasAttribute("formAction")){if(f=m,S=m[sn]||null)k=S.formAction;else if(wf(f)!==null)continue}else k=S.action;typeof k=="function"?r[l+1]=k:(r.splice(l,3),l-=3),u0(r)}}}function Sf(n){this._internalRoot=n}xc.prototype.render=Sf.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(a(409));var r=s.current,l=ns();s0(r,l,n,s,null,null)},xc.prototype.unmount=Sf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;n.tag===0&&ir(),s0(n.current,2,null,n,null,null),nc(),s[Gn]=null}};function xc(n){this._internalRoot=n}xc.prototype.unstable_scheduleHydration=function(n){if(n){var s=bt();n={blockedOn:null,target:n,priority:s};for(var r=0;r<Pi.length&&s!==0&&s<Pi[r].priority;r++);Pi.splice(r,0,n),r===0&&l0(n)}};var d0=e.version;if(d0!=="19.0.0")throw Error(a(527,d0,"19.0.0"));ee.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=Se(s),n=n!==null?Ve(n):null,n=n===null?null:n.stateNode,n};var Ew={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:P,findFiberByHostInstance:Js,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wc.isDisabled&&wc.supportsFiber)try{T=wc.inject(Ew),U=wc}catch{}}return Ro.createRoot=function(n,s){if(!c(n))throw Error(a(299));var r=!1,l="",f=kp,m=Ep,S=Ap,k=null;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(l=s.identifierPrefix),s.onUncaughtError!==void 0&&(f=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(k=s.unstable_transitionCallbacks)),s=t0(n,1,!1,null,null,r,l,f,m,S,k,null),n[Gn]=s.current,rf(n.nodeType===8?n.parentNode:n),new Sf(s)},Ro.hydrateRoot=function(n,s,r){if(!c(n))throw Error(a(299));var l=!1,f="",m=kp,S=Ep,k=Ap,$=null,Z=null;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(S=r.onCaughtError),r.onRecoverableError!==void 0&&(k=r.onRecoverableError),r.unstable_transitionCallbacks!==void 0&&($=r.unstable_transitionCallbacks),r.formState!==void 0&&(Z=r.formState)),s=t0(n,1,!0,s,r??null,l,f,m,S,k,$,Z),s.context=n0(null),r=s.current,l=ns(),f=Ti(l),f.callback=null,ki(r,f,l),s.current.lanes=l,He(s,l),Us(s),n[Gn]=s.current,rf(n),new xc(s)},Ro.version="19.0.0",Ro}var y0;function Hw(){if(y0)return Cf.exports;y0=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Cf.exports=Vw(),Cf.exports}var Gw=Hw();const Yw=Rv(Gw),Xw="modulepreload",Kw=function(t){return"/"+t},v0={},Pn=function(e,i,a){let c=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));c=Promise.allSettled(i.map(p=>{if(p=Kw(p),p in v0)return;v0[p]=!0;const y=p.endsWith(".css"),g=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${g}`))return;const w=document.createElement("link");if(w.rel=y?"stylesheet":Xw,y||(w.as="script"),w.crossOrigin="",w.href=p,h&&w.setAttribute("nonce",h),document.head.appendChild(w),y)return new Promise((C,j)=>{w.addEventListener("load",C),w.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${p}`)))})}))}function u(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return c.then(d=>{for(const h of d||[])h.status==="rejected"&&u(h.reason);return e().catch(u)})};function Lv(t,e){return function(){return t.apply(e,arguments)}}const{toString:Qw}=Object.prototype,{getPrototypeOf:Uh}=Object,iu=(t=>e=>{const i=Qw.call(e);return t[i]||(t[i]=i.slice(8,-1).toLowerCase())})(Object.create(null)),Os=t=>(t=t.toLowerCase(),e=>iu(e)===t),au=t=>e=>typeof e===t,{isArray:Rr}=Array,Ko=au("undefined");function Ww(t){return t!==null&&!Ko(t)&&t.constructor!==null&&!Ko(t.constructor)&&ss(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Ov=Os("ArrayBuffer");function Zw(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Ov(t.buffer),e}const Jw=au("string"),ss=au("function"),Dv=au("number"),ru=t=>t!==null&&typeof t=="object",e3=t=>t===!0||t===!1,Lc=t=>{if(iu(t)!=="object")return!1;const e=Uh(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},t3=Os("Date"),n3=Os("File"),s3=Os("Blob"),i3=Os("FileList"),a3=t=>ru(t)&&ss(t.pipe),r3=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ss(t.append)&&((e=iu(t))==="formdata"||e==="object"&&ss(t.toString)&&t.toString()==="[object FormData]"))},o3=Os("URLSearchParams"),[l3,c3,u3,d3]=["ReadableStream","Request","Response","Headers"].map(Os),f3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ll(t,e,{allOwnKeys:i=!1}={}){if(t===null||typeof t>"u")return;let a,c;if(typeof t!="object"&&(t=[t]),Rr(t))for(a=0,c=t.length;a<c;a++)e.call(null,t[a],a,t);else{const u=i?Object.getOwnPropertyNames(t):Object.keys(t),d=u.length;let h;for(a=0;a<d;a++)h=u[a],e.call(null,t[h],h,t)}}function Bv(t,e){e=e.toLowerCase();const i=Object.keys(t);let a=i.length,c;for(;a-- >0;)if(c=i[a],e===c.toLowerCase())return c;return null}const wa=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:globalThis,zv=t=>!Ko(t)&&t!==wa;function ih(){const{caseless:t}=zv(this)&&this||{},e={},i=(a,c)=>{const u=t&&Bv(e,c)||c;Lc(e[u])&&Lc(a)?e[u]=ih(e[u],a):Lc(a)?e[u]=ih({},a):Rr(a)?e[u]=a.slice():e[u]=a};for(let a=0,c=arguments.length;a<c;a++)arguments[a]&&ll(arguments[a],i);return e}const h3=(t,e,i,{allOwnKeys:a}={})=>(ll(e,(c,u)=>{i&&ss(c)?t[u]=Lv(c,i):t[u]=c},{allOwnKeys:a}),t),m3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),g3=(t,e,i,a)=>{t.prototype=Object.create(e.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),i&&Object.assign(t.prototype,i)},p3=(t,e,i,a)=>{let c,u,d;const h={};if(e=e||{},t==null)return e;do{for(c=Object.getOwnPropertyNames(t),u=c.length;u-- >0;)d=c[u],(!a||a(d,t,e))&&!h[d]&&(e[d]=t[d],h[d]=!0);t=i!==!1&&Uh(t)}while(t&&(!i||i(t,e))&&t!==Object.prototype);return e},y3=(t,e,i)=>{t=String(t),(i===void 0||i>t.length)&&(i=t.length),i-=e.length;const a=t.indexOf(e,i);return a!==-1&&a===i},v3=t=>{if(!t)return null;if(Rr(t))return t;let e=t.length;if(!Dv(e))return null;const i=new Array(e);for(;e-- >0;)i[e]=t[e];return i},b3=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Uh(Uint8Array)),x3=(t,e)=>{const a=(t&&t[Symbol.iterator]).call(t);let c;for(;(c=a.next())&&!c.done;){const u=c.value;e.call(t,u[0],u[1])}},w3=(t,e)=>{let i;const a=[];for(;(i=t.exec(e))!==null;)a.push(i);return a},_3=Os("HTMLFormElement"),S3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(i,a,c){return a.toUpperCase()+c}),b0=(({hasOwnProperty:t})=>(e,i)=>t.call(e,i))(Object.prototype),j3=Os("RegExp"),Pv=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t),a={};ll(i,(c,u)=>{let d;(d=e(c,u,t))!==!1&&(a[u]=d||c)}),Object.defineProperties(t,a)},C3=t=>{Pv(t,(e,i)=>{if(ss(t)&&["arguments","caller","callee"].indexOf(i)!==-1)return!1;const a=t[i];if(ss(a)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+i+"'")})}})},N3=(t,e)=>{const i={},a=c=>{c.forEach(u=>{i[u]=!0})};return Rr(t)?a(t):a(String(t).split(e)),i},T3=()=>{},k3=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function E3(t){return!!(t&&ss(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const A3=t=>{const e=new Array(10),i=(a,c)=>{if(ru(a)){if(e.indexOf(a)>=0)return;if(!("toJSON"in a)){e[c]=a;const u=Rr(a)?[]:{};return ll(a,(d,h)=>{const p=i(d,c+1);!Ko(p)&&(u[h]=p)}),e[c]=void 0,u}}return a};return i(t,0)},R3=Os("AsyncFunction"),M3=t=>t&&(ru(t)||ss(t))&&ss(t.then)&&ss(t.catch),$v=((t,e)=>t?setImmediate:e?((i,a)=>(wa.addEventListener("message",({source:c,data:u})=>{c===wa&&u===i&&a.length&&a.shift()()},!1),c=>{a.push(c),wa.postMessage(i,"*")}))(`axios@${Math.random()}`,[]):i=>setTimeout(i))(typeof setImmediate=="function",ss(wa.postMessage)),L3=typeof queueMicrotask<"u"?queueMicrotask.bind(wa):typeof qo<"u"&&qo.nextTick||$v,me={isArray:Rr,isArrayBuffer:Ov,isBuffer:Ww,isFormData:r3,isArrayBufferView:Zw,isString:Jw,isNumber:Dv,isBoolean:e3,isObject:ru,isPlainObject:Lc,isReadableStream:l3,isRequest:c3,isResponse:u3,isHeaders:d3,isUndefined:Ko,isDate:t3,isFile:n3,isBlob:s3,isRegExp:j3,isFunction:ss,isStream:a3,isURLSearchParams:o3,isTypedArray:b3,isFileList:i3,forEach:ll,merge:ih,extend:h3,trim:f3,stripBOM:m3,inherits:g3,toFlatObject:p3,kindOf:iu,kindOfTest:Os,endsWith:y3,toArray:v3,forEachEntry:x3,matchAll:w3,isHTMLForm:_3,hasOwnProperty:b0,hasOwnProp:b0,reduceDescriptors:Pv,freezeMethods:C3,toObjectSet:N3,toCamelCase:S3,noop:T3,toFiniteNumber:k3,findKey:Bv,global:wa,isContextDefined:zv,isSpecCompliantForm:E3,toJSONObject:A3,isAsyncFn:R3,isThenable:M3,setImmediate:$v,asap:L3};var Uv={},ou={};ou.byteLength=B3;ou.toByteArray=P3;ou.fromByteArray=I3;var Vs=[],bs=[],O3=typeof Uint8Array<"u"?Uint8Array:Array,kf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ur=0,D3=kf.length;ur<D3;++ur)Vs[ur]=kf[ur],bs[kf.charCodeAt(ur)]=ur;bs[45]=62;bs[95]=63;function Iv(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");i===-1&&(i=e);var a=i===e?0:4-i%4;return[i,a]}function B3(t){var e=Iv(t),i=e[0],a=e[1];return(i+a)*3/4-a}function z3(t,e,i){return(e+i)*3/4-i}function P3(t){var e,i=Iv(t),a=i[0],c=i[1],u=new O3(z3(t,a,c)),d=0,h=c>0?a-4:a,p;for(p=0;p<h;p+=4)e=bs[t.charCodeAt(p)]<<18|bs[t.charCodeAt(p+1)]<<12|bs[t.charCodeAt(p+2)]<<6|bs[t.charCodeAt(p+3)],u[d++]=e>>16&255,u[d++]=e>>8&255,u[d++]=e&255;return c===2&&(e=bs[t.charCodeAt(p)]<<2|bs[t.charCodeAt(p+1)]>>4,u[d++]=e&255),c===1&&(e=bs[t.charCodeAt(p)]<<10|bs[t.charCodeAt(p+1)]<<4|bs[t.charCodeAt(p+2)]>>2,u[d++]=e>>8&255,u[d++]=e&255),u}function $3(t){return Vs[t>>18&63]+Vs[t>>12&63]+Vs[t>>6&63]+Vs[t&63]}function U3(t,e,i){for(var a,c=[],u=e;u<i;u+=3)a=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(t[u+2]&255),c.push($3(a));return c.join("")}function I3(t){for(var e,i=t.length,a=i%3,c=[],u=16383,d=0,h=i-a;d<h;d+=u)c.push(U3(t,d,d+u>h?h:d+u));return a===1?(e=t[i-1],c.push(Vs[e>>2]+Vs[e<<4&63]+"==")):a===2&&(e=(t[i-2]<<8)+t[i-1],c.push(Vs[e>>10]+Vs[e>>4&63]+Vs[e<<2&63]+"=")),c.join("")}var Ih={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Ih.read=function(t,e,i,a,c){var u,d,h=c*8-a-1,p=(1<<h)-1,y=p>>1,g=-7,w=i?c-1:0,C=i?-1:1,j=t[e+w];for(w+=C,u=j&(1<<-g)-1,j>>=-g,g+=h;g>0;u=u*256+t[e+w],w+=C,g-=8);for(d=u&(1<<-g)-1,u>>=-g,g+=a;g>0;d=d*256+t[e+w],w+=C,g-=8);if(u===0)u=1-y;else{if(u===p)return d?NaN:(j?-1:1)*(1/0);d=d+Math.pow(2,a),u=u-y}return(j?-1:1)*d*Math.pow(2,u-a)};Ih.write=function(t,e,i,a,c,u){var d,h,p,y=u*8-c-1,g=(1<<y)-1,w=g>>1,C=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,j=a?0:u-1,N=a?1:-1,M=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(h=isNaN(e)?1:0,d=g):(d=Math.floor(Math.log(e)/Math.LN2),e*(p=Math.pow(2,-d))<1&&(d--,p*=2),d+w>=1?e+=C/p:e+=C*Math.pow(2,1-w),e*p>=2&&(d++,p/=2),d+w>=g?(h=0,d=g):d+w>=1?(h=(e*p-1)*Math.pow(2,c),d=d+w):(h=e*Math.pow(2,w-1)*Math.pow(2,c),d=0));c>=8;t[i+j]=h&255,j+=N,h/=256,c-=8);for(d=d<<c|h,y+=c;y>0;t[i+j]=d&255,j+=N,d/=256,y-=8);t[i+j-N]|=M*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=ou,i=Ih,a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=g,t.SlowBuffer=A,t.INSPECT_MAX_BYTES=50;const c=2147483647;t.kMaxLength=c;const{Uint8Array:u,ArrayBuffer:d,SharedArrayBuffer:h}=globalThis;g.TYPED_ARRAY_SUPPORT=p(),!g.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{const _=new u(1),v={foo:function(){return 42}};return Object.setPrototypeOf(v,u.prototype),Object.setPrototypeOf(_,v),_.foo()===42}catch{return!1}}Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}});function y(_){if(_>c)throw new RangeError('The value "'+_+'" is invalid for option "size"');const v=new u(_);return Object.setPrototypeOf(v,g.prototype),v}function g(_,v,x){if(typeof _=="number"){if(typeof v=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return N(_)}return w(_,v,x)}g.poolSize=8192;function w(_,v,x){if(typeof _=="string")return M(_,v);if(d.isView(_))return I(_);if(_==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _);if(Ke(_,d)||_&&Ke(_.buffer,d)||typeof h<"u"&&(Ke(_,h)||_&&Ke(_.buffer,h)))return V(_,v,x);if(typeof _=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const T=_.valueOf&&_.valueOf();if(T!=null&&T!==_)return g.from(T,v,x);const U=F(_);if(U)return U;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof _[Symbol.toPrimitive]=="function")return g.from(_[Symbol.toPrimitive]("string"),v,x);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof _)}g.from=function(_,v,x){return w(_,v,x)},Object.setPrototypeOf(g.prototype,u.prototype),Object.setPrototypeOf(g,u);function C(_){if(typeof _!="number")throw new TypeError('"size" argument must be of type number');if(_<0)throw new RangeError('The value "'+_+'" is invalid for option "size"')}function j(_,v,x){return C(_),_<=0?y(_):v!==void 0?typeof x=="string"?y(_).fill(v,x):y(_).fill(v):y(_)}g.alloc=function(_,v,x){return j(_,v,x)};function N(_){return C(_),y(_<0?0:O(_)|0)}g.allocUnsafe=function(_){return N(_)},g.allocUnsafeSlow=function(_){return N(_)};function M(_,v){if((typeof v!="string"||v==="")&&(v="utf8"),!g.isEncoding(v))throw new TypeError("Unknown encoding: "+v);const x=H(_,v)|0;let T=y(x);const U=T.write(_,v);return U!==x&&(T=T.slice(0,U)),T}function D(_){const v=_.length<0?0:O(_.length)|0,x=y(v);for(let T=0;T<v;T+=1)x[T]=_[T]&255;return x}function I(_){if(Ke(_,u)){const v=new u(_);return V(v.buffer,v.byteOffset,v.byteLength)}return D(_)}function V(_,v,x){if(v<0||_.byteLength<v)throw new RangeError('"offset" is outside of buffer bounds');if(_.byteLength<v+(x||0))throw new RangeError('"length" is outside of buffer bounds');let T;return v===void 0&&x===void 0?T=new u(_):x===void 0?T=new u(_,v):T=new u(_,v,x),Object.setPrototypeOf(T,g.prototype),T}function F(_){if(g.isBuffer(_)){const v=O(_.length)|0,x=y(v);return x.length===0||_.copy(x,0,0,v),x}if(_.length!==void 0)return typeof _.length!="number"||ht(_.length)?y(0):D(_);if(_.type==="Buffer"&&Array.isArray(_.data))return D(_.data)}function O(_){if(_>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return _|0}function A(_){return+_!=_&&(_=0),g.alloc(+_)}g.isBuffer=function(v){return v!=null&&v._isBuffer===!0&&v!==g.prototype},g.compare=function(v,x){if(Ke(v,u)&&(v=g.from(v,v.offset,v.byteLength)),Ke(x,u)&&(x=g.from(x,x.offset,x.byteLength)),!g.isBuffer(v)||!g.isBuffer(x))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(v===x)return 0;let T=v.length,U=x.length;for(let X=0,le=Math.min(T,U);X<le;++X)if(v[X]!==x[X]){T=v[X],U=x[X];break}return T<U?-1:U<T?1:0},g.isEncoding=function(v){switch(String(v).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(v,x){if(!Array.isArray(v))throw new TypeError('"list" argument must be an Array of Buffers');if(v.length===0)return g.alloc(0);let T;if(x===void 0)for(x=0,T=0;T<v.length;++T)x+=v[T].length;const U=g.allocUnsafe(x);let X=0;for(T=0;T<v.length;++T){let le=v[T];if(Ke(le,u))X+le.length>U.length?(g.isBuffer(le)||(le=g.from(le)),le.copy(U,X)):u.prototype.set.call(U,le,X);else if(g.isBuffer(le))le.copy(U,X);else throw new TypeError('"list" argument must be an Array of Buffers');X+=le.length}return U};function H(_,v){if(g.isBuffer(_))return _.length;if(d.isView(_)||Ke(_,d))return _.byteLength;if(typeof _!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof _);const x=_.length,T=arguments.length>2&&arguments[2]===!0;if(!T&&x===0)return 0;let U=!1;for(;;)switch(v){case"ascii":case"latin1":case"binary":return x;case"utf8":case"utf-8":return pe(_).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x*2;case"hex":return x>>>1;case"base64":return _t(_).length;default:if(U)return T?-1:pe(_).length;v=(""+v).toLowerCase(),U=!0}}g.byteLength=H;function E(_,v,x){let T=!1;if((v===void 0||v<0)&&(v=0),v>this.length||((x===void 0||x>this.length)&&(x=this.length),x<=0)||(x>>>=0,v>>>=0,x<=v))return"";for(_||(_="utf8");;)switch(_){case"hex":return Ve(this,v,x);case"utf8":case"utf-8":return q(this,v,x);case"ascii":return Ne(this,v,x);case"latin1":case"binary":return Se(this,v,x);case"base64":return K(this,v,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge(this,v,x);default:if(T)throw new TypeError("Unknown encoding: "+_);_=(_+"").toLowerCase(),T=!0}}g.prototype._isBuffer=!0;function L(_,v,x){const T=_[v];_[v]=_[x],_[x]=T}g.prototype.swap16=function(){const v=this.length;if(v%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let x=0;x<v;x+=2)L(this,x,x+1);return this},g.prototype.swap32=function(){const v=this.length;if(v%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let x=0;x<v;x+=4)L(this,x,x+3),L(this,x+1,x+2);return this},g.prototype.swap64=function(){const v=this.length;if(v%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let x=0;x<v;x+=8)L(this,x,x+7),L(this,x+1,x+6),L(this,x+2,x+5),L(this,x+3,x+4);return this},g.prototype.toString=function(){const v=this.length;return v===0?"":arguments.length===0?q(this,0,v):E.apply(this,arguments)},g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=function(v){if(!g.isBuffer(v))throw new TypeError("Argument must be a Buffer");return this===v?!0:g.compare(this,v)===0},g.prototype.inspect=function(){let v="";const x=t.INSPECT_MAX_BYTES;return v=this.toString("hex",0,x).replace(/(.{2})/g,"$1 ").trim(),this.length>x&&(v+=" ... "),"<Buffer "+v+">"},a&&(g.prototype[a]=g.prototype.inspect),g.prototype.compare=function(v,x,T,U,X){if(Ke(v,u)&&(v=g.from(v,v.offset,v.byteLength)),!g.isBuffer(v))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof v);if(x===void 0&&(x=0),T===void 0&&(T=v?v.length:0),U===void 0&&(U=0),X===void 0&&(X=this.length),x<0||T>v.length||U<0||X>this.length)throw new RangeError("out of range index");if(U>=X&&x>=T)return 0;if(U>=X)return-1;if(x>=T)return 1;if(x>>>=0,T>>>=0,U>>>=0,X>>>=0,this===v)return 0;let le=X-U,Ze=T-x;const we=Math.min(le,Ze),_e=this.slice(U,X),Le=v.slice(x,T);for(let Ye=0;Ye<we;++Ye)if(_e[Ye]!==Le[Ye]){le=_e[Ye],Ze=Le[Ye];break}return le<Ze?-1:Ze<le?1:0};function P(_,v,x,T,U){if(_.length===0)return-1;if(typeof x=="string"?(T=x,x=0):x>2147483647?x=2147483647:x<-2147483648&&(x=-2147483648),x=+x,ht(x)&&(x=U?0:_.length-1),x<0&&(x=_.length+x),x>=_.length){if(U)return-1;x=_.length-1}else if(x<0)if(U)x=0;else return-1;if(typeof v=="string"&&(v=g.from(v,T)),g.isBuffer(v))return v.length===0?-1:G(_,v,x,T,U);if(typeof v=="number")return v=v&255,typeof u.prototype.indexOf=="function"?U?u.prototype.indexOf.call(_,v,x):u.prototype.lastIndexOf.call(_,v,x):G(_,[v],x,T,U);throw new TypeError("val must be string, number or Buffer")}function G(_,v,x,T,U){let X=1,le=_.length,Ze=v.length;if(T!==void 0&&(T=String(T).toLowerCase(),T==="ucs2"||T==="ucs-2"||T==="utf16le"||T==="utf-16le")){if(_.length<2||v.length<2)return-1;X=2,le/=2,Ze/=2,x/=2}function we(Le,Ye){return X===1?Le[Ye]:Le.readUInt16BE(Ye*X)}let _e;if(U){let Le=-1;for(_e=x;_e<le;_e++)if(we(_,_e)===we(v,Le===-1?0:_e-Le)){if(Le===-1&&(Le=_e),_e-Le+1===Ze)return Le*X}else Le!==-1&&(_e-=_e-Le),Le=-1}else for(x+Ze>le&&(x=le-Ze),_e=x;_e>=0;_e--){let Le=!0;for(let Ye=0;Ye<Ze;Ye++)if(we(_,_e+Ye)!==we(v,Ye)){Le=!1;break}if(Le)return _e}return-1}g.prototype.includes=function(v,x,T){return this.indexOf(v,x,T)!==-1},g.prototype.indexOf=function(v,x,T){return P(this,v,x,T,!0)},g.prototype.lastIndexOf=function(v,x,T){return P(this,v,x,T,!1)};function Q(_,v,x,T){x=Number(x)||0;const U=_.length-x;T?(T=Number(T),T>U&&(T=U)):T=U;const X=v.length;T>X/2&&(T=X/2);let le;for(le=0;le<T;++le){const Ze=parseInt(v.substr(le*2,2),16);if(ht(Ze))return le;_[x+le]=Ze}return le}function z(_,v,x,T){return ke(pe(v,_.length-x),_,x,T)}function ae(_,v,x,T){return ke(je(v),_,x,T)}function Pe(_,v,x,T){return ke(_t(v),_,x,T)}function Ee(_,v,x,T){return ke(Je(v,_.length-x),_,x,T)}g.prototype.write=function(v,x,T,U){if(x===void 0)U="utf8",T=this.length,x=0;else if(T===void 0&&typeof x=="string")U=x,T=this.length,x=0;else if(isFinite(x))x=x>>>0,isFinite(T)?(T=T>>>0,U===void 0&&(U="utf8")):(U=T,T=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const X=this.length-x;if((T===void 0||T>X)&&(T=X),v.length>0&&(T<0||x<0)||x>this.length)throw new RangeError("Attempt to write outside buffer bounds");U||(U="utf8");let le=!1;for(;;)switch(U){case"hex":return Q(this,v,x,T);case"utf8":case"utf-8":return z(this,v,x,T);case"ascii":case"latin1":case"binary":return ae(this,v,x,T);case"base64":return Pe(this,v,x,T);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,v,x,T);default:if(le)throw new TypeError("Unknown encoding: "+U);U=(""+U).toLowerCase(),le=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(_,v,x){return v===0&&x===_.length?e.fromByteArray(_):e.fromByteArray(_.slice(v,x))}function q(_,v,x){x=Math.min(_.length,x);const T=[];let U=v;for(;U<x;){const X=_[U];let le=null,Ze=X>239?4:X>223?3:X>191?2:1;if(U+Ze<=x){let we,_e,Le,Ye;switch(Ze){case 1:X<128&&(le=X);break;case 2:we=_[U+1],(we&192)===128&&(Ye=(X&31)<<6|we&63,Ye>127&&(le=Ye));break;case 3:we=_[U+1],_e=_[U+2],(we&192)===128&&(_e&192)===128&&(Ye=(X&15)<<12|(we&63)<<6|_e&63,Ye>2047&&(Ye<55296||Ye>57343)&&(le=Ye));break;case 4:we=_[U+1],_e=_[U+2],Le=_[U+3],(we&192)===128&&(_e&192)===128&&(Le&192)===128&&(Ye=(X&15)<<18|(we&63)<<12|(_e&63)<<6|Le&63,Ye>65535&&Ye<1114112&&(le=Ye))}}le===null?(le=65533,Ze=1):le>65535&&(le-=65536,T.push(le>>>10&1023|55296),le=56320|le&1023),T.push(le),U+=Ze}return re(T)}const J=4096;function re(_){const v=_.length;if(v<=J)return String.fromCharCode.apply(String,_);let x="",T=0;for(;T<v;)x+=String.fromCharCode.apply(String,_.slice(T,T+=J));return x}function Ne(_,v,x){let T="";x=Math.min(_.length,x);for(let U=v;U<x;++U)T+=String.fromCharCode(_[U]&127);return T}function Se(_,v,x){let T="";x=Math.min(_.length,x);for(let U=v;U<x;++U)T+=String.fromCharCode(_[U]);return T}function Ve(_,v,x){const T=_.length;(!v||v<0)&&(v=0),(!x||x<0||x>T)&&(x=T);let U="";for(let X=v;X<x;++X)U+=B[_[X]];return U}function ge(_,v,x){const T=_.slice(v,x);let U="";for(let X=0;X<T.length-1;X+=2)U+=String.fromCharCode(T[X]+T[X+1]*256);return U}g.prototype.slice=function(v,x){const T=this.length;v=~~v,x=x===void 0?T:~~x,v<0?(v+=T,v<0&&(v=0)):v>T&&(v=T),x<0?(x+=T,x<0&&(x=0)):x>T&&(x=T),x<v&&(x=v);const U=this.subarray(v,x);return Object.setPrototypeOf(U,g.prototype),U};function ee(_,v,x){if(_%1!==0||_<0)throw new RangeError("offset is not uint");if(_+v>x)throw new RangeError("Trying to access beyond buffer length")}g.prototype.readUintLE=g.prototype.readUIntLE=function(v,x,T){v=v>>>0,x=x>>>0,T||ee(v,x,this.length);let U=this[v],X=1,le=0;for(;++le<x&&(X*=256);)U+=this[v+le]*X;return U},g.prototype.readUintBE=g.prototype.readUIntBE=function(v,x,T){v=v>>>0,x=x>>>0,T||ee(v,x,this.length);let U=this[v+--x],X=1;for(;x>0&&(X*=256);)U+=this[v+--x]*X;return U},g.prototype.readUint8=g.prototype.readUInt8=function(v,x){return v=v>>>0,x||ee(v,1,this.length),this[v]},g.prototype.readUint16LE=g.prototype.readUInt16LE=function(v,x){return v=v>>>0,x||ee(v,2,this.length),this[v]|this[v+1]<<8},g.prototype.readUint16BE=g.prototype.readUInt16BE=function(v,x){return v=v>>>0,x||ee(v,2,this.length),this[v]<<8|this[v+1]},g.prototype.readUint32LE=g.prototype.readUInt32LE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),(this[v]|this[v+1]<<8|this[v+2]<<16)+this[v+3]*16777216},g.prototype.readUint32BE=g.prototype.readUInt32BE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),this[v]*16777216+(this[v+1]<<16|this[v+2]<<8|this[v+3])},g.prototype.readBigUInt64LE=R(function(v){v=v>>>0,qe(v,"offset");const x=this[v],T=this[v+7];(x===void 0||T===void 0)&&jt(v,this.length-8);const U=x+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24,X=this[++v]+this[++v]*2**8+this[++v]*2**16+T*2**24;return BigInt(U)+(BigInt(X)<<BigInt(32))}),g.prototype.readBigUInt64BE=R(function(v){v=v>>>0,qe(v,"offset");const x=this[v],T=this[v+7];(x===void 0||T===void 0)&&jt(v,this.length-8);const U=x*2**24+this[++v]*2**16+this[++v]*2**8+this[++v],X=this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+T;return(BigInt(U)<<BigInt(32))+BigInt(X)}),g.prototype.readIntLE=function(v,x,T){v=v>>>0,x=x>>>0,T||ee(v,x,this.length);let U=this[v],X=1,le=0;for(;++le<x&&(X*=256);)U+=this[v+le]*X;return X*=128,U>=X&&(U-=Math.pow(2,8*x)),U},g.prototype.readIntBE=function(v,x,T){v=v>>>0,x=x>>>0,T||ee(v,x,this.length);let U=x,X=1,le=this[v+--U];for(;U>0&&(X*=256);)le+=this[v+--U]*X;return X*=128,le>=X&&(le-=Math.pow(2,8*x)),le},g.prototype.readInt8=function(v,x){return v=v>>>0,x||ee(v,1,this.length),this[v]&128?(255-this[v]+1)*-1:this[v]},g.prototype.readInt16LE=function(v,x){v=v>>>0,x||ee(v,2,this.length);const T=this[v]|this[v+1]<<8;return T&32768?T|4294901760:T},g.prototype.readInt16BE=function(v,x){v=v>>>0,x||ee(v,2,this.length);const T=this[v+1]|this[v]<<8;return T&32768?T|4294901760:T},g.prototype.readInt32LE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),this[v]|this[v+1]<<8|this[v+2]<<16|this[v+3]<<24},g.prototype.readInt32BE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),this[v]<<24|this[v+1]<<16|this[v+2]<<8|this[v+3]},g.prototype.readBigInt64LE=R(function(v){v=v>>>0,qe(v,"offset");const x=this[v],T=this[v+7];(x===void 0||T===void 0)&&jt(v,this.length-8);const U=this[v+4]+this[v+5]*2**8+this[v+6]*2**16+(T<<24);return(BigInt(U)<<BigInt(32))+BigInt(x+this[++v]*2**8+this[++v]*2**16+this[++v]*2**24)}),g.prototype.readBigInt64BE=R(function(v){v=v>>>0,qe(v,"offset");const x=this[v],T=this[v+7];(x===void 0||T===void 0)&&jt(v,this.length-8);const U=(x<<24)+this[++v]*2**16+this[++v]*2**8+this[++v];return(BigInt(U)<<BigInt(32))+BigInt(this[++v]*2**24+this[++v]*2**16+this[++v]*2**8+T)}),g.prototype.readFloatLE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),i.read(this,v,!0,23,4)},g.prototype.readFloatBE=function(v,x){return v=v>>>0,x||ee(v,4,this.length),i.read(this,v,!1,23,4)},g.prototype.readDoubleLE=function(v,x){return v=v>>>0,x||ee(v,8,this.length),i.read(this,v,!0,52,8)},g.prototype.readDoubleBE=function(v,x){return v=v>>>0,x||ee(v,8,this.length),i.read(this,v,!1,52,8)};function Re(_,v,x,T,U,X){if(!g.isBuffer(_))throw new TypeError('"buffer" argument must be a Buffer instance');if(v>U||v<X)throw new RangeError('"value" argument is out of bounds');if(x+T>_.length)throw new RangeError("Index out of range")}g.prototype.writeUintLE=g.prototype.writeUIntLE=function(v,x,T,U){if(v=+v,x=x>>>0,T=T>>>0,!U){const Ze=Math.pow(2,8*T)-1;Re(this,v,x,T,Ze,0)}let X=1,le=0;for(this[x]=v&255;++le<T&&(X*=256);)this[x+le]=v/X&255;return x+T},g.prototype.writeUintBE=g.prototype.writeUIntBE=function(v,x,T,U){if(v=+v,x=x>>>0,T=T>>>0,!U){const Ze=Math.pow(2,8*T)-1;Re(this,v,x,T,Ze,0)}let X=T-1,le=1;for(this[x+X]=v&255;--X>=0&&(le*=256);)this[x+X]=v/le&255;return x+T},g.prototype.writeUint8=g.prototype.writeUInt8=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,1,255,0),this[x]=v&255,x+1},g.prototype.writeUint16LE=g.prototype.writeUInt16LE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,2,65535,0),this[x]=v&255,this[x+1]=v>>>8,x+2},g.prototype.writeUint16BE=g.prototype.writeUInt16BE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,2,65535,0),this[x]=v>>>8,this[x+1]=v&255,x+2},g.prototype.writeUint32LE=g.prototype.writeUInt32LE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,4,4294967295,0),this[x+3]=v>>>24,this[x+2]=v>>>16,this[x+1]=v>>>8,this[x]=v&255,x+4},g.prototype.writeUint32BE=g.prototype.writeUInt32BE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,4,4294967295,0),this[x]=v>>>24,this[x+1]=v>>>16,this[x+2]=v>>>8,this[x+3]=v&255,x+4};function he(_,v,x,T,U){Ie(v,T,U,_,x,7);let X=Number(v&BigInt(4294967295));_[x++]=X,X=X>>8,_[x++]=X,X=X>>8,_[x++]=X,X=X>>8,_[x++]=X;let le=Number(v>>BigInt(32)&BigInt(4294967295));return _[x++]=le,le=le>>8,_[x++]=le,le=le>>8,_[x++]=le,le=le>>8,_[x++]=le,x}function Ue(_,v,x,T,U){Ie(v,T,U,_,x,7);let X=Number(v&BigInt(4294967295));_[x+7]=X,X=X>>8,_[x+6]=X,X=X>>8,_[x+5]=X,X=X>>8,_[x+4]=X;let le=Number(v>>BigInt(32)&BigInt(4294967295));return _[x+3]=le,le=le>>8,_[x+2]=le,le=le>>8,_[x+1]=le,le=le>>8,_[x]=le,x+8}g.prototype.writeBigUInt64LE=R(function(v,x=0){return he(this,v,x,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeBigUInt64BE=R(function(v,x=0){return Ue(this,v,x,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeIntLE=function(v,x,T,U){if(v=+v,x=x>>>0,!U){const we=Math.pow(2,8*T-1);Re(this,v,x,T,we-1,-we)}let X=0,le=1,Ze=0;for(this[x]=v&255;++X<T&&(le*=256);)v<0&&Ze===0&&this[x+X-1]!==0&&(Ze=1),this[x+X]=(v/le>>0)-Ze&255;return x+T},g.prototype.writeIntBE=function(v,x,T,U){if(v=+v,x=x>>>0,!U){const we=Math.pow(2,8*T-1);Re(this,v,x,T,we-1,-we)}let X=T-1,le=1,Ze=0;for(this[x+X]=v&255;--X>=0&&(le*=256);)v<0&&Ze===0&&this[x+X+1]!==0&&(Ze=1),this[x+X]=(v/le>>0)-Ze&255;return x+T},g.prototype.writeInt8=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,1,127,-128),v<0&&(v=255+v+1),this[x]=v&255,x+1},g.prototype.writeInt16LE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,2,32767,-32768),this[x]=v&255,this[x+1]=v>>>8,x+2},g.prototype.writeInt16BE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,2,32767,-32768),this[x]=v>>>8,this[x+1]=v&255,x+2},g.prototype.writeInt32LE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,4,2147483647,-2147483648),this[x]=v&255,this[x+1]=v>>>8,this[x+2]=v>>>16,this[x+3]=v>>>24,x+4},g.prototype.writeInt32BE=function(v,x,T){return v=+v,x=x>>>0,T||Re(this,v,x,4,2147483647,-2147483648),v<0&&(v=4294967295+v+1),this[x]=v>>>24,this[x+1]=v>>>16,this[x+2]=v>>>8,this[x+3]=v&255,x+4},g.prototype.writeBigInt64LE=R(function(v,x=0){return he(this,v,x,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),g.prototype.writeBigInt64BE=R(function(v,x=0){return Ue(this,v,x,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ze(_,v,x,T,U,X){if(x+T>_.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("Index out of range")}function Xe(_,v,x,T,U){return v=+v,x=x>>>0,U||ze(_,v,x,4),i.write(_,v,x,T,23,4),x+4}g.prototype.writeFloatLE=function(v,x,T){return Xe(this,v,x,!0,T)},g.prototype.writeFloatBE=function(v,x,T){return Xe(this,v,x,!1,T)};function Qe(_,v,x,T,U){return v=+v,x=x>>>0,U||ze(_,v,x,8),i.write(_,v,x,T,52,8),x+8}g.prototype.writeDoubleLE=function(v,x,T){return Qe(this,v,x,!0,T)},g.prototype.writeDoubleBE=function(v,x,T){return Qe(this,v,x,!1,T)},g.prototype.copy=function(v,x,T,U){if(!g.isBuffer(v))throw new TypeError("argument should be a Buffer");if(T||(T=0),!U&&U!==0&&(U=this.length),x>=v.length&&(x=v.length),x||(x=0),U>0&&U<T&&(U=T),U===T||v.length===0||this.length===0)return 0;if(x<0)throw new RangeError("targetStart out of bounds");if(T<0||T>=this.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("sourceEnd out of bounds");U>this.length&&(U=this.length),v.length-x<U-T&&(U=v.length-x+T);const X=U-T;return this===v&&typeof u.prototype.copyWithin=="function"?this.copyWithin(x,T,U):u.prototype.set.call(v,this.subarray(T,U),x),X},g.prototype.fill=function(v,x,T,U){if(typeof v=="string"){if(typeof x=="string"?(U=x,x=0,T=this.length):typeof T=="string"&&(U=T,T=this.length),U!==void 0&&typeof U!="string")throw new TypeError("encoding must be a string");if(typeof U=="string"&&!g.isEncoding(U))throw new TypeError("Unknown encoding: "+U);if(v.length===1){const le=v.charCodeAt(0);(U==="utf8"&&le<128||U==="latin1")&&(v=le)}}else typeof v=="number"?v=v&255:typeof v=="boolean"&&(v=Number(v));if(x<0||this.length<x||this.length<T)throw new RangeError("Out of range index");if(T<=x)return this;x=x>>>0,T=T===void 0?this.length:T>>>0,v||(v=0);let X;if(typeof v=="number")for(X=x;X<T;++X)this[X]=v;else{const le=g.isBuffer(v)?v:g.from(v,U),Ze=le.length;if(Ze===0)throw new TypeError('The value "'+v+'" is invalid for argument "value"');for(X=0;X<T-x;++X)this[X+x]=le[X%Ze]}return this};const Ge={};function at(_,v,x){Ge[_]=class extends x{constructor(){super(),Object.defineProperty(this,"message",{value:v.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${_}]`,this.stack,delete this.name}get code(){return _}set code(U){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:U,writable:!0})}toString(){return`${this.name} [${_}]: ${this.message}`}}}at("ERR_BUFFER_OUT_OF_BOUNDS",function(_){return _?`${_} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),at("ERR_INVALID_ARG_TYPE",function(_,v){return`The "${_}" argument must be of type number. Received type ${typeof v}`},TypeError),at("ERR_OUT_OF_RANGE",function(_,v,x){let T=`The value of "${_}" is out of range.`,U=x;return Number.isInteger(x)&&Math.abs(x)>2**32?U=yt(String(x)):typeof x=="bigint"&&(U=String(x),(x>BigInt(2)**BigInt(32)||x<-(BigInt(2)**BigInt(32)))&&(U=yt(U)),U+="n"),T+=` It must be ${v}. Received ${U}`,T},RangeError);function yt(_){let v="",x=_.length;const T=_[0]==="-"?1:0;for(;x>=T+4;x-=3)v=`_${_.slice(x-3,x)}${v}`;return`${_.slice(0,x)}${v}`}function mt(_,v,x){qe(v,"offset"),(_[v]===void 0||_[v+x]===void 0)&&jt(v,_.length-(x+1))}function Ie(_,v,x,T,U,X){if(_>x||_<v){const le=typeof v=="bigint"?"n":"";let Ze;throw v===0||v===BigInt(0)?Ze=`>= 0${le} and < 2${le} ** ${(X+1)*8}${le}`:Ze=`>= -(2${le} ** ${(X+1)*8-1}${le}) and < 2 ** ${(X+1)*8-1}${le}`,new Ge.ERR_OUT_OF_RANGE("value",Ze,_)}mt(T,U,X)}function qe(_,v){if(typeof _!="number")throw new Ge.ERR_INVALID_ARG_TYPE(v,"number",_)}function jt(_,v,x){throw Math.floor(_)!==_?(qe(_,x),new Ge.ERR_OUT_OF_RANGE("offset","an integer",_)):v<0?new Ge.ERR_BUFFER_OUT_OF_BOUNDS:new Ge.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${v}`,_)}const Ct=/[^+/0-9A-Za-z-_]/g;function Rt(_){if(_=_.split("=")[0],_=_.trim().replace(Ct,""),_.length<2)return"";for(;_.length%4!==0;)_=_+"=";return _}function pe(_,v){v=v||1/0;let x;const T=_.length;let U=null;const X=[];for(let le=0;le<T;++le){if(x=_.charCodeAt(le),x>55295&&x<57344){if(!U){if(x>56319){(v-=3)>-1&&X.push(239,191,189);continue}else if(le+1===T){(v-=3)>-1&&X.push(239,191,189);continue}U=x;continue}if(x<56320){(v-=3)>-1&&X.push(239,191,189),U=x;continue}x=(U-55296<<10|x-56320)+65536}else U&&(v-=3)>-1&&X.push(239,191,189);if(U=null,x<128){if((v-=1)<0)break;X.push(x)}else if(x<2048){if((v-=2)<0)break;X.push(x>>6|192,x&63|128)}else if(x<65536){if((v-=3)<0)break;X.push(x>>12|224,x>>6&63|128,x&63|128)}else if(x<1114112){if((v-=4)<0)break;X.push(x>>18|240,x>>12&63|128,x>>6&63|128,x&63|128)}else throw new Error("Invalid code point")}return X}function je(_){const v=[];for(let x=0;x<_.length;++x)v.push(_.charCodeAt(x)&255);return v}function Je(_,v){let x,T,U;const X=[];for(let le=0;le<_.length&&!((v-=2)<0);++le)x=_.charCodeAt(le),T=x>>8,U=x%256,X.push(U),X.push(T);return X}function _t(_){return e.toByteArray(Rt(_))}function ke(_,v,x,T){let U;for(U=0;U<T&&!(U+x>=v.length||U>=_.length);++U)v[U+x]=_[U];return U}function Ke(_,v){return _ instanceof v||_!=null&&_.constructor!=null&&_.constructor.name!=null&&_.constructor.name===v.name}function ht(_){return _!==_}const B=function(){const _="0123456789abcdef",v=new Array(256);for(let x=0;x<16;++x){const T=x*16;for(let U=0;U<16;++U)v[T+U]=_[x]+_[U]}return v}();function R(_){return typeof BigInt>"u"?Y:_}function Y(){throw new Error("BigInt not supported")}})(Uv);const F3=Uv.Buffer;function Nt(t,e,i,a,c){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),i&&(this.config=i),a&&(this.request=a),c&&(this.response=c,this.status=c.status?c.status:null)}me.inherits(Nt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:me.toJSONObject(this.config),code:this.code,status:this.status}}});const Fv=Nt.prototype,qv={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{qv[t]={value:t}});Object.defineProperties(Nt,qv);Object.defineProperty(Fv,"isAxiosError",{value:!0});Nt.from=(t,e,i,a,c,u)=>{const d=Object.create(Fv);return me.toFlatObject(t,d,function(p){return p!==Error.prototype},h=>h!=="isAxiosError"),Nt.call(d,t.message,e,i,a,c),d.cause=t,d.name=t.name,u&&Object.assign(d,u),d};const q3=null;function ah(t){return me.isPlainObject(t)||me.isArray(t)}function Vv(t){return me.endsWith(t,"[]")?t.slice(0,-2):t}function x0(t,e,i){return t?t.concat(e).map(function(c,u){return c=Vv(c),!i&&u?"["+c+"]":c}).join(i?".":""):e}function V3(t){return me.isArray(t)&&!t.some(ah)}const H3=me.toFlatObject(me,{},null,function(e){return/^is[A-Z]/.test(e)});function lu(t,e,i){if(!me.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,i=me.toFlatObject(i,{metaTokens:!0,dots:!1,indexes:!1},!1,function(M,D){return!me.isUndefined(D[M])});const a=i.metaTokens,c=i.visitor||g,u=i.dots,d=i.indexes,p=(i.Blob||typeof Blob<"u"&&Blob)&&me.isSpecCompliantForm(e);if(!me.isFunction(c))throw new TypeError("visitor must be a function");function y(N){if(N===null)return"";if(me.isDate(N))return N.toISOString();if(!p&&me.isBlob(N))throw new Nt("Blob is not supported. Use a Buffer instead.");return me.isArrayBuffer(N)||me.isTypedArray(N)?p&&typeof Blob=="function"?new Blob([N]):F3.from(N):N}function g(N,M,D){let I=N;if(N&&!D&&typeof N=="object"){if(me.endsWith(M,"{}"))M=a?M:M.slice(0,-2),N=JSON.stringify(N);else if(me.isArray(N)&&V3(N)||(me.isFileList(N)||me.endsWith(M,"[]"))&&(I=me.toArray(N)))return M=Vv(M),I.forEach(function(F,O){!(me.isUndefined(F)||F===null)&&e.append(d===!0?x0([M],O,u):d===null?M:M+"[]",y(F))}),!1}return ah(N)?!0:(e.append(x0(D,M,u),y(N)),!1)}const w=[],C=Object.assign(H3,{defaultVisitor:g,convertValue:y,isVisitable:ah});function j(N,M){if(!me.isUndefined(N)){if(w.indexOf(N)!==-1)throw Error("Circular reference detected in "+M.join("."));w.push(N),me.forEach(N,function(I,V){(!(me.isUndefined(I)||I===null)&&c.call(e,I,me.isString(V)?V.trim():V,M,C))===!0&&j(I,M?M.concat(V):[V])}),w.pop()}}if(!me.isObject(t))throw new TypeError("data must be an object");return j(t),e}function w0(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return e[a]})}function Fh(t,e){this._pairs=[],t&&lu(t,this,e)}const Hv=Fh.prototype;Hv.append=function(e,i){this._pairs.push([e,i])};Hv.toString=function(e){const i=e?function(a){return e.call(this,a,w0)}:w0;return this._pairs.map(function(c){return i(c[0])+"="+i(c[1])},"").join("&")};function G3(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Gv(t,e,i){if(!e)return t;const a=i&&i.encode||G3;me.isFunction(i)&&(i={serialize:i});const c=i&&i.serialize;let u;if(c?u=c(e,i):u=me.isURLSearchParams(e)?e.toString():new Fh(e,i).toString(a),u){const d=t.indexOf("#");d!==-1&&(t=t.slice(0,d)),t+=(t.indexOf("?")===-1?"?":"&")+u}return t}class _0{constructor(){this.handlers=[]}use(e,i,a){return this.handlers.push({fulfilled:e,rejected:i,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){me.forEach(this.handlers,function(a){a!==null&&e(a)})}}const Yv={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Y3=typeof URLSearchParams<"u"?URLSearchParams:Fh,X3=typeof FormData<"u"?FormData:null,K3=typeof Blob<"u"?Blob:null,Q3={isBrowser:!0,classes:{URLSearchParams:Y3,FormData:X3,Blob:K3},protocols:["http","https","file","blob","url","data"]},qh=typeof window<"u"&&typeof document<"u",rh=typeof navigator=="object"&&navigator||void 0,W3=qh&&(!rh||["ReactNative","NativeScript","NS"].indexOf(rh.product)<0),Z3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",J3=qh&&window.location.href||"http://localhost",e6=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:qh,hasStandardBrowserEnv:W3,hasStandardBrowserWebWorkerEnv:Z3,navigator:rh,origin:J3},Symbol.toStringTag,{value:"Module"})),$n={...e6,...Q3};function t6(t,e){return lu(t,new $n.classes.URLSearchParams,Object.assign({visitor:function(i,a,c,u){return $n.isNode&&me.isBuffer(i)?(this.append(a,i.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},e))}function n6(t){return me.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function s6(t){const e={},i=Object.keys(t);let a;const c=i.length;let u;for(a=0;a<c;a++)u=i[a],e[u]=t[u];return e}function Xv(t){function e(i,a,c,u){let d=i[u++];if(d==="__proto__")return!0;const h=Number.isFinite(+d),p=u>=i.length;return d=!d&&me.isArray(c)?c.length:d,p?(me.hasOwnProp(c,d)?c[d]=[c[d],a]:c[d]=a,!h):((!c[d]||!me.isObject(c[d]))&&(c[d]=[]),e(i,a,c[d],u)&&me.isArray(c[d])&&(c[d]=s6(c[d])),!h)}if(me.isFormData(t)&&me.isFunction(t.entries)){const i={};return me.forEachEntry(t,(a,c)=>{e(n6(a),c,i,0)}),i}return null}function i6(t,e,i){if(me.isString(t))try{return(e||JSON.parse)(t),me.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(i||JSON.stringify)(t)}const cl={transitional:Yv,adapter:["xhr","http","fetch"],transformRequest:[function(e,i){const a=i.getContentType()||"",c=a.indexOf("application/json")>-1,u=me.isObject(e);if(u&&me.isHTMLForm(e)&&(e=new FormData(e)),me.isFormData(e))return c?JSON.stringify(Xv(e)):e;if(me.isArrayBuffer(e)||me.isBuffer(e)||me.isStream(e)||me.isFile(e)||me.isBlob(e)||me.isReadableStream(e))return e;if(me.isArrayBufferView(e))return e.buffer;if(me.isURLSearchParams(e))return i.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let h;if(u){if(a.indexOf("application/x-www-form-urlencoded")>-1)return t6(e,this.formSerializer).toString();if((h=me.isFileList(e))||a.indexOf("multipart/form-data")>-1){const p=this.env&&this.env.FormData;return lu(h?{"files[]":e}:e,p&&new p,this.formSerializer)}}return u||c?(i.setContentType("application/json",!1),i6(e)):e}],transformResponse:[function(e){const i=this.transitional||cl.transitional,a=i&&i.forcedJSONParsing,c=this.responseType==="json";if(me.isResponse(e)||me.isReadableStream(e))return e;if(e&&me.isString(e)&&(a&&!this.responseType||c)){const d=!(i&&i.silentJSONParsing)&&c;try{return JSON.parse(e)}catch(h){if(d)throw h.name==="SyntaxError"?Nt.from(h,Nt.ERR_BAD_RESPONSE,this,null,this.response):h}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:$n.classes.FormData,Blob:$n.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};me.forEach(["delete","get","head","post","put","patch"],t=>{cl.headers[t]={}});const a6=me.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),r6=t=>{const e={};let i,a,c;return t&&t.split(`
`).forEach(function(d){c=d.indexOf(":"),i=d.substring(0,c).trim().toLowerCase(),a=d.substring(c+1).trim(),!(!i||e[i]&&a6[i])&&(i==="set-cookie"?e[i]?e[i].push(a):e[i]=[a]:e[i]=e[i]?e[i]+", "+a:a)}),e},S0=Symbol("internals");function Mo(t){return t&&String(t).trim().toLowerCase()}function Oc(t){return t===!1||t==null?t:me.isArray(t)?t.map(Oc):String(t)}function o6(t){const e=Object.create(null),i=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=i.exec(t);)e[a[1]]=a[2];return e}const l6=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ef(t,e,i,a,c){if(me.isFunction(a))return a.call(this,e,i);if(c&&(e=i),!!me.isString(e)){if(me.isString(a))return e.indexOf(a)!==-1;if(me.isRegExp(a))return a.test(e)}}function c6(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,i,a)=>i.toUpperCase()+a)}function u6(t,e){const i=me.toCamelCase(" "+e);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+i,{value:function(c,u,d){return this[a].call(this,e,c,u,d)},configurable:!0})})}let Qn=class{constructor(e){e&&this.set(e)}set(e,i,a){const c=this;function u(h,p,y){const g=Mo(p);if(!g)throw new Error("header name must be a non-empty string");const w=me.findKey(c,g);(!w||c[w]===void 0||y===!0||y===void 0&&c[w]!==!1)&&(c[w||p]=Oc(h))}const d=(h,p)=>me.forEach(h,(y,g)=>u(y,g,p));if(me.isPlainObject(e)||e instanceof this.constructor)d(e,i);else if(me.isString(e)&&(e=e.trim())&&!l6(e))d(r6(e),i);else if(me.isHeaders(e))for(const[h,p]of e.entries())u(p,h,a);else e!=null&&u(i,e,a);return this}get(e,i){if(e=Mo(e),e){const a=me.findKey(this,e);if(a){const c=this[a];if(!i)return c;if(i===!0)return o6(c);if(me.isFunction(i))return i.call(this,c,a);if(me.isRegExp(i))return i.exec(c);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,i){if(e=Mo(e),e){const a=me.findKey(this,e);return!!(a&&this[a]!==void 0&&(!i||Ef(this,this[a],a,i)))}return!1}delete(e,i){const a=this;let c=!1;function u(d){if(d=Mo(d),d){const h=me.findKey(a,d);h&&(!i||Ef(a,a[h],h,i))&&(delete a[h],c=!0)}}return me.isArray(e)?e.forEach(u):u(e),c}clear(e){const i=Object.keys(this);let a=i.length,c=!1;for(;a--;){const u=i[a];(!e||Ef(this,this[u],u,e,!0))&&(delete this[u],c=!0)}return c}normalize(e){const i=this,a={};return me.forEach(this,(c,u)=>{const d=me.findKey(a,u);if(d){i[d]=Oc(c),delete i[u];return}const h=e?c6(u):String(u).trim();h!==u&&delete i[u],i[h]=Oc(c),a[h]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const i=Object.create(null);return me.forEach(this,(a,c)=>{a!=null&&a!==!1&&(i[c]=e&&me.isArray(a)?a.join(", "):a)}),i}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,i])=>e+": "+i).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...i){const a=new this(e);return i.forEach(c=>a.set(c)),a}static accessor(e){const a=(this[S0]=this[S0]={accessors:{}}).accessors,c=this.prototype;function u(d){const h=Mo(d);a[h]||(u6(c,d),a[h]=!0)}return me.isArray(e)?e.forEach(u):u(e),this}};Qn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);me.reduceDescriptors(Qn.prototype,({value:t},e)=>{let i=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(a){this[i]=a}}});me.freezeMethods(Qn);function Af(t,e){const i=this||cl,a=e||i,c=Qn.from(a.headers);let u=a.data;return me.forEach(t,function(h){u=h.call(i,u,c.normalize(),e?e.status:void 0)}),c.normalize(),u}function Kv(t){return!!(t&&t.__CANCEL__)}function Mr(t,e,i){Nt.call(this,t??"canceled",Nt.ERR_CANCELED,e,i),this.name="CanceledError"}me.inherits(Mr,Nt,{__CANCEL__:!0});function Qv(t,e,i){const a=i.config.validateStatus;!i.status||!a||a(i.status)?t(i):e(new Nt("Request failed with status code "+i.status,[Nt.ERR_BAD_REQUEST,Nt.ERR_BAD_RESPONSE][Math.floor(i.status/100)-4],i.config,i.request,i))}function d6(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function f6(t,e){t=t||10;const i=new Array(t),a=new Array(t);let c=0,u=0,d;return e=e!==void 0?e:1e3,function(p){const y=Date.now(),g=a[u];d||(d=y),i[c]=p,a[c]=y;let w=u,C=0;for(;w!==c;)C+=i[w++],w=w%t;if(c=(c+1)%t,c===u&&(u=(u+1)%t),y-d<e)return;const j=g&&y-g;return j?Math.round(C*1e3/j):void 0}}function h6(t,e){let i=0,a=1e3/e,c,u;const d=(y,g=Date.now())=>{i=g,c=null,u&&(clearTimeout(u),u=null),t.apply(null,y)};return[(...y)=>{const g=Date.now(),w=g-i;w>=a?d(y,g):(c=y,u||(u=setTimeout(()=>{u=null,d(c)},a-w)))},()=>c&&d(c)]}const Yc=(t,e,i=3)=>{let a=0;const c=f6(50,250);return h6(u=>{const d=u.loaded,h=u.lengthComputable?u.total:void 0,p=d-a,y=c(p),g=d<=h;a=d;const w={loaded:d,total:h,progress:h?d/h:void 0,bytes:p,rate:y||void 0,estimated:y&&h&&g?(h-d)/y:void 0,event:u,lengthComputable:h!=null,[e?"download":"upload"]:!0};t(w)},i)},j0=(t,e)=>{const i=t!=null;return[a=>e[0]({lengthComputable:i,total:t,loaded:a}),e[1]]},C0=t=>(...e)=>me.asap(()=>t(...e)),m6=$n.hasStandardBrowserEnv?((t,e)=>i=>(i=new URL(i,$n.origin),t.protocol===i.protocol&&t.host===i.host&&(e||t.port===i.port)))(new URL($n.origin),$n.navigator&&/(msie|trident)/i.test($n.navigator.userAgent)):()=>!0,g6=$n.hasStandardBrowserEnv?{write(t,e,i,a,c,u){const d=[t+"="+encodeURIComponent(e)];me.isNumber(i)&&d.push("expires="+new Date(i).toGMTString()),me.isString(a)&&d.push("path="+a),me.isString(c)&&d.push("domain="+c),u===!0&&d.push("secure"),document.cookie=d.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function p6(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function y6(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Wv(t,e,i){let a=!p6(e);return t&&(a||i==!1)?y6(t,e):e}const N0=t=>t instanceof Qn?{...t}:t;function Na(t,e){e=e||{};const i={};function a(y,g,w,C){return me.isPlainObject(y)&&me.isPlainObject(g)?me.merge.call({caseless:C},y,g):me.isPlainObject(g)?me.merge({},g):me.isArray(g)?g.slice():g}function c(y,g,w,C){if(me.isUndefined(g)){if(!me.isUndefined(y))return a(void 0,y,w,C)}else return a(y,g,w,C)}function u(y,g){if(!me.isUndefined(g))return a(void 0,g)}function d(y,g){if(me.isUndefined(g)){if(!me.isUndefined(y))return a(void 0,y)}else return a(void 0,g)}function h(y,g,w){if(w in e)return a(y,g);if(w in t)return a(void 0,y)}const p={url:u,method:u,data:u,baseURL:d,transformRequest:d,transformResponse:d,paramsSerializer:d,timeout:d,timeoutMessage:d,withCredentials:d,withXSRFToken:d,adapter:d,responseType:d,xsrfCookieName:d,xsrfHeaderName:d,onUploadProgress:d,onDownloadProgress:d,decompress:d,maxContentLength:d,maxBodyLength:d,beforeRedirect:d,transport:d,httpAgent:d,httpsAgent:d,cancelToken:d,socketPath:d,responseEncoding:d,validateStatus:h,headers:(y,g,w)=>c(N0(y),N0(g),w,!0)};return me.forEach(Object.keys(Object.assign({},t,e)),function(g){const w=p[g]||c,C=w(t[g],e[g],g);me.isUndefined(C)&&w!==h||(i[g]=C)}),i}const Zv=t=>{const e=Na({},t);let{data:i,withXSRFToken:a,xsrfHeaderName:c,xsrfCookieName:u,headers:d,auth:h}=e;e.headers=d=Qn.from(d),e.url=Gv(Wv(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),h&&d.set("Authorization","Basic "+btoa((h.username||"")+":"+(h.password?unescape(encodeURIComponent(h.password)):"")));let p;if(me.isFormData(i)){if($n.hasStandardBrowserEnv||$n.hasStandardBrowserWebWorkerEnv)d.setContentType(void 0);else if((p=d.getContentType())!==!1){const[y,...g]=p?p.split(";").map(w=>w.trim()).filter(Boolean):[];d.setContentType([y||"multipart/form-data",...g].join("; "))}}if($n.hasStandardBrowserEnv&&(a&&me.isFunction(a)&&(a=a(e)),a||a!==!1&&m6(e.url))){const y=c&&u&&g6.read(u);y&&d.set(c,y)}return e},v6=typeof XMLHttpRequest<"u",b6=v6&&function(t){return new Promise(function(i,a){const c=Zv(t);let u=c.data;const d=Qn.from(c.headers).normalize();let{responseType:h,onUploadProgress:p,onDownloadProgress:y}=c,g,w,C,j,N;function M(){j&&j(),N&&N(),c.cancelToken&&c.cancelToken.unsubscribe(g),c.signal&&c.signal.removeEventListener("abort",g)}let D=new XMLHttpRequest;D.open(c.method.toUpperCase(),c.url,!0),D.timeout=c.timeout;function I(){if(!D)return;const F=Qn.from("getAllResponseHeaders"in D&&D.getAllResponseHeaders()),A={data:!h||h==="text"||h==="json"?D.responseText:D.response,status:D.status,statusText:D.statusText,headers:F,config:t,request:D};Qv(function(E){i(E),M()},function(E){a(E),M()},A),D=null}"onloadend"in D?D.onloadend=I:D.onreadystatechange=function(){!D||D.readyState!==4||D.status===0&&!(D.responseURL&&D.responseURL.indexOf("file:")===0)||setTimeout(I)},D.onabort=function(){D&&(a(new Nt("Request aborted",Nt.ECONNABORTED,t,D)),D=null)},D.onerror=function(){a(new Nt("Network Error",Nt.ERR_NETWORK,t,D)),D=null},D.ontimeout=function(){let O=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded";const A=c.transitional||Yv;c.timeoutErrorMessage&&(O=c.timeoutErrorMessage),a(new Nt(O,A.clarifyTimeoutError?Nt.ETIMEDOUT:Nt.ECONNABORTED,t,D)),D=null},u===void 0&&d.setContentType(null),"setRequestHeader"in D&&me.forEach(d.toJSON(),function(O,A){D.setRequestHeader(A,O)}),me.isUndefined(c.withCredentials)||(D.withCredentials=!!c.withCredentials),h&&h!=="json"&&(D.responseType=c.responseType),y&&([C,N]=Yc(y,!0),D.addEventListener("progress",C)),p&&D.upload&&([w,j]=Yc(p),D.upload.addEventListener("progress",w),D.upload.addEventListener("loadend",j)),(c.cancelToken||c.signal)&&(g=F=>{D&&(a(!F||F.type?new Mr(null,t,D):F),D.abort(),D=null)},c.cancelToken&&c.cancelToken.subscribe(g),c.signal&&(c.signal.aborted?g():c.signal.addEventListener("abort",g)));const V=d6(c.url);if(V&&$n.protocols.indexOf(V)===-1){a(new Nt("Unsupported protocol "+V+":",Nt.ERR_BAD_REQUEST,t));return}D.send(u||null)})},x6=(t,e)=>{const{length:i}=t=t?t.filter(Boolean):[];if(e||i){let a=new AbortController,c;const u=function(y){if(!c){c=!0,h();const g=y instanceof Error?y:this.reason;a.abort(g instanceof Nt?g:new Mr(g instanceof Error?g.message:g))}};let d=e&&setTimeout(()=>{d=null,u(new Nt(`timeout ${e} of ms exceeded`,Nt.ETIMEDOUT))},e);const h=()=>{t&&(d&&clearTimeout(d),d=null,t.forEach(y=>{y.unsubscribe?y.unsubscribe(u):y.removeEventListener("abort",u)}),t=null)};t.forEach(y=>y.addEventListener("abort",u));const{signal:p}=a;return p.unsubscribe=()=>me.asap(h),p}},w6=function*(t,e){let i=t.byteLength;if(i<e){yield t;return}let a=0,c;for(;a<i;)c=a+e,yield t.slice(a,c),a=c},_6=async function*(t,e){for await(const i of S6(t))yield*w6(i,e)},S6=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:i,value:a}=await e.read();if(i)break;yield a}}finally{await e.cancel()}},T0=(t,e,i,a)=>{const c=_6(t,e);let u=0,d,h=p=>{d||(d=!0,a&&a(p))};return new ReadableStream({async pull(p){try{const{done:y,value:g}=await c.next();if(y){h(),p.close();return}let w=g.byteLength;if(i){let C=u+=w;i(C)}p.enqueue(new Uint8Array(g))}catch(y){throw h(y),y}},cancel(p){return h(p),c.return()}},{highWaterMark:2})},cu=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Jv=cu&&typeof ReadableStream=="function",j6=cu&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),eb=(t,...e)=>{try{return!!t(...e)}catch{return!1}},C6=Jv&&eb(()=>{let t=!1;const e=new Request($n.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),k0=64*1024,oh=Jv&&eb(()=>me.isReadableStream(new Response("").body)),Xc={stream:oh&&(t=>t.body)};cu&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Xc[e]&&(Xc[e]=me.isFunction(t[e])?i=>i[e]():(i,a)=>{throw new Nt(`Response type '${e}' is not supported`,Nt.ERR_NOT_SUPPORT,a)})})})(new Response);const N6=async t=>{if(t==null)return 0;if(me.isBlob(t))return t.size;if(me.isSpecCompliantForm(t))return(await new Request($n.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(me.isArrayBufferView(t)||me.isArrayBuffer(t))return t.byteLength;if(me.isURLSearchParams(t)&&(t=t+""),me.isString(t))return(await j6(t)).byteLength},T6=async(t,e)=>{const i=me.toFiniteNumber(t.getContentLength());return i??N6(e)},k6=cu&&(async t=>{let{url:e,method:i,data:a,signal:c,cancelToken:u,timeout:d,onDownloadProgress:h,onUploadProgress:p,responseType:y,headers:g,withCredentials:w="same-origin",fetchOptions:C}=Zv(t);y=y?(y+"").toLowerCase():"text";let j=x6([c,u&&u.toAbortSignal()],d),N;const M=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let D;try{if(p&&C6&&i!=="get"&&i!=="head"&&(D=await T6(g,a))!==0){let A=new Request(e,{method:"POST",body:a,duplex:"half"}),H;if(me.isFormData(a)&&(H=A.headers.get("content-type"))&&g.setContentType(H),A.body){const[E,L]=j0(D,Yc(C0(p)));a=T0(A.body,k0,E,L)}}me.isString(w)||(w=w?"include":"omit");const I="credentials"in Request.prototype;N=new Request(e,{...C,signal:j,method:i.toUpperCase(),headers:g.normalize().toJSON(),body:a,duplex:"half",credentials:I?w:void 0});let V=await fetch(N);const F=oh&&(y==="stream"||y==="response");if(oh&&(h||F&&M)){const A={};["status","statusText","headers"].forEach(P=>{A[P]=V[P]});const H=me.toFiniteNumber(V.headers.get("content-length")),[E,L]=h&&j0(H,Yc(C0(h),!0))||[];V=new Response(T0(V.body,k0,E,()=>{L&&L(),M&&M()}),A)}y=y||"text";let O=await Xc[me.findKey(Xc,y)||"text"](V,t);return!F&&M&&M(),await new Promise((A,H)=>{Qv(A,H,{data:O,headers:Qn.from(V.headers),status:V.status,statusText:V.statusText,config:t,request:N})})}catch(I){throw M&&M(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new Nt("Network Error",Nt.ERR_NETWORK,t,N),{cause:I.cause||I}):Nt.from(I,I&&I.code,t,N)}}),lh={http:q3,xhr:b6,fetch:k6};me.forEach(lh,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const E0=t=>`- ${t}`,E6=t=>me.isFunction(t)||t===null||t===!1,tb={getAdapter:t=>{t=me.isArray(t)?t:[t];const{length:e}=t;let i,a;const c={};for(let u=0;u<e;u++){i=t[u];let d;if(a=i,!E6(i)&&(a=lh[(d=String(i)).toLowerCase()],a===void 0))throw new Nt(`Unknown adapter '${d}'`);if(a)break;c[d||"#"+u]=a}if(!a){const u=Object.entries(c).map(([h,p])=>`adapter ${h} `+(p===!1?"is not supported by the environment":"is not available in the build"));let d=e?u.length>1?`since :
`+u.map(E0).join(`
`):" "+E0(u[0]):"as no adapter specified";throw new Nt("There is no suitable adapter to dispatch the request "+d,"ERR_NOT_SUPPORT")}return a},adapters:lh};function Rf(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Mr(null,t)}function A0(t){return Rf(t),t.headers=Qn.from(t.headers),t.data=Af.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),tb.getAdapter(t.adapter||cl.adapter)(t).then(function(a){return Rf(t),a.data=Af.call(t,t.transformResponse,a),a.headers=Qn.from(a.headers),a},function(a){return Kv(a)||(Rf(t),a&&a.response&&(a.response.data=Af.call(t,t.transformResponse,a.response),a.response.headers=Qn.from(a.response.headers))),Promise.reject(a)})}const nb="1.8.4",uu={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{uu[t]=function(a){return typeof a===t||"a"+(e<1?"n ":" ")+t}});const R0={};uu.transitional=function(e,i,a){function c(u,d){return"[Axios v"+nb+"] Transitional option '"+u+"'"+d+(a?". "+a:"")}return(u,d,h)=>{if(e===!1)throw new Nt(c(d," has been removed"+(i?" in "+i:"")),Nt.ERR_DEPRECATED);return i&&!R0[d]&&(R0[d]=!0,console.warn(c(d," has been deprecated since v"+i+" and will be removed in the near future"))),e?e(u,d,h):!0}};uu.spelling=function(e){return(i,a)=>(console.warn(`${a} is likely a misspelling of ${e}`),!0)};function A6(t,e,i){if(typeof t!="object")throw new Nt("options must be an object",Nt.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let c=a.length;for(;c-- >0;){const u=a[c],d=e[u];if(d){const h=t[u],p=h===void 0||d(h,u,t);if(p!==!0)throw new Nt("option "+u+" must be "+p,Nt.ERR_BAD_OPTION_VALUE);continue}if(i!==!0)throw new Nt("Unknown option "+u,Nt.ERR_BAD_OPTION)}}const Dc={assertOptions:A6,validators:uu},Is=Dc.validators;let ja=class{constructor(e){this.defaults=e,this.interceptors={request:new _0,response:new _0}}async request(e,i){try{return await this._request(e,i)}catch(a){if(a instanceof Error){let c={};Error.captureStackTrace?Error.captureStackTrace(c):c=new Error;const u=c.stack?c.stack.replace(/^.+\n/,""):"";try{a.stack?u&&!String(a.stack).endsWith(u.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+u):a.stack=u}catch{}}throw a}}_request(e,i){typeof e=="string"?(i=i||{},i.url=e):i=e||{},i=Na(this.defaults,i);const{transitional:a,paramsSerializer:c,headers:u}=i;a!==void 0&&Dc.assertOptions(a,{silentJSONParsing:Is.transitional(Is.boolean),forcedJSONParsing:Is.transitional(Is.boolean),clarifyTimeoutError:Is.transitional(Is.boolean)},!1),c!=null&&(me.isFunction(c)?i.paramsSerializer={serialize:c}:Dc.assertOptions(c,{encode:Is.function,serialize:Is.function},!0)),i.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?i.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:i.allowAbsoluteUrls=!0),Dc.assertOptions(i,{baseUrl:Is.spelling("baseURL"),withXsrfToken:Is.spelling("withXSRFToken")},!0),i.method=(i.method||this.defaults.method||"get").toLowerCase();let d=u&&me.merge(u.common,u[i.method]);u&&me.forEach(["delete","get","head","post","put","patch","common"],N=>{delete u[N]}),i.headers=Qn.concat(d,u);const h=[];let p=!0;this.interceptors.request.forEach(function(M){typeof M.runWhen=="function"&&M.runWhen(i)===!1||(p=p&&M.synchronous,h.unshift(M.fulfilled,M.rejected))});const y=[];this.interceptors.response.forEach(function(M){y.push(M.fulfilled,M.rejected)});let g,w=0,C;if(!p){const N=[A0.bind(this),void 0];for(N.unshift.apply(N,h),N.push.apply(N,y),C=N.length,g=Promise.resolve(i);w<C;)g=g.then(N[w++],N[w++]);return g}C=h.length;let j=i;for(w=0;w<C;){const N=h[w++],M=h[w++];try{j=N(j)}catch(D){M.call(this,D);break}}try{g=A0.call(this,j)}catch(N){return Promise.reject(N)}for(w=0,C=y.length;w<C;)g=g.then(y[w++],y[w++]);return g}getUri(e){e=Na(this.defaults,e);const i=Wv(e.baseURL,e.url,e.allowAbsoluteUrls);return Gv(i,e.params,e.paramsSerializer)}};me.forEach(["delete","get","head","options"],function(e){ja.prototype[e]=function(i,a){return this.request(Na(a||{},{method:e,url:i,data:(a||{}).data}))}});me.forEach(["post","put","patch"],function(e){function i(a){return function(u,d,h){return this.request(Na(h||{},{method:e,headers:a?{"Content-Type":"multipart/form-data"}:{},url:u,data:d}))}}ja.prototype[e]=i(),ja.prototype[e+"Form"]=i(!0)});let R6=class sb{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let i;this.promise=new Promise(function(u){i=u});const a=this;this.promise.then(c=>{if(!a._listeners)return;let u=a._listeners.length;for(;u-- >0;)a._listeners[u](c);a._listeners=null}),this.promise.then=c=>{let u;const d=new Promise(h=>{a.subscribe(h),u=h}).then(c);return d.cancel=function(){a.unsubscribe(u)},d},e(function(u,d,h){a.reason||(a.reason=new Mr(u,d,h),i(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const i=this._listeners.indexOf(e);i!==-1&&this._listeners.splice(i,1)}toAbortSignal(){const e=new AbortController,i=a=>{e.abort(a)};return this.subscribe(i),e.signal.unsubscribe=()=>this.unsubscribe(i),e.signal}static source(){let e;return{token:new sb(function(c){e=c}),cancel:e}}};function M6(t){return function(i){return t.apply(null,i)}}function L6(t){return me.isObject(t)&&t.isAxiosError===!0}const ch={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ch).forEach(([t,e])=>{ch[e]=t});function ib(t){const e=new ja(t),i=Lv(ja.prototype.request,e);return me.extend(i,ja.prototype,e,{allOwnKeys:!0}),me.extend(i,e,null,{allOwnKeys:!0}),i.create=function(c){return ib(Na(t,c))},i}const Mt=ib(cl);Mt.Axios=ja;Mt.CanceledError=Mr;Mt.CancelToken=R6;Mt.isCancel=Kv;Mt.VERSION=nb;Mt.toFormData=lu;Mt.AxiosError=Nt;Mt.Cancel=Mt.CanceledError;Mt.all=function(e){return Promise.all(e)};Mt.spread=M6;Mt.isAxiosError=L6;Mt.mergeConfig=Na;Mt.AxiosHeaders=Qn;Mt.formToJSON=t=>Xv(me.isHTMLForm(t)?new FormData(t):t);Mt.getAdapter=tb.getAdapter;Mt.HttpStatusCode=ch;Mt.default=Mt;const{Axios:eD,AxiosError:tD,CanceledError:nD,isCancel:sD,CancelToken:iD,VERSION:aD,all:rD,Cancel:oD,isAxiosError:lD,spread:cD,toFormData:uD,AxiosHeaders:dD,HttpStatusCode:fD,formToJSON:hD,getAdapter:mD,mergeConfig:gD}=Mt,hn={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error",NONE:"none"},Ms={level:hn.ERROR,enabled:!1,includeTimestamp:!0,groupByContext:!0},M0={[hn.DEBUG]:0,[hn.INFO]:1,[hn.WARN]:2,[hn.ERROR]:3,[hn.NONE]:4},O6=(t,e)=>{let i="";if(t&&(i+=`[${t}] `),Ms.includeTimestamp){const c=new Date().toLocaleTimeString();i+=`${c} `}return i+=e,i},Hs=(t,e,i,...a)=>{if(!Ms.enabled||M0[t]<M0[Ms.level])return;const c=O6(e,i);if(Ms.groupByContext&&e&&a.length>0&&typeof a[0]=="object"){console.groupCollapsed(c),a.forEach(d=>{d!==null&&typeof d=="object"?console.dir(d):console.log(d)}),console.groupEnd();return}switch(t){case hn.DEBUG:console.debug(c,...a);break;case hn.INFO:console.info(c,...a);break;case hn.WARN:console.warn(c,...a);break;case hn.ERROR:console.error(c,...a);break;default:console.log(c,...a)}},D6=t=>({debug:(e,...i)=>Hs(hn.DEBUG,t,e,...i),info:(e,...i)=>Hs(hn.INFO,t,e,...i),warn:(e,...i)=>Hs(hn.WARN,t,e,...i),error:(e,...i)=>Hs(hn.ERROR,t,e,...i),log:(e,...i)=>Hs(hn.INFO,t,e,...i)}),An={debug:(t,...e)=>Hs(hn.DEBUG,"",t,...e),info:(t,...e)=>Hs(hn.INFO,"",t,...e),warn:(t,...e)=>Hs(hn.WARN,"",t,...e),error:(t,...e)=>Hs(hn.ERROR,"",t,...e),log:(t,...e)=>Hs(hn.INFO,"",t,...e),create:t=>D6(t),setLevel:t=>{hn[t]&&(Ms.level=t)},getLevel:()=>Ms.level,enable:()=>{Ms.enabled=!0},disable:()=>{Ms.enabled=!1},isEnabled:()=>Ms.enabled,includeTimestamp:(t=!0)=>{Ms.includeTimestamp=t},groupByContext:(t=!0)=>{Ms.groupByContext=t}},L0=(t,e)=>{var a,c,u,d,h,p,y;if(!t)return"No messages yet";const i=t.sender===e?"You: ":"";switch(t.type){case"text":const g=t.content||"";return i+(g.length>25?`${g.substring(0,25)}...`:g);case"wink":return i+"Sent a wink 😉";case"file":return(c=(a=t.metadata)==null?void 0:a.fileType)!=null&&c.startsWith("image/")?i+"Sent an image":(d=(u=t.metadata)==null?void 0:u.fileType)!=null&&d.startsWith("video/")?i+"Sent a video":(p=(h=t.metadata)==null?void 0:h.fileType)!=null&&p.startsWith("audio/")?i+"Sent an audio file":((y=t.metadata)==null?void 0:y.fileType)==="application/pdf"?i+"Sent a PDF document":i+"Sent a file";case"video":return i+"Video Call";default:return i+"New message"}},B6=(...t)=>t.filter(Boolean).join(" "),uh=t=>{if(!t)return null;const e=typeof t=="string"?t:String(t);if(/^[0-9a-fA-F]{24}$/.test(e))return e;if(e.length>24){const a=e.match(/([0-9a-fA-F]{24})/);if(a&&a[1])return a[1]}const i=e.match(/ObjectId\(['"](.*)['"]\)/);if(i&&i[1]){const a=i[1];if(/^[0-9a-fA-F]{24}$/.test(a))return a}return typeof t=="object"&&t!==null&&t._id?uh(t._id):typeof t=="object"&&t!==null&&t.id?uh(t.id):null},z6=()=>{if(window._objectIdRequestsPatched)return;window._objectIdRequestsPatched=!0,console.log("🔧 Installing API ObjectId request patch");const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){this.addEventListener("readystatechange",function(){if(this.readyState===4&&this.status===400)try{const e=JSON.parse(this.responseText);e.error&&(e.error==="Invalid user ID format"||e.error==="Invalid authenticated user ID format"||e.error==="Invalid user ID format in request")&&(console.warn("⚠️ Caught ObjectId validation error:",e.error),confirm("Session ID format error detected. Apply emergency fix?")&&emergencyUserIdFix())}catch{}}),t.apply(this,arguments)},console.log("✅ API ObjectId request patch installed")};z6();const Mf=new Map,ab=new Set,rb=t=>{if(!t)return`${window.location.origin}/placeholder.svg`;if(Mf.has(t))return Mf.get(t);if(ab.has(t))return`${window.location.origin}/placeholder.svg`;let e;if(t==="/default-avatar.png"||t==="/placeholder.svg")e=`${window.location.origin}${t}`;else if(t.startsWith("http"))e=t;else if(/^[0-9a-f]{24}$/i.test(t))e=`${window.location.origin}/api/avatars/${t}`;else if(t.startsWith("/uploads/"))e=`${window.location.origin}${t}`;else if(t.includes("/images/")||t.includes("/photos/")){const i=t.startsWith("/uploads")?t:`/uploads${t.startsWith("/")?"":"/"}${t}`;e=`${window.location.origin}${i}`}else t.startsWith("/")?e=`${window.location.origin}${t}`:e=t;return Mf.set(t,e),e},ob=t=>(ab.add(t),`${window.location.origin}/placeholder.svg`),Kc=(t,e={})=>{const{showTime:i=!0,showDate:a=!0,showRelative:c=!1,locale:u="en-US"}=e;if(!t)return"";const d=typeof t=="string"?new Date(t):t;if(isNaN(d.getTime()))return"";if(c){const y=new Date-d,g=Math.floor(y/1e3),w=Math.floor(g/60),C=Math.floor(w/60),j=Math.floor(C/24);if(g<60)return"just now";if(w<60)return`${w}m ago`;if(C<24)return`${C}h ago`;if(j<7)return`${j}d ago`}let h="";if(a&&(h=d.toLocaleDateString(u,{year:"numeric",month:"short",day:"numeric"})),i){const p=d.toLocaleTimeString(u,{hour:"2-digit",minute:"2-digit"});h=a?`${h}, ${p}`:p}return h},Qs=An.create("TokenStorage"),Vi=()=>{const t=sessionStorage.getItem("token")||localStorage.getItem("token");return t&&Qs.debug("Token retrieved from storage"),t},Vo=(t,e=!0)=>{t&&(sessionStorage.setItem("token",t),Qs.debug("Token stored in sessionStorage"),e?(localStorage.setItem("token",t),Qs.debug("Token also stored in localStorage (remember me)")):localStorage.removeItem("token"))},qi=()=>{sessionStorage.removeItem("token"),localStorage.removeItem("token"),Qs.debug("Token removed from all storage")},Qo=t=>{if(!t)return!0;try{const i=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),c=JSON.parse(atob(i)).exp*1e3,d=Date.now()>=c-3e4;return d&&Qs.debug(`Token expired at ${new Date(c).toISOString()}`),d}catch(e){return Qs.error("Error parsing JWT token:",e),!0}},Vh=t=>{if(!t)return null;try{const i=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(atob(i))}catch(e){return Qs.error("Error parsing JWT token:",e),null}},lb=t=>{if(!t)return null;try{const e=Vh(t);if(!e)return null;let i=null;return e.id?i=e.id:e.sub?i=e.sub:e.user&&(i=e.user._id||e.user.id),i?uh(i):(Qs.warn("No user ID found in token payload",e),null)}catch(e){return Qs.error("Error extracting user ID from token:",e),null}},P6=()=>{const t=Vi();return lb(t)},$6=t=>t?/^[0-9a-fA-F]{24}$/.test(t.toString()):!1,U6=t=>{if(!t)return 0;try{const e=Vh(t);if(!e||!e.exp)return 0;const i=e.exp*1e3,a=Date.now();return Math.max(0,i-a)}catch(e){return Qs.error("Error calculating token time remaining:",e),0}},I6=Object.freeze(Object.defineProperty({__proto__:null,getCurrentUserId:P6,getToken:Vi,getTokenTimeRemaining:U6,getUserIdFromToken:lb,isTokenExpired:Qo,isValidUserId:$6,parseToken:Vh,removeToken:qi,setToken:Vo},Symbol.toStringTag,{value:"Module"})),ut=An.create("ApiService"),Fs=An.create("ResponseCache"),Lf=An.create("NetworkMonitor"),qs=An.create("RequestQueue");class F6{constructor(e=100,i=6e4){this.cache=new Map,this.maxSize=e,this.ttl=i}generateKey(e,i){const a=e.replace(/\/+$/,""),c=a.match(/\/([0-9a-fA-F]{24})$/),u=c?a.replace(c[1],":id"):a,d=c?`${u}:${c[1]}`:a,h=i?JSON.stringify(Object.entries(i).sort()):"";return`${d}:${h}`}set(e,i,a){if(!a||!a.success)return null;const c=this.generateKey(e,i);let u=this.ttl;e.match(/\/users\/[0-9a-fA-F]{24}$/)&&(u=12e4,Fs.debug(`Using extended TTL (120s) for user profile: ${e}`)),e.includes("/messages/")&&(u=1e4,Fs.debug(`Using shorter TTL (10s) for messages endpoint: ${e}`));const d=Date.now()+u;if(this.cache.size>=this.maxSize){const h=this.cache.keys().next().value;this.cache.delete(h),Fs.debug(`Cache full, removing oldest entry: ${h}`)}return this.cache.set(c,{data:a,expiresAt:d}),Fs.debug(`Cached response for: ${c} (expires in ${Math.round(u/1e3)}s)`),a}get(e,i){const a=this.generateKey(e,i),c=this.cache.get(a);return c?c.expiresAt<Date.now()?(Fs.debug(`Cache expired for: ${a}`),this.cache.delete(a),null):(Fs.debug(`Cache hit for: ${a}`),c.data):(Fs.debug(`Cache miss for: ${a}`),null)}invalidate(e,i){const a=i?this.generateKey(e,i):null;if(a)this.cache.delete(a),Fs.debug(`Invalidated cache for: ${a}`);else if(e)for(const c of this.cache.keys())c.startsWith(`${e}:`)&&(this.cache.delete(c),Fs.debug(`Invalidated cache for: ${c}`));else this.cache.clear(),Fs.debug("Invalidated entire cache")}}class q6{constructor(e){this.isOnline=navigator.onLine,this.onStatusChange=e,window.addEventListener("online",this.handleOnline.bind(this)),window.addEventListener("offline",this.handleOffline.bind(this)),Lf.info(`Network monitor initialized. Online: ${this.isOnline}`)}handleOnline(){Lf.info("Network connection restored"),this.isOnline=!0,this.onStatusChange&&this.onStatusChange(!0)}handleOffline(){Lf.warn("Network connection lost"),this.isOnline=!1,this.onStatusChange&&this.onStatusChange(!1)}cleanup(){window.removeEventListener("online",this.handleOnline.bind(this)),window.removeEventListener("offline",this.handleOffline.bind(this))}}class V6{constructor(e){this.queue=[],this.apiInstance=e,this.isProcessing=!1,this.maxRetries=3,this.loadFromStorage()}add(e){return this.queue.push({...e,timestamp:Date.now(),retries:0}),qs.debug(`Added request to queue: ${e.method} ${e.url}`),this.saveToStorage(),this.queue.length}loadFromStorage(){try{const e=localStorage.getItem("api_request_queue");e&&(this.queue=JSON.parse(e),qs.info(`Loaded ${this.queue.length} requests from storage`))}catch(e){qs.error("Failed to load queue from storage:",e),this.queue=[]}}saveToStorage(){try{localStorage.setItem("api_request_queue",JSON.stringify(this.queue))}catch(e){qs.error("Failed to save queue to storage:",e)}}async processQueue(){if(this.isProcessing||this.queue.length===0)return;this.isProcessing=!0,qs.info(`Processing queue with ${this.queue.length} requests`);const e=[];for(let i=0;i<this.queue.length;i++){const a=this.queue[i];try{qs.debug(`Processing queued request: ${a.method} ${a.url}`),await this.apiInstance.request({url:a.url,method:a.method,data:a.data,params:a.params,headers:a.headers}),e.push(i),qs.debug(`Successfully processed queued request: ${a.method} ${a.url}`)}catch{a.retries++,qs.warn(`Failed to process queued request (attempt ${a.retries}): ${a.method} ${a.url}`),a.retries>=this.maxRetries&&(e.push(i),qs.error(`Giving up on queued request after ${this.maxRetries} attempts: ${a.method} ${a.url}`))}}for(let i=e.length-1;i>=0;i--)this.queue.splice(e[i],1);this.saveToStorage(),this.isProcessing=!1,qs.info(`Queue processing complete. ${e.length} requests processed, ${this.queue.length} remaining`)}}class H6{constructor(){_c(this,"isValidObjectId",e=>{if(!e)return!1;if(typeof e=="string"&&/^[0-9a-fA-F]{24}$/.test(e))return!0;try{const i=String(e);if(i.length===24&&/^[0-9a-fA-F]{24}$/.test(i))return!0;const a=i.match(/([0-9a-fA-F]{24})/);if(a&&a[1])return!0;const c=i.match(/ObjectId\(['"](.*)['"]\)/);if(c&&c[1]&&/^[0-9a-fA-F]{24}$/.test(c[1]))return!0}catch(i){ut.debug(`ObjectId validation error: ${i.message}`)}return!1});_c(this,"sanitizeObjectId",e=>{if(!e)return null;try{if(typeof e=="string"&&/^[0-9a-fA-F]{24}$/.test(e))return e;const i=String(e),a=i.match(/([0-9a-fA-F]{24})/);if(a&&a[1])return a[1];const c=i.match(/ObjectId\(['"](.*)['"]\)/);if(c&&c[1]&&/^[0-9a-fA-F]{24}$/.test(c[1]))return c[1];if(typeof e=="object"&&e!==null){if(e._id)return this.sanitizeObjectId(e._id);if(e.id)return this.sanitizeObjectId(e.id)}return null}catch(i){return ut.error(`Failed to sanitize ObjectId: ${i.message}`),null}});this.baseURL="/api",ut.info(`Initializing with baseURL: ${this.baseURL}`),this.api=Mt.create({baseURL:this.baseURL,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:15e3}),this.refreshTokenPromise=null,this.requestsToRetry=[],this.pendingRequests=new Map,this.metrics={totalRequests:0,successfulRequests:0,failedRequests:0,retries:0,avgResponseTime:0},this.cache=new F6(Number.parseInt("100"),Number.parseInt("60000")),this.requestQueue=new V6(this.api),this.networkMonitor=new q6(this._handleNetworkStatusChange.bind(this)),this._initializeInterceptors(),this._loadAuthToken()}_handleNetworkStatusChange(e){e?(ut.info("Network connection restored. Processing request queue..."),setTimeout(()=>this.requestQueue.processQueue(),1e3)):ut.warn("Network offline. Requests will be queued."),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("apiConnectionStatusChange",{detail:{isOnline:e}}))}_initializeInterceptors(){this.api.interceptors.request.use(this._handleRequest.bind(this),this._handleRequestError.bind(this)),this.api.interceptors.response.use(this._handleResponse.bind(this),this._handleResponseError.bind(this))}_handleRequest(e){const i=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;e.requestId=i,e.startTime=Date.now(),this.pendingRequests.set(i,{config:e,timestamp:Date.now()}),this.metrics.totalRequests++,e.method.toLowerCase()==="get"&&e.headers["x-no-cache"]&&(e.params=e.params||{},e.params._=Date.now());const a=this._getStoredToken();if(a&&Qo(a)&&!e.url.includes("/auth/refresh-token")&&!e._isRefreshRequest&&!e._tokenRefreshRetry){e._tokenRefreshRetry=!0,ut.debug(`Token expired before request. Queueing request: ${e.method} ${e.url}`),this.requestsToRetry.push(e),this.refreshToken().catch(u=>{ut.warn("Token refresh failed in request handler:",u.message)});const c=Mt.CancelToken.source();e.cancelToken=c.token,setTimeout(()=>c.cancel("Token expired. Request will be retried."),0)}return ut.debug(`Request: ${e.method.toUpperCase()} ${e.url}`,e.params?`Params: ${JSON.stringify(e.params)}`:""),e}_handleRequestError(e){return ut.error("Request error:",e.message),this.metrics.failedRequests++,Promise.reject(e)}_handleResponse(e){const i=Date.now()-e.config.startTime;return this.metrics.successfulRequests++,this.metrics.avgResponseTime=(this.metrics.avgResponseTime*(this.metrics.successfulRequests-1)+i)/this.metrics.successfulRequests,e.config.requestId&&this.pendingRequests.delete(e.config.requestId),ut.debug(`Response success: ${e.config.method.toUpperCase()} ${e.config.url} (${i}ms)`),e.config.method.toLowerCase()==="get"&&!e.config.headers["x-no-cache"]&&this.cache.set(e.config.url,e.config.params,e.data),e.data}_handleResponseError(e){var i,a;if(Mt.isCancel(e))return ut.debug(`Request canceled: ${e.message}`),Promise.reject({success:!1,error:"Request canceled",isCanceled:!0});if((i=e.config)!=null&&i.requestId&&this.pendingRequests.delete(e.config.requestId),!e.response){const c=!navigator.onLine,u=c?"You are currently offline. Please check your connection.":"Network error. Please try again.";return(!c||((a=e.config)==null?void 0:a.method)==="get")&&ne.error(u),Promise.reject({success:!1,error:u,isOffline:c,originalError:e})}return this._processHttpError(e)}async _processHttpError(e){const i=e.config,a=e.response.status;if(ut.error(`Response error: ${i.method.toUpperCase()} ${i.url}`,`Status: ${a}`,e.response.data),a===401&&!i._retry)return this._handleAuthError(e);const c=e.response.data,u=(c==null?void 0:c.error)||(c==null?void 0:c.message)||(c==null?void 0:c.msg)||(e.response.status===400&&i.url.includes("/like")?"You've already liked this user or reached your daily limit":"An error occurred"),d=(c==null?void 0:c.code)||null;return this._showErrorNotification(a,u,d),Promise.reject({success:!1,error:u,code:d,status:a,data:e.response.data})}async _handleAuthError(e){const i=e.config;if(i._retry=!0,i.url.includes("/auth/refresh-token"))return ut.warn("Refresh token request failed"),this._handleLogout("Session expired. Please log in again."),Promise.reject({success:!1,error:"Authentication failed",status:401});ut.debug("Received 401 error. Attempting token refresh...");try{const a=await this.refreshToken();if(a)return ut.debug("Token refreshed successfully. Retrying original request."),i.headers.Authorization=`Bearer ${a}`,i.headers["x-auth-token"]=a,this.api(i);throw ut.warn("Token refresh returned null"),this._getStoredToken()&&this._handleLogout("Session expired. Please log in again."),new Error("Failed to refresh token")}catch(a){return ut.error("Token refresh failed:",a),this._getStoredToken()&&this._handleLogout("Session expired. Please log in again."),Promise.reject({success:!1,error:"Authentication failed",status:401})}}_showErrorNotification(e,i,a){if(!document.hidden)switch(e){case 400:ne.error(`Request error: ${i}`);break;case 403:ne.error(`Access denied: ${i}`);break;case 404:ne.error(`Not found: ${i}`);break;case 422:ne.error(`Validation error: ${i}`);break;case 429:ne.error("Too many requests. Please try again later.");break;case 500:case 502:case 503:case 504:ne.error(`Server error (${e}). Please try again later.`);break;default:ne.error(i)}}_handleLogout(e){this._removeToken(),this.setAuthToken(null),ne.error(e),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("authLogout"))}_getStoredToken(){return Vi()}_storeToken(e,i=!1){e&&Vo(e,i)}_removeToken(){qi()}_loadAuthToken(){const e=this._getStoredToken();return e?(this.setAuthToken(e),Qo(e)&&(ut.info("Token expired, attempting to refresh"),this.refreshToken().catch(i=>{ut.warn("Token refresh failed on initialization:",i)})),e):null}setAuthToken(e){e?(this.api.defaults.headers.common.Authorization=`Bearer ${e}`,this.api.defaults.headers.common["x-auth-token"]=e,Mt.defaults.headers.common.Authorization=`Bearer ${e}`,Mt.defaults.headers.common["x-auth-token"]=e,ut.debug("Auth token set in all API instances")):(delete this.api.defaults.headers.common.Authorization,delete this.api.defaults.headers.common["x-auth-token"],delete Mt.defaults.headers.common.Authorization,delete Mt.defaults.headers.common["x-auth-token"],ut.debug("Auth token removed from all API instances"))}async refreshToken(){return this.refreshTokenPromise?this.refreshTokenPromise:(this.refreshTokenPromise=(async()=>{try{ut.info("Refreshing authentication token...");const e=this._getStoredToken();if(!e)return ut.warn("No token available for refresh"),null;const i=await Mt.post(`${this.baseURL}/auth/refresh-token`,{token:e},{headers:{"Content-Type":"application/json","x-no-cache":"true"}});if(i.data&&i.data.success&&i.data.token){const a=i.data.token;this._storeToken(a,localStorage.getItem("token")!==null),this.setAuthToken(a),ut.info("Token refreshed successfully"),this._retryQueuedRequests(a);try{const c=JSON.parse(atob(a.split(".")[1]));if(c.exp){const u=c.exp*1e3-Date.now()-6e4;u>0&&(this.tokenRefreshTimer=setTimeout(()=>this.refreshToken(),u),ut.debug(`Scheduled next token refresh in ${Math.round(u/1e3)} seconds`))}}catch(c){ut.error("Error scheduling token refresh:",c)}return a}else throw ut.warn("Invalid refresh token response:",i.data),new Error("Invalid refresh token response")}catch(e){return ut.error("Token refresh failed:",e),e.response&&(e.response.status===401||e.response.status===403)&&(this._removeToken(),this.setAuthToken(null),ne.error("Your session has expired. Please log in again."),typeof window<"u"&&window.dispatchEvent&&window.dispatchEvent(new CustomEvent("authLogout"))),null}finally{setTimeout(()=>{this.refreshTokenPromise=null},1e3)}})(),this.refreshTokenPromise)}_retryQueuedRequests(e){const i=[...this.requestsToRetry];this.requestsToRetry=[],ut.info(`Retrying ${i.length} queued requests with new token`),i.forEach(a=>{a.headers.Authorization=`Bearer ${e}`,a.headers["x-auth-token"]=e,this.api(a).catch(c=>{ut.error(`Error retrying queued request: ${a.method} ${a.url}`,c)})})}_processResponse(e){return e&&typeof e.success=="boolean"?e:e&&e.error?{success:!1,error:e.error,data:e}:{success:!0,data:e}}async get(e,i={},a={}){var c;try{e.includes("/messages")&&ut.info(`Message API call: GET ${e} params:${JSON.stringify(i)}`);const u=e.match(/\/([^/]+)$/);if(u&&u[1]&&!e.includes("?")&&!e.endsWith("/")){const p=u[1];if(p.length>=24||p.includes("ObjectId")){const y=this.sanitizeObjectId(p);if(y&&y!==p)ut.debug(`Sanitized ObjectId in URL: ${p} -> ${y}`),e=e.replace(p,y);else if(p.length===24&&!this.isValidObjectId(p))return ut.error(`Invalid ObjectId in request: ${p}`),{success:!1,error:"Invalid ID format",status:400}}}const d={...i};for(const p in d)if(p.toLowerCase().includes("id")&&d[p]){const y=this.sanitizeObjectId(d[p]);y&&(ut.debug(`Sanitized param ${p}: ${d[p]} -> ${y}`),d[p]=y)}const h=await this.api.get(e,{params:d,...a,cancelToken:((c=a.request)==null?void 0:c.cancelToken)||a.cancelToken});return e.includes("/messages")&&ut.info(`Message API response success: GET ${e} - Data: ${JSON.stringify(h)}`),this._processResponse(h)}catch(u){throw e.includes("/messages")?(ut.error(`Message API request failed: GET ${e}`,u),u.response?ut.error(`Message API error details: ${JSON.stringify({status:u.response.status,data:u.response.data,headers:u.response.headers})}`):u.request?ut.error(`Message API no response received: ${u.request}`):ut.error(`Message API error setting up request: ${u.message}`)):ut.error(`GET request failed: ${e}`,u),u}}async post(e,i={},a={}){var c;try{e.includes("/messages")&&ut.info(`Message API call: POST ${e} data:${JSON.stringify(i)}`),a.invalidateCache!==!1&&this.cache.invalidate(e);const u={...i};this._sanitizeObjectInPlace(u);const d=await this.api.post(e,u,{...a,cancelToken:((c=a.request)==null?void 0:c.cancelToken)||a.cancelToken});return e.includes("/messages")&&ut.info(`Message API response success: POST ${e} - Data: ${JSON.stringify(d)}`),this._processResponse(d)}catch(u){throw e.includes("/messages")?(ut.error(`Message API request failed: POST ${e}`,u),u.response?ut.error(`Message API error details: ${JSON.stringify({status:u.response.status,data:u.response.data,headers:u.response.headers})}`):u.request?ut.error(`Message API no response received: ${u.request}`):ut.error(`Message API error setting up request: ${u.message}`)):ut.error(`POST request failed: ${e}`,u),u}}_sanitizeObjectInPlace(e){!e||typeof e!="object"||Object.keys(e).forEach(i=>{if((i==="_id"||i==="id"||i.endsWith("Id"))&&e[i]){const a=this.sanitizeObjectId(e[i]);a&&(e[i]=a)}else e[i]&&typeof e[i]=="object"&&(Array.isArray(e[i])?e[i].forEach(a=>{a&&typeof a=="object"&&this._sanitizeObjectInPlace(a)}):this._sanitizeObjectInPlace(e[i]))})}async put(e,i={},a={}){var c;try{a.invalidateCache!==!1&&this.cache.invalidate(e);const u={...i};this._sanitizeObjectInPlace(u);const d=await this.api.put(e,u,{...a,cancelToken:((c=a.request)==null?void 0:c.cancelToken)||a.cancelToken});return this._processResponse(d)}catch(u){throw ut.error(`PUT request failed: ${e}`,u),u}}async delete(e,i={}){var a;try{i.invalidateCache!==!1&&this.cache.invalidate(e);const c=e.match(/\/([^/]+)$/);if(c&&c[1]&&!e.includes("?")&&!e.endsWith("/")){const d=c[1];if(d.length>=24||d.includes("ObjectId")){const h=this.sanitizeObjectId(d);h&&h!==d&&(ut.debug(`Sanitized ObjectId in DELETE URL: ${d} -> ${h}`),e=e.replace(d,h))}}const u=await this.api.delete(e,{...i,cancelToken:((a=i.request)==null?void 0:a.cancelToken)||i.cancelToken});return this._processResponse(u)}catch(c){throw ut.error(`DELETE request failed: ${e}`,c),c}}async upload(e,i,a=null,c={}){var u;try{const d=((u=c.request)==null?void 0:u.cancelToken)||c.cancelToken||Mt.CancelToken.source().token;return await this.api.post(e,i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a?p=>{const y=Math.round(p.loaded*100/p.total);a(y)}:void 0,cancelToken:d,...c})}catch(d){throw ut.error(`Upload failed: ${e}`,d),d}}async download(e,i={},a=null,c={}){var u;try{const d=((u=c.request)==null?void 0:u.cancelToken)||c.cancelToken||Mt.CancelToken.source().token;return await this.api.get(e,{params:i,responseType:"blob",onDownloadProgress:a?p=>{const y=Math.round(p.loaded*100/p.total);a(y)}:void 0,cancelToken:d,...c})}catch(d){throw ut.error(`Download failed: ${e}`,d),d}}createCancelToken(){return Mt.CancelToken.source()}createCancelableRequest(){const e=Mt.CancelToken.source();return{request:{cancelToken:e.token},cancel:()=>e.cancel("Request canceled")}}isCancel(e){return Mt.isCancel(e)}cancelAllRequests(e="Request canceled by user"){const i=this.pendingRequests.size;if(i>0){ut.info(`Canceling ${i} pending requests: ${e}`);for(const[a,c]of this.pendingRequests.entries())Mt.CancelToken.source().cancel(e),this.pendingRequests.delete(a)}}async testConnection(){try{const{request:e,cancel:i}=this.createCancelableRequest(),a=setTimeout(()=>{i("Connection test timeout")},5e3),c=await this.get("/auth/test-connection",{},{request:e});return clearTimeout(a),{success:!0,data:c,ping:c.timestamp?new Date-new Date(c.timestamp):null}}catch(e){return{success:!1,error:e.error||e.message||"Connection test failed",isOffline:!navigator.onLine}}}async getHealthStatus(){try{return{success:!0,data:await this.get("/health",{},{timeout:3e3})}}catch(e){return{success:!1,error:e.error||e.message||"Health check failed"}}}getMetrics(){return{...this.metrics}}clearCache(e=null){this.cache.invalidate(e)}processQueue(){navigator.onLine&&this.requestQueue.processQueue()}cleanup(){this.cancelAllRequests("API service cleanup"),this.networkMonitor&&this.networkMonitor.cleanup()}async login(e,i=!1){try{const a=await this.post("/auth/login",e);if(a.success&&a.token)return this._storeToken(a.token,i),this.setAuthToken(a.token),a;throw new Error(a.error||"Invalid login response")}catch(a){throw a}}async logout(){try{this._getStoredToken()&&await this.post("/auth/logout")}catch(e){ut.warn("Logout request failed:",e)}finally{this._removeToken(),this.setAuthToken(null),this.cancelAllRequests("User logout"),this.clearCache()}}}const st=new H6;typeof window<"u"&&window.addEventListener("unload",()=>{st.pendingRequests.forEach(t=>{var e,i;(i=(e=t.config)==null?void 0:e.cancelToken)!=null&&i.cancel&&t.config.cancelToken.cancel("Navigation canceled request")})});const Ft=An.create("AuthContext"),cb=b.createContext(),Sn=()=>b.useContext(cb),G6=({children:t})=>{const e=async G=>{try{if(!G){Ft.warn("Received null or undefined user data"),a(null);return}const Q={...G};!Q._id&&Q.id&&(Ft.debug("Converting id field to _id for consistency"),Q._id=Q.id);const z=ae=>ae&&/^[0-9a-fA-F]{24}$/.test(ae.toString());if(Q._id&&!(typeof Q._id=="string"&&z(Q._id))){if(typeof Q._id=="object"&&Q._id!==null)try{const ae=Q._id.toString();z(ae)&&(Ft.debug(`Fixed user ID format: object -> ${ae}`),Q._id=ae)}catch(ae){Ft.error(`Error converting user ID to string: ${ae.message}`)}}if(!Q._id||!z(Q._id)){Ft.warn(`User data has invalid ID format: "${Q._id}"`);try{const ae=sessionStorage.getItem("token")||localStorage.getItem("token");if(ae){const Ee=ae.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),K=JSON.parse(atob(Ee)),q=K.id||K.user&&(K.user._id||K.user.id);q&&z(q)&&(Ft.info(`Using ID from token: ${q}`),Q._id=q)}}catch(ae){Ft.error(`Error extracting ID from token: ${ae.message}`)}!Q._id||z(Q._id)}if(!z(Q._id)){Ft.error(`Failed to obtain valid user ID. Invalid format: "${Q._id}"`),ne.error("Authentication error: Your user profile has an invalid format. Please try logging in again."),a(null),y(!1),qi();return}!Q.id&&Q._id&&(Q.id=Q._id),Ft.debug(`Setting user with ID: ${Q._id}`),a(Q)}catch(Q){Ft.error(`Error in validateAndSetUser: ${Q.message}`),a(null),y(!1)}},[i,a]=b.useState(null),[c,u]=b.useState(!0),[d,h]=b.useState(null),[p,y]=b.useState(!1),[g,w]=b.useState(!1),C=b.useRef(null),j=b.useRef(null),N=b.useRef(null),M=b.useRef(!1),D=b.useCallback(()=>{h(null)},[]),I=b.useCallback(async()=>{if(!i)return console.error("Cannot fix user ID: No user available"),!1;try{const G=z=>z&&/^[0-9a-fA-F]{24}$/.test(z.toString());let Q=null;if(i._id){if(typeof i._id=="string"&&G(i._id))Q=i._id;else if(typeof i._id=="object"&&i._id!==null)try{const ae=i._id.toString().match(/([0-9a-fA-F]{24})/);ae&&ae[1]&&(Q=ae[1],Ft.debug(`Extracted ObjectId from complex object: ${Q}`))}catch(z){Ft.error(`Failed to extract valid ID from object: ${z.message}`)}}if(!Q&&i.id&&G(i.id)&&(Q=i.id,Ft.debug(`Using user.id instead of user._id: ${Q}`)),!Q)try{const z=sessionStorage.getItem("token")||localStorage.getItem("token");if(z){const Pe=z.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),Ee=JSON.parse(atob(Pe)),K=Ee.id||Ee.sub||Ee.user&&(Ee.user._id||Ee.user.id);K&&G(K)&&(Q=K,Ft.info(`Using ID from token payload: ${Q}`))}}catch(z){Ft.error(`Failed to extract ID from token: ${z.message}`)}if(Q){if(Q===i._id){if(Ft.debug("User ID is already in valid format:",Q),!i.id||i.id!==Q){const ae={...i,id:Q};a(ae),Ft.info(`Added missing id field: ${Q}`)}return!0}const z={...i,_id:Q,id:Q};return a(z),Ft.info(`User ID fixed to: ${Q} (was: ${i._id||"undefined"})`),!0}return Ft.error(`Cannot fix user ID format: ${i._id||"undefined"}`),!1}catch(G){return Ft.error(`Error in fixUserIdFormat: ${G.message}`),!1}},[i]),V=b.useCallback(async()=>{u(!0);try{j.current&&(clearTimeout(j.current),j.current=null);try{await st.logout()}catch(G){console.warn("Logout API call failed:",G)}qi(),a(null),y(!1),ne.info("You have been logged out")}catch(G){console.error("Logout error:",G),qi(),a(null),y(!1)}finally{u(!1)}},[]),F=b.useCallback(G=>{j.current&&(clearTimeout(j.current),j.current=null);try{const z=G.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),ae=JSON.parse(atob(z));if(ae.exp){const Pe=ae.exp*1e3,Ee=Date.now(),K=Pe-Ee-5*60*1e3;if(K>6e4){console.log(`Scheduling token refresh in ${Math.round(K/6e4)} minutes`);const q=setTimeout(()=>{O()},K);j.current=q}else console.log("Token expires soon, refreshing now"),O()}}catch(Q){console.error("Error scheduling token refresh:",Q)}},[]),O=b.useCallback(()=>!p&&!Vi()?Promise.resolve(null):(C.current||(C.current=(async()=>{var Q;const G=Vi();if(!G)return null;try{Ft.info("Refreshing auth token...");const z=await st.post("/auth/refresh-token",{token:G},{headers:{"x-no-cache":"true"},_isRefreshRequest:!0});if(z.success&&z.token){const ae=z.token,Pe=localStorage.getItem("token")!==null;Vo(ae,Pe),F(ae);try{const K=(await Pn(()=>Promise.resolve().then(()=>I6),void 0)).getUserIdFromToken(ae);if(K&&(!(i!=null&&i._id)||K!==i._id)&&(Ft.info(`Updating user ID from refreshed token: ${K}`),i)){const q={...i,_id:K,id:K};a(q)}}catch(Ee){Ft.error("Error updating user ID from token:",Ee)}return Ft.info("Token refreshed successfully"),ae}else throw new Error("Invalid refresh response")}catch(z){if(Ft.error("Token refresh failed:",z),C.current=null,((Q=z==null?void 0:z.response)==null?void 0:Q.status)===401||(z==null?void 0:z.status)===401)V();else{const ae=Vi();ae&&Qo(ae)&&(Ft.warn("Token expired, logging out"),ne.error("Your session has expired. Please log in again."),V())}return null}finally{setTimeout(()=>{C.current=null},1e3)}})()),C.current),[p,V,F,i]),A=b.useCallback(async G=>{u(!0),h(null);try{const Q=await st.post("/auth/register",G);if(Q.success){if(Q.token){Vo(Q.token,!0),e(Q.user),y(!0),F(Q.token);try{const z=await st.get("/auth/me");z.success&&z.data&&e(z.data)}catch(z){console.warn("Failed to fetch complete user data:",z)}}return u(!1),!0}else return h(Q.error||"Registration failed"),u(!1),!1}catch(Q){if(console.error("Registration error:",Q),Q.response&&Q.response.data)if(Q.response.data.error){const z=Q.response.data.error;throw h(z),new Error(z)}else if(Q.response.data.errors&&Q.response.data.errors.length>0){const z=Q.response.data.errors[0].msg;throw h(z),new Error(z)}else{const z="Registration failed. Please check your information and try again.";throw h(z),new Error(z)}else{const z=Q.message||Q.error||(Q.code==="EMAIL_EXISTS"?"User already exists":"Network error. Please check your connection and try again.");throw h(z),new Error(z)}}finally{u(!1)}},[F]),H=b.useCallback(async()=>{try{const G=Vi();return G?Qo(G)?(Ft.info("Token is expired, attempting refresh"),!!await O()):(await st.get("/auth/verify")).success?!0:(Ft.warn("Token verification failed, attempting refresh"),!!await O()):!1}catch(G){return Ft.error("Token verification/refresh error:",G),!1}},[V,O]),E=b.useCallback(async(G,Q=!0)=>{u(!0),h(null);try{const z=await st.post("/auth/login",G);if(z.success&&z.token){if(Vo(z.token,Q),F(z.token),z.user){e(z.user),Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([Pe,Ee])=>{var J,re;const K=Pe.default,q=Ee.default;(J=z.user.settings)!=null&&J.notifications?K.initialize(z.user.settings):K.initialize(),(re=z.user.settings)!=null&&re.privacy&&q.updatePrivacySettings(z.user.settings.privacy),console.log("Services initialized with user settings")}).catch(Pe=>{console.error("Failed to initialize services:",Pe)});const ae=z.user.nickname?`Welcome back, ${z.user.nickname}!`:"Welcome back!";ne.success(ae)}else try{const ae=await st.get("/auth/me");if(ae.success&&ae.data){e(ae.data),Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([Ee,K])=>{var re,Ne;const q=Ee.default,J=K.default;(re=ae.data.settings)!=null&&re.notifications?q.initialize(ae.data.settings):q.initialize(),(Ne=ae.data.settings)!=null&&Ne.privacy&&J.updatePrivacySettings(ae.data.settings.privacy),console.log("Services initialized with user settings")}).catch(Ee=>{console.error("Failed to initialize services:",Ee)});const Pe=ae.data.nickname?`Welcome back, ${ae.data.nickname}!`:"Welcome back!";ne.success(Pe)}else ne.success("Welcome back!")}catch(ae){console.error("Error fetching user data:",ae),ne.success("Welcome back!")}return y(!0),z}else throw new Error(z.error||"Login failed")}catch(z){const ae=z.error||z.message||"Login failed";throw h(ae),ne.error(ae),z}finally{u(!1)}},[F]),L=b.useCallback(async()=>{u(!0);try{const G=await st.get("/auth/me");if(G.success)return e(G.data),y(!0),Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([Q,z])=>{var Ee,K;const ae=Q.default,Pe=z.default;(Ee=G.data.settings)!=null&&Ee.notifications?ae.initialize(G.data.settings):ae.initialize(),(K=G.data.settings)!=null&&K.privacy&&Pe.updatePrivacySettings(G.data.settings.privacy),console.log("Services initialized with user settings")}).catch(Q=>{console.error("Failed to initialize services:",Q)}),G.data;throw new Error(G.error||"Failed to get user profile")}catch(G){return console.error("Get current user error:",G),a(null),y(!1),null}finally{u(!1),w(!0),M.current=!0}},[]);b.useEffect(()=>{N.current&&clearTimeout(N.current),N.current=setTimeout(()=>{c&&(console.warn("Auth check timeout - forcing loading state to false"),u(!1),w(!0),M.current=!0,localStorage.getItem("token")&&(console.info("Auth recovery: Setting minimal authenticated state based on token"),y(!0)))},8e3);const G=async()=>{try{if(w(!1),!localStorage.getItem("token")){y(!1),a(null),w(!0),u(!1),M.current=!0,clearTimeout(N.current);return}const z=await st.get("/auth/me");z.success&&z.data?(e(z.data),y(!0)):await H()||(y(!1),a(null),qi())}catch(Q){console.error("Auth check error:",Q),y(!1),a(null),qi()}finally{w(!0),u(!1),M.current=!0,clearTimeout(N.current)}};return M.current||G(),()=>{N.current&&(clearTimeout(N.current),N.current=null)}},[L,O,H]),b.useEffect(()=>()=>{j.current&&clearTimeout(j.current)},[]),b.useEffect(()=>{const G=()=>{j.current&&(clearTimeout(j.current),j.current=null),a(null),y(!1),qi()};return window.addEventListener("authLogout",G),()=>{window.removeEventListener("authLogout",G)}},[]);const P={user:i,loading:c,error:d,isAuthenticated:p,authChecked:g,register:A,login:E,logout:V,refreshToken:O,getCurrentUser:L,clearError:D,fixUserIdFormat:I,token:Vi()};return o.jsx(cb.Provider,{value:P,children:t})},Zs="/stories",vr=new Map,Y6=async()=>{try{const t=await st.get(Zs);return Array.isArray(t)?{success:!0,data:t}:t}catch(t){return console.error("Error fetching stories:",t),{success:!1,message:t.message||"Failed to fetch stories"}}},X6=async t=>{try{const e=await st.get(`${Zs}/user/${t}`);return Array.isArray(e)?{success:!0,data:e}:e}catch(e){return console.error(`Error fetching stories for user ${t}:`,e),{success:!1,message:e.message||"Failed to fetch user stories"}}},K6=async(t,e)=>{const i=`create-story-${Date.now()}`;if(vr.has(i.substring(0,i.length-3)))return console.warn("Duplicate story creation request detected"),{success:!1,message:"A similar request is already in progress"};vr.set(i,!0);try{if(t instanceof FormData)t.append("timestamp",Date.now().toString());else if(typeof t=="object"){if(t.mediaType==="text"||t.type==="text")return ub(t,e);t.timestamp=Date.now()}const a=await st.upload(Zs,t,e);return{success:!0,data:a.data||a,message:"Story created successfully"}}catch(a){return console.error("Error creating story:",a),{success:!1}}finally{setTimeout(()=>{vr.delete(i)},5e3)}},ub=async(t,e)=>{const a=`create-text-story-${t.content?t.content.substring(0,10):""}-${Date.now()}`;if(vr.has(a.substring(0,a.length-3)))return console.warn("Duplicate text story creation request detected"),{success:!1,message:"A similar request is already in progress"};vr.set(a,!0);try{const c={...t,timestamp:Date.now(),type:"text",mediaType:"text"},u=await st.post(`${Zs}/text`,c,{onUploadProgress:e});if(u&&typeof u=="object"){if(u.error)throw new Error(u.error);if(u.success===!1)throw new Error(u.message||"Failed to create text story")}return u.success?{success:!0,data:u.data||u.story,message:"Story created successfully"}:u._id?{success:!0,data:u,message:"Story created successfully"}:u}catch(c){return console.error("Error creating text story:",c),{success:!1,message:c.message||"Failed to create text story"}}finally{setTimeout(()=>{vr.delete(a)},5e3)}},Q6=async t=>{try{const e=await st.delete(`${Zs}/${t}`);return e&&!e.success&&e.msg?{success:!0,message:e.msg}:e}catch(e){return console.error(`Error deleting story ${t}:`,e),{success:!1,message:e.message||"Failed to delete story"}}},W6=async t=>{try{const e=await st.post(`${Zs}/${t}/view`);return e&&!e.success&&e.msg?{success:!0,message:e.msg}:e}catch(e){return console.error(`Error marking story ${t} as viewed:`,e),{success:!1,message:e.message||"Failed to mark story as viewed"}}},Z6=async(t,e)=>{try{const i=await st.post(`${Zs}/${t}/react`,{reactionType:e});return i&&i.data&&!i.success?{success:!0,data:i.data,message:"Reaction added successfully"}:i}catch(i){return console.error(`Error reacting to story ${t}:`,i),{success:!1,message:i.message||"Failed to react to story"}}},J6=async t=>{try{return await st.delete(`${Zs}/${t}/react`)}catch(e){return console.error(`Error removing reaction from story ${t}:`,e),{success:!1,message:e.message||"Failed to remove reaction"}}},e5=async t=>{try{return await st.get(`${Zs}/${t}/reactions`)}catch(e){return console.error(`Error fetching reactions for story ${t}:`,e),{success:!1,message:e.message||"Failed to fetch story reactions"}}},t5=async t=>{try{return await st.get(`${Zs}/${t}/viewers`)}catch(e){return console.error(`Error fetching viewers for story ${t}:`,e),{success:!1,message:e.message||"Failed to fetch story viewers"}}},ga={getAllStories:Y6,getUserStories:X6,createStory:K6,createTextStory:ub,deleteStory:Q6,markStoryAsViewed:W6,reactToStory:Z6,removeReaction:J6,getStoryReactions:e5,getStoryViewers:t5},db=b.createContext(),n5=({children:t})=>{const{user:e,isAuthenticated:i}=Sn(),[a,c]=b.useState([]),[u,d]=b.useState(!1),[h,p]=b.useState(null),[y,g]=b.useState({}),[w,C]=b.useState(0),[j,N]=b.useState(!1),M=b.useRef(null),D=b.useRef(new Map),I=b.useRef(null),V=b.useRef(!1),F=b.useRef(null),O=b.useRef(!1),A=b.useCallback((K,q)=>{let J;return(...re)=>{clearTimeout(J),J=setTimeout(()=>K(...re),q)}},[]),H=b.useCallback(()=>{p(null)},[]),E=b.useCallback(async(K=!1)=>{if(V.current)return I.current&&clearTimeout(I.current),I.current=setTimeout(()=>{I.current=null,E(!0)},1e3),a;const q=Date.now(),J=q-w,re=a.length>0&&J<6e4;if(!K&&re)return a;V.current=!0,d(!0),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{V.current=!1,d(!1),p("Request timeout. Please try again."),F.current=null},3e4);try{const Ne=await ga.getAllStories();if(!Ne.success)throw new Error(Ne.message||"Failed to load stories");if(!Array.isArray(Ne.data))throw new Error("Invalid response format: expected array of stories");const Se=new Map,Ve=[];for(let ge=Ne.data.length-1;ge>=0;ge--){const ee=Ne.data[ge];!ee||!ee._id||Se.has(ee._id)||(Se.set(ee._id,!0),Ve.unshift(ee))}return c(Ve),C(q),p(null),Ve}catch(Ne){return p(Ne.message||"Failed to load stories"),[]}finally{V.current=!1,d(!1),F.current&&(clearTimeout(F.current),F.current=null),I.current&&(clearTimeout(I.current),I.current=null)}},[w,a]),L=b.useMemo(()=>A(K=>{E(K)},300),[E,A]),P=b.useCallback(async K=>{if(!K)return console.error("Cannot load user stories: Missing userId"),[];const q=`loadUserStories-${K}`;if(D.current.has(q))return D.current.get(q);const J=(async()=>{try{d(!0);const re=await ga.getUserStories(K);if(!re.success)throw new Error(re.message||"Failed to load user stories");return Array.isArray(re.data)?[...re.data]:[]}catch(re){return console.error(`Error loading stories for user ${K}:`,re),[]}finally{d(!1),setTimeout(()=>{D.current.delete(q)},300)}})();return D.current.set(q,J),J},[]),G=b.useCallback(async(K,q)=>{if(!e)return ne.error("You must be logged in to create a story"),{success:!1,message:"You must be logged in to create a story"};if(j||O.current)return;if(N(!0),O.current=!0,d(!0),!K||!K.mediaType)return N(!1),O.current=!1,d(!1),ne.error("Invalid story data"),{success:!1,message:"Invalid story data"};const J={...K};if(J.mediaType==="text"&&(J.content=J.content||J.text,!J.content))return N(!1),O.current=!1,d(!1),ne.error("Text stories require content"),{success:!1,message:"Text stories require content"};try{let re;if(J.mediaType==="text"?re=await ga.createTextStory(J,q):re=await ga.createStory(J,q),!re.success)throw new Error(re.message||"Failed to create story");const Ne=re.data||re.story;if(!Ne)throw new Error("Story created but data not returned");return c(Se=>Se.some(Ve=>Ve._id===Ne._id)?Se:[Ne,...Se]),re}catch(re){return console.error("Error creating story:",re),ne.error(re.message||"Failed to create story"),{success:!1,message:re.message||"Failed to create story"}}finally{d(!1),N(!1),setTimeout(()=>{O.current=!1},500)}},[e,j]),Q=b.useCallback(async K=>{if(!e)return ne.error("You must be logged in to delete a story"),{success:!1,message:"You must be logged in to delete a story"};if(!K)return ne.error("Invalid story ID"),{success:!1,message:"Invalid story ID"};const q=`deleteStory-${K}`;if(D.current.has(q))return{success:!1,message:"Delete operation in progress"};const J=(async()=>{try{d(!0);const re=await ga.deleteStory(K);if(!re.success)throw new Error(re.message||"Failed to delete story");return c(Ne=>Ne.filter(Se=>Se._id!==K)),ne.success("Story deleted successfully"),re}catch(re){return console.error(`Error deleting story ${K}:`,re),ne.error(re.message||"Failed to delete story"),{success:!1,message:re.message||"Failed to delete story"}}finally{d(!1),setTimeout(()=>{D.current.delete(q)},300)}})();return D.current.set(q,J),J},[e]),z=b.useCallback(async K=>{if(!e||!K)return!1;const q=`viewStory-${K}`;if(D.current.has(q))return D.current.get(q);if(y[K])return!0;const J=(async()=>{try{const re=await ga.markStoryAsViewed(K);if(!re.success)throw new Error(re.message||"Failed to mark story as viewed");return g(Ne=>({...Ne,[K]:Date.now()})),!0}catch(re){return console.error(`Error marking story ${K} as viewed:`,re),!1}finally{setTimeout(()=>{D.current.delete(q)},300)}})();return D.current.set(q,J),J},[e,y]),ae=b.useCallback(K=>{if(!a||!K||!e)return!1;const q=a.filter(J=>J?(J.user&&(typeof J.user=="string"?J.user:J.user._id))===K:!1);return!q||q.length===0?!1:q.some(J=>!y[J._id])},[a,y,e]),Pe=b.useCallback(async(K,q)=>{if(!e)return ne.error("You must be logged in to react to a story"),{success:!1};if(!K||!q)return ne.error("Invalid story ID or reaction type"),{success:!1,message:"Invalid story ID or reaction type"};const J=`reactToStory-${K}-${q}`;if(D.current.has(J))return D.current.get(J);const re=(async()=>{try{const Ne=await ga.reactToStory(K,q);if(!Ne.success)throw new Error(Ne.message||"Failed to react to story");return ne.success("Reaction added!"),Ne}catch(Ne){return console.error("Error reacting to story:",Ne),ne.error(Ne.message||"Failed to add reaction"),{success:!1}}finally{setTimeout(()=>{D.current.delete(J)},300)}})();return D.current.set(J,re),re},[e]);b.useEffect(()=>{if(e)try{const K=`viewedStories_${e._id}`,q=localStorage.getItem(K);if(q){const J=JSON.parse(q);J&&typeof J=="object"&&g(J)}}catch(K){console.error("Error parsing viewed stories from localStorage:",K),g({})}},[e]),b.useEffect(()=>{if(!e||Object.keys(y).length===0)return;const K=`viewedStories_${e._id}`;return A(()=>{try{localStorage.setItem(K,JSON.stringify(y))}catch(J){console.error("Error saving viewed stories to localStorage:",J)}},1e3)(),()=>{try{localStorage.setItem(K,JSON.stringify(y))}catch(J){console.error("Error saving viewed stories to localStorage on unmount:",J)}}},[y,e,A]),b.useEffect(()=>{if(M.current&&(clearInterval(M.current),M.current=null),!i)return;const K=setTimeout(()=>{i&&L(!1)},1e3),q=setInterval(()=>{document.visibilityState==="visible"&&!V.current&&L(!0)},5*60*1e3);return M.current=q,()=>{clearTimeout(K),M.current&&(clearInterval(M.current),M.current=null),I.current&&(clearTimeout(I.current),I.current=null),F.current&&(clearTimeout(F.current),F.current=null)}},[i,L]);const Ee=b.useMemo(()=>({stories:a,loading:u,error:h,clearError:H,loadStories:E,loadUserStories:P,createStory:G,deleteStory:Q,viewStory:z,reactToStory:Pe,hasUnviewedStories:ae,viewedStories:y}),[a,u,h,H,E,P,G,Q,z,Pe,ae,y]);return o.jsx(db.Provider,{value:Ee,children:t})},Lr=()=>{const t=b.useContext(db);return t===void 0?(console.warn("useStories must be used within a StoriesProvider"),null):t};function fb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(t)}function hb(t){return Fe({attr:{viewBox:"0 0 488 512"},child:[{tag:"path",attr:{d:"M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z"},child:[]}]})(t)}function br(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(t)}function xr(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M190.5 66.9l22.2-22.2c9.4-9.4 24.6-9.4 33.9 0L441 239c9.4 9.4 9.4 24.6 0 33.9L246.6 467.3c-9.4 9.4-24.6 9.4-33.9 0l-22.2-22.2c-9.5-9.5-9.3-25 .4-34.3L311.4 296H24c-13.3 0-24-10.7-24-24v-32c0-13.3 10.7-24 24-24h287.4L190.9 101.2c-9.8-9.3-10-24.8-.4-34.3z"},child:[]}]})(t)}function s5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"},child:[]}]})(t)}function dh(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.034 8 8 119.033 8 256s111.034 248 248 248 248-111.034 248-248S392.967 8 256 8zm130.108 117.892c65.448 65.448 70 165.481 20.677 235.637L150.47 105.216c70.204-49.356 170.226-44.735 235.638 20.676zM125.892 386.108c-65.448-65.448-70-165.481-20.677-235.637L361.53 406.784c-70.203 49.356-170.226 44.736-235.638-20.676z"},child:[]}]})(t)}function i5(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-90.62-70.05c.19-1.38.8-2.66.8-4.06.05-7.55-2.61-15.27-8.61-21.71-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84c-40.33 8.38-74.66 31.07-97.59 62.57L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.35 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.42-6.97 4.17-17.02-2.81-22.45zM157.23 251.54c-8.61 67.96-36.41 93.33-52.62 110.75-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h241.92L157.23 251.54zM320 512c35.32 0 63.97-28.65 63.97-64H256.03c0 35.35 28.65 64 63.97 64z"},child:[]}]})(t)}function Nr(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z"},child:[]}]})(t)}function Hh(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M0 464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V192H0v272zm320-196c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM192 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40zM64 268c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zm0 128c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12H76c-6.6 0-12-5.4-12-12v-40zM400 64h-48V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H160V16c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v48H48C21.5 64 0 85.5 0 112v48h448v-48c0-26.5-21.5-48-48-48z"},child:[]}]})(t)}function Wo(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z"},child:[]}]})(t)}function a5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 174.8l-39.6-39.6c-9.4-9.4-24.6-9.4-33.9 0L192 374.7 80.6 263.2c-9.4-9.4-24.6-9.4-33.9 0L7 302.9c-9.4 9.4-9.4 24.6 0 34L175 505c9.4 9.4 24.6 9.4 33.9 0l296-296.2c9.4-9.5 9.4-24.7.1-34zm-324.3 106c6.2 6.3 16.4 6.3 22.6 0l208-208.2c6.2-6.3 6.2-16.4 0-22.6L366.1 4.7c-6.2-6.3-16.4-6.3-22.6 0L192 156.2l-55.4-55.5c-6.2-6.3-16.4-6.3-22.6 0L68.7 146c-6.2 6.3-6.2 16.4 0 22.6l112 112.2z"},child:[]}]})(t)}function Lt(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"},child:[]}]})(t)}function Sc(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"},child:[]}]})(t)}function Gh(t){return Fe({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M34.52 239.03L228.87 44.69c9.37-9.37 24.57-9.37 33.94 0l22.67 22.67c9.36 9.36 9.37 24.52.04 33.9L131.49 256l154.02 154.75c9.34 9.38 9.32 24.54-.04 33.9l-22.67 22.67c-9.37 9.37-24.57 9.37-33.94 0L34.52 272.97c-9.37-9.37-9.37-24.57 0-33.94z"},child:[]}]})(t)}function mb(t){return Fe({attr:{viewBox:"0 0 320 512"},child:[{tag:"path",attr:{d:"M285.476 272.971L91.132 467.314c-9.373 9.373-24.569 9.373-33.941 0l-22.667-22.667c-9.357-9.357-9.375-24.522-.04-33.901L188.505 256 34.484 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L285.475 239.03c9.373 9.372 9.373 24.568.001 33.941z"},child:[]}]})(t)}function jc(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"},child:[]}]})(t)}function r5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"},child:[]}]})(t)}function O0(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"},child:[]}]})(t)}function Ta(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"},child:[]}]})(t)}function o5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M4.686 427.314L104 328l-32.922-31.029C55.958 281.851 66.666 256 88.048 256h112C213.303 256 224 266.745 224 280v112c0 21.382-25.803 32.09-40.922 16.971L152 376l-99.314 99.314c-6.248 6.248-16.379 6.248-22.627 0L4.686 449.941c-6.248-6.248-6.248-16.379 0-22.627zM443.314 84.686L344 184l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C234.697 256 224 245.255 224 232V120c0-21.382 25.803-32.09 40.922-16.971L296 136l99.314-99.314c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.248 6.248 6.248 16.379 0 22.627z"},child:[]}]})(t)}function gb(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M528 448H112c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h416c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm64-320c-26.5 0-48 21.5-48 48 0 7.1 1.6 13.7 4.4 19.8L476 239.2c-15.4 9.2-35.3 4-44.2-11.6L350.3 85C361 76.2 368 63 368 48c0-26.5-21.5-48-48-48s-48 21.5-48 48c0 15 7 28.2 17.7 37l-81.5 142.6c-8.9 15.6-28.9 20.8-44.2 11.6l-72.3-43.4c2.7-6 4.4-12.7 4.4-19.8 0-26.5-21.5-48-48-48S0 149.5 0 176s21.5 48 48 48c2.6 0 5.2-.4 7.7-.8L128 416h384l72.3-192.8c2.5.4 5.1.8 7.7.8 26.5 0 48-21.5 48-48s-21.5-48-48-48z"},child:[]}]})(t)}function pb(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(t)}function yb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"},child:[]}]})(t)}function l5(t){return Fe({attr:{viewBox:"0 0 192 512"},child:[{tag:"path",attr:{d:"M96 184c39.8 0 72 32.2 72 72s-32.2 72-72 72-72-32.2-72-72 32.2-72 72-72zM24 80c0 39.8 32.2 72 72 72s72-32.2 72-72S135.8 8 96 8 24 40.2 24 80zm0 352c0 39.8 32.2 72 72 72s72-32.2 72-72-32.2-72-72-72-72 32.2-72 72z"},child:[]}]})(t)}function c5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M512 464c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V200.724a48 48 0 0 1 18.387-37.776c24.913-19.529 45.501-35.365 164.2-121.511C199.412 29.17 232.797-.347 256 .003c23.198-.354 56.596 29.172 73.413 41.433 118.687 86.137 139.303 101.995 164.2 121.512A48 48 0 0 1 512 200.724V464zm-65.666-196.605c-2.563-3.728-7.7-4.595-11.339-1.907-22.845 16.873-55.462 40.705-105.582 77.079-16.825 12.266-50.21 41.781-73.413 41.43-23.211.344-56.559-29.143-73.413-41.43-50.114-36.37-82.734-60.204-105.582-77.079-3.639-2.688-8.776-1.821-11.339 1.907l-9.072 13.196a7.998 7.998 0 0 0 1.839 10.967c22.887 16.899 55.454 40.69 105.303 76.868 20.274 14.781 56.524 47.813 92.264 47.573 35.724.242 71.961-32.771 92.263-47.573 49.85-36.179 82.418-59.97 105.303-76.868a7.998 7.998 0 0 0 1.839-10.967l-9.071-13.196z"},child:[]}]})(t)}function Yh(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(t)}function D0(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(t)}function Kt(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(t)}function u5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M212.686 315.314L120 408l32.922 31.029c15.12 15.12 4.412 40.971-16.97 40.971h-112C10.697 480 0 469.255 0 456V344c0-21.382 25.803-32.09 40.922-16.971L72 360l92.686-92.686c6.248-6.248 16.379-6.248 22.627 0l25.373 25.373c6.249 6.248 6.249 16.378 0 22.627zm22.628-118.628L328 104l-32.922-31.029C279.958 57.851 290.666 32 312.048 32h112C437.303 32 448 42.745 448 56v112c0 21.382-25.803 32.09-40.922 16.971L376 152l-92.686 92.686c-6.248 6.248-16.379 6.248-22.627 0l-25.373-25.373c-6.249-6.248-6.249-16.378 0-22.627z"},child:[]}]})(t)}function vb(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M320 400c-75.85 0-137.25-58.71-142.9-133.11L72.2 185.82c-13.79 17.3-26.48 35.59-36.72 55.59a32.35 32.35 0 0 0 0 29.19C89.71 376.41 197.07 448 320 448c26.91 0 52.87-4 77.89-10.46L346 397.39a144.13 144.13 0 0 1-26 2.61zm313.82 58.1l-110.55-85.44a331.25 331.25 0 0 0 81.25-102.07 32.35 32.35 0 0 0 0-29.19C550.29 135.59 442.93 64 320 64a308.15 308.15 0 0 0-147.32 37.7L45.46 3.37A16 16 0 0 0 23 6.18L3.37 31.45A16 16 0 0 0 6.18 53.9l588.36 454.73a16 16 0 0 0 22.46-2.81l19.64-25.27a16 16 0 0 0-2.82-22.45zm-183.72-142l-39.3-30.38A94.75 94.75 0 0 0 416 256a94.76 94.76 0 0 0-121.31-92.21A47.65 47.65 0 0 1 304 192a46.64 46.64 0 0 1-1.54 10l-73.61-56.89A142.31 142.31 0 0 1 320 112a143.92 143.92 0 0 1 144 144c0 21.63-5.29 41.79-13.9 60.11z"},child:[]}]})(t)}function wr(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(t)}function B0(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function z0(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm-64 268c0 10.7-12.9 16-20.5 8.5L104 376H76c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h28l35.5-36.5c7.6-7.6 20.5-2.2 20.5 8.5v136zm33.2-47.6c9.1-9.3 9.1-24.1 0-33.4-22.1-22.8 12.2-56.2 34.4-33.5 27.2 27.9 27.2 72.4 0 100.4-21.8 22.3-56.9-10.4-34.4-33.5zm86-117.1c54.4 55.9 54.4 144.8 0 200.8-21.8 22.4-57-10.3-34.4-33.5 36.2-37.2 36.3-96.5 0-133.8-22.1-22.8 12.3-56.3 34.4-33.5zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function P0(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"},child:[]}]})(t)}function $0(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M384 121.941V128H256V0h6.059c6.365 0 12.47 2.529 16.971 7.029l97.941 97.941A24.005 24.005 0 0 1 384 121.941zM224 136V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248c-13.2 0-24-10.8-24-24zm96 144.016v111.963c0 21.445-25.943 31.998-40.971 16.971L224 353.941V392c0 13.255-10.745 24-24 24H88c-13.255 0-24-10.745-24-24V280c0-13.255 10.745-24 24-24h112c13.255 0 24 10.745 24 24v38.059l55.029-55.013c15.011-15.01 40.971-4.491 40.971 16.97z"},child:[]}]})(t)}function d5(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function Xh(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"},child:[]}]})(t)}function bb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M349.565 98.783C295.978 98.783 251.721 64 184.348 64c-24.955 0-47.309 4.384-68.045 12.013a55.947 55.947 0 0 0 3.586-23.562C118.117 24.015 94.806 1.206 66.338.048 34.345-1.254 8 24.296 8 56c0 19.026 9.497 35.825 24 45.945V488c0 13.255 10.745 24 24 24h16c13.255 0 24-10.745 24-24v-94.4c28.311-12.064 63.582-22.122 114.435-22.122 53.588 0 97.844 34.783 165.217 34.783 48.169 0 86.667-16.294 122.505-40.858C506.84 359.452 512 349.571 512 339.045v-243.1c0-23.393-24.269-38.87-45.485-29.016-34.338 15.948-76.454 31.854-116.95 31.854z"},child:[]}]})(t)}function U0(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 416h-23.41L277.88 53.69A32 32 0 0 0 247.58 32h-47.16a32 32 0 0 0-30.3 21.69L39.41 416H16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16h-19.58l23.3-64h152.56l23.3 64H304a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h128a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM176.85 272L224 142.51 271.15 272z"},child:[]}]})(t)}function vi(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"},child:[]}]})(t)}function du(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 448H48c-26.51 0-48-21.49-48-48V112c0-26.51 21.49-48 48-48h416c26.51 0 48 21.49 48 48v288c0 26.51-21.49 48-48 48zM112 120c-30.928 0-56 25.072-56 56s25.072 56 56 56 56-25.072 56-56-25.072-56-56-56zM64 384h384V272l-87.515-87.515c-4.686-4.686-12.284-4.686-16.971 0L208 320l-55.515-55.515c-4.686-4.686-12.284-4.686-16.971 0L64 336v48z"},child:[]}]})(t)}function f5(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M567.938 243.908L462.25 85.374A48.003 48.003 0 0 0 422.311 64H153.689a48 48 0 0 0-39.938 21.374L8.062 243.908A47.994 47.994 0 0 0 0 270.533V400c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V270.533a47.994 47.994 0 0 0-8.062-26.625zM162.252 128h251.497l85.333 128H376l-32 64H232l-32-64H76.918l85.334-128z"},child:[]}]})(t)}function h5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M80 368H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm0-320H16A16 16 0 0 0 0 64v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16V64a16 16 0 0 0-16-16zm0 160H16a16 16 0 0 0-16 16v64a16 16 0 0 0 16 16h64a16 16 0 0 0 16-16v-64a16 16 0 0 0-16-16zm416 176H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zm0-320H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16zm0 160H176a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h320a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16z"},child:[]}]})(t)}function m5(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M423.5 0C339.5.3 272 69.5 272 153.5V224H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48h-48v-71.1c0-39.6 31.7-72.5 71.3-72.9 40-.4 72.7 32.1 72.7 72v80c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24v-80C576 68 507.5-.3 423.5 0z"},child:[]}]})(t)}function Ss(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M400 224h-24v-72C376 68.2 307.8 0 224 0S72 68.2 72 152v72H48c-26.5 0-48 21.5-48 48v192c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V272c0-26.5-21.5-48-48-48zm-104 0H152v-72c0-39.7 32.3-72 72-72s72 32.3 72 72v72z"},child:[]}]})(t)}function Tr(t){return Fe({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(t)}function I0(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.82 458.1l-157.8-121.96C488.61 312.13 496 285.01 496 256v-48c0-8.84-7.16-16-16-16h-16c-8.84 0-16 7.16-16 16v48c0 17.92-3.96 34.8-10.72 50.2l-26.55-20.52c3.1-9.4 5.28-19.22 5.28-29.67V96c0-53.02-42.98-96-96-96s-96 42.98-96 96v45.36L45.47 3.37C38.49-2.05 28.43-.8 23.01 6.18L3.37 31.45C-2.05 38.42-.8 48.47 6.18 53.9l588.36 454.73c6.98 5.43 17.03 4.17 22.46-2.81l19.64-25.27c5.41-6.97 4.16-17.02-2.82-22.45zM400 464h-56v-33.77c11.66-1.6 22.85-4.54 33.67-8.31l-50.11-38.73c-6.71.4-13.41.87-20.35.2-55.85-5.45-98.74-48.63-111.18-101.85L144 241.31v6.85c0 89.64 63.97 169.55 152 181.69V464h-56c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function g5(t){return Fe({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M176 352c53.02 0 96-42.98 96-96V96c0-53.02-42.98-96-96-96S80 42.98 80 96v160c0 53.02 42.98 96 96 96zm160-160h-16c-8.84 0-16 7.16-16 16v48c0 74.8-64.49 134.82-140.79 127.38C96.71 376.89 48 317.11 48 250.3V208c0-8.84-7.16-16-16-16H16c-8.84 0-16 7.16-16 16v40.16c0 89.64 63.97 169.55 152 181.69V464H96c-8.84 0-16 7.16-16 16v16c0 8.84 7.16 16 16 16h160c8.84 0 16-7.16 16-16v-16c0-8.84-7.16-16-16-16h-56v-33.77C285.71 418.47 352 344.9 352 256v-48c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function p5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 0 0 283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"},child:[]}]})(t)}function fh(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M204.3 5C104.9 24.4 24.8 104.3 5.2 203.4c-37 187 131.7 326.4 258.8 306.7 41.2-6.4 61.4-54.6 42.5-91.7-23.1-45.4 9.9-98.4 60.9-98.4h79.7c35.8 0 64.8-29.6 64.9-65.3C511.5 97.1 368.1-26.9 204.3 5zM96 320c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm32-128c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128-64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 64c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z"},child:[]}]})(t)}function y5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(t)}function v5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M43.246 466.142c-58.43-60.289-57.341-157.511 1.386-217.581L254.392 34c44.316-45.332 116.351-45.336 160.671 0 43.89 44.894 43.943 117.329 0 162.276L232.214 383.128c-29.855 30.537-78.633 30.111-107.982-.998-28.275-29.97-27.368-77.473 1.452-106.953l143.743-146.835c6.182-6.314 16.312-6.422 22.626-.241l22.861 22.379c6.315 6.182 6.422 16.312.241 22.626L171.427 319.927c-4.932 5.045-5.236 13.428-.648 18.292 4.372 4.634 11.245 4.711 15.688.165l182.849-186.851c19.613-20.062 19.613-52.725-.011-72.798-19.189-19.627-49.957-19.637-69.154 0L90.39 293.295c-34.763 35.56-35.299 93.12-1.191 128.313 34.01 35.093 88.985 35.137 123.058.286l172.06-175.999c6.177-6.319 16.307-6.433 22.626-.256l22.877 22.364c6.319 6.177 6.434 16.307.256 22.626l-172.06 175.998c-59.576 60.938-155.943 60.216-214.77-.485z"},child:[]}]})(t)}function b5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"},child:[]}]})(t)}function Qc(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M268.2 381.4l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48c-10.7 4.6-16.5 16.1-13.9 27.5l24 104c2.5 10.8 12.1 18.6 23.4 18.6 100.7 0 193.7-32.4 269.7-86.9l-80-61.8c-10.9 6.5-22.1 12.7-33.6 18.1zm365.6 76.7L475.1 335.5C537.9 256.4 576 156.9 576 48c0-11.2-7.7-20.9-18.6-23.4l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-12.2 26.1-27.9 50.3-46 72.8L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4l588.4 454.7c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.4-6.8 4.1-16.9-2.9-22.3z"},child:[]}]})(t)}function x5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(t)}function Lo(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"},child:[]}]})(t)}function xb(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(t)}function w5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function Kh(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}function _5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M503.691 189.836L327.687 37.851C312.281 24.546 288 35.347 288 56.015v80.053C127.371 137.907 0 170.1 0 322.326c0 61.441 39.581 122.309 83.333 154.132 13.653 9.931 33.111-2.533 28.077-18.631C66.066 312.814 132.917 274.316 288 272.085V360c0 20.7 24.3 31.453 39.687 18.164l176.004-152c11.071-9.562 11.086-26.753 0-36.328z"},child:[]}]})(t)}function S5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M466.5 83.7l-192-80a48.15 48.15 0 0 0-36.9 0l-192 80C27.7 91.1 16 108.6 16 128c0 198.5 114.5 335.7 221.5 380.3 11.8 4.9 25.1 4.9 36.9 0C360.1 472.6 496 349.3 496 128c0-19.4-11.7-36.9-29.5-44.3zM256.1 446.3l-.1-381 175.9 73.3c-3.3 151.4-82.1 261.1-175.8 307.7z"},child:[]}]})(t)}function j5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"},child:[]}]})(t)}function C5(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M216 288h-48c-8.84 0-16 7.16-16 16v192c0 8.84 7.16 16 16 16h48c8.84 0 16-7.16 16-16V304c0-8.84-7.16-16-16-16zM88 384H40c-8.84 0-16 7.16-16 16v96c0 8.84 7.16 16 16 16h48c8.84 0 16-7.16 16-16v-96c0-8.84-7.16-16-16-16zm256-192h-48c-8.84 0-16 7.16-16 16v288c0 8.84 7.16 16 16 16h48c8.84 0 16-7.16 16-16V208c0-8.84-7.16-16-16-16zm128-96h-48c-8.84 0-16 7.16-16 16v384c0 8.84 7.16 16 16 16h48c8.84 0 16-7.16 16-16V112c0-8.84-7.16-16-16-16zM600 0h-48c-8.84 0-16 7.16-16 16v480c0 8.84 7.16 16 16 16h48c8.84 0 16-7.16 16-16V16c0-8.84-7.16-16-16-16z"},child:[]}]})(t)}function N5(t){return Fe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm80 168c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zm-160 0c17.7 0 32 14.3 32 32s-14.3 32-32 32-32-14.3-32-32 14.3-32 32-32zm194.8 170.2C334.3 380.4 292.5 400 248 400s-86.3-19.6-114.8-53.8c-13.6-16.3 11-36.7 24.6-20.5 22.4 26.9 55.2 42.2 90.2 42.2s67.8-15.4 90.2-42.2c13.4-16.2 38.1 4.2 24.6 20.5z"},child:[]}]})(t)}function ws(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(t)}function T5(t){return Fe({attr:{viewBox:"0 0 480 512"},child:[{tag:"path",attr:{d:"M471.99 334.43L336.06 256l135.93-78.43c7.66-4.42 10.28-14.2 5.86-21.86l-32.02-55.43c-4.42-7.65-14.21-10.28-21.87-5.86l-135.93 78.43V16c0-8.84-7.17-16-16.01-16h-64.04c-8.84 0-16.01 7.16-16.01 16v156.86L56.04 94.43c-7.66-4.42-17.45-1.79-21.87 5.86L2.15 155.71c-4.42 7.65-1.8 17.44 5.86 21.86L143.94 256 8.01 334.43c-7.66 4.42-10.28 14.21-5.86 21.86l32.02 55.43c4.42 7.65 14.21 10.27 21.87 5.86l135.93-78.43V496c0 8.84 7.17 16 16.01 16h64.04c8.84 0 16.01-7.16 16.01-16V339.14l135.93 78.43c7.66 4.42 17.45 1.8 21.87-5.86l32.02-55.43c4.42-7.65 1.8-17.43-5.86-21.85z"},child:[]}]})(t)}function k5(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"},child:[]}]})(t)}function E5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"},child:[]}]})(t)}function F0(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M370.72 133.28C339.458 104.008 298.888 87.962 255.848 88c-77.458.068-144.328 53.178-162.791 126.85-1.344 5.363-6.122 9.15-11.651 9.15H24.103c-7.498 0-13.194-6.807-11.807-14.176C33.933 94.924 134.813 8 256 8c66.448 0 126.791 26.136 171.315 68.685L463.03 40.97C478.149 25.851 504 36.559 504 57.941V192c0 13.255-10.745 24-24 24H345.941c-21.382 0-32.09-25.851-16.971-40.971l41.75-41.749zM32 296h134.059c21.382 0 32.09 25.851 16.971 40.971l-41.75 41.75c31.262 29.273 71.835 45.319 114.876 45.28 77.418-.07 144.315-53.144 162.787-126.849 1.344-5.363 6.122-9.15 11.651-9.15h57.304c7.498 0 13.194 6.807 11.807 14.176C478.067 417.076 377.187 504 256 504c-66.448 0-126.791-26.136-171.315-68.685L48.97 471.03C33.851 486.149 8 475.441 8 454.059V320c0-13.255 10.745-24 24-24z"},child:[]}]})(t)}function wb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M440.65 12.57l4 82.77A247.16 247.16 0 0 0 255.83 8C134.73 8 33.91 94.92 12.29 209.82A12 12 0 0 0 24.09 224h49.05a12 12 0 0 0 11.67-9.26 175.91 175.91 0 0 1 317-56.94l-101.46-4.86a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12H500a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12h-47.37a12 12 0 0 0-11.98 12.57zM255.83 432a175.61 175.61 0 0 1-146-77.8l101.8 4.87a12 12 0 0 0 12.57-12v-47.4a12 12 0 0 0-12-12H12a12 12 0 0 0-12 12V500a12 12 0 0 0 12 12h47.35a12 12 0 0 0 12-12.6l-4.15-82.57A247.17 247.17 0 0 0 255.83 504c121.11 0 221.93-86.92 243.55-201.82a12 12 0 0 0-11.8-14.18h-49.05a12 12 0 0 0-11.67 9.26A175.86 175.86 0 0 1 255.83 432z"},child:[]}]})(t)}function A5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M296 32h192c13.255 0 24 10.745 24 24v160c0 13.255-10.745 24-24 24H296c-13.255 0-24-10.745-24-24V56c0-13.255 10.745-24 24-24zm-80 0H24C10.745 32 0 42.745 0 56v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V56c0-13.255-10.745-24-24-24zM0 296v160c0 13.255 10.745 24 24 24h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H24c-13.255 0-24 10.745-24 24zm296 184h192c13.255 0 24-10.745 24-24V296c0-13.255-10.745-24-24-24H296c-13.255 0-24 10.745-24 24v160c0 13.255 10.745 24 24 24z"},child:[]}]})(t)}function Vn(t){return Fe({attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(t)}function _r(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(t)}function _b(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M552 64H448V24c0-13.3-10.7-24-24-24H152c-13.3 0-24 10.7-24 24v40H24C10.7 64 0 74.7 0 88v56c0 35.7 22.5 72.4 61.9 100.7 31.5 22.7 69.8 37.1 110 41.7C203.3 338.5 240 360 240 360v72h-48c-35.3 0-64 20.7-64 56v12c0 6.6 5.4 12 12 12h296c6.6 0 12-5.4 12-12v-12c0-35.3-28.7-56-64-56h-48v-72s36.7-21.5 68.1-73.6c40.3-4.6 78.6-19 110-41.7 39.3-28.3 61.9-65 61.9-100.7V88c0-13.3-10.7-24-24-24zM99.3 192.8C74.9 175.2 64 155.6 64 144v-16h64.2c1 32.6 5.8 61.2 12.8 86.2-15.1-5.2-29.2-12.4-41.7-21.4zM512 144c0 16.1-17.7 36.1-35.3 48.8-12.5 9-26.7 16.2-41.8 21.4 7-25 11.8-53.6 12.8-86.2H512v16z"},child:[]}]})(t)}function R5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"},child:[]}]})(t)}function Cc(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"},child:[]}]})(t)}function Zo(t){return Fe({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"},child:[]}]})(t)}function Bc(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(t)}function M5(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M96 224c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm448 0c35.3 0 64-28.7 64-64s-28.7-64-64-64-64 28.7-64 64 28.7 64 64 64zm32 32h-64c-17.6 0-33.5 7.1-45.1 18.6 40.3 22.1 68.9 62 75.1 109.4h66c17.7 0 32-14.3 32-32v-32c0-35.3-28.7-64-64-64zm-256 0c61.9 0 112-50.1 112-112S381.9 32 320 32 208 82.1 208 144s50.1 112 112 112zm76.8 32h-8.3c-20.8 10-43.9 16-68.5 16s-47.6-6-68.5-16h-8.3C179.6 288 128 339.6 128 403.2V432c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48v-28.8c0-63.6-51.6-115.2-115.2-115.2zm-223.7-13.4C161.5 263.1 145.6 256 128 256H64c-35.3 0-64 28.7-64 64v32c0 17.7 14.3 32 32 32h65.9c6.3-47.4 34.9-87.3 75.2-109.4z"},child:[]}]})(t)}function L5(t){return Fe({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M633.8 458.1l-55-42.5c15.4-1.4 29.2-13.7 29.2-31.1v-257c0-25.5-29.1-40.4-50.4-25.8L448 177.3v137.2l-32-24.7v-178c0-26.4-21.4-47.8-47.8-47.8H123.9L45.5 3.4C38.5-2 28.5-.8 23 6.2L3.4 31.4c-5.4 7-4.2 17 2.8 22.4L42.7 82 416 370.6l178.5 138c7 5.4 17 4.2 22.5-2.8l19.6-25.3c5.5-6.9 4.2-17-2.8-22.4zM32 400.2c0 26.4 21.4 47.8 47.8 47.8h288.4c11.2 0 21.4-4 29.6-10.5L32 154.7v245.5z"},child:[]}]})(t)}function xa(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z"},child:[]}]})(t)}function O5(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zM461.64 256l45.64-45.64c6.3-6.3 6.3-16.52 0-22.82l-22.82-22.82c-6.3-6.3-16.52-6.3-22.82 0L416 210.36l-45.64-45.64c-6.3-6.3-16.52-6.3-22.82 0l-22.82 22.82c-6.3 6.3-6.3 16.52 0 22.82L370.36 256l-45.63 45.63c-6.3 6.3-6.3 16.52 0 22.82l22.82 22.82c6.3 6.3 16.52 6.3 22.82 0L416 301.64l45.64 45.64c6.3 6.3 16.52 6.3 22.82 0l22.82-22.82c6.3-6.3 6.3-16.52 0-22.82L461.64 256z"},child:[]}]})(t)}function D5(t){return Fe({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(t)}function Sb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"},child:[]}]})(t)}function jb(t){return Fe({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M458.4 64.3C400.6 15.7 311.3 23 256 79.3 200.7 23 111.4 15.6 53.6 64.3-21.6 127.6-10.6 230.8 43 285.5l175.4 178.7c10 10.2 23.4 15.9 37.6 15.9 14.3 0 27.6-5.6 37.6-15.8L469 285.6c53.5-54.7 64.7-157.9-10.6-221.3zm-23.6 187.5L259.4 430.5c-2.4 2.4-4.4 2.4-6.8 0L77.2 251.8c-36.5-37.2-43.9-107.6 7.3-150.7 38.9-32.7 98.9-27.8 136.5 10.5l35 35.7 35-35.7c37.8-38.5 97.8-43.2 136.5-10.6 51.1 43.1 43.5 113.9 7.3 150.8z"},child:[]}]})(t)}function B5(t){return Fe({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M268 416h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12zM432 80h-82.41l-34-56.7A48 48 0 0 0 274.41 0H173.59a48 48 0 0 0-41.16 23.3L98.41 80H16A16 16 0 0 0 0 96v16a16 16 0 0 0 16 16h16v336a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128h16a16 16 0 0 0 16-16V96a16 16 0 0 0-16-16zM171.84 50.91A6 6 0 0 1 177 48h94a6 6 0 0 1 5.15 2.91L293.61 80H154.39zM368 464H80V128h288zm-212-48h24a12 12 0 0 0 12-12V188a12 12 0 0 0-12-12h-24a12 12 0 0 0-12 12v216a12 12 0 0 0 12 12z"},child:[]}]})(t)}const Cb=b.createContext(),z5=(t,e)=>{switch(e.type){case"SET_LOADING":return{...t,loading:e.payload};case"GET_USERS":return{...t,users:e.payload,loading:!1};case"APPEND_USERS":return{...t,users:[...t.users,...e.payload],loading:!1};case"GET_USER":return{...t,currentUser:e.payload.user,messages:e.payload.messages,loading:!1};case"USER_ONLINE":return{...t,users:t.users.map(a=>a._id===e.payload.userId?{...a,isOnline:!0,lastActive:Date.now()}:a),currentUser:t.currentUser&&t.currentUser._id===e.payload.userId?{...t.currentUser,isOnline:!0,lastActive:Date.now()}:t.currentUser};case"USER_OFFLINE":return{...t,users:t.users.map(a=>a._id===e.payload.userId?{...a,isOnline:!1,lastActive:Date.now()}:a),currentUser:t.currentUser&&t.currentUser._id===e.payload.userId?{...t.currentUser,isOnline:!1,lastActive:Date.now()}:t.currentUser};case"UPLOAD_PHOTO":return{...t,currentUser:t.currentUser?{...t.currentUser,photos:[...t.currentUser.photos||[],e.payload]}:t.currentUser,uploadingPhoto:!1};case"UPLOADING_PHOTO":return{...t,uploadingPhoto:!0};case"PHOTO_PERMISSION_REQUESTED":return{...t,photoPermissions:[...t.photoPermissions,e.payload]};case"PHOTO_PERMISSION_UPDATED":return{...t,photoPermissions:t.photoPermissions.map(a=>a._id===e.payload._id?e.payload:a)};case"UPDATE_PROFILE":const i={...t.currentUser};if(Object.keys(e.payload).forEach(a=>{a!=="settings"&&(i[a]=e.payload[a])}),e.payload.settings){if(i.settings||(i.settings={}),e.payload.settings.notifications){const a={},c=e.payload.settings.notifications;"messages"in c&&(a.messages=c.messages===!1?!1:!!c.messages),"calls"in c&&(a.calls=c.calls===!1?!1:!!c.calls),"stories"in c&&(a.stories=c.stories===!1?!1:!!c.stories),"likes"in c&&(a.likes=c.likes===!1?!1:!!c.likes),"comments"in c&&(a.comments=c.comments===!1?!1:!!c.comments),"photoRequests"in c&&(a.photoRequests=c.photoRequests===!1?!1:!!c.photoRequests),console.log("Normalized notification settings for user update:",a),i.settings.notifications={...i.settings.notifications||{},...a}}e.payload.settings.privacy&&(i.settings.privacy={...i.settings.privacy||{},...e.payload.settings.privacy}),console.log("Merged settings in user reducer:",i.settings)}return{...t,currentUser:i,updatingProfile:!1};case"UPDATING_PROFILE":return{...t,updatingProfile:!0};case"SET_LIKED_USERS":return{...t,likedUsers:e.payload};case"ADD_LIKED_USER":return t.likedUsers.some(a=>a.recipient&&a.recipient._id&&a.recipient._id===e.payload.recipient||a.recipient===e.payload.recipient)?t:{...t,likedUsers:[...t.likedUsers,e.payload]};case"REMOVE_LIKED_USER":return{...t,likedUsers:t.likedUsers.filter(a=>typeof a.recipient=="object"&&a.recipient!==null?a.recipient._id!==e.payload:a.recipient!==e.payload)};case"SET_LIKES_LOADING":return{...t,likesLoading:e.payload};case"USER_ERROR":return ne.error(e.payload),{...t,error:e.payload,loading:!1,uploadingPhoto:!1,updatingProfile:!1,likesLoading:!1};case"CLEAR_ERROR":return{...t,error:null};default:return t}},P5={users:[],currentUser:null,messages:[],photoPermissions:[],loading:!1,uploadingPhoto:!1,updatingProfile:!1,likedUsers:[],likesLoading:!0,error:null},$5=({children:t})=>{const[e,i]=b.useReducer(z5,P5),{user:a,isAuthenticated:c}=Sn(),u=b.useRef(null),d=b.useRef(!1),h=b.useCallback(async(E=1,L=20)=>{var P,G;i({type:"SET_LOADING",payload:E===1});try{const Q=await st.get(`/users?page=${E}&limit=${L}`);if(Q.success)return i({type:E===1?"GET_USERS":"APPEND_USERS",payload:Q.data}),{users:Q.data,hasMore:Q.hasMore||((P=Q.pagination)==null?void 0:P.hasNext)||Q.data.length===L,totalPages:((G=Q.pagination)==null?void 0:G.totalPages)||Math.ceil(Q.totalCount/L)||1};throw new Error(Q.error||"Failed to fetch users")}catch(Q){const z=Q.error||Q.message||"Failed to fetch users";return i({type:"USER_ERROR",payload:z}),{users:[],hasMore:!1,totalPages:1}}},[]),p=b.useCallback(async(E=!1)=>{!e.likesLoading&&E&&i({type:"SET_LIKES_LOADING",payload:!0});try{if(!a||!a._id||typeof a._id!="string"){console.warn("Current user ID is missing or invalid",a),i({type:"SET_LIKES_LOADING",payload:!1});return}if(!/^[0-9a-fA-F]{24}$/.test(a._id)){console.warn(`Invalid user ID format: ${a._id}`),i({type:"SET_LIKES_LOADING",payload:!1});return}console.log("Fetching liked users from server with forceRefresh:",E);const P=await st.get("/users/likes",{},{headers:E?{"x-no-cache":"true"}:{},useCache:!E});P.success?(console.log("Liked users response:",P.data),i({type:"SET_LIKED_USERS",payload:P.data||[]}),d.current=!0):(console.error("Error in getLikedUsers:",P.error),i({type:"SET_LIKED_USERS",payload:[]}))}catch(L){console.error("Error fetching liked users:",L),i({type:"SET_LIKED_USERS",payload:[]})}finally{i({type:"SET_LIKES_LOADING",payload:!1})}},[a]);b.useEffect(()=>{if(c&&a&&a._id){p(!0);const E=setInterval(()=>{document.visibilityState==="visible"&&p(!0)},5*60*1e3);return()=>clearInterval(E)}else i({type:"SET_LIKED_USERS",payload:[]}),d.current=!1},[c,a,p]);const y=b.useCallback(()=>{u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{c&&a&&h()},500)},[c,a,h]);b.useEffect(()=>(c&&a&&y(),()=>{u.current&&clearTimeout(u.current)}),[c,a,y]);const g=b.useCallback(async E=>{if(!E)return null;if(!/^[0-9a-fA-F]{24}$/.test(E))return i({type:"USER_ERROR",payload:"Invalid user ID format"}),null;i({type:"SET_LOADING",payload:!0});try{const P=await st.get(`/users/${E}`);if(P.success){if(i({type:"GET_USER",payload:P.data}),a&&E===a._id&&P.data.user&&P.data.user.settings)try{Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([G,Q])=>{const z=G.default,ae=Q.default;console.log("Initializing services with user settings:",P.data.user.settings),z.initialize(P.data.user.settings),P.data.user.settings.privacy&&ae.updatePrivacySettings(P.data.user.settings.privacy),console.log("Services initialized with user settings")}).catch(G=>{console.error("Error initializing services with settings:",G)})}catch(G){console.error("Error in dynamic import for services:",G)}return P.data}else throw new Error(P.error||"Failed to fetch user")}catch(P){const G=P.error||P.message||"Failed to fetch user";return i({type:"USER_ERROR",payload:G}),null}},[a]),w=b.useCallback(async E=>{i({type:"UPDATING_PROFILE",payload:!0});try{console.log("Updating profile with data:",E);const L=await st.put("/users/profile",E);if(L.success){if(E.settings&&(L.data.settings||(L.data.settings={}),E.settings.notifications&&!L.data.settings.notifications&&(L.data.settings.notifications=E.settings.notifications),E.settings.privacy&&!L.data.settings.privacy&&(L.data.settings.privacy=E.settings.privacy),console.log("Using settings in UPDATE_PROFILE:",L.data.settings)),!L.data._id&&e.currentUser&&e.currentUser._id&&(console.log("Adding missing _id to profile data:",e.currentUser._id),L.data._id=e.currentUser._id),i({type:"UPDATE_PROFILE",payload:L.data}),e.currentUser){const G={...e.currentUser,...L.data,details:{...e.currentUser.details,...L.data.details}};E.details&&(E.details.iAm!==void 0&&(G.details.iAm=E.details.iAm),E.details.maritalStatus!==void 0&&(G.details.maritalStatus=E.details.maritalStatus)),i({type:"UPDATE_PROFILE",payload:G})}if(E.settings)try{Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([G,Q])=>{const z=G.default,ae=Q.default;E.settings.notifications&&(console.log("Updating notification service after profile update:",E.settings.notifications),z.updateSettings(E.settings.notifications)),E.settings.privacy&&(console.log("Updating socket service after profile update:",E.settings.privacy),ae.updatePrivacySettings(E.settings.privacy)),console.log("Services updated after profile update with new settings")}).catch(G=>{console.error("Error updating services after profile update:",G)})}catch(G){console.error("Error importing services for settings update:",G)}return ne.success("Profile updated successfully"),e.currentUser?{...L.data,_id:e.currentUser._id}:L.data}else throw new Error(L.error||"Failed to update profile")}catch(L){const P=L.error||L.message||"Failed to update profile";return i({type:"USER_ERROR",payload:P}),null}},[e.currentUser]),C=b.useCallback(async(E,L)=>{i({type:"UPLOADING_PHOTO",payload:!0});try{const P=new FormData;P.append("photo",E),P.append("isPrivate",L);const G=await st.upload("/users/photos",P,Q=>{console.log(`Upload progress: ${Q}%`)});if(G.success)return i({type:"UPLOAD_PHOTO",payload:G.data}),ne.success(`${L?"Private":"Public"} photo uploaded successfully`),G.data;throw new Error(G.error||"Failed to upload photo")}catch(P){const G=P.error||P.message||"Failed to upload photo";return i({type:"USER_ERROR",payload:G}),null}},[]),j=b.useCallback(async(E,L)=>{try{const P=await st.post(`/photos/${E}/request`,{userId:L});if(P.success)return i({type:"PHOTO_PERMISSION_REQUESTED",payload:P.data}),ne.success("Photo access request sent"),P.data;throw new Error(P.error||"Failed to request photo access")}catch(P){const G=P.error||P.message||"Failed to request photo access";return i({type:"USER_ERROR",payload:G}),null}},[]),N=b.useCallback(async(E,L)=>{try{const P=await st.put(`/photos/permissions/${E}`,{status:L});if(P.success)return i({type:"PHOTO_PERMISSION_UPDATED",payload:P.data}),ne.success(`Photo access ${L}`),P.data;throw new Error(P.error||`Failed to ${L} photo access`)}catch(P){const G=P.error||P.message||`Failed to ${L} photo access`;return i({type:"USER_ERROR",payload:G}),null}},[]),M=b.useCallback(async(E=null)=>{try{try{console.log("Refreshing user data from auth endpoint");const P=await st.get("/auth/me");if(P.success&&P.data)return i({type:"UPDATE_PROFILE",payload:P.data}),console.log("User data refreshed from auth endpoint"),h().catch(G=>console.error("Error refreshing users list:",G)),!0}catch(P){console.warn("Could not refresh from auth endpoint",P)}const L=E||e.currentUser&&e.currentUser._id;if(L){if(console.log(`Falling back to user API with ID: ${L}`),await g(L))return console.log("User data refreshed from user API"),h().catch(G=>console.error("Error refreshing users list:",G)),!0;console.error(`Failed to refresh user data for ID: ${L}`)}else{console.warn("No user ID available for refresh, using token-based refresh");try{const P=sessionStorage.getItem("token")||localStorage.getItem("token");if(P){const Q=P.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),z=JSON.parse(atob(Q)),ae=z.id||z.user&&(z.user._id||z.user.id);if(ae&&(console.log(`Using ID from token: ${ae}`),await g(ae)))return console.log("User data refreshed from user API using token ID"),h().catch(Ee=>console.error("Error refreshing users list:",Ee)),!0}}catch(P){console.error("Failed to extract ID from token",P)}}return h().catch(P=>console.error("Error refreshing users list:",P)),!1}catch(L){return console.error("Error in refreshUserData:",L),!1}},[e.currentUser,g,h,i]),D=b.useCallback(()=>{i({type:"CLEAR_ERROR"})},[]),I=b.useCallback(E=>{if(!e.likedUsers||!Array.isArray(e.likedUsers)||!E)return!1;const L=typeof E=="object"&&E!==null?E.toString():E;return e.likedUsers.some(P=>P?typeof P.recipient=="object"&&P.recipient!==null?P.recipient._id?P.recipient._id.toString()===L:P.recipient.toString()===L:P.recipient===L:!1)},[e.likedUsers]),V=b.useCallback(async(E,L)=>{if(!a||!a._id)return!1;try{if(!E||!/^[0-9a-fA-F]{24}$/.test(E))return ne.error("Invalid user ID format"),!1;if(I(E))return console.log(`User ${E} is already liked, skipping API call`),!0;i({type:"ADD_LIKED_USER",payload:{recipient:E,createdAt:new Date().toISOString()}}),console.log(`Sending like request for user ${E}`);const P=await st.post(`/users/${E}/like`,{},{headers:{"x-no-cache":"true"}});return P.success?(p(!0),ne.success(o.jsxs("div",{className:"like-toast",children:[o.jsx(vi,{className:"like-icon pulse"}),o.jsxs("span",{children:["You liked ",L||"this user"]})]})),P.likesRemaining!==void 0&&ne.info(`You have ${P.likesRemaining} likes remaining today`),!0):P.error==="Already liked"?(console.log("User already liked according to server"),!0):(i({type:"REMOVE_LIKED_USER",payload:E}),ne.error(P.error||"Failed to like user"),!1)}catch(P){i({type:"REMOVE_LIKED_USER",payload:E});const G=P.error||P.message||"Failed to like user";return ne.error(G),console.error("Like error:",P),!1}},[a,I,p,i]),F=b.useCallback(async(E,L)=>{if(!a||!a._id)return!1;try{if(!E||!/^[0-9a-fA-F]{24}$/.test(E))return ne.error("Invalid user ID format"),!1;if(!I(E))return console.log(`User ${E} is not liked, skipping API call`),!0;i({type:"REMOVE_LIKED_USER",payload:E}),console.log(`Sending unlike request for user ${E}`);const P=await st.delete(`/users/${E}/like`,{},{headers:{"x-no-cache":"true"}});if(P.success)return p(!0),ne.info(`You unliked ${L||"this user"}`),!0;throw i({type:"ADD_LIKED_USER",payload:{recipient:E,createdAt:new Date().toISOString()}}),new Error(P.error||"Failed to unlike user")}catch(P){p(!0);const G=P.error||P.message||"Failed to unlike user";return ne.error(G),console.error("Unlike error:",P),!1}},[a,p,I,i]),O=b.useCallback(async E=>{try{const L=await st.post("/messages/start",{recipient:E});if(L.success)return L.data;throw new Error(L.error||"Failed to send message")}catch(L){const P=L.error||L.message||"Failed to send message";return i({type:"USER_ERROR",payload:P}),null}},[]),A=b.useCallback(async E=>{try{const L=await st.post(`/users/${E}/block`);if(L.success)return ne.success("User blocked successfully"),!0;throw new Error(L.error||"Failed to block user")}catch(L){const P=L.error||L.message||"Failed to block user";return i({type:"USER_ERROR",payload:P}),!1}},[]),H=b.useCallback(async E=>{try{const L=await st.post(`/users/${E}/report`);if(L.success)return ne.success("User reported successfully"),!0;throw new Error(L.error||"Failed to report user")}catch(L){const P=L.error||L.message||"Failed to report user";return i({type:"USER_ERROR",payload:P}),!1}},[]);return o.jsx(Cb.Provider,{value:{users:e.users,currentUser:e.currentUser,messages:e.messages,photoPermissions:e.photoPermissions,loading:e.loading,uploadingPhoto:e.uploadingPhoto,updatingProfile:e.updatingProfile,error:e.error,likedUsers:e.likedUsers,likesLoading:e.likesLoading,getUsers:h,getUser:g,updateProfile:w,uploadPhoto:C,requestPhotoPermission:j,updatePhotoPermission:N,refreshUserData:M,clearError:D,isUserLiked:I,likeUser:V,unlikeUser:F,getLikedUsers:p,sendMessage:O,blockUser:A,reportUser:H},children:t})},ka=()=>{const t=b.useContext(Cb);if(t===void 0)throw new Error("useUser must be used within a UserProvider");return t},Nb=b.createContext(),U5=({children:t})=>{const[e,i]=b.useState(()=>{const u=localStorage.getItem("theme");return u||(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});b.useEffect(()=>{const u=window.document.documentElement;u.classList.remove("light","dark"),u.classList.add(e),localStorage.setItem("theme",e)},[e]);const a=()=>{i(u=>u==="light"?"dark":"light")},c=u=>{["light","dark","system"].includes(u)&&i(u)};return o.jsx(Nb.Provider,{value:{theme:e,toggleTheme:a,setTheme:c},children:t})},Tb=()=>{const t=b.useContext(Nb);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},Ws=Object.create(null);Ws.open="0";Ws.close="1";Ws.ping="2";Ws.pong="3";Ws.message="4";Ws.upgrade="5";Ws.noop="6";const zc=Object.create(null);Object.keys(Ws).forEach(t=>{zc[Ws[t]]=t});const hh={type:"error",data:"parser error"},kb=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Eb=typeof ArrayBuffer=="function",Ab=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,Qh=({type:t,data:e},i,a)=>kb&&e instanceof Blob?i?a(e):q0(e,a):Eb&&(e instanceof ArrayBuffer||Ab(e))?i?a(e):q0(new Blob([e]),a):a(Ws[t]+(e||"")),q0=(t,e)=>{const i=new FileReader;return i.onload=function(){const a=i.result.split(",")[1];e("b"+(a||""))},i.readAsDataURL(t)};function V0(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let Of;function I5(t,e){if(kb&&t.data instanceof Blob)return t.data.arrayBuffer().then(V0).then(e);if(Eb&&(t.data instanceof ArrayBuffer||Ab(t.data)))return e(V0(t.data));Qh(t,!1,i=>{Of||(Of=new TextEncoder),e(Of.encode(i))})}const H0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$o=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<H0.length;t++)$o[H0.charCodeAt(t)]=t;const F5=t=>{let e=t.length*.75,i=t.length,a,c=0,u,d,h,p;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const y=new ArrayBuffer(e),g=new Uint8Array(y);for(a=0;a<i;a+=4)u=$o[t.charCodeAt(a)],d=$o[t.charCodeAt(a+1)],h=$o[t.charCodeAt(a+2)],p=$o[t.charCodeAt(a+3)],g[c++]=u<<2|d>>4,g[c++]=(d&15)<<4|h>>2,g[c++]=(h&3)<<6|p&63;return y},q5=typeof ArrayBuffer=="function",Wh=(t,e)=>{if(typeof t!="string")return{type:"message",data:Rb(t,e)};const i=t.charAt(0);return i==="b"?{type:"message",data:V5(t.substring(1),e)}:zc[i]?t.length>1?{type:zc[i],data:t.substring(1)}:{type:zc[i]}:hh},V5=(t,e)=>{if(q5){const i=F5(t);return Rb(i,e)}else return{base64:!0,data:t}},Rb=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Mb="",H5=(t,e)=>{const i=t.length,a=new Array(i);let c=0;t.forEach((u,d)=>{Qh(u,!1,h=>{a[d]=h,++c===i&&e(a.join(Mb))})})},G5=(t,e)=>{const i=t.split(Mb),a=[];for(let c=0;c<i.length;c++){const u=Wh(i[c],e);if(a.push(u),u.type==="error")break}return a};function Y5(){return new TransformStream({transform(t,e){I5(t,i=>{const a=i.length;let c;if(a<126)c=new Uint8Array(1),new DataView(c.buffer).setUint8(0,a);else if(a<65536){c=new Uint8Array(3);const u=new DataView(c.buffer);u.setUint8(0,126),u.setUint16(1,a)}else{c=new Uint8Array(9);const u=new DataView(c.buffer);u.setUint8(0,127),u.setBigUint64(1,BigInt(a))}t.data&&typeof t.data!="string"&&(c[0]|=128),e.enqueue(c),e.enqueue(i)})}})}let Df;function Nc(t){return t.reduce((e,i)=>e+i.length,0)}function Tc(t,e){if(t[0].length===e)return t.shift();const i=new Uint8Array(e);let a=0;for(let c=0;c<e;c++)i[c]=t[0][a++],a===t[0].length&&(t.shift(),a=0);return t.length&&a<t[0].length&&(t[0]=t[0].slice(a)),i}function X5(t,e){Df||(Df=new TextDecoder);const i=[];let a=0,c=-1,u=!1;return new TransformStream({transform(d,h){for(i.push(d);;){if(a===0){if(Nc(i)<1)break;const p=Tc(i,1);u=(p[0]&128)===128,c=p[0]&127,c<126?a=3:c===126?a=1:a=2}else if(a===1){if(Nc(i)<2)break;const p=Tc(i,2);c=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),a=3}else if(a===2){if(Nc(i)<8)break;const p=Tc(i,8),y=new DataView(p.buffer,p.byteOffset,p.length),g=y.getUint32(0);if(g>Math.pow(2,21)-1){h.enqueue(hh);break}c=g*Math.pow(2,32)+y.getUint32(4),a=3}else{if(Nc(i)<c)break;const p=Tc(i,c);h.enqueue(Wh(u?p:Df.decode(p),e)),a=0}if(c===0||c>t){h.enqueue(hh);break}}}})}const Lb=4;function vn(t){if(t)return K5(t)}function K5(t){for(var e in vn.prototype)t[e]=vn.prototype[e];return t}vn.prototype.on=vn.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};vn.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this};vn.prototype.off=vn.prototype.removeListener=vn.prototype.removeAllListeners=vn.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var a,c=0;c<i.length;c++)if(a=i[c],a===e||a.fn===e){i.splice(c,1);break}return i.length===0&&delete this._callbacks["$"+t],this};vn.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],a=1;a<arguments.length;a++)e[a-1]=arguments[a];if(i){i=i.slice(0);for(var a=0,c=i.length;a<c;++a)i[a].apply(this,e)}return this};vn.prototype.emitReserved=vn.prototype.emit;vn.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};vn.prototype.hasListeners=function(t){return!!this.listeners(t).length};const fu=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,i)=>i(e,0),xs=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Q5="arraybuffer";function Ob(t,...e){return e.reduce((i,a)=>(t.hasOwnProperty(a)&&(i[a]=t[a]),i),{})}const W5=xs.setTimeout,Z5=xs.clearTimeout;function hu(t,e){e.useNativeTimers?(t.setTimeoutFn=W5.bind(xs),t.clearTimeoutFn=Z5.bind(xs)):(t.setTimeoutFn=xs.setTimeout.bind(xs),t.clearTimeoutFn=xs.clearTimeout.bind(xs))}const J5=1.33;function e_(t){return typeof t=="string"?t_(t):Math.ceil((t.byteLength||t.size)*J5)}function t_(t){let e=0,i=0;for(let a=0,c=t.length;a<c;a++)e=t.charCodeAt(a),e<128?i+=1:e<2048?i+=2:e<55296||e>=57344?i+=3:(a++,i+=4);return i}function Db(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function n_(t){let e="";for(let i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e}function s_(t){let e={},i=t.split("&");for(let a=0,c=i.length;a<c;a++){let u=i[a].split("=");e[decodeURIComponent(u[0])]=decodeURIComponent(u[1])}return e}class i_ extends Error{constructor(e,i,a){super(e),this.description=i,this.context=a,this.type="TransportError"}}class Zh extends vn{constructor(e){super(),this.writable=!1,hu(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,i,a){return super.emitReserved("error",new i_(e,i,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const i=Wh(e,this.socket.binaryType);this.onPacket(i)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,i={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(i)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const i=n_(e);return i.length?"?"+i:""}}class a_ extends Zh{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const i=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||i()})),this.writable||(a++,this.once("drain",function(){--a||i()}))}else i()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const i=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};G5(e,this.socket.binaryType).forEach(i),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,H5(e,i=>{this.doWrite(i,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",i=this.query||{};return this.opts.timestampRequests!==!1&&(i[this.opts.timestampParam]=Db()),!this.supportsBinary&&!i.sid&&(i.b64=1),this.createUri(e,i)}}let Bb=!1;try{Bb=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const r_=Bb;function o_(){}class l_ extends a_{constructor(e){if(super(e),typeof location<"u"){const i=location.protocol==="https:";let a=location.port;a||(a=i?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||a!==e.port}}doWrite(e,i){const a=this.request({method:"POST",data:e});a.on("success",i),a.on("error",(c,u)=>{this.onError("xhr post error",c,u)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(i,a)=>{this.onError("xhr poll error",i,a)}),this.pollXhr=e}}let Sr=class Pc extends vn{constructor(e,i,a){super(),this.createRequest=e,hu(this,a),this._opts=a,this._method=a.method||"GET",this._uri=i,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var e;const i=Ob(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(i);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let c in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(c)&&a.setRequestHeader(c,this._opts.extraHeaders[c])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var c;a.readyState===3&&((c=this._opts.cookieJar)===null||c===void 0||c.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(c){this.setTimeoutFn(()=>{this._onError(c)},0);return}typeof document<"u"&&(this._index=Pc.requestsCount++,Pc.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=o_,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Pc.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};Sr.requestsCount=0;Sr.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",G0);else if(typeof addEventListener=="function"){const t="onpagehide"in xs?"pagehide":"unload";addEventListener(t,G0,!1)}}function G0(){for(let t in Sr.requests)Sr.requests.hasOwnProperty(t)&&Sr.requests[t].abort()}const c_=function(){const t=zb({xdomain:!1});return t&&t.responseType!==null}();class u_ extends l_{constructor(e){super(e);const i=e&&e.forceBase64;this.supportsBinary=c_&&!i}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Sr(zb,this.uri(),e)}}function zb(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||r_))return new XMLHttpRequest}catch{}if(!e)try{return new xs[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Pb=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class d_ extends Zh{get name(){return"websocket"}doOpen(){const e=this.uri(),i=this.opts.protocols,a=Pb?{}:Ob(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,i,a)}catch(c){return this.emitReserved("error",c)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let i=0;i<e.length;i++){const a=e[i],c=i===e.length-1;Qh(a,this.supportsBinary,u=>{try{this.doWrite(a,u)}catch{}c&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",i=this.query||{};return this.opts.timestampRequests&&(i[this.opts.timestampParam]=Db()),this.supportsBinary||(i.b64=1),this.createUri(e,i)}}const Bf=xs.WebSocket||xs.MozWebSocket;class f_ extends d_{createSocket(e,i,a){return Pb?new Bf(e,i,a):i?new Bf(e,i):new Bf(e)}doWrite(e,i){this.ws.send(i)}}class h_ extends Zh{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const i=X5(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=e.readable.pipeThrough(i).getReader(),c=Y5();c.readable.pipeTo(e.writable),this._writer=c.writable.getWriter();const u=()=>{a.read().then(({done:h,value:p})=>{h||(this.onPacket(p),u())}).catch(h=>{})};u();const d={type:"open"};this.query.sid&&(d.data=`{"sid":"${this.query.sid}"}`),this._writer.write(d).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let i=0;i<e.length;i++){const a=e[i],c=i===e.length-1;this._writer.write(a).then(()=>{c&&fu(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const m_={websocket:f_,webtransport:h_,polling:u_},g_=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,p_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function mh(t){if(t.length>8e3)throw"URI too long";const e=t,i=t.indexOf("["),a=t.indexOf("]");i!=-1&&a!=-1&&(t=t.substring(0,i)+t.substring(i,a).replace(/:/g,";")+t.substring(a,t.length));let c=g_.exec(t||""),u={},d=14;for(;d--;)u[p_[d]]=c[d]||"";return i!=-1&&a!=-1&&(u.source=e,u.host=u.host.substring(1,u.host.length-1).replace(/;/g,":"),u.authority=u.authority.replace("[","").replace("]","").replace(/;/g,":"),u.ipv6uri=!0),u.pathNames=y_(u,u.path),u.queryKey=v_(u,u.query),u}function y_(t,e){const i=/\/{2,9}/g,a=e.replace(i,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&a.splice(0,1),e.slice(-1)=="/"&&a.splice(a.length-1,1),a}function v_(t,e){const i={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,c,u){c&&(i[c]=u)}),i}const gh=typeof addEventListener=="function"&&typeof removeEventListener=="function",$c=[];gh&&addEventListener("offline",()=>{$c.forEach(t=>t())},!1);class Hi extends vn{constructor(e,i){if(super(),this.binaryType=Q5,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(i=e,e=null),e){const a=mh(e);i.hostname=a.host,i.secure=a.protocol==="https"||a.protocol==="wss",i.port=a.port,a.query&&(i.query=a.query)}else i.host&&(i.hostname=mh(i.host).host);hu(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},i.transports.forEach(a=>{const c=a.prototype.name;this.transports.push(c),this._transportsByName[c]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=s_(this.opts.query)),gh&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},$c.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const i=Object.assign({},this.opts.query);i.EIO=Lb,i.transport=e,this.id&&(i.sid=this.id);const a=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Hi.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const i=this.createTransport(e);i.open(),this.setTransport(i)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",i=>this._onClose("transport close",i))}onOpen(){this.readyState="open",Hi.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const i=new Error("server error");i.code=e.data,this._onError(i);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let a=0;a<this.writeBuffer.length;a++){const c=this.writeBuffer[a].data;if(c&&(i+=e_(c)),a>0&&i>this._maxPayload)return this.writeBuffer.slice(0,a);i+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,fu(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,i,a){return this._sendPacket("message",e,i,a),this}send(e,i,a){return this._sendPacket("message",e,i,a),this}_sendPacket(e,i,a,c){if(typeof i=="function"&&(c=i,i=void 0),typeof a=="function"&&(c=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const u={type:e,data:i,options:a};this.emitReserved("packetCreate",u),this.writeBuffer.push(u),c&&this.once("flush",c),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),e()},a=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():e()}):this.upgrading?a():e()),this}_onError(e){if(Hi.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,i){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),gh&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=$c.indexOf(this._offlineEventListener);a!==-1&&$c.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,i),this.writeBuffer=[],this._prevBufferLen=0}}}Hi.protocol=Lb;class b_ extends Hi{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let i=this.createTransport(e),a=!1;Hi.priorWebsocketSuccess=!1;const c=()=>{a||(i.send([{type:"ping",data:"probe"}]),i.once("packet",w=>{if(!a)if(w.type==="pong"&&w.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;Hi.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(g(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const C=new Error("probe error");C.transport=i.name,this.emitReserved("upgradeError",C)}}))};function u(){a||(a=!0,g(),i.close(),i=null)}const d=w=>{const C=new Error("probe error: "+w);C.transport=i.name,u(),this.emitReserved("upgradeError",C)};function h(){d("transport closed")}function p(){d("socket closed")}function y(w){i&&w.name!==i.name&&u()}const g=()=>{i.removeListener("open",c),i.removeListener("error",d),i.removeListener("close",h),this.off("close",p),this.off("upgrading",y)};i.once("open",c),i.once("error",d),i.once("close",h),this.once("close",p),this.once("upgrading",y),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{a||i.open()},200):i.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const i=[];for(let a=0;a<e.length;a++)~this.transports.indexOf(e[a])&&i.push(e[a]);return i}}let x_=class extends b_{constructor(e,i={}){const a=typeof e=="object"?e:i;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(c=>m_[c]).filter(c=>!!c)),super(e,a)}};function w_(t,e="",i){let a=t;i=i||typeof location<"u"&&location,t==null&&(t=i.protocol+"//"+i.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=i.protocol+t:t=i.host+t),/^(https?|wss?):\/\//.test(t)||(typeof i<"u"?t=i.protocol+"//"+t:t="https://"+t),a=mh(t)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const u=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+u+":"+a.port+e,a.href=a.protocol+"://"+u+(i&&i.port===a.port?"":":"+a.port),a}const __=typeof ArrayBuffer=="function",S_=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,$b=Object.prototype.toString,j_=typeof Blob=="function"||typeof Blob<"u"&&$b.call(Blob)==="[object BlobConstructor]",C_=typeof File=="function"||typeof File<"u"&&$b.call(File)==="[object FileConstructor]";function Jh(t){return __&&(t instanceof ArrayBuffer||S_(t))||j_&&t instanceof Blob||C_&&t instanceof File}function Uc(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let i=0,a=t.length;i<a;i++)if(Uc(t[i]))return!0;return!1}if(Jh(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Uc(t.toJSON(),!0);for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&Uc(t[i]))return!0;return!1}function N_(t){const e=[],i=t.data,a=t;return a.data=ph(i,e),a.attachments=e.length,{packet:a,buffers:e}}function ph(t,e){if(!t)return t;if(Jh(t)){const i={_placeholder:!0,num:e.length};return e.push(t),i}else if(Array.isArray(t)){const i=new Array(t.length);for(let a=0;a<t.length;a++)i[a]=ph(t[a],e);return i}else if(typeof t=="object"&&!(t instanceof Date)){const i={};for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(i[a]=ph(t[a],e));return i}return t}function T_(t,e){return t.data=yh(t.data,e),delete t.attachments,t}function yh(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let i=0;i<t.length;i++)t[i]=yh(t[i],e);else if(typeof t=="object")for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=yh(t[i],e));return t}const k_=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],E_=5;var Dt;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(Dt||(Dt={}));class A_{constructor(e){this.replacer=e}encode(e){return(e.type===Dt.EVENT||e.type===Dt.ACK)&&Uc(e)?this.encodeAsBinary({type:e.type===Dt.EVENT?Dt.BINARY_EVENT:Dt.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let i=""+e.type;return(e.type===Dt.BINARY_EVENT||e.type===Dt.BINARY_ACK)&&(i+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(i+=e.nsp+","),e.id!=null&&(i+=e.id),e.data!=null&&(i+=JSON.stringify(e.data,this.replacer)),i}encodeAsBinary(e){const i=N_(e),a=this.encodeAsString(i.packet),c=i.buffers;return c.unshift(a),c}}function Y0(t){return Object.prototype.toString.call(t)==="[object Object]"}class em extends vn{constructor(e){super(),this.reviver=e}add(e){let i;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(e);const a=i.type===Dt.BINARY_EVENT;a||i.type===Dt.BINARY_ACK?(i.type=a?Dt.EVENT:Dt.ACK,this.reconstructor=new R_(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(Jh(e)||e.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(e),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let i=0;const a={type:Number(e.charAt(0))};if(Dt[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===Dt.BINARY_EVENT||a.type===Dt.BINARY_ACK){const u=i+1;for(;e.charAt(++i)!=="-"&&i!=e.length;);const d=e.substring(u,i);if(d!=Number(d)||e.charAt(i)!=="-")throw new Error("Illegal attachments");a.attachments=Number(d)}if(e.charAt(i+1)==="/"){const u=i+1;for(;++i&&!(e.charAt(i)===","||i===e.length););a.nsp=e.substring(u,i)}else a.nsp="/";const c=e.charAt(i+1);if(c!==""&&Number(c)==c){const u=i+1;for(;++i;){const d=e.charAt(i);if(d==null||Number(d)!=d){--i;break}if(i===e.length)break}a.id=Number(e.substring(u,i+1))}if(e.charAt(++i)){const u=this.tryParse(e.substr(i));if(em.isPayloadValid(a.type,u))a.data=u;else throw new Error("invalid payload")}return a}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,i){switch(e){case Dt.CONNECT:return Y0(i);case Dt.DISCONNECT:return i===void 0;case Dt.CONNECT_ERROR:return typeof i=="string"||Y0(i);case Dt.EVENT:case Dt.BINARY_EVENT:return Array.isArray(i)&&(typeof i[0]=="number"||typeof i[0]=="string"&&k_.indexOf(i[0])===-1);case Dt.ACK:case Dt.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class R_{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const i=T_(this.reconPack,this.buffers);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const M_=Object.freeze(Object.defineProperty({__proto__:null,Decoder:em,Encoder:A_,get PacketType(){return Dt},protocol:E_},Symbol.toStringTag,{value:"Module"}));function Ls(t,e,i){return t.on(e,i),function(){t.off(e,i)}}const L_=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Ub extends vn{constructor(e,i,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=i,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Ls(e,"open",this.onopen.bind(this)),Ls(e,"packet",this.onpacket.bind(this)),Ls(e,"error",this.onerror.bind(this)),Ls(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...i){var a,c,u;if(L_.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(i.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;const d={type:Dt.EVENT,data:i};if(d.options={},d.options.compress=this.flags.compress!==!1,typeof i[i.length-1]=="function"){const g=this.ids++,w=i.pop();this._registerAckCallback(g,w),d.id=g}const h=(c=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||c===void 0?void 0:c.writable,p=this.connected&&!(!((u=this.io.engine)===null||u===void 0)&&u._hasPingExpired());return this.flags.volatile&&!h||(p?(this.notifyOutgoingListeners(d),this.packet(d)):this.sendBuffer.push(d)),this.flags={},this}_registerAckCallback(e,i){var a;const c=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(c===void 0){this.acks[e]=i;return}const u=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let h=0;h<this.sendBuffer.length;h++)this.sendBuffer[h].id===e&&this.sendBuffer.splice(h,1);i.call(this,new Error("operation has timed out"))},c),d=(...h)=>{this.io.clearTimeoutFn(u),i.apply(this,h)};d.withError=!0,this.acks[e]=d}emitWithAck(e,...i){return new Promise((a,c)=>{const u=(d,h)=>d?c(d):a(h);u.withError=!0,i.push(u),this.emit(e,...i)})}_addToQueue(e){let i;typeof e[e.length-1]=="function"&&(i=e.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((c,...u)=>a!==this._queue[0]?void 0:(c!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),i&&i(c)):(this._queue.shift(),i&&i(null,...u)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const i=this._queue[0];i.pending&&!e||(i.pending=!0,i.tryCount++,this.flags=i.flags,this.emit.apply(this,i.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:Dt.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,i),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(a=>String(a.id)===e)){const a=this.acks[e];delete this.acks[e],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case Dt.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Dt.EVENT:case Dt.BINARY_EVENT:this.onevent(e);break;case Dt.ACK:case Dt.BINARY_ACK:this.onack(e);break;case Dt.DISCONNECT:this.ondisconnect();break;case Dt.CONNECT_ERROR:this.destroy();const a=new Error(e.data.message);a.data=e.data.data,this.emitReserved("connect_error",a);break}}onevent(e){const i=e.data||[];e.id!=null&&i.push(this.ack(e.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const i=this._anyListeners.slice();for(const a of i)a.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const i=this;let a=!1;return function(...c){a||(a=!0,i.packet({type:Dt.ACK,id:e,data:c}))}}onack(e){const i=this.acks[e.id];typeof i=="function"&&(delete this.acks[e.id],i.withError&&e.data.unshift(null),i.apply(this,e.data))}onconnect(e,i){this.id=e,this.recovered=i&&this._pid===i,this._pid=i,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:Dt.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const i=this._anyListeners;for(let a=0;a<i.length;a++)if(e===i[a])return i.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const i=this._anyOutgoingListeners;for(let a=0;a<i.length;a++)if(e===i[a])return i.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const i=this._anyOutgoingListeners.slice();for(const a of i)a.apply(this,e.data)}}}function Or(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Or.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-i:t+i}return Math.min(t,this.max)|0};Or.prototype.reset=function(){this.attempts=0};Or.prototype.setMin=function(t){this.ms=t};Or.prototype.setMax=function(t){this.max=t};Or.prototype.setJitter=function(t){this.jitter=t};class vh extends vn{constructor(e,i){var a;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(i=e,e=void 0),i=i||{},i.path=i.path||"/socket.io",this.opts=i,hu(this,i),this.reconnection(i.reconnection!==!1),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor((a=i.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new Or({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(i.timeout==null?2e4:i.timeout),this._readyState="closed",this.uri=e;const c=i.parser||M_;this.encoder=new c.Encoder,this.decoder=new c.Decoder,this._autoConnect=i.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var i;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(i=this.backoff)===null||i===void 0||i.setMin(e),this)}randomizationFactor(e){var i;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(i=this.backoff)===null||i===void 0||i.setJitter(e),this)}reconnectionDelayMax(e){var i;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(i=this.backoff)===null||i===void 0||i.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new x_(this.uri,this.opts);const i=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const c=Ls(i,"open",function(){a.onopen(),e&&e()}),u=h=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",h),e?e(h):this.maybeReconnectOnOpen()},d=Ls(i,"error",u);if(this._timeout!==!1){const h=this._timeout,p=this.setTimeoutFn(()=>{c(),u(new Error("timeout")),i.close()},h);this.opts.autoUnref&&p.unref(),this.subs.push(()=>{this.clearTimeoutFn(p)})}return this.subs.push(c),this.subs.push(d),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Ls(e,"ping",this.onping.bind(this)),Ls(e,"data",this.ondata.bind(this)),Ls(e,"error",this.onerror.bind(this)),Ls(e,"close",this.onclose.bind(this)),Ls(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(i){this.onclose("parse error",i)}}ondecoded(e){fu(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,i){let a=this.nsps[e];return a?this._autoConnect&&!a.active&&a.connect():(a=new Ub(this,e,i),this.nsps[e]=a),a}_destroy(e){const i=Object.keys(this.nsps);for(const a of i)if(this.nsps[a].active)return;this._close()}_packet(e){const i=this.encoder.encode(e);for(let a=0;a<i.length;a++)this.engine.write(i[a],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,i){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const i=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(c=>{c?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",c)):e.onreconnect()}))},i);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Oo={};function Ic(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const i=w_(t,e.path||"/socket.io"),a=i.source,c=i.id,u=i.path,d=Oo[c]&&u in Oo[c].nsps,h=e.forceNew||e["force new connection"]||e.multiplex===!1||d;let p;return h?p=new vh(a,e):(Oo[c]||(Oo[c]=new vh(a,e)),p=Oo[c]),i.query&&!e.query&&(e.query=i.queryKey),p.socket(i.path,e)}Object.assign(Ic,{Manager:vh,Socket:Ub,io:Ic,connect:Ic});var O_={};class D_{constructor(){this.socket=null,this.connected=!1,this.reconnecting=!1,this.userId=null,this.pendingMessages=[],this.eventHandlers={},this.connectionAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=5e3,this.heartbeatInterval=null,this.lastPong=null,this.notificationSyncChannel=null,this.connectionMonitorInterval=null,this.notificationEventTypes=["notification","newMessage","newLike","photoPermissionRequestReceived","photoPermissionResponseReceived","newComment","incomingCall","newStory"]}init(e,i,a={}){if(this.socket&&this.connected)return console.log("Socket already connected"),this.socket;this.userId=e;const c=a.serverUrl||O_.REACT_APP_SOCKET_URL||window.location.origin;console.log(`Connecting to socket server at ${c}`);try{return this.socket=Ic(c,{query:{token:i},auth:{token:i,userId:e},reconnection:!0,reconnectionAttempts:this.maxReconnectAttempts,reconnectionDelay:this.reconnectDelay,reconnectionDelayMax:3e4,timeout:2e4,transports:["websocket","polling"],autoConnect:!0}),this._setupSocketHandlers(),this.setupNotificationSyncChannel(),this.startConnectionMonitoring(),this.socket}catch(u){throw console.error("Socket initialization error:",u),u}}isConnected(){return this.socket&&this.connected}_setupSocketHandlers(){this.socket&&(this.socket.on("connect",()=>{console.log("Socket connected successfully"),this.connected=!0,this.connectionAttempts=0,this._startHeartbeat(),this._processPendingMessages(),this._notifyEventHandlers("socketConnected",{userId:this.userId,socketId:this.socket.id}),window.dispatchEvent(new CustomEvent("socketConnected",{detail:{userId:this.userId,socketId:this.socket.id}}))}),this.socket.on("connect_error",e=>{console.error("Socket connection error:",e),this.connected=!1,this.connectionAttempts++,this.connectionAttempts>=this.maxReconnectAttempts&&(this._notifyEventHandlers("socketConnectionFailed",{error:e.message,attempts:this.connectionAttempts}),this.connectionAttempts===this.maxReconnectAttempts&&ne.error("Failed to connect to the chat server. Please check your internet connection.")),window.dispatchEvent(new CustomEvent("socketConnectionError",{detail:{error:e.message,attempts:this.connectionAttempts}}))}),this.socket.on("disconnect",e=>{console.log(`Socket disconnected: ${e}`),this.connected=!1,this._stopHeartbeat(),this._notifyEventHandlers("socketDisconnected",{reason:e}),window.dispatchEvent(new CustomEvent("socketDisconnected",{detail:{reason:e}})),(e==="io server disconnect"||e==="transport close")&&this.enhancedReconnect()}),this.socket.on("reconnect",e=>{console.log(`Socket reconnected after ${e} attempts`),this.connected=!0,this.reconnecting=!1,this._notifyEventHandlers("socketReconnected",{userId:this.userId,attempts:e}),window.dispatchEvent(new CustomEvent("socketReconnected",{detail:{userId:this.userId,attempts:e}}))}),this.socket.on("reconnect_attempt",e=>{console.log(`Socket reconnect attempt ${e}`),this.reconnecting=!0}),this.socket.on("reconnect_error",e=>{console.error("Socket reconnection error:",e)}),this.socket.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),this.reconnecting=!1,ne.error("Failed to reconnect to the chat server. Please reload the page."),this._notifyEventHandlers("socketReconnectFailed",{userId:this.userId}),window.dispatchEvent(new CustomEvent("socketReconnectFailed",{detail:{userId:this.userId}}))}),this.socket.on("welcome",e=>{console.log("Socket welcome message received:",e)}),this.socket.on("pong",()=>{this.lastPong=Date.now()}),this.socket.on("error",e=>{console.error("Socket server error:",e),ne.error(`Server error: ${e.message||"Unknown error"}`)}),this.socket.on("auth_error",e=>{console.error("Socket authentication error:",e),ne.error("Authentication failed. Please log in again."),window.dispatchEvent(new CustomEvent("authLogout"))}),this._registerEnhancedEventForwarder("messageReceived"),this._registerEnhancedEventForwarder("messageSent"),this._registerEnhancedEventForwarder("messageError"),this._registerEnhancedEventForwarder("userTyping"),this._registerEnhancedEventForwarder("videoSignal"),this._registerEnhancedEventForwarder("videoHangup"),this._registerEnhancedEventForwarder("videoError"),this._registerEnhancedEventForwarder("videoMediaControl"),this._registerEnhancedEventForwarder("incomingCall"),this._registerEnhancedEventForwarder("callAnswered"),this._registerEnhancedEventForwarder("callInitiated"),this._registerEnhancedEventForwarder("callError"),this._registerEnhancedEventForwarder("userOnline"),this._registerEnhancedEventForwarder("userOffline"),this._registerEnhancedEventForwarder("notification"),this._registerEnhancedEventForwarder("newLike"),this._registerEnhancedEventForwarder("photoPermissionRequestReceived"),this._registerEnhancedEventForwarder("photoPermissionResponseReceived"),this._registerEnhancedEventForwarder("newComment"),this._registerEnhancedEventForwarder("newStory"))}_registerEnhancedEventForwarder(e){this.socket.on(e,i=>{if(this._notifyEventHandlers(e,i),this.notificationEventTypes.includes(e)&&(window.dispatchEvent(new CustomEvent(e,{detail:i})),window.dispatchEvent(new CustomEvent("notification",{detail:i})),this.notificationSyncChannel))try{this.notificationSyncChannel.postMessage({type:"NEW_NOTIFICATION",data:i})}catch(a){console.error("Error syncing notification to other tabs:",a)}})}setupNotificationSyncChannel(){if(typeof BroadcastChannel>"u")return console.log("BroadcastChannel not supported, cross-tab sync disabled"),null;try{return this.notificationSyncChannel=new BroadcastChannel("notification_sync"),this.notificationSyncChannel.onmessage=e=>{const{type:i,data:a}=e.data;i==="NEW_NOTIFICATION"?(console.log("Received new notification from another tab"),window.dispatchEvent(new CustomEvent("newNotification",{detail:a}))):i==="MARK_READ"?(console.log("Received mark-read event from another tab"),window.dispatchEvent(new CustomEvent("notificationRead",{detail:a}))):i==="MARK_ALL_READ"&&(console.log("Received mark-all-read event from another tab"),window.dispatchEvent(new CustomEvent("allNotificationsRead")))},console.log("Notification sync channel initialized"),this.notificationSyncChannel}catch(e){return console.error("Error setting up notification sync channel:",e),this.notificationSyncChannel=null,null}}_startHeartbeat(){this._stopHeartbeat(),this.lastPong=Date.now(),this.heartbeatInterval=setInterval(()=>{if(this.socket&&this.connected){this.socket.emit("ping");const e=Date.now();this.lastPong&&e-this.lastPong>6e4&&(console.warn("No heartbeat response in 60 seconds, reconnecting..."),this.enhancedReconnect())}},3e4)}_stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}startConnectionMonitoring(){this.stopConnectionMonitoring(),this.connectionMonitorInterval=setInterval(()=>{this.checkSocketHealthForNotifications()},45e3),console.log("Notification connection monitoring started")}stopConnectionMonitoring(){this.connectionMonitorInterval&&(clearInterval(this.connectionMonitorInterval),this.connectionMonitorInterval=null)}checkSocketHealthForNotifications(){if(!this.userId||!this.socket)return!1;const e=Date.now(),i=this.lastPong||0;return e-i>6e4?(console.warn("No socket response in the last minute, reconnecting for notifications..."),this.enhancedReconnect(),!1):this.connected?!0:(console.warn("Socket appears disconnected, reconnecting for notifications..."),this.enhancedReconnect(),!1)}_processPendingMessages(){if(!this.connected||this.pendingMessages.length===0)return;console.log(`Processing ${this.pendingMessages.length} pending messages`);const e=[...this.pendingMessages];this.pendingMessages=[],e.forEach(i=>{this.emit(i.event,i.data)})}on(e,i){return this.eventHandlers[e]||(this.eventHandlers[e]=[]),this.eventHandlers[e].push(i),this.socket&&this.socket.on(e,i),()=>this.off(e,i)}off(e,i){this.socket&&this.socket.off(e,i),this.eventHandlers[e]&&(this.eventHandlers[e]=this.eventHandlers[e].filter(a=>a!==i),this.eventHandlers[e].length===0&&delete this.eventHandlers[e])}_notifyEventHandlers(e,i){this.eventHandlers[e]&&this.eventHandlers[e].forEach(a=>{try{a(i)}catch(c){console.error(`Error in ${e} handler:`,c)}})}emit(e,i={}){if(!this.socket)return console.warn(`Socket not initialized, cannot emit '${e}'`),!1;if(!this.connected)return console.log(`Socket not connected, queueing '${e}'`),this.pendingMessages.push({event:e,data:i}),!0;try{return this.socket.emit(e,i),!0}catch(a){return console.error(`Error emitting '${e}':`,a),!1}}enhancedReconnect(){if(!this.reconnecting){if(console.log("Forcing socket reconnection with notification support..."),this.reconnecting=!0,this.socket)try{this.socket.close()}catch(e){console.error("Error closing socket:",e)}if(this._stopHeartbeat(),this.userId){const e=localStorage.getItem("token")||sessionStorage.getItem("token");if(e){const i=1e3+Math.random()*2e3;setTimeout(()=>{try{const a=localStorage.getItem("token")||sessionStorage.getItem("token");a!==e&&console.log("Token changed since reconnection attempt started, using fresh token"),this.init(this.userId,a||e),window.dispatchEvent(new CustomEvent("notificationSocketReconnected")),console.log("Socket reconnected with notification support")}catch(a){console.error("Socket reconnection failed:",a),a.message&&a.message.includes("auth")&&(console.log("Authentication error detected, trying emergency session reset"),setTimeout(()=>{try{typeof window.fixMyUserId=="function"?window.fixMyUserId():(localStorage.clear(),sessionStorage.clear(),window.location.reload())}catch(c){console.error("Emergency recovery failed:",c)}},2e3))}this.reconnecting=!1},i)}else console.error("Cannot reconnect: No authentication token found"),this.reconnecting=!1}else console.error("Cannot reconnect: No user ID"),this.reconnecting=!1}}reconnect(){this.enhancedReconnect()}disconnect(){if(console.log("Disconnecting socket"),this._stopHeartbeat(),this.stopConnectionMonitoring(),this.notificationSyncChannel)try{this.notificationSyncChannel.close(),this.notificationSyncChannel=null}catch(e){console.error("Error closing notification sync channel:",e)}if(this.socket){try{this.socket.disconnect()}catch(e){console.error("Error disconnecting socket:",e)}this.socket=null}this.connected=!1,this.reconnecting=!1}}const B_=new D_;class z_{constructor(){this.socket=B_,this.initialized=!1,this.showConnectionToasts=!0,this.debugMode=!1,this.eventListeners=new Map,this.pendingMessages=[],this.userId=null,this.connectionState="disconnected",this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectInterval=3e3,this.connectionMonitor=null}init(e,i,a={}){if(this.initialized&&this.socket.isConnected()&&this.userId===e)return this._log("Socket service already initialized and connected"),this.socket;this._clearConnectionMonitor(),this._log(`Initializing socket service for user: ${e}`),this.userId=e,this.reconnectAttempts=0;try{return this.socket.init(e,i,a),this.initialized=!0,this.connectionState="connecting",this.socket.on("connect",()=>{this._log("Socket connection established"),this.connectionState="connected",this.reconnectAttempts=0,this._processPendingMessages(),window.dispatchEvent(new CustomEvent("socketReconnected"))}),this.socket.on("disconnect",c=>{this._log(`Socket disconnected: ${c}`),this.connectionState="disconnected",this._startConnectionMonitor()}),this.socket.on("connect_error",c=>{this._log(`Socket connection error: ${c}`),this.connectionState="error",this._startConnectionMonitor()}),this._startConnectionMonitor(),this.socket}catch(c){throw this._log(`Socket initialization error: ${c.message}`,"error"),this.connectionState="error",c}}_startConnectionMonitor(){this.connectionMonitor||(this._log("Starting socket connection monitor"),this.connectionMonitor=setInterval(()=>{this.initialized&&this.connectionState!=="connected"&&this.reconnectAttempts<this.maxReconnectAttempts&&this.connectionState!=="reconnecting"&&(this._log(`Connection monitor: Socket is ${this.connectionState}, attempting reconnect`),this.reconnect())},15e3))}_clearConnectionMonitor(){this.connectionMonitor&&(clearInterval(this.connectionMonitor),this.connectionMonitor=null,this._log("Cleared socket connection monitor"))}isConnected(){return this.socket&&this.socket.isConnected()}reconnect(){if(this.connectionState==="connected")return this._log("Socket already connected, no need to reconnect"),this.reconnectAttempts=0,!0;if(this.reconnectAttempts>=this.maxReconnectAttempts)return this._log(`Maximum reconnect attempts (${this.maxReconnectAttempts}) reached, stopping reconnection attempts`,"warn"),setTimeout(()=>{this._log("Reconnect cooldown completed, resetting counter"),this.reconnectAttempts=0},3e4),!1;this.reconnectAttempts++,this._log(`Forcing socket reconnection (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),this.connectionState="reconnecting";try{return this.socket&&typeof this.socket.reconnect=="function"?this.socket.reconnect():(this._log("Socket not initialized, cannot reconnect","warn"),!1)}catch(e){return this._log(`Reconnection error: ${e.message}`,"error"),!1}}disconnect(){return this._log("Disconnecting socket"),this._clearConnectionMonitor(),this.initialized=!1,this.connectionState="disconnected",this.pendingMessages=[],this.savedListeners=Array.from(this.eventListeners.entries()),this.eventListeners.clear(),this.socket.disconnect()}on(e,i){if(!i||typeof i!="function")return this._log(`Invalid callback for event: ${e}`,"error"),()=>{};this._log(`Registering listener for event: ${e}`),this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(i);let a;try{a=this.socket.on(e,i)}catch(c){this._log(`Error registering event listener for ${e}: ${c.message}`,"error"),a=()=>{}}return()=>{this.eventListeners.has(e)&&(this.eventListeners.get(e).delete(i),this.eventListeners.get(e).size===0&&this.eventListeners.delete(e));try{a()}catch(c){this._log(`Error unsubscribing from event ${e}: ${c.message}`,"error")}}}off(e,i){this._log(`Removing listener for event: ${e}`);try{this.socket.off(e,i)}catch(a){this._log(`Error removing event listener for ${e}: ${a.message}`,"error")}this.eventListeners.has(e)&&i?(this.eventListeners.get(e).delete(i),this.eventListeners.get(e).size===0&&this.eventListeners.delete(e)):this.eventListeners.has(e)&&!i&&this.eventListeners.delete(e)}emit(e,i={}){if(!this.socket)return this._log(`Socket not initialized, cannot emit '${e}'`,"warn"),!1;if(!this.isConnected())return this._log(`Socket not connected, queueing '${e}'`,"warn"),this.pendingMessages.push({event:e,data:i,timestamp:Date.now()}),!0;try{return this._log(`Emitting event: ${e}`),this.socket.emit(e,i),!0}catch(a){return this._log(`Error emitting '${e}': ${a.message}`,"error"),["sendMessage","messageRead","answerCall"].includes(e)&&(this._log(`Adding failed '${e}' to pending queue for retry`,"warn"),this.pendingMessages.push({event:e,data:i,timestamp:Date.now()})),!1}}async sendMessage(e,i="text",a,c={}){return this._log(`Attempting to send ${i} message to ${e}`),new Promise((u,d)=>{const h=`temp-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,p={current:null};let y=!1;if(!this.isConnected()){this._log(`Socket not connected, returning pending message with id ${h}`);const M={_id:h,sender:this.userId,recipient:e,type:i,content:a,metadata:{...c,clientMessageId:h},createdAt:new Date().toISOString(),read:!1,pending:!0,status:"pending",tempMessageId:h};return this.pendingMessages.push({event:"sendMessage",data:{recipientId:e,type:i,content:a,metadata:{...c,clientMessageId:h},tempMessageId:h},timestamp:Date.now()}),u(M)}const g=()=>{y||(y=!0,this.socket.off("messageSent",w),this.socket.off("messageError",C),p.current&&(clearTimeout(p.current),p.current=null))},w=M=>{M&&M.tempMessageId===h&&(this._log(`Message confirmed sent: ${h}`),g(),u(M))},C=M=>{M&&M.tempMessageId===h&&(this._log(`Message error for ${h}: ${M.error||"Unknown error"}`,"error"),g(),d(new Error(M.error||"Failed to send message")))};this.socket.on("messageSent",w),this.socket.on("messageError",C);const j={...c,clientMessageId:h};if(this._log(`Emitting sendMessage with tempId: ${h}`),!this.socket.emit("sendMessage",{recipientId:e,type:i,content:a,metadata:j,tempMessageId:h})){this._log(`Message emission failed immediately for ${h}`,"error"),g(),u({_id:h,sender:this.userId,recipient:e,content:a,type:i,metadata:j,createdAt:new Date().toISOString(),read:!1,status:"pending",pending:!0,tempMessageId:h});return}p.current=setTimeout(()=>{y||(this._log(`Message timeout reached for ${h}`,"warn"),g(),u({_id:h,sender:this.userId,recipient:e,content:a,type:i,metadata:j,createdAt:new Date().toISOString(),read:!1,status:"pending",pending:!0,tempMessageId:h}))},1e4)})}sendTyping(e){this.isConnected()&&this.socket.emit("typing",{recipientId:e})}_processPendingMessages(){if(this.pendingMessages.length===0)return;this._log(`Processing ${this.pendingMessages.length} pending messages`);const e=[...this.pendingMessages];this.pendingMessages=[],e.forEach((i,a)=>{setTimeout(()=>{if(Date.now()-i.timestamp>3e5){this._log(`Skipping stale pending message of type ${i.event}`,"warn");return}this._log(`Processing queued message: ${i.event}`),this.emit(i.event,i.data)},a*100)})}initiateVideoCall(e){return this._log(`Initiating video call to ${e}`),new Promise((i,a)=>{if(!this.isConnected())return this._log("Socket not connected, cannot initiate call","error"),a(new Error("Socket not connected"));const c={callId:`call-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,recipientId:e,callType:"video",userId:this.userId,caller:{userId:this.userId,name:localStorage.getItem("userNickname")||"User"},timestamp:Date.now()},u=h=>{this._log(`Call initiated successfully: ${h.callId||"unknown"}`),this.socket.off("callInitiated",u),this.socket.off("callError",d),i(h)},d=h=>{this._log(`Call initiation error: ${h.message||"unknown"}`,"error"),this.socket.off("callInitiated",u),this.socket.off("callError",d),a(new Error(h.message||"Failed to initiate call"))};this.socket.on("callInitiated",u),this.socket.on("callError",d),this.socket.emit("initiateCall",c),setTimeout(()=>{this._log("Call initiation timeout reached","warn"),this.socket.off("callInitiated",u),this.socket.off("callError",d),i({success:!0,callId:c.callId})},5e3)})}answerVideoCall(e,i,a){if(this._log(`Answering call from ${e} with accept=${i}`),!this.isConnected())return this._log("Cannot answer call: Socket not connected","error"),!1;let c=0;const u=3,d=()=>{c++;const h=this.socket.emit("answerCall",{callerId:e,accept:i,callId:a,userId:this.userId,timestamp:Date.now()});return!h&&c<u&&(this._log(`Retrying call answer (attempt ${c})`,"warn"),setTimeout(d,1e3)),h};return d()}getStatus(){return{connected:this.isConnected(),initialized:this.initialized,userId:this.userId,state:this.connectionState,reconnectAttempts:this.reconnectAttempts,pendingMessages:this.pendingMessages.length}}setShowConnectionToasts(e){this.showConnectionToasts=e}updatePrivacySettings(e){e&&(this.privacySettings=e,e.showOnlineStatus!==void 0&&(this._log(`Updating online status visibility: ${e.showOnlineStatus}`),this.isConnected()&&this.socket.emit("updatePrivacySettings",{showOnlineStatus:e.showOnlineStatus})),this._log(`Privacy settings updated: ${JSON.stringify(e)}`))}setDebugMode(e){this.debugMode=e}_log(e,i="log"){if(!this.debugMode&&i==="log")return;const a="[SocketService]",c=new Date().toISOString().substring(11,19);switch(i){case"warn":console.warn(`${a} [${c}]`,e);break;case"error":console.error(`${a} [${c}]`,e);break;default:console.log(`${a} [${c}]`,e)}}}const Be=new z_,jr=Object.freeze(Object.defineProperty({__proto__:null,default:Be},Symbol.toStringTag,{value:"Module"})),Bn=An.create("NotificationService");class P_{constructor(){this.notifications=[],this.unreadCount=0,this.initialized=!1,this.userSettings=null,this.listeners=[],this.navigate=null,this.socketListeners=[],this.socketReconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectTimer=null,this.isLoading=!1,this.lastFetch=0,this.fetchQueue=Promise.resolve(),this.bundleTimeframe=60*60*1e3,this.notificationEventTypes=["notification","newMessage","newLike","photoPermissionRequestReceived","photoPermissionResponseReceived","newComment","incomingCall","newStory"],this.setupNotificationSyncChannel()}setupNotificationSyncChannel(){try{typeof BroadcastChannel<"u"?(this.notificationSyncChannel=new BroadcastChannel("notification_sync"),this.notificationSyncChannel.onmessage=e=>{const{type:i,data:a}=e.data||{};if(i)switch(i){case"NEW_NOTIFICATION":Bn.debug("Received new notification from another tab"),this.addBundledNotification(a),window.dispatchEvent(new CustomEvent("newNotification",{detail:a}));break;case"MARK_READ":a&&a.notificationId&&this.markAsRead(a.notificationId,!1);break;case"MARK_ALL_READ":this.markAllAsRead(!1);break;default:break}},Bn.info("Notification sync channel initialized")):Bn.warn("BroadcastChannel not supported, cross-tab sync disabled")}catch(e){Bn.error("Error setting up notification sync channel:",e),this.notificationSyncChannel=null}}setNavigate(e){typeof e=="function"?(this.navigate=e,Bn.debug("Navigate function set successfully in NotificationService")):Bn.warn("Attempted to set invalid navigate function in NotificationService")}initialize(e){var i,a;if(this.initialized){Bn.debug("NotificationService already initialized"),e&&e.notifications&&(Bn.debug("Updating settings of already initialized service:",e),this.userSettings=e);return}Bn.info("Initializing NotificationService with settings:",e),Bn.debug("Messages notification setting specifically:",(i=e==null?void 0:e.notifications)==null?void 0:i.messages,"typeof:",typeof((a=e==null?void 0:e.notifications)==null?void 0:a.messages)),this.userSettings=e||{notifications:{messages:!0,calls:!0,stories:!0,likes:!0,comments:!0,photoRequests:!0}},this.userSettings.notifications||(this.userSettings.notifications={messages:!0,calls:!0,stories:!0,likes:!0,comments:!0,photoRequests:!0}),this.checkSocketConnection(),this._setupSocketConnectionRetry(),this.initialized=!0,this.getNotifications().catch(c=>{Bn.error("Failed to fetch initial notifications:",c)}),Bn.info("NotificationService initialized successfully with settings:",this.userSettings),Bn.debug("Final messages notification setting:",this.userSettings.notifications.messages),document.addEventListener("visibilitychange",this._handleVisibilityChange.bind(this))}_setupSocketConnectionRetry(){this.reconnectTimer&&clearInterval(this.reconnectTimer),this.reconnectTimer=setInterval(()=>{!Be.isConnected()&&this.initialized?this.socketReconnectAttempts<this.maxReconnectAttempts?(Bn.info(`Attempting to reconnect socket for notifications (attempt ${this.socketReconnectAttempts+1}/${this.maxReconnectAttempts})`),this.socketReconnectAttempts++,this.checkSocketConnection()):this.socketReconnectAttempts===this.maxReconnectAttempts&&(Bn.warn("Max socket reconnection attempts reached for notifications"),this.socketReconnectAttempts++,clearInterval(this.reconnectTimer),this.reconnectTimer=setInterval(()=>{Bn.info("Periodic socket reconnection attempt for notifications"),this.checkSocketConnection()},12e4)):Be.isConnected()&&(this.socketReconnectAttempts=0)},3e4)}_handleVisibilityChange(){document.visibilityState==="visible"&&Date.now()-this.lastFetch>6e4&&(console.log("Tab became visible, refreshing notifications"),this.refreshNotifications())}cleanup(){this.socketListeners.forEach(e=>{typeof e=="function"&&e()}),this.socketListeners=[],this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null),this.notificationSyncChannel&&(this.notificationSyncChannel.close(),this.notificationSyncChannel=null),document.removeEventListener("visibilitychange",this._handleVisibilityChange),console.log("NotificationService resources cleaned up")}checkSocketConnection(){return Be.isConnected()?(console.log("Socket is connected, registering notification listeners"),this.registerSocketListeners(),!0):(console.log("Socket is not connected, notification listeners not registered"),!1)}registerSocketListeners(){if(this.cleanup(),!Be.isConnected()){console.warn("NotificationService: Socket not connected. Cannot register listeners.");return}const e=[{event:"newMessage",type:"message",settingName:"messages",handler:this._handleMessageNotification.bind(this)},{event:"incomingCall",type:"call",handler:this._handleCallNotification.bind(this)},{event:"newStory",type:"story",handler:this._handleStoryNotification.bind(this)},{event:"newLike",type:"like",handler:this._handleLikeNotification.bind(this)},{event:"newComment",type:"comment",handler:this._handleCommentNotification.bind(this)},{event:"photoPermissionRequestReceived",type:"photoRequest",handler:this._handlePhotoRequestNotification.bind(this)},{event:"photoPermissionResponseReceived",type:"photoResponse",handler:this._handlePhotoResponseNotification.bind(this)},{event:"notification",type:"generic",handler:this._handleGenericNotification.bind(this)}];e.forEach(({event:c,handler:u})=>{const d=Be.on(c,u);this.socketListeners.push(d)});const i=()=>{console.log("Socket reconnected, refreshing notifications"),this.refreshNotifications()},a=Be.on("connect",i);this.socketListeners.push(a),console.log(`Registered ${e.length} socket notification listeners`)}_handleMessageNotification(e){var i;if(console.log("Checking if message notification should be shown"),this.shouldShowNotification("message")&&e){console.log("Message notification will be shown");const a={_id:e._id||`msg-${Date.now()}`,type:"message",title:`New message from ${((i=e.sender)==null?void 0:i.nickname)||"Someone"}`,message:e.content,time:"Just now",read:!1,sender:e.sender,data:e,createdAt:e.createdAt||new Date().toISOString()};this.addBundledNotification(a)}else console.log("Message notification suppressed by settings")}_handleCallNotification(e){var i,a,c;if(this.shouldShowNotification("calls")&&e){const u={_id:e.callId||`call-${Date.now()}`,type:"call",title:`Incoming call from ${((i=e.caller)==null?void 0:i.name)||"Someone"}`,message:"Click to answer",time:"Just now",read:!1,sender:{_id:(a=e.caller)==null?void 0:a.userId,nickname:((c=e.caller)==null?void 0:c.name)||"Caller"},data:e,createdAt:new Date().toISOString()};this.addBundledNotification(u)}}_handleStoryNotification(e){var i;if(this.shouldShowNotification("stories")&&e){const a={_id:e._id||`story-${Date.now()}`,type:"story",title:`${((i=e.user)==null?void 0:i.nickname)||"Someone"} shared a new story`,message:"Click to view",time:"Just now",read:!1,sender:e.user,data:e,createdAt:e.createdAt||new Date().toISOString()};this.addBundledNotification(a)}}_handleLikeNotification(e){var i;if(this.shouldShowNotification("likes")&&e){const a={_id:e.likeId||`like-${Date.now()}`,type:"like",title:`${((i=e.sender)==null?void 0:i.nickname)||"Someone"} liked you`,message:e.isMatch?"You have a new match!":"Click to view profile",time:"Just now",read:!1,sender:e.sender,data:e,isMatch:e.isMatch,createdAt:e.timestamp?new Date(e.timestamp).toISOString():new Date().toISOString()};this.addBundledNotification(a)}}_handleCommentNotification(e){var i;if(this.shouldShowNotification("comments")&&e){const a={_id:e._id||`comment-${Date.now()}`,type:"comment",title:`${((i=e.user)==null?void 0:i.nickname)||"Someone"} commented on your post`,message:e.content||"Click to view",time:"Just now",read:!1,sender:e.user,data:e,createdAt:e.createdAt||new Date().toISOString()};this.addBundledNotification(a)}}_handlePhotoRequestNotification(e){var i;if(this.shouldShowNotification("photoRequests")&&e){const a=((i=e.sender)==null?void 0:i.nickname)||"Someone",c={_id:e.permissionId||`permReq-${Date.now()}`,type:"photoRequest",title:`${a} requested photo access`,message:"Click to review",time:"Just now",read:!1,sender:e.sender,data:e,createdAt:e.timestamp?new Date(e.timestamp).toISOString():new Date().toISOString()};this.addBundledNotification(c)}}_handlePhotoResponseNotification(e){var i;if(this.shouldShowNotification("photoRequests")&&e){const a=((i=e.sender)==null?void 0:i.nickname)||"Someone",c=e.status==="approved"?"approved":"rejected",u={_id:e.permissionId||`permRes-${Date.now()}`,type:"photoResponse",title:`${a} ${c} your request`,message:e.status==="approved"?"You can now view their photo.":"Request declined.",time:"Just now",read:!1,sender:e.sender,data:e,createdAt:e.timestamp?new Date(e.timestamp).toISOString():new Date().toISOString()};this.addBundledNotification(u),window.dispatchEvent(new CustomEvent("permissionStatusUpdated",{detail:{photoId:e.photoId,status:e.status}}))}}_handleGenericNotification(e){e!=null&&e.type&&this.shouldShowNotification(e.type)&&this.addBundledNotification(e)}shouldShowNotification(e){var a,c,u,d,h,p;if(!this.initialized||!this.userSettings)return console.log(`Notification check - not initialized yet, defaulting to show ${e}`),!0;if(e==="photoRequest"||e==="photoResponse"){const y=((a=this.userSettings.notifications)==null?void 0:a.photoRequests)!==!1;return console.log(`Notification ${e} check - photoRequests setting:`,(c=this.userSettings.notifications)==null?void 0:c.photoRequests,"shouldShow:",y),y}if(e==="message"){if(((u=this.userSettings.notifications)==null?void 0:u.message)!==void 0){const y=this.userSettings.notifications.message,g=y!==!1;return console.log('Message notification check - direct "message" setting:',y,"typeof:",typeof y,"shouldShow:",g),g}if(((d=this.userSettings.notifications)==null?void 0:d.messages)!==void 0){const y=this.userSettings.notifications.messages,g=y!==!1;return console.log('Message notification check - "messages" setting:',y,"typeof:",typeof y,"shouldShow:",g),g}return console.log("Message notification check - no setting found, defaulting to true"),!0}const i=((h=this.userSettings.notifications)==null?void 0:h[e])!==!1;return console.log(`Notification ${e} check - setting:`,(p=this.userSettings.notifications)==null?void 0:p[e],"shouldShow:",i),i}isValidNotification(e){if(!e)return!1;const i=e._id||e.id,a=e.message||e.title||e.content,c=e.type;return!!(i&&a&&c)}sanitizeNotification(e){if(!e)return null;const i={...e};return!i._id&&!i.id&&(i._id=`gen-${Date.now()}-${Math.random().toString(16).substring(2,8)}`),!i.message&&i.title?i.message=i.title:!i.message&&!i.title&&(i.message="New notification"),i.type||(i.type="system"),i.createdAt||(i.createdAt=new Date().toISOString()),i.read===void 0&&(i.read=!1),i.time||(i.time="Just now"),i}addBundledNotification(e){var u,d,h,p,y;const i=this.sanitizeNotification(e);if(!i||!this.isValidNotification(i)){console.warn("Skipping invalid notification:",e);return}const a=new Date;new Date(i.createdAt);const c=((u=i.sender)==null?void 0:u._id)||((d=i.sender)==null?void 0:d.id)||((p=(h=i.data)==null?void 0:h.sender)==null?void 0:p._id);if(c){const g=this.notifications.findIndex(w=>{var N,M,D,I;if((((N=w.sender)==null?void 0:N._id)||((M=w.sender)==null?void 0:M.id)||((I=(D=w.data)==null?void 0:D.sender)==null?void 0:I._id))!==c||w.type!==i.type)return!1;const j=new Date(w.createdAt);return a-j<this.bundleTimeframe});if(g!==-1){const w=this.notifications[g],C=w.count||1;return this.notifications[g]={...w,count:C+1,message:this._getBundledMessage(i.type,C+1,(y=w.sender)==null?void 0:y.nickname),updatedAt:a.toISOString(),read:!1},w.read&&this.unreadCount++,this.notifyListeners(),this._syncToOtherTabs("NEW_NOTIFICATION",this.notifications[g]),this.notifications[g]}}return i.count=1,this.notifications.unshift(i),i.read||this.unreadCount++,this.notifyListeners(),this._syncToOtherTabs("NEW_NOTIFICATION",i),window.dispatchEvent(new CustomEvent("newNotification",{detail:i})),console.log(`Added notification: ${i.type} - ${i.title||i.message}`),i}_syncToOtherTabs(e,i){if(this.notificationSyncChannel)try{this.notificationSyncChannel.postMessage({type:e,data:i})}catch(a){console.error("Error syncing to other tabs:",a)}}_getBundledMessage(e,i,a){switch(e){case"message":return`${i} new messages from ${a||"this user"}`;case"like":return`${a||"Someone"} and ${i-1} others liked you`;case"comment":return`${i} new comments on your post`;case"photoRequest":return`${i} photo access requests`;case"photoResponse":return`${i} responses to your photo requests`;case"story":return`${a||"Someone"} shared ${i} new stories`;default:return`${i} new notifications`}}showToast(e){console.log("Toast notifications have been disabled")}addNotification(e){return this.addBundledNotification(e)}handleNotificationClick(e){var i,a,c,u,d,h,p,y;if(e){if(console.log("Handling click for notification:",e),e.read||this.markAsRead(e._id||e.id),!this.navigate){console.warn("Cannot navigate - navigate function not set in NotificationService"),window.dispatchEvent(new CustomEvent("notificationClicked",{detail:e}));return}try{switch(e.type){case"message":const g=((i=e.sender)==null?void 0:i._id)||((c=(a=e.data)==null?void 0:a.sender)==null?void 0:c._id);g?this.navigate(`/messages/${g}`):this.navigate("/messages");break;case"like":case"match":const w=(u=e.sender)==null?void 0:u._id;w?this.navigate(`/user/${w}`):this.navigate("/matches");break;case"photoRequest":this.navigate("/settings?tab=privacy");break;case"photoResponse":const C=(d=e.sender)==null?void 0:d._id;C?this.navigate(`/user/${C}`):this.navigate("/dashboard");break;case"story":const j=((h=e.data)==null?void 0:h.storyId)||e._id;j?window.dispatchEvent(new CustomEvent("viewStory",{detail:{storyId:j}})):this.navigate("/dashboard");break;case"call":window.dispatchEvent(new CustomEvent("callNotificationClicked",{detail:e}));break;case"comment":const N=((p=e.data)==null?void 0:p.referenceId)||((y=e.data)==null?void 0:y.postId);N?this.navigate(`/post/${N}`):this.navigate("/dashboard");break;default:this.navigate("/dashboard")}document.querySelectorAll(".notification-dropdown").forEach(g=>{g instanceof HTMLElement&&(g.style.display="none")})}catch(g){console.error("Error during notification navigation:",g),this.navigate("/dashboard")}}}markAsRead(e,i=!0){if(!e)return;const a=this.notifications.findIndex(u=>u._id&&u._id===e||u.id&&u.id===e);if(a===-1||this.notifications[a].read)return;const c=[...this.notifications];c[a]={...c[a],read:!0},this.notifications=c,this.unreadCount=Math.max(0,this.unreadCount-1),this.notifyListeners(),i&&this._syncToOtherTabs("MARK_READ",{notificationId:e}),e&&/^[0-9a-fA-F]{24}$/.test(e)&&st.put("/notifications/read",{ids:[e]}).catch(u=>{console.warn(`Failed to mark notification ${e} as read on server:`,u),st.put(`/notifications/${e}/read`).catch(d=>console.warn(`Failed backend markAsRead for ${e}:`,d))})}markAllAsRead(e=!0){if(this.unreadCount===0)return;this.notifications=this.notifications.map(a=>({...a,read:!0})),this.unreadCount=0,this.notifyListeners(),e&&this._syncToOtherTabs("MARK_ALL_READ");const i=this.notifications.map(a=>a._id||a.id).filter(a=>a&&/^[0-9a-fA-F]{24}$/.test(a));i.length>0&&st.put("/notifications/read-all").catch(a=>{console.warn("Failed to mark all notifications as read on server:",a),st.put("/notifications/read",{ids:i}).catch(c=>console.warn("Failed backend markAllAsRead:",c))})}async getNotifications(e={}){return this.fetchQueue=this.fetchQueue.then(async()=>{if(this.isLoading)return console.log("Notifications already loading, request queued"),this.notifications;this.isLoading=!0;let i=!1;try{this.initialized||console.warn("Trying to fetch notifications before initialization"),console.log("Fetching notifications from server...");const a=await st.get("/notifications",e);if(this.lastFetch=Date.now(),a.success&&Array.isArray(a.data)){const c=a.data.map(d=>this.sanitizeNotification(d)).filter(d=>this.isValidNotification(d)),u=this._bundleServerNotifications(c);return this.notifications=u,this.unreadCount=u.filter(d=>!d.read).length,this.notifyListeners(),console.log(`Loaded ${u.length} notifications from server`),i=!0,this.notifications}return console.log("No notifications found or invalid response format"),this.notifications=[],this.unreadCount=0,this.notifyListeners(),[]}catch(a){return console.error("Error fetching notifications from API:",a),!i&&this.notifications.length===0&&(this.notifications=[],this.unreadCount=0,this.notifyListeners()),this.notifications}finally{this.isLoading=!1}}).catch(i=>(console.error("Unexpected error in notification fetch queue:",i),this.isLoading=!1,this.notifications)),this.fetchQueue}_bundleServerNotifications(e){const i={};e.forEach(c=>{var g,w,C,j;const u=((g=c.sender)==null?void 0:g._id)||((w=c.sender)==null?void 0:w.id)||((j=(C=c.data)==null?void 0:C.sender)==null?void 0:j._id);if(!u||!c.type)return;const d=`${u}:${c.type}`,h=new Date,p=new Date(c.createdAt);h-p<=this.bundleTimeframe&&(i[d]?i[d].push(c):i[d]=[c])});const a=[];return e.forEach(c=>{var d,h,p,y;(!(((d=c.sender)==null?void 0:d._id)||((h=c.sender)==null?void 0:h.id)||((y=(p=c.data)==null?void 0:p.sender)==null?void 0:y._id))||!c.type)&&a.push(c)}),Object.values(i).forEach(c=>{var u;if(c.length===1)a.push(c[0]);else{const d=c.sort((h,p)=>new Date(p.createdAt)-new Date(h.createdAt))[0];a.push({...d,count:c.length,message:this._getBundledMessage(d.type,c.length,(u=d.sender)==null?void 0:u.nickname)})}}),a.sort((c,u)=>new Date(u.createdAt)-new Date(c.createdAt))}updateSettings(e){console.log("Updating NotificationService settings:",e),console.log("Messages notification setting specifically:",e==null?void 0:e.messages,"typeof:",typeof(e==null?void 0:e.messages));const i={};e&&(i.messages=e.messages===!1?!1:!!e.messages,i.calls=e.calls===!1?!1:!!e.calls,i.stories=e.stories===!1?!1:!!e.stories,i.likes=e.likes===!1?!1:!!e.likes,i.comments=e.comments===!1?!1:!!e.comments,i.photoRequests=e.photoRequests===!1?!1:!!e.photoRequests),console.log("Normalized notification settings:",i),this.userSettings={...this.userSettings,notifications:i},Pn(()=>Promise.resolve().then(()=>MT),void 0).then(a=>a.default.updateNotificationSettings(i)).then(()=>console.log("Notification settings saved to server")).catch(a=>console.error("Failed to save notification settings to server:",a)),this.notifyListeners(),console.log("Final state of notification settings:",this.userSettings.notifications)}addListener(e){return typeof e!="function"?()=>{}:(this.listeners.push(e),e({notifications:[...this.notifications],unreadCount:this.unreadCount}),()=>{this.listeners=this.listeners.filter(i=>i!==e)})}notifyListeners(){const e={notifications:[...this.notifications],unreadCount:this.unreadCount};this.listeners.forEach(i=>{try{i(e)}catch(a){console.error("Notify listener error:",a)}})}refreshNotifications(){return this.getNotifications({_t:Date.now()})}addTestNotification(){const e=[{type:"message",title:"Test Message",message:"Hello!"},{type:"like",title:"Test Like",message:"Someone liked you."},{type:"photoRequest",title:"Test Request",message:"Wants photo access."},{type:"photoResponse",title:"Test Response",message:"Request approved.",data:{status:"approved"}},{type:"comment",title:"Test Comment",message:"Someone commented on your post."}],i=e[Math.floor(Math.random()*e.length)],a={_id:`test-${Date.now()}`,...i,sender:{nickname:"Tester",_id:`testUser-${Date.now()}`},read:!1,createdAt:new Date().toISOString()};return this.addBundledNotification(a),this.createTestNotificationOnServer(a.type),a}async createTestNotificationOnServer(e="system"){try{const i=await st.post("/notifications/create-test",{type:e});i!=null&&i.success&&console.log("Created test notification on server:",i.data)}catch(i){console.warn("Failed to create test notification on server:",i)}}}const kn=new P_;function Ib(){const t=In();b.useEffect(()=>{kn.setNavigate(t),console.log("NotificationService navigation initialized via hook"),kn.initialized&&kn.checkSocketConnection();const e=()=>{console.log("Socket reconnected - reinitializing notification listeners"),kn.initialized&&kn.checkSocketConnection()};return window.addEventListener("socketReconnected",e),()=>{window.removeEventListener("socketReconnected",e)}},[t])}kn.globalCleanup=()=>{kn.cleanup()};const Cr=Object.freeze(Object.defineProperty({__proto__:null,default:kn,useInitializeNotificationServiceNavigation:Ib},Symbol.toStringTag,{value:"Module"})),Fb=b.createContext(),$_=({children:t})=>{const{isAuthenticated:e,user:i}=Sn(),[a,c]=b.useState([]),[u,d]=b.useState(0),[h,p]=b.useState(!1),[y,g]=b.useState(!1),w=In(),C=b.useCallback(async()=>{try{p(!0),console.log("Fetching notifications from server");const O=await kn.getNotifications();return console.log(`Fetched ${O.length} notifications`),c(O),d(O.filter(A=>!A.read).length),O}catch(O){return console.error("Error fetching notifications:",O),[]}finally{p(!1)}},[]);b.useEffect(()=>{w&&(kn.setNavigate(w),console.log("NotificationService navigation initialized"))},[w]),b.useEffect(()=>{if(!e||!i)return;const O=E=>{console.log("New notification received via socket:",E),c(L=>{if(L.some(Q=>Q._id&&E._id&&Q._id===E._id||Q.id&&E.id&&Q.id===E.id))return L;const G=[E,...L];return console.log("Updated notifications state with new notification"),G}),E.read||d(L=>L+1)},A=()=>{console.log("Socket connected - enabling real-time notifications"),g(!0),C()},H=()=>{console.log("Socket disconnected - real-time notifications paused"),g(!1)};return Be.socket&&(console.log("Setting up direct socket listeners for notifications"),Be.socket.on("notification",O),Be.socket.on("newMessage",O),Be.socket.on("newLike",O),Be.socket.on("photoPermissionRequestReceived",O),Be.socket.on("photoPermissionResponseReceived",O),Be.socket.on("newComment",O),Be.socket.on("incomingCall",O),Be.socket.on("connect",A),Be.socket.on("disconnect",H),g(Be.isConnected())),()=>{Be.socket&&(Be.socket.off("notification",O),Be.socket.off("newMessage",O),Be.socket.off("newLike",O),Be.socket.off("photoPermissionRequestReceived",O),Be.socket.off("photoPermissionResponseReceived",O),Be.socket.off("newComment",O),Be.socket.off("incomingCall",O),Be.socket.off("connect",A),Be.socket.off("disconnect",H))}},[e,i,C]),b.useEffect(()=>{let O=null;return(async()=>{if(e&&i){p(!0),console.log("Initializing notification service");const H=i.settings||{notifications:{messages:!0,calls:!0,stories:!0,likes:!0,comments:!0,photoRequests:!0}};kn.initialize(H),O=kn.addListener(E=>{E&&E.notifications&&(c(E.notifications),d(E.unreadCount),console.log("Notifications updated through service listener"))}),await C(),kn.initialized&&kn.registerSocketListeners()}else c([]),d(0)})(),()=>{O&&O()}},[e,i,C]),b.useEffect(()=>{if(!e||!i)return;const O=3e4;if(!y){console.log("Socket disconnected, setting up polling for notifications");const A=setInterval(async()=>{console.log("Polling for new notifications"),await C()},O);return()=>clearInterval(A)}},[e,i,y,C]);const j=()=>{const O=kn.addTestNotification();c(A=>[O,...A]),d(A=>A+1),ne.info(`Added test ${O.type} notification`)},N=O=>{kn.markAsRead(O),c(A=>A.map(H=>H._id&&H._id===O||H.id&&H.id===O?{...H,read:!0}:H)),d(A=>Math.max(0,A-1))},M=()=>{kn.markAllAsRead(),c(O=>O.map(A=>({...A,read:!0}))),d(0)},D=O=>{if(O&&!O.read){const A=O._id||O.id;A&&N(A)}kn.handleNotificationClick(O)},I=async()=>{await C()},V=O=>{c(A=>[O,...A]),d(A=>A+1)},F=b.useCallback(O=>{var H,E;if(!O)return;console.log("Received like notification:",O);const A={_id:O._id||`like-${Date.now()}`,type:O.isMatch?"match":"like",title:O.isMatch?`You have a match with ${((H=O.sender)==null?void 0:H.nickname)||"Someone"}!`:`${((E=O.sender)==null?void 0:E.nickname)||"Someone"} liked you`,message:O.isMatch?"You both liked each other. Start a conversation now!":"Someone has shown interest in your profile",sender:O.sender,createdAt:O.timestamp||new Date().toISOString(),read:!1};V(A),ne.success(o.jsxs("div",{className:"notification-toast",children:[o.jsx("div",{className:"notification-icon",children:o.jsx(vi,{className:O.isMatch?"match-icon pulse":"like-icon pulse"})}),o.jsxs("div",{className:"notification-content",children:[o.jsx("div",{className:"notification-title",children:A.title}),o.jsx("div",{className:"notification-message",children:A.message})]})]}),{autoClose:5e3})},[V]);return b.useEffect(()=>{if(!(!Be.socket||!e))return Be.socket.on("newLike",F),()=>{Be.socket&&Be.socket.off("newLike",F)}},[Be.socket,e,F]),o.jsx(Fb.Provider,{value:{notifications:a,unreadCount:u,isLoading:h,socketConnected:y,addTestNotification:j,markAsRead:N,markAllAsRead:M,handleNotificationClick:D,refreshNotifications:I},children:t})},qb=()=>{const t=b.useContext(Fb);if(t===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return t},Zt=An.create("ChatConnectionContext"),U_=b.createContext(),I_=({children:t})=>{const{user:e,isAuthenticated:i,token:a}=Sn(),[c,u]=b.useState(Be.isConnected()),[d,h]=b.useState(!1),[p,y]=b.useState(0),[g,w]=b.useState(null);b.useEffect(()=>{let N=!0;return(async()=>{i&&(e!=null&&e._id)&&a?(await new Promise(D=>setTimeout(D,500)),N&&(Zt.debug("User authenticated, initializing socket"),C())):i||(u(!1),h(!1),w(null))})(),()=>{N=!1;try{Be.isConnected()&&(Zt.debug("Disconnecting socket on cleanup"),Be.disconnect())}catch(D){console.error("Error during socket cleanup:",D)}}},[i,e,a]);const C=()=>{if(!i){Zt.warn("Cannot initialize socket: Not authenticated");return}if(!e){Zt.warn("Cannot initialize socket: No user object available");{w("User data is missing. Please refresh the page or log in again.");return}}const N=e==null?void 0:e._id;if(!N){Zt.warn("Cannot initialize socket: No user ID available");{w("User ID is missing. Please refresh the page or log in again.");return}}let M;try{const I=V=>V&&/^[0-9a-fA-F]{24}$/.test(V.toString());if(N){if(typeof N=="string"&&I(N))M=N;else if(typeof N=="object"&&N!==null)try{const F=N.toString().match(/([0-9a-fA-F]{24})/);F&&F[1]&&(M=F[1],Zt.debug(`Extracted ObjectId from complex object: ${M}`))}catch(V){Zt.error(`Failed to extract valid ID from object: ${V.message}`)}}if(!M||!I(M)){Zt.warn(`User has invalid ID: ${N}, trying token-based ID`);try{const V=sessionStorage.getItem("token")||localStorage.getItem("token");if(V){const O=V.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),A=JSON.parse(atob(O)),H=A.id||A.sub||A.user&&(A.user._id||A.user.id);H&&I(H)&&(M=H,Zt.info(`Using ID from token payload: ${M}`))}}catch(V){Zt.error(`Failed to extract ID from token: ${V.message}`)}}}catch(I){Zt.error("Error validating user ID:",I),M=N&&/^[0-9a-fA-F]{24}$/.test(N)?N:null}if(!M){Zt.error(`Cannot initialize socket: Invalid user ID format: ${N}`),w("Invalid user ID format. Please try logging out and in again.");return}if(Be.isConnected()){Zt.debug("Socket already connected"),u(!0),h(!1);return}const D=a||localStorage.getItem("token")||sessionStorage.getItem("token");if(!D){Zt.error("Cannot initialize socket: No auth token available"),w("Authentication token missing. Please log in again.");return}Zt.debug(`Initializing socket for user ${M}`),h(!0);try{Be.init(M,D);const I=()=>{Zt.info("Socket connected successfully"),u(!0),h(!1),w(null),y(0)},V=E=>{Zt.warn(`Socket disconnected: ${E}`),u(!1),E==="io server disconnect"?(h(!1),w("The server disconnected your session. Please refresh the page.")):E==="transport close"||E==="transport error"?Zt.info("Network disconnect - will attempt reconnection"):h(!1)},F=E=>{const L=(E==null?void 0:E.message)||"Unknown error";Zt.error(`Socket error: ${L}`),w(`Connection error: ${L}`),h(!1)},O=E=>{var G,Q;const L=(E==null?void 0:E.message)||"Unknown error";Zt.error(`Socket connection error: ${L}`),h(!1);const P=p+1;y(P),((G=E==null?void 0:E.message)!=null&&G.includes("auth")||(Q=E==null?void 0:E.message)!=null&&Q.includes("token"))&&P>2?w("Authentication failed. Please try refreshing the page or log out and log in again."):P>3?w(`Connection error: ${L}`):Zt.info(`Connection attempt ${P} failed, will retry`)},A=[Be.on("connect",I),Be.on("disconnect",V),Be.on("error",F),Be.on("connect_error",O)],H=setInterval(()=>{!Be.isConnected()&&i&&(e!=null&&e._id)&&p<5&&(Zt.debug(`Auto reconnect attempt ${p+1}`),y(L=>L+1),Be.reconnect())},3e4);return()=>{A.forEach(E=>E()),clearInterval(H)}}catch(I){Zt.error(`Error initializing socket: ${I.message}`),h(!1),w(`Failed to connect: ${I.message}`)}};b.useEffect(()=>{const N=()=>{!document.hidden&&i&&(e!=null&&e._id)&&!Be.isConnected()&&!d&&(Zt.debug("Page became visible, reconnecting socket"),Be.reconnect())};return document.addEventListener("visibilitychange",N),()=>{document.removeEventListener("visibilitychange",N)}},[i,e,d]);const j={connected:c,connecting:d,error:g,reconnectAttempts:p,initializeSocket:C};return o.jsx(U_.Provider,{value:j,children:t})};class Vb extends b.Component{constructor(e){super(e),this.state={hasError:!1,errorMessage:"",errorStack:""}}static getDerivedStateFromError(e){return{hasError:!0,errorMessage:e.message||"An unknown error occurred"}}componentDidCatch(e,i){const a=e.message||"An unknown error occurred",c=e.stack||i.componentStack||"";console.error("ErrorBoundary caught an error",a,c),this.setState({errorMessage:a,errorStack:c})}render(){return this.state.hasError?o.jsxs("div",{className:"error-boundary",children:[o.jsx("h1",{children:"Something went wrong"}),o.jsx("p",{children:"We're sorry, but an error occurred. Please try refreshing the page."}),o.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Refresh Page"}),!1]}):this.props.children}}const pa=({children:t})=>{const{user:e,isAuthenticated:i,loading:a,error:c}=Sn(),u=$h(),[d,h]=b.useState(!1);return b.useEffect(()=>{if(c){h(!0);const p=setTimeout(()=>{h(!1)},3e3);return()=>clearTimeout(p)}},[c]),a?o.jsxs("div",{className:"loading-container",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{className:"loading-text",children:"Loading..."})]}):d?o.jsx("div",{className:"auth-error",children:o.jsxs("div",{className:"auth-error-content",children:[o.jsx(Kt,{className:"auth-error-icon"}),o.jsx("h3",{children:"Authentication Error"}),o.jsx("p",{children:c||"Authentication failed"})]})}):!i||!e?o.jsx(Dw,{to:"/login",state:{from:u.pathname},replace:!0}):t},F_="_loginContainer_5udi8_1",q_="_gradientBar_5udi8_17",V_="_pageTitle_5udi8_24",H_="_subtitle_5udi8_40",G_="_formGroup_5udi8_51",Y_="_formLabel_5udi8_55",X_="_inputWrapper_5udi8_66",K_="_inputIcon_5udi8_72",Q_="_input_5udi8_66",W_="_errorMessage_5udi8_102",Z_="_togglePassword_5udi8_111",J_="_rememberForgotWrapper_5udi8_133",eS="_checkboxLabel_5udi8_140",tS="_checkbox_5udi8_140",nS="_forgotPassword_5udi8_159",sS="_submitButton_5udi8_171",iS="_spinner_5udi8_199",aS="_divider_5udi8_213",rS="_socialButton_5udi8_246",oS="_googleIcon_5udi8_280",lS="_facebookIcon_5udi8_284",cS="_footer_5udi8_288",uS="_footerLink_5udi8_299",dS="_alert_5udi8_311",fS="_alertDanger_5udi8_320",Ut={loginContainer:F_,gradientBar:q_,pageTitle:V_,subtitle:H_,formGroup:G_,formLabel:Y_,inputWrapper:X_,inputIcon:K_,input:Q_,errorMessage:W_,togglePassword:Z_,rememberForgotWrapper:J_,checkboxLabel:eS,checkbox:tS,forgotPassword:nS,submitButton:sS,spinner:iS,divider:aS,socialButton:rS,googleIcon:oS,facebookIcon:lS,footer:cS,footerLink:uS,alert:dS,alertDanger:fS},hS=()=>{var A;const[t,e]=b.useState({email:"",password:""}),[i,a]=b.useState(!1),[c,u]=b.useState(!1),[d,h]=b.useState({}),[p,y]=b.useState(!1),{login:g,error:w,clearError:C,isAuthenticated:j}=Sn(),N=In(),M=$h(),D=((A=M.state)==null?void 0:A.from)||"/dashboard";b.useEffect(()=>{j&&N(D)},[j,N,D]),b.useEffect(()=>{var H;(H=M.state)!=null&&H.email&&e(E=>({...E,email:M.state.email})),C()},[]),b.useEffect(()=>{w&&(h({general:w}),y(!1))},[w]);const I=()=>{const H={},E=/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/;return t.email?E.test(t.email)||(H.email="Invalid email format"):H.email="Email is required",t.password?t.password.length<6&&(H.password="Password must be at least 6 characters"):H.password="Password is required",H},V=H=>{const{name:E,value:L}=H.target;e({...t,[E]:L}),d[E]&&h({...d,[E]:""})},F=async H=>{H.preventDefault();const E=I();if(Object.keys(E).length>0){h(E);return}h({}),y(!0);try{await g({email:t.email,password:t.password})}catch(L){console.error("Login error",L)}},O=()=>{a(!i)};return o.jsx("div",{className:"auth-page login-page d-flex min-vh-100 bg-light-subtle",children:o.jsxs("div",{className:Ut.loginContainer,children:[o.jsx("div",{className:Ut.gradientBar}),o.jsxs("div",{className:"text-center mb-4",children:[o.jsx(_n,{to:"/",className:Ut.pageTitle,children:"Mandarin"}),o.jsx("p",{className:Ut.subtitle,children:"Sign in to continue your journey"})]}),d.general&&o.jsxs("div",{className:`${Ut.alert} ${Ut.alertDanger}`,children:[o.jsx(Kt,{}),o.jsx("p",{className:"mb-0",children:d.general})]}),o.jsxs("form",{onSubmit:F,children:[o.jsxs("div",{className:Ut.formGroup,children:[o.jsx("label",{className:Ut.formLabel,htmlFor:"email",children:"Email Address"}),o.jsxs("div",{className:Ut.inputWrapper,children:[o.jsx(Yh,{className:Ut.inputIcon}),o.jsx("input",{type:"email",id:"email",name:"email",className:Ut.input,placeholder:"Enter your email",value:t.email,onChange:V,disabled:p,autoComplete:"email"})]}),d.email&&o.jsxs("p",{className:Ut.errorMessage,children:[o.jsx(Kt,{}),d.email]})]}),o.jsxs("div",{className:Ut.formGroup,children:[o.jsx("label",{className:Ut.formLabel,htmlFor:"password",children:"Password"}),o.jsxs("div",{className:Ut.inputWrapper,children:[o.jsx(Ss,{className:Ut.inputIcon}),o.jsx("input",{type:i?"text":"password",id:"password",name:"password",className:Ut.input,placeholder:"Enter your password",value:t.password,onChange:V,disabled:p,autoComplete:"current-password"}),o.jsx("button",{type:"button",className:Ut.togglePassword,onClick:O,tabIndex:-1,children:i?o.jsx(vb,{}):o.jsx(wr,{})})]}),d.password&&o.jsxs("p",{className:Ut.errorMessage,children:[o.jsx(Kt,{}),d.password]})]}),o.jsxs("div",{className:Ut.rememberForgotWrapper,children:[o.jsxs("label",{className:Ut.checkboxLabel,children:[o.jsx("input",{type:"checkbox",className:Ut.checkbox,checked:c,onChange:()=>u(!c),disabled:p}),"Remember me"]}),o.jsx(_n,{to:"/forgot-password",className:Ut.forgotPassword,children:"Forgot Password?"})]}),o.jsx("button",{type:"submit",className:Ut.submitButton,disabled:p,children:p?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:Ut.spinner}),o.jsx("span",{children:"Signing in..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Sign In"}),o.jsx(xr,{})]})})]}),o.jsx("div",{className:Ut.divider,children:"OR"}),o.jsxs("div",{children:[o.jsxs("button",{className:Ut.socialButton,children:[o.jsx(hb,{className:Ut.googleIcon}),o.jsx("span",{children:"Sign in with Google"})]}),o.jsxs("button",{className:Ut.socialButton,children:[o.jsx(fb,{className:Ut.facebookIcon}),o.jsx("span",{children:"Sign in with Facebook"})]})]}),o.jsxs("div",{className:Ut.footer,children:["Don't have an account?"," ",o.jsx(_n,{to:"/register",className:Ut.footerLink,children:"Sign Up"})]})]})})},mS="_registerContainer_ruz71_1",gS="_gradientBar_ruz71_17",pS="_pageTitle_ruz71_24",yS="_subtitle_ruz71_40",vS="_progressContainer_ruz71_51",bS="_progressSteps_ruz71_55",xS="_progressLine_ruz71_64",wS="_progressStep_ruz71_55",_S="_stepCircle_ruz71_85",SS="_stepLabel_ruz71_107",jS="_active_ruz71_117",CS="_stepHeader_ruz71_133",NS="_formGroup_ruz71_158",TS="_formLabel_ruz71_162",kS="_inputWrapper_ruz71_173",ES="_inputIcon_ruz71_179",AS="_input_ruz71_173",RS="_errorMessage_ruz71_209",MS="_helpText_ruz71_218",LS="_togglePassword_ruz71_228",OS="_formActions_ruz71_250",DS="_button_ruz71_256",BS="_buttonOutline_ruz71_269",zS="_buttonPrimary_ruz71_290",PS="_spinner_ruz71_307",$S="_spin_ruz71_307",US="_alert_ruz71_321",IS="_alertDanger_ruz71_330",FS="_tagContainer_ruz71_339",qS="_tag_ruz71_339",VS="_selected_ruz71_372",HS="_tagCheck_ruz71_384",GS="_checkboxGroup_ruz71_388",YS="_checkboxLabel_ruz71_392",XS="_checkboxLabelError_ruz71_405",KS="_checkbox_ruz71_388",QS="_divider_ruz71_415",WS="_socialButtons_ruz71_448",ZS="_socialButton_ruz71_448",JS="_googleIcon_ruz71_486",e8="_facebookIcon_ruz71_490",t8="_footer_ruz71_494",n8="_footerLink_ruz71_505",s8="_photoUploadContainer_ruz71_517",i8="_photoUploadArea_ruz71_521",a8="_hasImage_ruz71_548",r8="_photoUploadIcon_ruz71_553",o8="_photoUploadText_ruz71_559",l8="_profileImagePreview_ruz71_570",c8="_uploadGuidelines_ruz71_576",u8="_photoActions_ruz71_587",d8="_photoActionButton_ruz71_594",f8="_changePhotoButton_ruz71_605",h8="_removePhotoButton_ruz71_609",te={registerContainer:mS,gradientBar:gS,pageTitle:pS,subtitle:yS,progressContainer:vS,progressSteps:bS,progressLine:xS,progressStep:wS,stepCircle:_S,stepLabel:SS,active:jS,stepHeader:CS,formGroup:NS,formLabel:TS,inputWrapper:kS,inputIcon:ES,input:AS,errorMessage:RS,helpText:MS,togglePassword:LS,formActions:OS,button:DS,buttonOutline:BS,buttonPrimary:zS,spinner:PS,spin:$S,alert:US,alertDanger:IS,tagContainer:FS,tag:qS,selected:VS,tagCheck:HS,checkboxGroup:GS,checkboxLabel:YS,checkboxLabelError:XS,checkbox:KS,divider:QS,socialButtons:WS,socialButton:ZS,googleIcon:JS,facebookIcon:e8,footer:t8,footerLink:n8,photoUploadContainer:s8,photoUploadArea:i8,hasImage:a8,photoUploadIcon:r8,photoUploadText:o8,profileImagePreview:l8,uploadGuidelines:c8,photoActions:u8,photoActionButton:d8,changePhotoButton:f8,removePhotoButton:h8},m8=()=>{var Rt;const[t,e]=b.useState(1),[i,a]=b.useState({nickname:"",email:"",password:"",confirmPassword:"",dateOfBirth:"",location:"",interests:[],lookingFor:[],agreeTerms:!1,agreePrivacy:!1,newsletter:!1,iAm:"",intoTags:[],turnOns:[],maritalStatus:"",profilePhoto:null}),[c,u]=b.useState(null),d=b.useRef(null),[h,p]=b.useState(!1),[y,g]=b.useState({}),[w,C]=b.useState(!1),[j,N]=b.useState(!1),[M,D]=b.useState({}),[I,V]=b.useState([]),{register:F,error:O,isAuthenticated:A}=Sn(),H=In(),E=$h(),L=["Dating","Casual","Friendship","Long-term","Travel","Outdoors","Movies","Music","Fitness","Food","Art","Reading","Gaming","Photography","Dancing","Cooking","Sports"],P=["woman","man","couple"],G=["women","men","couples"],Q=["Meetups","Power play","Threesomes","Online fun","Hot chat","Photo sharing","Camera chat","Cuckold","Golden showers","Strap-on","Forced bi","Erotic domination","Humiliation","Crossdressing","Worship","Foot fetish","Oral","From behind","Role-play","Toys","Massages","Foreplay","Casual meetups","Fantasy fulfillment","Bizarre","Education","Experiences","Tantra"],z=["Sexy ass","Dirty talk","Aggressive","Slow and gentle","In a public place","Pampering","Sexy clothing","Leather/latex clothing","Watching porn","Fit body","Bathing together","Erotic writing","Eye contact","Being pampered","Sexy legs","Teasing","Pushing boundaries"],ae=["Single","Married","Divorced","Separated","Widowed","In a relationship","It's complicated","Open relationship","Polyamorous"],Pe=["Tel Aviv, Israel","Jerusalem, Israel","Haifa, Israel","Eilat, Israel","Beer Sheva, Israel","Netanya, Israel","Herzliya, Israel","Ashdod, Israel","Ashkelon, Israel","Tiberias, Israel","Ramat Gan, Israel","Rishon LeZion, Israel","Petah Tikva, Israel","Holon, Israel","Bat Yam, Israel","Rehovot, Israel","Kfar Saba, Israel","Raanana, Israel","Nahariya, Israel","Acre, Israel"],Ee=pe=>{if(!pe)return 0;const je=new Date(pe),Je=new Date;let _t=Je.getFullYear()-je.getFullYear();const ke=Je.getMonth()-je.getMonth();return(ke<0||ke===0&&Je.getDate()<je.getDate())&&_t--,_t};b.useEffect(()=>{var pe;return A&&H("/dashboard"),(pe=E.state)!=null&&pe.email&&a(je=>({...je,email:E.state.email})),()=>{a({nickname:"",email:"",password:"",confirmPassword:"",dateOfBirth:"",location:"",interests:[],lookingFor:[],agreeTerms:!1,agreePrivacy:!1,newsletter:!1,iAm:"",intoTags:[],turnOns:[],maritalStatus:""})}},[A,H,(Rt=E.state)==null?void 0:Rt.email]),b.useEffect(()=>{if(O){g(je=>({...je,general:O})),C(!1);const pe=document.querySelector(`.${te.alertDanger}`);pe&&pe.scrollIntoView({behavior:"smooth",block:"start"})}},[O]);const K=b.useCallback(pe=>{const je={};if(pe===1){const Je=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;i.nickname.trim()?i.nickname.length<3?je.nickname="Nickname must be at least 3 characters":i.nickname.length>50?je.nickname="Nickname cannot exceed 50 characters":/^[a-zA-Z0-9_]+$/.test(i.nickname)||(je.nickname="Nickname can only contain letters, numbers, and underscores"):je.nickname="Nickname is required",i.email?Je.test(i.email.toLowerCase())||(je.email="Please enter a valid email address"):je.email="Email is required",i.password?i.password.length<8?je.password="Password must be at least 8 characters":/(?=.*[a-z])/.test(i.password)?/(?=.*[A-Z])/.test(i.password)?/(?=.*\d)/.test(i.password)?/(?=.*[@$!%*?&])/.test(i.password)||(je.password="Password must include at least one special character (@$!%*?&)"):je.password="Password must include at least one number":je.password="Password must include at least one uppercase letter":je.password="Password must include at least one lowercase letter":je.password="Password is required",i.password!==i.confirmPassword&&(je.confirmPassword="Passwords do not match")}if(pe===2){if(!i.dateOfBirth)je.dateOfBirth="Date of birth is required";else{const Je=Ee(i.dateOfBirth);Je<18?je.dateOfBirth="You must be at least 18 years old":Je>120&&(je.dateOfBirth="Please enter a valid date of birth")}i.iAm||(je.iAm="Please select who you are"),i.location.trim()?i.location.length<2?je.location="Location must be at least 2 characters":i.location.length>100&&(je.location="Location cannot exceed 100 characters"):je.location="Location is required"}return pe===3&&(i.profilePhoto||(je.profilePhoto="Please upload a profile photo")),pe===4&&(i.maritalStatus||(je.maritalStatus="Please select your marital status"),i.lookingFor.length===0?je.lookingFor="Please select what you're looking for":i.lookingFor.length>3&&(je.lookingFor="Please select no more than 3 options"),i.intoTags.length>20&&(je.intoTags="Please select no more than 20 'I'm into' tags"),i.turnOns.length>20&&(je.turnOns="Please select no more than 20 'Turn ons' tags"),i.interests.length===0?je.interests="Please select at least one interest":i.interests.length>10&&(je.interests="Please select no more than 10 interests"),i.agreeTerms||(je.agreeTerms="You must agree to the Terms of Service"),i.agreePrivacy||(je.agreePrivacy="You must agree to the Privacy Policy")),je},[i]),q=pe=>{const{name:je,value:Je,type:_t,checked:ke}=pe.target;_t==="checkbox"?a({...i,[je]:ke}):_t==="number"?(Je===""||!isNaN(Number.parseInt(Je)))&&a({...i,[je]:Je}):a({...i,[je]:Je}),y[je]&&g({...y,[je]:""})},J=pe=>{const je=pe.target.value;if(a({...i,location:je}),y.location&&g({...y,location:""}),je.length>1){const Je=Pe.filter(_t=>_t.toLowerCase().includes(je.toLowerCase()));V(Je)}else V([])},re=()=>{N(!0);const pe=K(t);if(Object.keys(pe).length>0){g(pe);const je=document.querySelector(`.${te.errorMessage}`);je&&je.scrollIntoView({behavior:"smooth",block:"start"});return}g({}),e(t+1),N(!1),window.scrollTo({top:0,behavior:"smooth"})},Ne=()=>{e(t-1),g({}),N(!1),window.scrollTo({top:0,behavior:"smooth"})},Se=pe=>{let je;i.interests.includes(pe)?je=i.interests.filter(Je=>Je!==pe):je=[...i.interests,pe],a({...i,interests:je}),y.interests&&je.length>0&&g({...y,interests:""})},Ve=pe=>{let je;i.lookingFor.includes(pe)?je=i.lookingFor.filter(Je=>Je!==pe):je=[...i.lookingFor,pe],a({...i,lookingFor:je}),y.lookingFor&&je.length>0&&g({...y,lookingFor:""})},ge=pe=>{a({...i,iAm:i.iAm===pe?"":pe}),y.iAm&&pe&&g({...y,iAm:""})},ee=pe=>{let je;if(i.intoTags.includes(pe))je=i.intoTags.filter(Je=>Je!==pe);else{if(i.intoTags.length>=20){ne.warning("You can select up to 20 'I'm into' tags");return}je=[...i.intoTags,pe]}a({...i,intoTags:je}),y.intoTags&&je.length>0&&g({...y,intoTags:""})},Re=pe=>{let je;if(i.turnOns.includes(pe))je=i.turnOns.filter(Je=>Je!==pe);else{if(i.turnOns.length>=20){ne.warning("You can select up to 20 'Turn ons' tags");return}je=[...i.turnOns,pe]}a({...i,turnOns:je}),y.turnOns&&je.length>0&&g({...y,turnOns:""})},he=pe=>{a({...i,maritalStatus:pe.target.value}),y.maritalStatus&&g({...y,maritalStatus:""})},Ue=pe=>{const je=pe.target.files[0];if(!je)return;if(!["image/jpeg","image/png","image/jpg"].includes(je.type)){ne.error("Please upload a valid image file (JPEG, JPG or PNG)");return}if(je.size>5*1024*1024){ne.error("Image size should be less than 5MB");return}a({...i,profilePhoto:je});const _t=new FileReader;_t.onloadend=()=>{u(_t.result)},_t.readAsDataURL(je),y.profilePhoto&&g({...y,profilePhoto:""})},ze=()=>{a({...i,profilePhoto:null}),u(null),d.current&&(d.current.value="")},Xe=()=>{d.current&&d.current.click()},Qe=b.useCallback(()=>({}),[i]),Ge=async pe=>{pe==null||pe.preventDefault();const je=Qe();if(Object.keys(je).length>0){D(je);const Je=document.querySelector(`.${te.errorMessage}`);Je&&Je.scrollIntoView({behavior:"smooth",block:"center"});return}D({}),C(!0);try{let Je="";i.iAm.toLowerCase()==="woman"?Je="female":i.iAm.toLowerCase()==="man"?Je="male":i.iAm.toLowerCase()==="couple"&&(Je="other");let _t="FREE";const ke=i.iAm.toLowerCase()==="couple";i.iAm.toLowerCase()==="woman"?_t="FEMALE":ke&&(_t="COUPLE");const Ke={nickname:i.nickname.trim(),email:i.email.trim().toLowerCase(),password:i.password,accountTier:_t,isCouple:ke,details:{age:Ee(i.dateOfBirth),gender:Je,location:i.location.trim(),bio:"",interests:i.interests,iAm:i.iAm,lookingFor:i.lookingFor,intoTags:i.intoTags,turnOns:i.turnOns,maritalStatus:i.maritalStatus,dateOfBirth:i.dateOfBirth}};try{if(await F(Ke)){if(i.profilePhoto)try{const B=new FormData;B.append("photo",i.profilePhoto),B.append("isPrivate","false");const _=await(await fetch("/api/users/photos",{method:"POST",body:B,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"x-auth-token":localStorage.getItem("token")}})).json();_.success?ne.success("Profile photo uploaded successfully"):ne.error("Failed to upload profile photo: "+(_.error||"Unknown error"))}catch(B){console.error("Error uploading photo:",B),ne.error("Failed to upload profile photo")}ne.success("Welcome to Mandarin! Your account has been created successfully."),H("/dashboard")}}catch(ht){if(ht.error==="User already exists"||ht.code==="EMAIL_EXISTS"||ht.message&&ht.message.includes("already exists")){g({email:"This email is already registered. Please log in or use a different email.",general:"An account with this email already exists. Would you like to log in instead?"});const B=document.querySelector(`.${te.errorMessage}`);B&&B.scrollIntoView({behavior:"smooth",block:"start"})}else g(B=>({...B,general:ht.message||"An unexpected error occurred. Please try again."}))}}catch(Je){console.error("Registration error",Je),C(!1),y.general||g(_t=>({..._t,general:"An unexpected error occurred. Please try again."}))}finally{C(!1)}},at=()=>{p(!h)},yt=()=>o.jsx("div",{className:te.progressContainer,children:o.jsxs("div",{className:te.progressSteps,children:[o.jsxs("div",{className:`${te.progressStep} ${t>=1?te.active:""}`,children:[o.jsx("div",{className:te.stepCircle,children:t>1?o.jsx(Lt,{}):1}),o.jsx("span",{className:te.stepLabel,children:"Account"})]}),o.jsx("div",{className:te.progressLine}),o.jsxs("div",{className:`${te.progressStep} ${t>=2?te.active:""}`,children:[o.jsx("div",{className:te.stepCircle,children:t>2?o.jsx(Lt,{}):2}),o.jsx("span",{className:te.stepLabel,children:"Profile"})]}),o.jsx("div",{className:te.progressLine}),o.jsxs("div",{className:`${te.progressStep} ${t>=3?te.active:""}`,children:[o.jsx("div",{className:te.stepCircle,children:t>3?o.jsx(Lt,{}):3}),o.jsx("span",{className:te.stepLabel,children:"Photo"})]}),o.jsx("div",{className:te.progressLine}),o.jsxs("div",{className:`${te.progressStep} ${t>=4?te.active:""}`,children:[o.jsx("div",{className:te.stepCircle,children:t>4?o.jsx(Lt,{}):4}),o.jsx("span",{className:te.stepLabel,children:"Preferences"})]})]})}),mt=()=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:te.stepHeader,children:[o.jsx("h3",{children:"Create Your Account"}),o.jsx("p",{children:"Enter your basic information"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"nickname",children:"Nickname"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Bc,{className:te.inputIcon}),o.jsx("input",{type:"text",id:"nickname",name:"nickname",placeholder:"Choose a nickname",className:te.input,value:i.nickname,onChange:q,maxLength:50})]}),y.nickname?o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.nickname]}):o.jsx("p",{className:te.helpText,children:"Your public display name (can contain letters, numbers, and underscores)"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"email",children:"Email Address"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Yh,{className:te.inputIcon}),o.jsx("input",{type:"email",id:"email",name:"email",placeholder:"Enter your email",className:te.input,value:i.email,onChange:q})]}),y.email?o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.email]}):o.jsx("p",{className:te.helpText,children:"We'll never share your email with anyone else"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"password",children:"Password"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Ss,{className:te.inputIcon}),o.jsx("input",{type:h?"text":"password",id:"password",name:"password",placeholder:"Create a password",className:te.input,value:i.password,onChange:q}),o.jsx("button",{type:"button",className:te.togglePassword,onClick:at,tabIndex:-1,"aria-label":h?"Hide password":"Show password",children:h?o.jsx(vb,{}):o.jsx(wr,{})})]}),y.password?o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.password]}):o.jsx("p",{className:te.helpText,children:"Must be at least 8 characters with uppercase, lowercase, number, and special character"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"confirmPassword",children:"Confirm Password"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Ss,{className:te.inputIcon}),o.jsx("input",{type:h?"text":"password",id:"confirmPassword",name:"confirmPassword",placeholder:"Confirm password",className:te.input,value:i.confirmPassword,onChange:q})]}),y.confirmPassword&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.confirmPassword]})]}),o.jsxs("div",{className:te.formActions,children:[o.jsx("div",{})," ",o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonPrimary}`,onClick:re,disabled:w,children:["Continue ",o.jsx(xr,{})]})]})]}),Ie=()=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:te.stepHeader,children:[o.jsx("h3",{children:"Tell Us About Yourself"}),o.jsx("p",{children:"Add some basic profile details"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"dateOfBirth",children:"Date of Birth"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Hh,{className:te.inputIcon}),o.jsx("input",{type:"date",id:"dateOfBirth",name:"dateOfBirth",className:te.input,value:i.dateOfBirth,onChange:q,max:new Date(new Date().setFullYear(new Date().getFullYear()-18)).toISOString().split("T")[0]})]}),y.dateOfBirth?o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.dateOfBirth]}):o.jsx("p",{className:te.helpText,children:"You must be at least 18 years old to use this service"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"I am a"}),o.jsx("div",{className:te.tagContainer,children:P.map(pe=>o.jsxs("button",{type:"button",className:`${te.tag} ${i.iAm===pe?te.selected:""}`,onClick:()=>ge(pe),children:[pe.charAt(0).toUpperCase()+pe.slice(1),i.iAm===pe&&o.jsx(Lt,{className:te.tagCheck})]},pe))}),y.iAm&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.iAm]})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,htmlFor:"location",children:"Location"}),o.jsxs("div",{className:te.inputWrapper,children:[o.jsx(Tr,{className:te.inputIcon}),o.jsx("input",{type:"text",id:"location",name:"location",placeholder:"City, Country",className:te.input,value:i.location,onChange:J,maxLength:100,list:"location-suggestions"}),o.jsx("datalist",{id:"location-suggestions",children:Pe.map((pe,je)=>o.jsx("option",{value:pe},je))})]}),y.location?o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.location]}):o.jsx("p",{className:te.helpText,children:"Your general location (e.g., Tel Aviv, Israel)"})]}),o.jsxs("div",{className:te.formActions,children:[o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonOutline}`,onClick:Ne,children:[o.jsx(br,{})," Back"]}),o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonPrimary}`,onClick:re,disabled:w,children:["Continue ",o.jsx(xr,{})]})]})]}),qe=()=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:te.stepHeader,children:[o.jsx("h3",{children:"Upload Your Photo"}),o.jsx("p",{children:"Add a profile photo to improve your visibility"})]}),o.jsxs("div",{className:te.photoUploadContainer,children:[o.jsxs("div",{className:`${te.photoUploadArea} ${c?te.hasImage:""}`,onClick:Xe,children:[o.jsx("input",{type:"file",ref:d,accept:"image/jpeg,image/png,image/jpg",onChange:Ue,className:"d-none"}),c?o.jsx("img",{src:c,alt:"Profile Preview",className:te.profileImagePreview}):o.jsxs(o.Fragment,{children:[o.jsx(Wo,{className:te.photoUploadIcon}),o.jsx("p",{className:te.photoUploadText,children:"Click to upload a profile photo"})]})]}),o.jsxs("p",{className:te.uploadGuidelines,children:["Photos should be clear, recent and show your face.",o.jsx("br",{}),"Maximum size: 5MB. Formats: JPG, JPEG, PNG."]}),y.profilePhoto&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.profilePhoto]}),c&&o.jsxs("div",{className:te.photoActions,children:[o.jsxs("button",{type:"button",className:`${te.photoActionButton} ${te.changePhotoButton}`,onClick:Xe,children:[o.jsx(pb,{})," Change Photo"]}),o.jsxs("button",{type:"button",className:`${te.photoActionButton} ${te.removePhotoButton}`,onClick:ze,children:[o.jsx(_r,{})," Remove"]})]})]}),o.jsxs("div",{className:te.formActions,children:[o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonOutline}`,onClick:Ne,disabled:w,children:[o.jsx(br,{})," Back"]}),o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonPrimary}`,onClick:re,disabled:w,children:["Continue ",o.jsx(xr,{})]})]})]}),jt=()=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:te.stepHeader,children:[o.jsx("h3",{children:"Your Preferences"}),o.jsx("p",{children:"Tell us about yourself and what you're looking for"})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"Marital Status"}),o.jsxs("select",{className:te.input,name:"maritalStatus",value:i.maritalStatus,onChange:he,style:{paddingLeft:"1rem"},children:[o.jsx("option",{value:"",children:"Select your status"}),ae.map(pe=>o.jsx("option",{value:pe,children:pe},pe))]}),y.maritalStatus&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.maritalStatus]})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"Looking For"}),o.jsx("p",{className:te.helpText,children:"Select up to 3 options"}),o.jsx("div",{className:te.tagContainer,children:G.map(pe=>o.jsxs("button",{type:"button",className:`${te.tag} ${i.lookingFor.includes(pe)?te.selected:""}`,onClick:()=>Ve(pe),disabled:!i.lookingFor.includes(pe)&&i.lookingFor.length>=3,children:[pe.charAt(0).toUpperCase()+pe.slice(1),i.lookingFor.includes(pe)&&o.jsx(Lt,{className:te.tagCheck})]},pe))}),y.lookingFor&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.lookingFor]})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"Interests"}),o.jsx("p",{className:te.helpText,children:"Select up to 10 interests"}),o.jsx("div",{className:te.tagContainer,children:L.map(pe=>o.jsxs("button",{type:"button",className:`${te.tag} ${i.interests.includes(pe)?te.selected:""}`,onClick:()=>Se(pe),disabled:!i.interests.includes(pe)&&i.interests.length>=10,children:[pe,i.interests.includes(pe)&&o.jsx(Lt,{className:te.tagCheck})]},pe))}),y.interests&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.interests]})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"I'm into"}),o.jsx("p",{className:te.helpText,children:"Select up to 20 tags"}),o.jsx("div",{className:te.tagContainer,children:Q.map(pe=>o.jsxs("button",{type:"button",className:`${te.tag} ${i.intoTags.includes(pe)?te.selected:""}`,onClick:()=>ee(pe),disabled:!i.intoTags.includes(pe)&&i.intoTags.length>=20,children:[pe,i.intoTags.includes(pe)&&o.jsx(Lt,{className:te.tagCheck})]},pe))}),y.intoTags&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.intoTags]})]}),o.jsxs("div",{className:te.formGroup,children:[o.jsx("label",{className:te.formLabel,children:"It turns me on"}),o.jsx("p",{className:te.helpText,children:"Select up to 20 tags"}),o.jsx("div",{className:te.tagContainer,children:z.map(pe=>o.jsxs("button",{type:"button",className:`${te.tag} ${i.turnOns.includes(pe)?te.selected:""}`,onClick:()=>Re(pe),disabled:!i.turnOns.includes(pe)&&i.turnOns.length>=20,children:[pe,i.turnOns.includes(pe)&&o.jsx(Lt,{className:te.tagCheck})]},pe))}),y.turnOns&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.turnOns]})]}),o.jsxs("div",{className:te.checkboxGroup,children:[o.jsxs("label",{className:`${te.checkboxLabel} ${y.agreeTerms?te.checkboxLabelError:""}`,children:[o.jsx("input",{type:"checkbox",className:te.checkbox,name:"agreeTerms",checked:i.agreeTerms,onChange:q}),"I agree to the"," ",o.jsx(_n,{to:"/terms",target:"_blank",rel:"noopener noreferrer",className:te.footerLink,children:"Terms of Service"})]}),y.agreeTerms&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.agreeTerms]})]}),o.jsxs("div",{className:te.checkboxGroup,children:[o.jsxs("label",{className:`${te.checkboxLabel} ${y.agreePrivacy?te.checkboxLabelError:""}`,children:[o.jsx("input",{type:"checkbox",className:te.checkbox,name:"agreePrivacy",checked:i.agreePrivacy,onChange:q}),"I agree to the"," ",o.jsx(_n,{to:"/privacy",target:"_blank",rel:"noopener noreferrer",className:te.footerLink,children:"Privacy Policy"})]}),y.agreePrivacy&&o.jsxs("p",{className:te.errorMessage,children:[o.jsx(Kt,{}),y.agreePrivacy]})]}),o.jsx("div",{className:te.checkboxGroup,children:o.jsxs("label",{className:te.checkboxLabel,children:[o.jsx("input",{type:"checkbox",className:te.checkbox,name:"newsletter",checked:i.newsletter,onChange:q}),"I want to receive news and special offers (optional)"]})}),o.jsxs("div",{className:te.formActions,children:[o.jsxs("button",{type:"button",className:`${te.button} ${te.buttonOutline}`,onClick:Ne,disabled:w,children:[o.jsx(br,{})," Back"]}),o.jsx("button",{type:"submit",className:`${te.button} ${te.buttonPrimary}`,disabled:w,onClick:Ge,children:w?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:te.spinner}),o.jsx("span",{children:"Creating account..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Create Account"})," ",o.jsx(Lt,{})]})})]})]}),Ct=()=>{switch(t){case 1:return mt();case 2:return Ie();case 3:return qe();case 4:return jt();default:return null}};return o.jsx("div",{className:"auth-page register-page d-flex min-vh-100 bg-light-subtle",children:o.jsxs("div",{className:te.registerContainer,children:[o.jsx("div",{className:te.gradientBar}),o.jsxs("div",{className:"text-center mb-4",children:[o.jsx(_n,{to:"/",className:te.pageTitle,children:"Mandarin"}),o.jsx("p",{className:te.subtitle,children:"Create your account in a few steps"})]}),y.general&&o.jsxs("div",{className:`${te.alert} ${te.alertDanger}`,children:[o.jsx(Kt,{}),o.jsx("p",{className:"mb-0",children:y.general})]}),yt(),o.jsx("form",{onSubmit:pe=>{pe.preventDefault(),t===4&&Ge()},children:Ct()}),t===1&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:te.divider,children:"OR SIGN UP WITH"}),o.jsxs("div",{className:te.socialButtons,children:[o.jsxs("button",{className:te.socialButton,children:[o.jsx(hb,{className:te.googleIcon}),o.jsx("span",{children:"Sign up with Google"})]}),o.jsxs("button",{className:te.socialButton,children:[o.jsx(fb,{className:te.facebookIcon}),o.jsx("span",{children:"Sign up with Facebook"})]})]})]}),o.jsxs("div",{className:te.footer,children:["Already have an account?"," ",o.jsx(_n,{to:"/login",className:te.footerLink,children:"Sign In"})]})]})})},g8="_chatContainer_1avrl_3",p8="_chatHeader_1avrl_30",y8="_chatUser_1avrl_43",v8="_chatAvatar_1avrl_50",b8="_chatAvatarPlaceholder_1avrl_59",x8="_chatUserInfo_1avrl_67",w8="_statusContainer_1avrl_82",_8="_statusOnline_1avrl_88",S8="_statusOffline_1avrl_88",j8="_connectionStatus_1avrl_93",C8="_statusIcon_1avrl_104",N8="_chatHeaderActions_1avrl_108",T8="_chatHeaderBtn_1avrl_113",k8="_premiumBanner_1avrl_132",E8="_premiumIcon_1avrl_143",A8="_upgradeBtn_1avrl_149",R8="_activeCallBanner_1avrl_168",M8="_callIcon_1avrl_179",L8="_endCallBtn_1avrl_184",O8="_messagesContainer_1avrl_203",D8="_loadingMessages_1avrl_213",B8="_noMessages_1avrl_213",z8="_spinner_1avrl_225",P8="_messageDate_1avrl_240",$8="_message_1avrl_203",U8="_sent_1avrl_285",I8="_received_1avrl_292",F8="_messageContent_1avrl_297",q8="_messageTime_1avrl_302",V8="_readIndicator_1avrl_317",H8="_pending_1avrl_325",G8="_pendingIndicator_1avrl_325",Y8="_error_1avrl_338",X8="_errorIndicator_1avrl_338",K8="_systemMessage_1avrl_345",Q8="_systemMessageContent_1avrl_365",W8="_errorContent_1avrl_375",Z8="_winkMessage_1avrl_380",J8="_messageLabel_1avrl_391",ej="_videoCallMessage_1avrl_402",tj="_videoIcon_1avrl_408",nj="_fileMessage_1avrl_418",sj="_imageAttachment_1avrl_422",ij="_fileAttachment_1avrl_436",aj="_fileIcon_1avrl_452",rj="_fileName_1avrl_462",oj="_fileSize_1avrl_468",lj="_downloadLink_1avrl_477",cj="_typingIndicator_1avrl_503",uj="_messageError_1avrl_544",dj="_errorActions_1avrl_561",fj="_retryButton_1avrl_567",hj="_initButton_1avrl_567",mj="_refreshButton_1avrl_591",gj="_attachmentPreview_1avrl_610",pj="_attachmentInfo_1avrl_619",yj="_attachmentName_1avrl_625",vj="_attachmentSize_1avrl_634",bj="_removeAttachment_1avrl_639",xj="_uploadProgressContainer_1avrl_653",wj="_uploadProgressBar_1avrl_663",_j="_uploadProgressText_1avrl_670",Sj="_messageInput_1avrl_680",jj="_inputSend_1avrl_731",Cj="_inputWink_1avrl_735",Nj="_emojiPicker_1avrl_740",Tj="_emojiHeader_1avrl_752",kj="_emojiList_1avrl_780",Ej="_videoCallOverlay_1avrl_803",Aj="_active_1avrl_168",Rj="_incomingCallActions_1avrl_902",Mj="_incomingCallBanner_1avrl_1062",Lj="_incomingCallInfo_1avrl_1078",Oj="_declineCallBtnSmall_1avrl_1098",Dj="_acceptCallBtnSmall_1avrl_1098",Bj="_opening_1avrl_1147",$e={chatContainer:g8,chatHeader:p8,chatUser:y8,chatAvatar:v8,chatAvatarPlaceholder:b8,chatUserInfo:x8,statusContainer:w8,statusOnline:_8,statusOffline:S8,connectionStatus:j8,statusIcon:C8,chatHeaderActions:N8,chatHeaderBtn:T8,premiumBanner:k8,premiumIcon:E8,upgradeBtn:A8,activeCallBanner:R8,callIcon:M8,endCallBtn:L8,messagesContainer:O8,loadingMessages:D8,noMessages:B8,spinner:z8,messageDate:P8,message:$8,sent:U8,received:I8,messageContent:F8,messageTime:q8,readIndicator:V8,pending:H8,pendingIndicator:G8,error:Y8,errorIndicator:X8,systemMessage:K8,systemMessageContent:Q8,errorContent:W8,winkMessage:Z8,messageLabel:J8,videoCallMessage:ej,videoIcon:tj,fileMessage:nj,imageAttachment:sj,fileAttachment:ij,fileIcon:aj,fileName:rj,fileSize:oj,downloadLink:lj,typingIndicator:cj,messageError:uj,errorActions:dj,retryButton:fj,initButton:hj,refreshButton:mj,attachmentPreview:gj,attachmentInfo:pj,attachmentName:yj,attachmentSize:vj,removeAttachment:bj,uploadProgressContainer:xj,uploadProgressBar:wj,uploadProgressText:_j,messageInput:Sj,inputSend:jj,inputWink:Cj,emojiPicker:Nj,emojiHeader:Tj,emojiList:kj,videoCallOverlay:Ej,active:Aj,incomingCallActions:Rj,incomingCallBanner:Mj,incomingCallInfo:Lj,declineCallBtnSmall:Oj,acceptCallBtnSmall:Dj,opening:Bj},lt=An.create("ChatService");class zj{constructor(){_c(this,"_processedMessages",new Set);this.initialized=!1,this.user=null,this.activeChats=new Map,this.eventListeners=new Map,this.pendingMessages=[],this.messageCache=new Map}initialize(e){var a;if(console.log("ChatService.initialize called with user:",e),this.initialized&&((a=this.user)==null?void 0:a._id)===(e==null?void 0:e._id))return lt.debug("Chat service already initialized for this user"),console.log("Chat service already initialized for user:",e==null?void 0:e._id),Promise.resolve(!0);if(!e){const c=new Error("Cannot initialize chat service without user data");return lt.error(c.message),console.error(c.message),Promise.reject(c)}let i;try{const c=d=>d&&/^[0-9a-fA-F]{24}$/.test(d.toString());if(e._id){if(typeof e._id=="string"&&c(e._id))i=e._id;else if(typeof e._id=="object"&&e._id!==null)try{const h=e._id.toString().match(/([0-9a-fA-F]{24})/);h&&h[1]&&(i=h[1],lt.debug(`Extracted ObjectId from complex object: ${i}`))}catch(d){lt.error(`Failed to extract valid ID from object: ${d.message}`)}}if(!i&&e.id&&c(e.id)&&(i=e.id,lt.debug(`Using user.id instead of user._id: ${i}`)),!i){lt.warn(`User has invalid ID: ${e._id}, trying token-based ID`);try{const d=localStorage.getItem("token")||sessionStorage.getItem("token");if(d){const p=d.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),y=JSON.parse(atob(p)),g=y.id||y.sub||y.user&&(y.user._id||y.user.id);g&&c(g)&&(i=g,lt.info(`Using ID from token payload: ${i}`))}}catch(d){lt.error(`Failed to extract ID from token: ${d.message}`)}}if(!i){lt.error("Cannot initialize chat service: no valid user ID available");return}const u={...e,_id:i,id:i};return lt.info(`Initializing chat service for user: ${u.nickname||u._id}`),console.log(`Initializing chat service for user ID: ${u._id}`),this.user=u,this.initialized=!0,this._setupSocketListeners(),Promise.resolve(!0)}catch(c){return lt.error("Error validating user ID:",c),console.error("Error validating user ID:",c),lt.warn("Falling back to original user object without validation"),console.warn("Falling back to original user object without validation"),this.user=e,this.initialized=!0,i=e._id,this._setupSocketListeners(),Promise.resolve(!0)}if(!Be.isConnected()&&i){const c=localStorage.getItem("token")||sessionStorage.getItem("token");c&&(lt.debug(`Initializing socket with validated user ID: ${i}`),console.log(`Initializing socket with validated user ID: ${i}`),Be.init(i,c))}return Promise.resolve(!0)}_setupSocketListeners(){this._cleanupSocketListeners(),this.socketListeners=[];const e=Be.on("messageReceived",d=>{var p;lt.debug(`New message received from ${d.sender}`);const h=d.sender===((p=this.user)==null?void 0:p._id)?d.recipient:d.sender;this._updateMessageCache(h,d),this._notifyEventListeners("messageReceived",d)});this.socketListeners.push(e);const i=Be.on("messageSent",d=>{lt.debug(`Message sent confirmation received for ${d._id}`);const h=d.recipient;this._updateMessageCache(h,d),this._notifyEventListeners("messageSent",d)});this.socketListeners.push(i);const a=Be.on("userTyping",d=>{this._notifyEventListeners("userTyping",d)});this.socketListeners.push(a);const c=Be.on("connect",()=>{lt.info("Socket connected, processing pending messages"),this._processPendingMessages(),this._notifyEventListeners("connectionChanged",{connected:!0})});this.socketListeners.push(c);const u=Be.on("disconnect",()=>{this._notifyEventListeners("connectionChanged",{connected:!1})});this.socketListeners.push(u)}_cleanupSocketListeners(){this.socketListeners&&(this.socketListeners.forEach(e=>{typeof e=="function"&&e()}),this.socketListeners=[])}_updateMessageCache(e,i){if(!e||!i)return;lt.debug(`Updating message cache for ${e} with message ${i._id||"unknown"}`);const a=this.messageCache.get(e)||[],c=i.tempMessageId||i.tempId;if(c){const d=a.findIndex(h=>h.tempId===c||h.tempMessageId===c||h._id===c);if(d>=0){lt.debug(`Found temp message to update at index ${d}`),a[d]={...i,tempId:c},this._notifyEventListeners("messageUpdated",a[d]),a.sort((h,p)=>new Date(p.createdAt)-new Date(h.createdAt)),this.messageCache.set(e,a);return}}const u=a.findIndex(d=>d._id===i._id);u>=0?(lt.debug(`Updating existing message at index ${u}`),a[u]={...a[u],...i},this._notifyEventListeners("messageUpdated",a[u])):a.filter(h=>h.content===i.content&&h.sender===i.sender&&h.recipient===i.recipient&&Math.abs(new Date(h.createdAt)-new Date(i.createdAt))<5e3).length>0?lt.debug(`Skipping near-duplicate message in cache for ${e}`):(lt.debug(`Adding new message to cache for ${e}`),a.unshift(i),this._notifyEventListeners("messageReceived",i)),a.sort((d,h)=>new Date(h.createdAt)-new Date(d.createdAt)),this.messageCache.set(e,a)}async getMessages(e,i=1,a=20){var d,h,p;if(lt.info(`getMessages called with recipientId: ${e}, initialized: ${this.initialized}, user: ${(d=this.user)==null?void 0:d._id}`),console.log(`ChatService.getMessages called with recipientId: ${e}, page: ${i}, limit: ${a}`),console.log(`ChatService state: initialized=${this.initialized}, user ID=${(h=this.user)==null?void 0:h._id}`),!this.initialized||!((p=this.user)!=null&&p._id))return lt.warn("Attempted to get messages without initialization"),console.warn("ChatService not initialized or missing user ID, returning empty array"),[];if(!e)return lt.error("No recipient ID provided for getMessages"),console.error("No recipient ID provided for ChatService.getMessages"),[];const c=this.messageCache.get(e);console.log(c?`Found ${c.length} cached messages for ${e}`:`No cached messages found for ${e}`),c||(console.log("Adding small delay before API call to ensure initialization"),await new Promise(y=>setTimeout(y,100)));const u=(y=8e3)=>Promise.race([st.get(`/messages/${e}`,{page:i,limit:a,_t:Date.now(),_c:Math.random().toString(36).substring(2,8)}),new Promise((g,w)=>setTimeout(()=>w(new Error("Request timed out")),y))]);try{lt.debug(`Fetching messages with ${e}, page ${i}`),console.log(`Fetching messages from API for ${e}, page ${i}`),console.log("About to call API with fetchWithTimeout");const y=await u();if(console.log("API response received:",y),y&&(!y.data||y.data.length===0))return lt.debug("Response received but no messages found"),console.log("Response received but no messages found or empty data array"),this.messageCache.set(e,[]),[];if(!y||!y.success){const w=(y==null?void 0:y.error)||"Failed to load messages";if(lt.error(`API returned error: ${w}`),console.error(`API returned error: ${w}`,y),c&&c.length>0)return lt.debug(`Using ${c.length} cached messages due to API error`),console.log(`Using ${c.length} cached messages due to API error`),c;throw console.error("No cached messages available and API error occurred"),new Error(w)}const g=Array.isArray(y.data)?y.data:[];return lt.debug(`Loaded ${g.length} messages from server`),console.log(`Loaded ${g.length} messages from server:`,g),this.messageCache.set(e,g),console.log(`ChatService.getMessages returning ${g.length} messages`),Array.isArray(g)?g:[]}catch(y){return lt.error(`Error fetching messages with ${e}:`,y),c&&c.length>0?(lt.debug(`Returning ${c.length} cached messages as fallback`),c):(lt.debug("No cached messages available, returning empty array"),[])}}async sendMessage(e,i,a="text",c=null){var u,d;if(console.log(`ChatService.sendMessage called: recipientId=${e}, content="${i}", type="${a}"`),console.log(`ChatService state: initialized=${this.initialized}, user ID=${(u=this.user)==null?void 0:u._id}`),!this.initialized||!((d=this.user)!=null&&d._id))throw lt.warn("Attempted to send message without initialization"),console.warn("ChatService not initialized or missing user ID"),new Error("Chat service not initialized");if(!e)throw console.error("No recipient ID provided for sendMessage"),new Error("Recipient ID is required");lt.debug(`Sending ${a} message to ${e}`),console.log(`Sending ${a} message to ${e} with content: "${i}"`),console.log("Socket connected:",Be.isConnected());try{const h=`temp-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,p={_id:h,sender:this.user._id,recipient:e,content:i,type:a,metadata:c||{},createdAt:new Date().toISOString(),read:!1,status:"sending",pending:!0,tempId:h};return this._updateMessageCache(e,p),Be.isConnected()?new Promise((y,g)=>{lt.debug(`Emitting socket message to ${e} with tempId ${h}`),console.log(`Emitting socket message to ${e} with tempId ${h}`);const w={recipientId:e,content:i,type:a,metadata:c,tempMessageId:h};console.log("Socket emit data:",w),Be.emit("sendMessage",w),console.log("Socket message emitted");let C,j,N,M;const D=O=>{lt.debug(`Message confirmed sent: ${h}`),console.log(`Message confirmed sent: ${h}`,O),C&&(console.log("Cleaning up messageListener"),C(),C.cleanup&&C.cleanup()),j&&(console.log("Cleaning up messageListener2"),j(),j.cleanup&&j.cleanup()),N&&(console.log("Cleaning up errorListener"),N(),N.cleanup&&N.cleanup()),M&&(console.log("Cleaning up errorListener2"),M(),M.cleanup&&M.cleanup()),console.log("Resolving promise with message:",O),y(O),this._updateMessageCache(e,{...O,pending:!1,status:"sent"})},I=O=>{lt.error(`Message error for ${h}: ${O.message||O.error||"Unknown error"}`),console.error(`Message error for ${h}:`,O),C&&(console.log("Cleaning up messageListener"),C(),C.cleanup&&C.cleanup()),j&&(console.log("Cleaning up messageListener2"),j(),j.cleanup&&j.cleanup()),N&&(console.log("Cleaning up errorListener"),N(),N.cleanup&&N.cleanup()),M&&(console.log("Cleaning up errorListener2"),M(),M.cleanup&&M.cleanup()),console.log("Updating message cache with error state"),this._updateMessageCache(e,{...p,status:"error",error:O.message||O.error||"Failed to send message"}),console.log("Rejecting promise with error"),g(new Error(O.message||O.error||"Failed to send message"))};C=Be.on("messageSent",O=>{O&&O.tempMessageId===h&&D(O)}),j=Be.on("message:sent",O=>{O&&O.tempMessageId===h&&D(O)}),N=Be.on("messageError",O=>{O&&O.tempMessageId===h&&I(O)}),M=Be.on("message:error",O=>{O&&O.tempMessageId===h&&I(O)});const V=setTimeout(()=>{console.log(`Message socket timeout reached for ${h}`),Be.isConnected()?(lt.debug(`Message socket timeout reached for ${h}, falling back to API`),console.log("Socket still connected but timeout reached, falling back to API"),this._sendViaApi(e,i,a,c,h).then(O=>{console.log("API fallback successful:",O),y(O)}).catch(O=>{console.error("API fallback failed:",O),g(O)})):(lt.debug(`Socket not connected for ${h}, immediately falling back to API`),console.log("Socket not connected, immediately falling back to API"),this._sendViaApi(e,i,a,c,h).then(O=>{console.log("API fallback successful:",O),y(O)}).catch(O=>{console.error("API fallback failed:",O),g(O)}))},2e3),F=()=>{clearTimeout(V)};C.cleanup=F,j.cleanup=F,N.cleanup=F,M.cleanup=F}):(this._queuePendingMessage({recipient:e,content:i,type:a,metadata:c,tempMessageId:h}),this._sendViaApi(e,i,a,c,h))}catch(h){throw lt.error("Error sending message:",h),h}}async _sendViaApi(e,i,a,c,u){try{lt.info(`Sending message via API fallback to ${e}`),console.log(`Sending message via API fallback to ${e}`);const d={_id:u,sender:this.user._id,recipient:e,content:i,type:a,metadata:c||{},createdAt:new Date().toISOString(),status:"sending",pending:!0,tempId:u,tempMessageId:u,note:"Sending via API..."};console.log("Updating cache with sending state:",d),this._updateMessageCache(e,d),console.log("Making API request to /messages endpoint");const h={recipient:e,content:i,type:a,metadata:c};console.log("API request data:",h);const p=await st.post("/messages",h);if(console.log("API response:",p),!p.success)throw console.error("API response indicates failure:",p.error),new Error(p.error||"Failed to send message");const y=p.data;lt.debug(`Message sent via API: ${y._id}`),console.log(`Message sent via API: ${y._id}`,y);const g={...y,tempMessageId:u,pending:!1,status:"sent"};return console.log("Formatted message for cache update:",g),this._updateMessageCache(e,g),console.log("Message already added to cache, not triggering additional events"),console.log("Returning formatted message from _sendViaApi"),g}catch(d){lt.error("API message send error:",d),console.error("API message send error:",d);const h={_id:u,sender:this.user._id,recipient:e,content:i,type:a,metadata:c||{},createdAt:new Date().toISOString(),status:"error",error:d.message,pending:!1,tempId:u,tempMessageId:u};throw console.log("Updating cache with error state:",h),this._updateMessageCache(e,h),console.log("Notifying event listeners of message error"),this._notifyEventListeners("messageError",{tempMessageId:u,error:d.message}),d}}_queuePendingMessage(e){this.pendingMessages.push({...e,timestamp:Date.now()}),lt.debug(`Queued message to ${e.recipient} for later sending`)}_processPendingMessages(){if(this.pendingMessages.length===0)return;lt.info(`Processing ${this.pendingMessages.length} pending messages`);const e=[...this.pendingMessages];this.pendingMessages=[],e.forEach(i=>{if(Date.now()-i.timestamp>6e5){lt.debug(`Skipping stale message to ${i.recipient}`);return}Be.emit("sendMessage",i)})}async markConversationRead(e){var i;if(!this.initialized||!((i=this.user)!=null&&i._id)||!e)return null;try{lt.debug(`Marking conversation with ${e} as read`);const a=await st.put(`/messages/conversation/${e}/read`),u=(this.messageCache.get(e)||[]).map(d=>d.sender===e&&!d.read?{...d,read:!0,readAt:new Date().toISOString()}:d);return this.messageCache.set(e,u),a}catch(a){return lt.error("Error marking conversation as read:",a),null}}async getConversations(){var i;if(!this.initialized||!((i=this.user)!=null&&i._id))return lt.warn("Attempted to get conversations without initialization"),[];const e=(a=8e3)=>Promise.race([st.get("/messages/conversations"),new Promise((c,u)=>setTimeout(()=>u(new Error("Request timed out")),a))]);try{lt.debug("Fetching conversations list");const a=await e();if(!a||!a.success){const u=(a==null?void 0:a.error)||"Failed to load conversations";return lt.error(`API error loading conversations: ${u}`),[]}const c=Array.isArray(a.data)?a.data:[];return lt.debug(`Loaded ${c.length} conversations`),c}catch(a){return lt.error("Error fetching conversations:",a),[]}}sendTypingIndicator(e){return!this.initialized||!Be.isConnected()||!e?!1:(Be.emit("typing",{recipientId:e}),!0)}on(e,i){return this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e).add(i),()=>{const c=this.eventListeners.get(e);c&&c.delete(i)}}_notifyEventListeners(e,i){if((e==="messageReceived"||e==="messageSent")&&i&&i._id){const a=`${e}-${i._id}-${Date.now().toString().substring(0,10)}`;if(this._processedMessages.has(a)){lt.debug(`Skipping duplicate ${e} notification for message ${i._id}`);return}this._processedMessages.add(a),setTimeout(()=>{this._processedMessages.delete(a)},2e3)}this.eventListeners.has(e)&&this.eventListeners.get(e).forEach(a=>{try{a(i)}catch(c){lt.error(`Error in ${e} event listener:`,c)}})}isReady(){var e;return this.initialized&&!!((e=this.user)!=null&&e._id)}isConnected(){return Be.isConnected()}cleanup(){this._cleanupSocketListeners(),this.eventListeners.clear(),this.messageCache.clear(),this.pendingMessages=[],this.initialized=!1,this.user=null,lt.debug("Chat service cleaned up")}}const tn=new zj,Pj=Object.freeze(Object.defineProperty({__proto__:null,default:tn},Symbol.toStringTag,{value:"Module"})),wn=An.create("useChat"),$j=(t=null)=>{const e=t?String(t):null,{user:i,isAuthenticated:a}=Sn(),[c,u]=b.useState([]),[d,h]=b.useState(!1),[p,y]=b.useState(!1),[g,w]=b.useState(null),[C,j]=b.useState(!0),[N,M]=b.useState(1),[D,I]=b.useState(!1),[V,F]=b.useState(!1),[O,A]=b.useState(tn.isConnected()),[H,E]=b.useState(!1),L=b.useRef(c),P=b.useRef(null),G=b.useRef(null),Q=b.useRef(!0),z=b.useRef(null);b.useEffect(()=>{L.current=c},[c]),b.useEffect(()=>{Q.current=!0;let re=0;const Ne=3;let Se=null;const Ve=async()=>{if(a&&(i!=null&&i._id))try{console.log(`Initializing chat service (attempt ${re+1})...`,{userId:i._id,isAuthenticated:a}),await tn.initialize(i),Q.current&&(console.log("Chat service initialized successfully!"),E(!0),A(tn.isConnected()))}catch(ge){if(wn.error("Failed to initialize chat service:",ge),console.error("Chat service initialization error:",ge),Q.current)if(re<Ne){re++;const ee=Math.min(1e3*Math.pow(2,re),5e3);console.log(`Retrying chat initialization in ${ee}ms (attempt ${re+1}/${Ne+1})`),Se=setTimeout(Ve,ee)}else w("Failed to initialize chat. Please refresh and try again.")}else console.warn("Cannot initialize chat: missing user ID or not authenticated",{userId:i==null?void 0:i._id,isAuthenticated:a})};return Ve(),()=>{Q.current=!1,P.current&&clearTimeout(P.current),z.current&&clearTimeout(z.current),Se&&clearTimeout(Se),G.current&&(G.current.forEach(ge=>{typeof ge=="function"&&ge()}),G.current=null)}},[a,i]),b.useEffect(()=>{if(!e||!a||!(i!=null&&i._id)||!H)return;G.current&&G.current.forEach(he=>{typeof he=="function"&&he()});const re=[],Ne=tn.on("messageUpdated",he=>{Q.current&&u(Ue=>Ue.map(ze=>ze._id===he._id||he.tempId&&ze.tempId===he.tempId||he.tempMessageId&&ze.tempId===he.tempMessageId?{...ze,...he,updated:!0}:ze))});re.push(Ne);const Se=tn.on("messageReceived",he=>{Q.current&&he.sender===e&&he.recipient===i._id&&(wn.debug(`Received message from ${e}`),u(Ue=>Ue.some(Xe=>Xe._id===he._id||he.tempMessageId&&Xe.tempId===he.tempMessageId)?(wn.debug(`Skipping duplicate message ${he._id} - already exists in state`),Ue):[...Ue,he]),tn.markConversationRead(e))});re.push(Se);const Ve=tn.on("messageSent",he=>{Q.current&&he.recipient===e&&(wn.debug(`Message sent confirmation for ${e}`),u(Ue=>{const ze=Ue.findIndex(Xe=>Xe._id===he._id||Xe.tempId===he.tempMessageId);if(ze>=0){const Xe=[...Ue];return Xe[ze]={...Xe[ze],...he,status:"sent",pending:!1},Xe}return wn.debug("Message with tempId not found - this shouldn't happen normally"),Ue}))});re.push(Ve);const ge=tn.on("userTyping",he=>{Q.current&&he.userId===e&&(F(!0),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{Q.current&&F(!1)},3e3))});re.push(ge);const ee=tn.on("connectionChanged",({connected:he})=>{Q.current&&(A(he),he&&ae(!0))});re.push(ee);const Re=tn.on("messageError",he=>{Q.current&&(he.tempMessageId&&u(Ue=>Ue.map(ze=>ze.tempId===he.tempMessageId?{...ze,error:!0,status:"error",errorMessage:he.error||"Failed to send message"}:ze)),w(he.error||"Error sending message"))});return re.push(Re),G.current=re,ae(),tn.markConversationRead(e),()=>{re&&re.length&&re.forEach(he=>{typeof he=="function"&&he()}),P.current&&clearTimeout(P.current)}},[e,a,i,H]);const ae=b.useCallback(async(re=!1)=>{if(!e||!a||!(i!=null&&i._id)||!H)return wn.warn("Cannot load messages: Missing required data"),[];if(d&&!re)return wn.debug("Already loading messages, skipping duplicate request"),L.current;h(!0),w(null),z.current&&clearTimeout(z.current),z.current=setTimeout(()=>{Q.current&&d&&(wn.warn("Message loading timeout reached"),h(!1),w("Loading timed out. Please try again."))},15e3);try{wn.debug(`Loading messages for conversation with ${e}`);let Ne;try{Ne=await tn.getMessages(e,1,20)}catch(ee){wn.warn("First attempt to load messages failed, retrying:",ee),await new Promise(Re=>setTimeout(Re,800)),Ne=await tn.getMessages(e,1,20)}if(z.current&&(clearTimeout(z.current),z.current=null),!Q.current)return[];const Se=Array.isArray(Ne)?Ne:[],Ve=[],ge=new Set;return[...Se].reverse().forEach(ee=>{ee._id&&!ge.has(ee._id)&&(Ve.push(ee),ge.add(ee._id))}),u(Ve),j(Ve.length>=20),M(1),h(!1),wn.debug(`Loaded ${Se.length} messages`),Se}catch(Ne){return wn.error("Failed to load messages:",Ne),z.current&&(clearTimeout(z.current),z.current=null),Q.current?(w(Ne.message||"Failed to load messages"),h(!1),[]):[]}},[e,a,i,d,H]),Pe=b.useCallback(async()=>{if(!e||!a||D||!C||!H)return[];I(!0);try{const re=N+1;wn.debug(`Loading more messages, page ${re}`);const Ne=await tn.getMessages(e,re,20);if(!Q.current)return[];const Se=Array.isArray(Ne)?Ne:[];return Se.length>0&&(u(Ve=>{const ge=[...Ve];return[...Se].reverse().forEach(Re=>{ge.some(he=>he._id===Re._id)||ge.push(Re)}),ge}),M(re)),j(Se.length>=20),I(!1),Se}catch(re){return wn.error("Failed to load more messages:",re),Q.current?(w(re.message||"Failed to load more messages"),I(!1),[]):[]}},[e,a,D,C,N,H]),Ee=b.useCallback(async(re,Ne="text",Se=null)=>{if(!e||!a||!(i!=null&&i._id)||!H){const Ve="Cannot send message: Missing required data";throw wn.error(Ve),new Error(Ve)}y(!0);try{wn.debug(`Sending ${Ne} message to ${e}`);const Ve=`temp-${Date.now()}-${Math.random().toString(36).slice(2,11)}`,ge={_id:Ve,tempId:Ve,sender:i._id,recipient:e,content:re,type:Ne,metadata:Se||{},createdAt:new Date().toISOString(),status:"sending",pending:!0};u(Re=>{const he=new Date;return Re.filter(ze=>ze.content===ge.content&&ze.sender===ge.sender&&ze.recipient===ge.recipient&&he-new Date(ze.createdAt)<5e3).length>0?(wn.debug("Skipping duplicate message send - already have same content"),Re):[...Re,ge]});const ee=await tn.sendMessage(e,re,Ne,Se,Ve);return Q.current&&(u(Re=>{const he=Re.findIndex(Ue=>Ue.tempId===Ve||Ue._id===ee._id);if(he>=0){const Ue=[...Re];return Ue[he]={...ee,tempId:Ve,status:"sent",pending:!1},Ue}return wn.debug("Message with tempId not found - this shouldn't happen normally"),Re}),y(!1)),ee}catch(Ve){throw wn.error("Failed to send message:",Ve),Q.current&&(w(Ve.message||"Failed to send message"),y(!1)),Ve}},[e,a,i,H]),K=b.useCallback(()=>{e&&a&&H&&tn.isConnected()&&tn.sendTypingIndicator(e)},[e,a,H]),q=b.useCallback(()=>ae(!0),[ae]),J=b.useCallback(()=>{w(null)},[]);return{messages:c,loading:d,sending:p,error:g,hasMore:C,typingStatus:V,isConnected:O,initialized:H,loadMessages:ae,loadMoreMessages:Pe,sendMessage:Ee,sendTyping:K,refresh:q,resetError:J}},de=An.create("VideoCall"),Uj=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voip.blackberry.com:3478"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}],X0={iceServers:Uj,iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},K0={width:{ideal:640,max:1280},height:{ideal:480,max:720},frameRate:{ideal:24,max:30}},Q0={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},dr=3,Ij=2e4,Fj=3e4,W0=2e3,qj=5e3,Vj=100,Fc=t=>t?typeof t=="string"?t:[t.candidate,t.sdpMid,t.sdpMLineIndex].join("|"):"",zf=t=>{var e,i,a;if(!t||!t.type)return`invalid-${Date.now()}`;if(t.type==="ice-candidate")return`ice-${Fc(t.candidate)}`;if(t.type==="offer"||t.type==="answer"){const c=((i=(e=t.sdp)==null?void 0:e.sdp)==null?void 0:i.slice(0,150))||((a=t.sdp)==null?void 0:a.slice(0,150))||"";return`${t.type}-${c}`}return`${t.type}-${Date.now()}`},Z0=t=>{const e=Math.floor(t/60),i=Math.floor(t%60);return`${String(e).padStart(2,"0")}:${String(i).padStart(2,"0")}`},Pf=t=>{if(!t)return"unknown";const e=t.iceConnectionState,i=t.connectionState;return i==="failed"||e==="failed"||i==="disconnected"||e==="disconnected"?"poor":i==="connecting"||e==="checking"?"fair":i==="connected"&&e==="connected"?"good":i==="connected"&&e==="completed"?"excellent":"unknown"},Hj=t=>{if(!t)return null;if(typeof t=="string"){if(t.includes("Permission denied"))return"Camera or microphone access was denied. Please check browser permissions.";if(t.includes("NotFoundError")||t.includes("Devices not found"))return"Camera or microphone not found. Please check if they are connected and enabled.";if(t.includes("timed out"))return"Connection timed out. Please check your network connection.";if(t.includes("Could not access"))return"Unable to access camera or microphone. Please check connections and browser permissions.";if(t.includes("multiple attempts"))return"Connection failed after several attempts. Please check your network or try again later.";if(t.includes("Failed to set remote answer sdp: Called in wrong state"))return"Connection synchronization error. Attempting to recover...";if(t.includes("Failed to execute 'addIceCandidate'"))return"Network negotiation issue occurred. Attempting to continue..."}return`An unexpected error occurred${t?`: ${t.toString().split(":")[0]}`:""}. Please try again.`},Do=(t,e)=>{if(!t)return;const i=t.getContext("2d");if(!i)return;i.clearRect(0,0,t.width,t.height);let a="#aaaaaa",c=0;switch(e){case"excellent":a="#4caf50",c=4;break;case"good":a="#8bc34a",c=3;break;case"fair":a="#ffc107",c=2;break;case"poor":a="#f44336",c=1;break;default:c=0}const u=Math.floor(t.width/5),d=Math.floor(u/4),h=u-d;i.fillStyle=a;for(let p=0;p<4;p++){const y=Math.floor(t.height*(.4+p*.2)),g=p*u,w=t.height-y;p<c?i.fillRect(g,w,h,y):(i.strokeStyle="#888888",i.lineWidth=1,i.strokeRect(g,w,h,y))}},Ui=(t,e)=>{if(!t)return;const i=t.getContext("2d");if(!i)return;i.clearRect(0,0,t.width,t.height);const a=Math.min(1,Math.max(0,e)),c=i.createLinearGradient(0,t.height,0,0);c.addColorStop(0,"#4caf50"),c.addColorStop(.5,"#ffeb3b"),c.addColorStop(1,"#f44336"),i.fillStyle=c;const u=Math.round(t.height*a);i.fillRect(0,t.height-u,t.width,u),i.fillStyle="#222";for(let d=0;d<=10;d++){const h=t.height-d*t.height/10,p=d%5===0?10:5;i.fillRect(0,h,p,1)}},Ii=(t,e)=>{if(!t)return;const i=t.getContext("2d");if(!i)return;i.clearRect(0,0,t.width,t.height),i.fillStyle="#222",i.fillRect(0,0,t.width,t.height),i.fillStyle="#fff",i.font="20px Arial",i.textAlign="center",i.textBaseline="middle",i.fillText(e||"Video Off",t.width/2,t.height/2),i.strokeStyle="#fff",i.lineWidth=2;const a=50,c=(t.width-a)/2,u=(t.height-a)/2-40;i.beginPath(),i.rect(c,u,a,a*.7),i.stroke(),i.beginPath(),i.arc(c+a/2,u+a*.35,a*.25,0,Math.PI*2),i.stroke(),i.beginPath(),i.moveTo(c-5,u-5),i.lineTo(c+a+5,u+a*.7+5),i.stroke()},Gj=({isActive:t,userId:e,recipientId:i,onEndCall:a,isIncoming:c=!1,callId:u=null})=>{const d=b.useRef(null),h=b.useRef(null),p=b.useRef(null),y=b.useRef(null),g=b.useRef(null),w=b.useRef(null),C=b.useRef(null),j=b.useRef(null),N=b.useRef(null),M=b.useRef(null),D=b.useRef(null),I=b.useRef(null),V=b.useRef(null),F=b.useRef(null),O=b.useRef(null),A=b.useRef(null),H=b.useRef(null),E=b.useRef(null),L=b.useRef(null),P=b.useRef([]),G=b.useRef(new Set),Q=b.useRef(new Set),z=b.useRef([]),ae=b.useRef(!1),Pe=b.useRef(!1),Ee=b.useRef(!1),[K,q]=b.useState(!0),[J,re]=b.useState(!1),[Ne,Se]=b.useState(!1),[Ve,ge]=b.useState(!1),[ee,Re]=b.useState(!1),[he,Ue]=b.useState(!1),[ze,Xe]=b.useState(!1),[Qe,Ge]=b.useState(null),[at,yt]=b.useState(0),[mt,Ie]=b.useState(0),[qe,jt]=b.useState(!0),[Ct,Rt]=b.useState("unknown"),[pe,je]=b.useState(0),[Je,_t]=b.useState(0),[ke,Ke]=b.useState({resolution:"",frameRate:0,bitrate:0}),ht=b.useCallback(async()=>{if(de.debug("Initializing local media..."),q(!0),Ge(null),j.current){de.debug("Reusing existing media stream."),d.current&&d.current.srcObject!==j.current&&(d.current.srcObject=j.current),!M.current&&j.current.getAudioTracks().length>0&&B();return}try{let fe=null;try{de.debug("Requesting user media with video and audio constraints."),fe=await navigator.mediaDevices.getUserMedia({video:K0,audio:Q0}),de.debug("Acquired video and audio stream."),Se(!1),ge(!1)}catch(Me){de.warn(`Media acquisition with audio+video failed: ${Me.message}. Trying fallbacks.`);try{fe=await navigator.mediaDevices.getUserMedia({video:K0}),Se(!0),ge(!1),ne.warning("Microphone access failed. You are muted."),de.warn("Acquired video-only stream.")}catch(He){de.warn(`Video-only acquisition failed: ${He.message}. Trying audio only.`);try{fe=await navigator.mediaDevices.getUserMedia({audio:Q0}),Se(!1),ge(!0),ne.warning("Camera access failed. Using audio only."),de.warn("Acquired audio-only stream.")}catch(dt){throw de.error(`All media acquisition attempts failed: ${dt.message}`),new Error("Could not access camera or microphone. Check connections & browser permissions.")}}}if(!fe)throw new Error("Media stream acquisition failed unexpectedly.");j.current=fe,d.current&&(d.current.srcObject=fe,d.current.muted=!0,(fe.getVideoTracks().length===0||!fe.getVideoTracks()[0].enabled)&&(ge(!0),w.current&&Ii(w.current,"Camera Off"))),fe.getAudioTracks().length>0&&B(),de.info("Media initialized successfully.")}catch(fe){throw de.error("Media initialization failed:",fe),Ge(`Media Error: ${fe.message}`),q(!1),fe}},[]),B=b.useCallback(()=>{if(!(!j.current||!j.current.getAudioTracks().length))try{const fe=new(window.AudioContext||window.webkitAudioContext),Me=fe.createMediaStreamSource(j.current),He=fe.createAnalyser();He.fftSize=256,Me.connect(He),M.current=He,D.current=new Uint8Array(He.frequencyBinCount),L.current&&clearInterval(L.current),L.current=setInterval(()=>{R()},Vj),de.debug("Audio visualization setup complete")}catch(fe){de.warn("Could not setup audio visualization:",fe)}},[]),R=b.useCallback(()=>{if(M.current&&D.current&&!Ne){M.current.getByteFrequencyData(D.current);const Me=Array.from(D.current).reduce((He,dt)=>He+dt,0)/D.current.length/255;je(Me),y.current&&Ui(y.current,Me)}else Ne&&y.current&&(Ui(y.current,0),je(0));if(I.current&&V.current&&!ee){I.current.getByteFrequencyData(V.current);const Me=Array.from(V.current).reduce((He,dt)=>He+dt,0)/V.current.length/255;_t(Me),g.current&&Ui(g.current,Me)}else ee&&g.current&&(Ui(g.current,0),_t(0))},[Ne,ee]),Y=b.useCallback(async()=>{var Me;if(!N.current)return;if(H.current&&(clearTimeout(H.current),H.current=null),!N.current.remoteDescription){de.debug("Remote description not set yet, delaying candidate flush"),H.current=setTimeout(Y,500);return}const fe=[...P.current];P.current=[],fe.length>0&&de.debug(`Flushing ${fe.length} queued ICE candidates.`);for(const He of fe)try{const dt=Fc(He);G.current.has(dt)?de.debug("Skipping already processed queued ICE candidate."):(await N.current.addIceCandidate(new RTCIceCandidate(He)),G.current.add(dt),de.debug("Added queued ICE candidate:",(Me=He.candidate)==null?void 0:Me.slice(0,50)))}catch(dt){de.error("Error adding queued ICE candidate:",dt),(dt.name==="OperationError"||dt.message.includes("prerequisite"))&&P.current.push(He)}P.current.length>0&&!H.current&&(de.warn(`Re-scheduling flush for ${P.current.length} candidates.`),H.current=setTimeout(Y,1e3))},[]),_=b.useCallback(()=>{if(z.current.length>0){de.debug(`Flushing ${z.current.length} queued incoming signals`);const fe=[...z.current];z.current=[],fe.forEach(Me=>{we(Me)})}},[]),v=b.useCallback(fe=>{var Me;if(fe.candidate&&N.current){const He=Fc(fe.candidate);if(G.current.has(He)){de.debug("Skipping duplicate local ICE candidate.");return}G.current.add(He),de.debug("Gathered local ICE candidate:",(Me=fe.candidate.candidate)==null?void 0:Me.slice(0,50)),Be.emit("videoSignal",{recipientId:i,signal:{type:"ice-candidate",candidate:fe.candidate.toJSON()},from:{userId:e,callId:u}})}else fe.candidate||de.debug("ICE gathering complete for this phase.")},[i,e,u]),x=b.useCallback(fe=>{var Me,He;de.debug("Received remote track:",(Me=fe.track)==null?void 0:Me.kind,"Stream ID:",(He=fe.streams[0])==null?void 0:He.id);try{if(!fe.streams||fe.streams.length===0){de.warn("Remote track received without a stream.");return}const dt=fe.streams[0];if(fe.track.kind==="audio"&&!I.current)try{const Et=new(window.AudioContext||window.webkitAudioContext),oe=Et.createMediaStreamSource(dt),We=Et.createAnalyser();We.fftSize=256,oe.connect(We),I.current=We,V.current=new Uint8Array(We.frequencyBinCount),de.debug("Remote audio visualization setup complete")}catch(Et){de.warn("Could not setup remote audio visualization:",Et)}if(h.current&&h.current.srcObject!==dt&&(de.info("Attaching remote stream to video element."),h.current.srcObject=dt,Ee.current=!0,re(!0),q(!1),Ge(null),yt(0),O.current&&(clearTimeout(O.current),O.current=null),de.info("Connection established with media stream.")),fe.track.kind==="audio"){const Et=fe.track.muted||!fe.track.enabled;Re(Et),fe.track.onmute=()=>{de.debug("Remote audio muted"),Re(!0)},fe.track.onunmute=()=>{de.debug("Remote audio unmuted"),Re(!1)},fe.track.onended=()=>{de.warn("Remote audio track ended"),Re(!0)}}else if(fe.track.kind==="video"){const Et=fe.track.muted||!fe.track.enabled;Ue(Et),Et&&C.current&&Ii(C.current,"Remote Camera Off"),fe.track.onmute=()=>{de.debug("Remote video disabled"),Ue(!0),C.current&&Ii(C.current,"Remote Camera Off")},fe.track.onunmute=()=>{de.debug("Remote video enabled"),Ue(!1)},fe.track.onended=()=>{de.warn("Remote video track ended"),Ue(!0),C.current&&Ii(C.current,"Remote Video Ended")}}}catch(dt){de.error("Error handling remote track:",dt)}},[]),T=b.useCallback(()=>{if(!N.current)return;const fe=N.current;de.debug("RTCPeerConnection state changed:",fe.connectionState);const Me=Pf(fe);switch(Rt(Me),p.current&&Do(p.current,Me),fe.connectionState){case"connected":de.info("Connection state connected - Updating UI"),Ee.current=!0,re(!0),q(!1),Ge(null),ae.current=!1,yt(0),O.current&&(clearTimeout(O.current),O.current=null),Y();break;case"disconnected":de.warn("Connection state disconnected"),setTimeout(()=>{var He;Pe.current&&((He=N.current)==null?void 0:He.connectionState)==="disconnected"&&(de.warn("Connection still disconnected after grace period"),re(!1))},3e3);break;case"failed":de.error("Connection state failed"),re(!1),q(!1),Ge("Connection failed. Please retry."),Le(X,Ye);break;case"closed":de.info("Connection state closed"),re(!1),q(!1);break;case"connecting":de.debug("Connection state connecting"),J||q(!0);break;case"new":de.debug("Connection state new"),J||q(!0);break}},[Y,J]),U=b.useCallback(()=>{if(!N.current)return;const fe=N.current;de.debug("ICE connection state changed:",fe.iceConnectionState);const Me=Pf(fe);switch(Rt(Me),p.current&&Do(p.current,Me),fe.iceConnectionState){case"connected":case"completed":de.info(`ICE connection ${fe.iceConnectionState} - Updating UI`),Ee.current=!0,re(!0),q(!1),Ge(null),Y();break;case"failed":de.error("ICE connection failed"),re(!1),Ge("Network connection failed."),_e(le);break;case"disconnected":de.warn("ICE connection disconnected, attempting recovery"),setTimeout(()=>{var He;Pe.current&&((He=N.current)==null?void 0:He.iceConnectionState)==="disconnected"&&_e(le)},1500);break}},[Y]),X=b.useCallback(async()=>{de.debug("Attempting to create new RTCPeerConnection"),N.current&&(de.warn("Closing existing peer connection before creating a new one."),N.current.close(),N.current=null),G.current.clear(),Q.current.clear(),P.current=[],z.current=[],ae.current=!1;try{const fe=new RTCPeerConnection(X0);if(de.debug("RTCPeerConnection created with config:",X0),j.current)j.current.getTracks().forEach(Me=>{try{fe.addTrack(Me,j.current),de.debug(`Added local ${Me.kind} track to peer connection.`)}catch(He){de.error(`Failed to add ${Me.kind} track:`,He)}});else throw de.warn("No local stream available when creating peer connection."),new Error("Local media stream missing.");return fe.ontrack=x,fe.onicecandidate=v,fe.onconnectionstatechange=T,fe.oniceconnectionstatechange=U,fe.onicegatheringstatechange=()=>{de.debug("ICE gathering state:",fe.iceGatheringState),fe.iceGatheringState==="complete"&&Y()},fe.onsignalingstatechange=()=>{de.debug("Signaling state changed:",fe.signalingState),ae.current=fe.signalingState!=="stable"},fe.onnegotiationneeded=()=>{de.debug("Negotiation needed event fired. Current state:",fe.signalingState)},N.current=fe,de.info("Peer connection created and listeners attached successfully."),_(),fe}catch(fe){throw de.error("Fatal error creating peer connection:",fe),Ge(`Failed to initialize connection: ${fe.message}`),q(!1),fe}},[x,v,T,U,Y,_]),le=b.useCallback(async(fe={})=>{if(!N.current){de.error("Cannot create offer: Peer connection does not exist.");return}const Me=N.current;if(Me.signalingState!=="stable"){de.warn(`Cannot create offer in signaling state: ${Me.signalingState}. Aborting.`);return}if(ae.current){de.warn("Negotiation already in progress, skipping offer creation.");return}try{ae.current=!0,de.debug("Creating offer...");const He={offerToReceiveAudio:!0,offerToReceiveVideo:!0,iceRestart:(fe==null?void 0:fe.iceRestart)||!1},dt=await Me.createOffer(He);if(Me.signalingState!=="stable"){de.warn(`Signaling state changed to ${Me.signalingState} during offer creation. Aborting.`),ae.current=!1;return}await Me.setLocalDescription(dt),de.debug("Offer created and set as local description.");const Et={type:"offer",sdp:Me.localDescription},oe=zf(Et);Q.current.add(oe),Be.emit("videoSignal",{recipientId:i,signal:Et,from:{userId:e,callId:u}}),de.debug("Offer sent to remote peer."),Y()}catch(He){de.error("Error creating or setting offer:",He),Ge(`Signaling Error: ${He.message}`),ae.current=!1,_e(le)}},[i,e,u,Y]),Ze=b.useCallback(async()=>{if(!N.current){de.error("Cannot create answer: Peer connection does not exist.");return}const fe=N.current;if(fe.signalingState!=="have-remote-offer"){de.warn(`Cannot create answer in signaling state: ${fe.signalingState}. Aborting.`);return}try{ae.current=!0,de.debug("Creating answer...");const Me=await fe.createAnswer();if(fe.signalingState!=="have-remote-offer"){de.warn(`Signaling state changed to ${fe.signalingState} during answer creation. Aborting.`),ae.current=!1;return}await fe.setLocalDescription(Me),de.debug("Answer created and set as local description.");const He={type:"answer",sdp:fe.localDescription},dt=zf(He);Q.current.add(dt),Be.emit("videoSignal",{recipientId:i,signal:He,from:{userId:e,callId:u}}),de.debug("Answer sent to remote peer."),Y()}catch(Me){de.error("Error creating or setting answer:",Me),Ge(`Signaling Error: ${Me.message}`),ae.current=!1,_e(le)}},[i,e,u,Y,le]),we=b.useCallback(fe=>{if(!fe||!fe.signal||!fe.signal.type||!fe.userId){de.warn("Received invalid signal data structure.");return}if(fe.userId!==i){de.debug(`Ignoring signal from unexpected user: ${fe.userId}`);return}const Me=fe.signal,He=Me.type;if(de.debug(`Received '${He}' signal from ${fe.userId}`),!N.current){de.warn(`Peer connection not ready. Queuing '${He}' signal.`),z.current.push(fe);return}const dt=N.current,Et=dt.signalingState;de.debug(`Processing '${He}'. Current state: ${Et}. Negotiation: ${ae.current}`);const oe=zf(Me);if(Q.current.has(oe)){de.debug(`Ignoring duplicate '${He}' signal (ID: ${oe.substring(0,50)}...)`);return}try{switch(He){case"request-offer":de.debug("Received request-offer signal."),Et==="stable"&&!ae.current?le().catch(ft=>de.error("Error creating offer:",ft)):de.warn(`Cannot create offer now upon request. State: ${Et}, Negotiation: ${ae.current}`);break;case"offer":de.debug("Processing received offer."),Q.current.add(oe),ae.current&&Et==="have-local-offer"?(de.warn("Offer collision detected (both peers sending offers)."),e>i?(de.debug("This peer is polite. Rolling back local offer and accepting remote offer."),ae.current=!1,dt.setLocalDescription({type:"rollback"}).then(()=>dt.setRemoteDescription(new RTCSessionDescription(Me.sdp))).then(()=>(Y(),Ze())).catch(rt=>{de.error("Error handling polite offer collision:",rt)})):de.debug("This peer is impolite. Ignoring remote offer, expecting peer to accept ours.")):Et==="stable"||Et==="have-remote-offer"?dt.setRemoteDescription(new RTCSessionDescription(Me.sdp)).then(()=>{if(de.debug("Remote offer set successfully."),Y(),dt.signalingState==="have-remote-offer")return Ze();de.warn(`State after setting remote offer is ${dt.signalingState}, not creating answer yet.`)}).catch(ft=>{de.error("Error setting remote description:",ft),Ge(`Signaling Error: ${ft.message}`)}):(de.error(`Cannot handle offer in unexpected state: ${Et}.`),_e(le));break;case"answer":de.debug("Processing received answer."),Et==="have-local-offer"?(Q.current.add(oe),dt.setRemoteDescription(new RTCSessionDescription(Me.sdp)).then(()=>{de.debug("Remote answer set successfully. Connection should establish soon."),ae.current=!1,Y()}).catch(ft=>{de.error("Error setting remote answer description:",ft),Ge(`Signaling Error: ${ft.message}`)})):de.warn(`Received answer in unexpected state: ${Et}. Ignoring.`);break;case"ice-candidate":if(!Me.candidate){de.debug("Received empty ICE candidate signal (end of candidates).");return}const bt=new RTCIceCandidate(Me.candidate),vt=Fc(bt);if(G.current.has(vt)){de.debug("Skipping duplicate remote ICE candidate.");return}dt.remoteDescription?dt.addIceCandidate(bt).then(()=>{var ft;G.current.add(vt),de.debug("Added remote ICE candidate:",(ft=bt.candidate)==null?void 0:ft.slice(0,50))}).catch(ft=>{de.error("Error adding remote ICE candidate:",ft),dt.signalingState!=="closed"&&P.current.push(bt)}):(de.debug("Queuing remote ICE candidate (no remote description yet)."),P.current.push(bt));break;default:de.warn(`Received unknown signal type: ${He}`)}}catch(We){de.error(`Error processing signal type ${He}:`,We),Ge(`Signaling Error: ${We.message}`),ae.current=!1,_e(le)}},[i,e,u,le,Ze,Y]),_e=b.useCallback(fe=>{if(!N.current||!Pe.current)return;const Me=N.current;de.warn("Attempting connection recovery (ICE Restart)."),Rt(Pf(Me)),p.current&&Do(p.current,"poor"),typeof Me.restartIce=="function"&&(Me.iceConnectionState==="disconnected"||Me.iceConnectionState==="failed")?(de.debug("Performing ICE restart."),ae.current=!1,Me.restartIce(),!c&&Me.signalingState==="stable"&&(de.debug("Initiator attempting offer creation after ICE restart."),setTimeout(()=>{var He;Pe.current&&((He=N.current)==null?void 0:He.signalingState)==="stable"&&fe({iceRestart:!0}).catch(dt=>de.error("Error creating recovery offer:",dt))},500))):(de.warn(`ICE restart not applicable or supported. State: ${Me.iceConnectionState}. Attempting full reconnect.`),Le(X,Ye))},[c]),Le=b.useCallback((fe,Me)=>{if(!Pe.current)return;if(at>=dr){de.error("Max reconnection attempts reached. Giving up."),Ge("Failed to establish connection after multiple attempts. Please check network or try again later."),q(!1);return}if(A.current){de.debug("Reconnect attempt already scheduled.");return}q(!0),re(!1),yt(dt=>dt+1);const He=at+1;de.warn(`Attempting full reconnect (${He}/${dr}) in ${W0}ms...`),Ge(`Connection lost. Attempting to reconnect (${He}/${dr})...`),A.current=setTimeout(async()=>{if(A.current=null,!!Pe.current){de.debug(`Executing reconnect attempt ${He}`);try{if(await fe(),!Pe.current)return;await Me(),de.info(`Reconnect attempt ${He} initiated signaling.`)}catch(dt){de.error(`Error during reconnection attempt ${He}:`,dt),Ge(`Reconnection failed: ${dt.message}`),q(!1),He<dr?Le(fe,Me):(de.error("Final reconnection attempt failed."),Ge("Failed to reconnect. Please try again later."))}}},W0)},[at]),Ye=b.useCallback(async()=>{de.debug(`Starting signaling. Role: ${c?"Callee (Incoming)":"Caller (Outgoing)"}`),F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{Pe.current&&!J&&K&&(de.error("Signaling timeout reached. Connection failed."),Ge("Connection timed out. Peer might be offline or network issues."),q(!1))},Ij);try{if(!N.current)throw new Error("Peer connection not initialized before starting signaling.");c?de.debug("Incoming call: Waiting for offer from caller."):(de.debug("Outgoing call: Creating initial offer."),await le())}catch(fe){de.error("Error during signaling initiation:",fe),Ge(`Signaling Error: ${fe.message}`),q(!1)}},[c,le,J,K]),Bt=b.useCallback(async()=>{if(!(!N.current||!J))try{const fe=await N.current.getStats();let Me=null,He=null,dt=null,Et=null;if(fe.forEach(oe=>{oe.type==="inbound-rtp"&&oe.kind==="video"&&(Me=oe),oe.type==="inbound-rtp"&&oe.kind==="audio"&&(He=oe),oe.type==="outbound-rtp"&&oe.kind==="video"&&(dt=oe),oe.type==="candidate-pair"&&oe.state==="succeeded"&&(Et=oe)}),Me){const oe=Me.frameWidth||0,We=Me.frameHeight||0,bt=Math.round(Me.framesPerSecond||0);Ke({resolution:oe&&We?`${oe}x${We}`:"",frameRate:bt,bitrate:Math.round((Me.bytesReceived||0)/1024/8)})}if(Et&&Me){const oe=Et.currentRoundTripTime||0,We=Me.packetsLost||0,bt=Me.packetsReceived||1,vt=We/(We+bt),ft=Me.jitter||0;let rt="unknown";oe<.1&&vt<.01&&ft<.01?rt="excellent":oe<.3&&vt<.05&&ft<.03?rt="good":oe<.5&&vt<.1&&ft<.05?rt="fair":rt="poor",Rt(rt),p.current&&Do(p.current,rt)}}catch(fe){de.warn("Error getting WebRTC stats:",fe)}},[J]),xt=b.useCallback(()=>{de.info("Closing VideoCall connection and cleaning up resources."),F.current&&clearTimeout(F.current),O.current&&clearTimeout(O.current),A.current&&clearTimeout(A.current),H.current&&clearTimeout(H.current),E.current&&clearInterval(E.current),L.current&&clearInterval(L.current),F.current=null,O.current=null,A.current=null,H.current=null,E.current=null,L.current=null,j.current&&(de.debug("Stopping local media tracks."),j.current.getTracks().forEach(fe=>{fe.stop()}),j.current=null),M.current=null,D.current=null,I.current=null,V.current=null,d.current&&(d.current.srcObject=null),h.current&&(h.current.srcObject=null),N.current&&(de.debug("Closing RTCPeerConnection."),N.current.close(),N.current=null),P.current=[],z.current=[],G.current.clear(),Q.current.clear(),ae.current=!1,Ee.current=!1,de.debug("VideoCall cleanup complete.")},[]),Ht=b.useCallback(()=>{if(!j.current)return;const fe=j.current.getAudioTracks();if(fe.length>0){const Me=!Ne;fe[0].enabled=!Me,Se(Me),y.current&&Ui(y.current,Me?0:pe),de.debug(`Local audio ${Me?"muted":"unmuted"}.`),Be.emit("videoMediaControl",{recipientId:i,type:"audio",muted:Me})}else de.warn("Attempted to toggle mute but no local audio track found.")},[Ne,i,pe]),mn=b.useCallback(()=>{if(!j.current)return;const fe=j.current.getVideoTracks();if(fe.length>0){const Me=!Ve;fe[0].enabled=!Me,ge(Me),w.current&&Me&&Ii(w.current,"Camera Off"),de.debug(`Local video ${Me?"disabled":"enabled"}.`),Be.emit("videoMediaControl",{recipientId:i,type:"video",muted:Me})}else de.warn("Attempted to toggle video but no local video track found.")},[Ve,i]),is=b.useCallback(()=>{de.info("User initiated end call."),Be.emit("videoHangup",{recipientId:i}),a&&a()},[i,a]),Ds=b.useCallback(()=>{const fe=document.querySelector(".video-container");fe&&(document.fullscreenElement?document.exitFullscreen().then(()=>Xe(!1)):fe.requestFullscreen().then(()=>Xe(!0)).catch(Me=>ne.error(`Could not enter fullscreen: ${Me.message}`)))},[]);return b.useEffect(()=>(Pe.current=!0,de.debug("VideoCall component mounted."),()=>{Pe.current=!1,de.debug("VideoCall component unmounting."),xt()}),[xt]),b.useEffect(()=>{if(t&&Pe.current){de.info("VideoCall activated. Initializing..."),Ee.current=!1,O.current=setTimeout(()=>{Pe.current&&!Ee.current&&(de.error("Overall connection timeout reached."),Ge("Connection failed to establish after 30 seconds."),q(!1))},Fj),(async()=>{try{if(Ge(null),q(!0),yt(0),await ht(),!Pe.current||(await X(),!Pe.current)||(await Ye(),!Pe.current))return;de.info("Call initialization sequence completed.")}catch(He){de.error("Error during call initialization sequence:",He),q(!1),Ge(`Setup failed: ${He.message}`)}})(),E.current=setInterval(()=>{Bt()},qj);const Me=setInterval(()=>{Ie(He=>He+1)},1e3);return()=>{de.info("VideoCall deactivated or unmounting. Cleaning up active call."),clearInterval(Me),E.current&&clearInterval(E.current),O.current&&clearTimeout(O.current),xt(),Ie(0)}}else!t&&N.current&&(de.info("VideoCall deactivated. Performing cleanup."),xt(),re(!1),q(!1),Ge(null),yt(0),Ie(0))},[t,ht,X,Ye,xt,Bt]),b.useEffect(()=>{if(!t)return;de.debug("Setting up socket listeners for VideoCall");const fe=oe=>we(oe),Me=oe=>{oe.userId===i&&(de.info("Received hangup signal from peer."),ne.info("The other user has ended the call."),a&&a())},He=oe=>{oe.userId===i&&(de.debug(`Received media control from peer: ${oe.type} = ${oe.muted}`),oe.type==="audio"&&(Re(oe.muted),g.current&&Ui(g.current,oe.muted?0:Je)),oe.type==="video"&&(Ue(oe.muted),oe.muted&&C.current&&Ii(C.current,"Remote Camera Off")))},dt=oe=>{de.error("Received error signal from peer or server:",oe==null?void 0:oe.error),Ge(`Remote Error: ${(oe==null?void 0:oe.error)||"Unknown issue"}`),q(!1)},Et=[Be.on("videoSignal",fe),Be.on("videoHangup",Me),Be.on("videoMediaControl",He),Be.on("videoError",dt)];return()=>{de.debug("Removing socket listeners for VideoCall"),Et.forEach(oe=>oe())}},[t,i,a,we,Je]),b.useEffect(()=>{let fe=null;const Me=()=>{jt(!0),fe&&clearTimeout(fe),fe=setTimeout(()=>{Pe.current&&jt(!1)},3e3)},He=document.querySelector(".video-container");return He&&(He.addEventListener("mousemove",Me),Me()),()=>{fe&&clearTimeout(fe),He==null||He.removeEventListener("mousemove",Me)}},[]),b.useEffect(()=>{p.current&&Do(p.current,Ct),y.current&&Ui(y.current,Ne?0:pe),g.current&&Ui(g.current,ee?0:Je),Ve&&w.current&&Ii(w.current,"Camera Off"),he&&C.current&&Ii(C.current,"Remote Camera Off")},[Ct,pe,Je,Ne,ee,Ve,he]),b.useEffect(()=>{de.debug(`Connection status changed - connected: ${J}, connecting: ${K}, error: ${Qe||"none"}`)},[J,K,Qe]),o.jsxs("div",{className:"video-call",children:[o.jsxs("div",{className:"video-container",onMouseMove:()=>jt(!0),children:[o.jsxs("div",{className:"remote-video-wrapper",children:[o.jsx("video",{ref:h,className:"remote-video",autoPlay:!0,playsInline:!0}),he&&o.jsx("canvas",{ref:C,className:"video-placeholder remote-video-placeholder",width:"640",height:"480"}),o.jsxs("div",{className:"connection-quality-indicator",children:[o.jsx("canvas",{ref:p,width:"100",height:"30",className:`quality-canvas ${Ct}`}),o.jsx("span",{className:"quality-text",children:Ct})]}),o.jsx("div",{className:"remote-audio-indicator",children:o.jsx("canvas",{ref:g,width:"15",height:"80",className:"audio-level-canvas"})}),ee&&!K&&!Qe&&o.jsx("div",{className:"audio-off-indicator remote-audio-off",children:o.jsx(I0,{"aria-label":"Remote peer muted"})}),K&&!J&&o.jsxs("div",{className:"connecting-indicator",children:[o.jsx(ws,{className:"spin","aria-hidden":"true"}),o.jsx("span",{children:"Connecting..."}),at>0&&o.jsxs("span",{className:"retry-count",children:["Attempt ",at,"/",dr]})]}),Qe&&!K&&o.jsx("div",{className:"error-indicator",children:o.jsxs("div",{className:"error-message",children:[o.jsx("span",{children:Hj(Qe)}),at<dr&&!J&&o.jsxs("button",{className:"retry-button",onClick:()=>Le(X,Ye),"aria-label":"Retry connection",children:[o.jsx(R5,{})," Retry"]}),o.jsxs("button",{className:"error-end-call-button",onClick:is,"aria-label":"End Call",children:[o.jsx(Qc,{})," End Call"]})]})})]}),o.jsxs("div",{className:"local-video-wrapper",children:[o.jsx("video",{ref:d,className:"local-video",autoPlay:!0,playsInline:!0,muted:!0}),Ve&&o.jsx("canvas",{ref:w,className:"video-placeholder local-video-placeholder",width:"160",height:"120"}),o.jsx("div",{className:"local-audio-indicator",children:o.jsx("canvas",{ref:y,width:"10",height:"60",className:"audio-level-canvas"})})]}),o.jsxs("div",{className:"call-info",children:[o.jsx("span",{className:"call-duration","aria-label":`Call duration: ${Z0(mt)}`,children:Z0(mt)}),J&&ke.resolution&&o.jsxs("span",{className:"video-stats",children:[ke.resolution," • ",ke.frameRate," fps"]})]}),o.jsxs("div",{className:`call-controls ${qe?"visible":"hidden"}`,children:[o.jsx("button",{className:`control-button ${Ne?"active":""}`,onClick:Ht,"aria-label":Ne?"Unmute Microphone":"Mute Microphone","aria-pressed":Ne,children:Ne?o.jsx(I0,{}):o.jsx(g5,{})}),o.jsx("button",{className:`control-button ${Ve?"active":""}`,onClick:mn,"aria-label":Ve?"Turn Camera On":"Turn Camera Off","aria-pressed":Ve,children:Ve?o.jsx(L5,{}):o.jsx(xa,{})}),o.jsx("button",{className:"control-button end-call",onClick:is,"aria-label":"End Call",children:o.jsx(Qc,{})}),o.jsx("button",{className:`control-button ${ze?"active":""}`,onClick:Ds,"aria-label":ze?"Exit Fullscreen":"Enter Fullscreen","aria-pressed":ze,children:ze?o.jsx(o5,{}):o.jsx(u5,{})}),o.jsxs("button",{className:"control-button quality-button","aria-label":"Show connection quality",children:[o.jsx(C5,{}),o.jsx("span",{className:`quality-dot ${Ct}`})]})]})]}),o.jsx("style",{jsx:"true",children:`
        .video-call {
          width: 100%;
          height: 100%;
          position: relative;
          background-color: #1a1a1a;
          overflow: hidden;
          border-radius: 8px;
          color: #fff;
          font-family: system-ui, -apple-system, sans-serif;
        }
        
        .video-container {
          width: 100%;
          height: 100%;
          position: relative;
          display: flex;
          align-items: center;
          justify-content: center;
        }
        
        /* Remote Video Styles */
        .remote-video-wrapper {
          width: 100%;
          height: 100%;
          position: relative;
          overflow: hidden;
          background-color: #222;
        }
        
        .remote-video {
          width: 100%;
          height: 100%;
          object-fit: cover;
          background-color: #222;
        }
        
        /* Video Placeholders */
        .video-placeholder {
          position: absolute;
          top: 0;
          left: 0;
          background-color: rgba(0, 0, 0, 0.8);
        }
        
        .remote-video-placeholder {
          width: 100%;
          height: 100%;
          z-index: 5;
        }
        
        /* Connection Quality Indicator */
        .connection-quality-indicator {
          position: absolute;
          top: 20px;
          right: 20px;
          display: flex;
          align-items: center;
          background-color: rgba(0, 0, 0, 0.6);
          padding: 5px 10px;
          border-radius: 12px;
          z-index: 25;
          backdrop-filter: blur(3px);
        }
        
        .quality-canvas {
          margin-right: 8px;
        }
        
        .quality-text {
          font-size: 12px;
          font-weight: 500;
          text-transform: capitalize;
        }
        
        /* Audio Level Indicators */
        .remote-audio-indicator {
          position: absolute;
          bottom: 20px;
          right: 20px;
          z-index: 15;
          background-color: rgba(0, 0, 0, 0.6);
          padding: 5px;
          border-radius: 8px;
          backdrop-filter: blur(3px);
        }
        
        .local-audio-indicator {
          position: absolute;
          bottom: 5px;
          right: 5px;
          z-index: 15;
          background-color: rgba(0, 0, 0, 0.6);
          padding: 3px;
          border-radius: 5px;
          backdrop-filter: blur(3px);
        }
        
        .audio-level-canvas {
          display: block;
        }
        
        /* Indicator Styles for Video/Audio State */
        .connecting-indicator,
        .error-indicator {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          background-color: rgba(0, 0, 0, 0.75);
          z-index: 20;
          backdrop-filter: blur(4px);
        }
        
        .connecting-indicator {
          gap: 15px;
          color: #fff;
          font-size: 1.1em;
        }
        
        .spin {
          animation: spin 1.2s infinite linear;
          font-size: 3em;
          color: #4a90e2;
        }
        
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
        
        .retry-count {
          font-size: 0.9em;
          opacity: 0.8;
        }
        
        .error-indicator {
          pointer-events: auto;
        }
        
        .error-message {
          background-color: rgba(220, 53, 69, 0.9);
          padding: 20px 25px;
          border-radius: 8px;
          max-width: 85%;
          text-align: center;
          display: flex;
          flex-direction: column;
          gap: 15px;
          font-size: 0.95em;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .retry-button,
        .error-end-call-button {
          background-color: rgba(255, 255, 255, 0.2);
          border: none;
          border-radius: 5px;
          color: #fff;
          padding: 10px 15px;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 8px;
          margin: 0 auto;
          transition: background-color 0.2s, transform 0.2s;
          font-size: 0.9em;
          font-weight: 500;
        }
        
        .retry-button:hover {
          background-color: rgba(255, 255, 255, 0.3);
          transform: translateY(-2px);
        }
        
        .error-end-call-button {
          background-color: rgba(150, 40, 50, 0.9);
        }
        
        .error-end-call-button:hover {
          background-color: rgba(180, 45, 55, 1);
          transform: translateY(-2px);
        }
        
        .audio-off-indicator {
          position: absolute;
          top: 20px;
          right: 90px;
          background-color: rgba(0, 0, 0, 0.6);
          color: #dc3545;
          padding: 8px;
          border-radius: 50%;
          z-index: 10;
          font-size: 1.2em;
          backdrop-filter: blur(3px);
        }
        
        /* Local Video */
        .local-video-wrapper {
          position: absolute;
          width: clamp(120px, 20%, 180px);
          aspect-ratio: 4/3;
          bottom: 20px;
          left: 20px;
          border-radius: 8px;
          overflow: hidden;
          border: 2px solid rgba(255, 255, 255, 0.5);
          box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
          z-index: 10;
          transition: transform 0.3s ease;
        }
        
        .local-video-wrapper:hover {
          transform: scale(1.05);
        }
        
        .local-video {
          width: 100%;
          height: 100%;
          object-fit: cover;
          background-color: #333;
          transform: scaleX(-1); /* Mirror local view */
        }
        
        .local-video-placeholder {
          width: 100%;
          height: 100%;
          z-index: 5;
        }
        
        /* Call Info */
        .call-info {
          position: absolute;
          top: 20px;
          left: 20px;
          display: flex;
          flex-direction: column;
          gap: 5px;
          background-color: rgba(0, 0, 0, 0.6);
          padding: 8px 14px;
          border-radius: 15px;
          font-size: 0.9em;
          font-weight: 500;
          z-index: 20;
          backdrop-filter: blur(3px);
        }
        
        .video-stats {
          font-size: 0.75em;
          opacity: 0.8;
        }
        
        /* Controls */
        .call-controls {
          position: absolute;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          display: flex;
          gap: 16px;
          background-color: rgba(0, 0, 0, 0.7);
          padding: 12px 20px;
          border-radius: 32px;
          transition: opacity 0.4s ease, transform 0.4s ease;
          z-index: 20;
          backdrop-filter: blur(10px);
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .call-controls.visible {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
        
        .call-controls.hidden {
          opacity: 0;
          transform: translateX(-50%) translateY(80px);
          pointer-events: none;
        }
        
        .control-button {
          width: 52px;
          height: 52px;
          border-radius: 50%;
          border: none;
          background-color: rgba(255, 255, 255, 0.15);
          color: #fff;
          font-size: 1.2em;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          transition: all 0.2s ease;
          position: relative;
        }
        
        .control-button:hover {
          background-color: rgba(255, 255, 255, 0.25);
          transform: translateY(-3px);
        }
        
        .control-button.active {
          background-color: #4a90e2;
        }
        
        .control-button.end-call {
          background-color: #dc3545;
        }
        
        .control-button.end-call:hover {
          background-color: #c82333;
        }
        
        .quality-dot {
          position: absolute;
          bottom: 3px;
          right: 3px;
          width: 8px;
          height: 8px;
          border-radius: 50%;
          background-color: #aaa;
        }
        
        .quality-dot.excellent {
          background-color: #4caf50;
        }
        
        .quality-dot.good {
          background-color: #8bc34a;
        }
        
        .quality-dot.fair {
          background-color: #ffc107;
        }
        
        .quality-dot.poor {
          background-color: #f44336;
        }
        
        /* Connection Quality Text Colors */
        .quality-text.excellent,
        .connection-quality.excellent {
          color: #4caf50;
        }
        
        .quality-text.good,
        .connection-quality.good {
          color: #8bc34a;
        }
        
        .quality-text.fair,
        .connection-quality.fair {
          color: #ffc107;
        }
        
        .quality-text.poor,
        .connection-quality.poor {
          color: #f44336;
        }
      `})]})},cn=An.create("EmbeddedChat");let J0=0;const Kn=()=>(J0++,`system-${Date.now()}-${J0}-${Math.random().toString(36).substring(2,15)}`),ul=({recipient:t,isOpen:e=!0,onClose:i=()=>{},embedded:a=!0})=>{var Ze;const[c,u]=b.useState(!1),[d,h]=b.useState(!1),{user:p,isAuthenticated:y}=Sn(),g=In(),{messages:w,loading:C,error:j,sendMessage:N,typingStatus:M,sendTyping:D,initialized:I,isConnected:V,refresh:F}=$j(t==null?void 0:t._id),[O,A]=b.useState(""),[H,E]=b.useState(!1),[L,P]=b.useState(!1),[G,Q]=b.useState(null),[z,ae]=b.useState(!1),[Pe,Ee]=b.useState(0),[K,q]=b.useState([]),[J,re]=b.useState(0),[Ne,Se]=b.useState(!1),[Ve,ge]=b.useState([]),[ee,Re]=b.useState(null),[he,Ue]=b.useState(!1),[ze,Xe]=b.useState(!1),Qe=b.useRef(null),Ge=b.useRef(null),at=b.useRef(null),yt=b.useRef(null),mt=b.useRef(null),Ie=b.useRef(null);b.useEffect(()=>(cn.debug("EmbeddedChat mounted with recipient:",t==null?void 0:t.nickname),console.log("Chat initialization state:",{recipientId:t==null?void 0:t._id,initialized:I,isConnected:V,currentUserId:p==null?void 0:p._id,isAuthenticatedUser:y}),()=>cn.debug("EmbeddedChat unmounted")),[t,I,V,p,y]);const qe=b.useCallback(()=>{const we=localStorage.getItem("token")||sessionStorage.getItem("token");return Mt.create({baseURL:"",headers:{"Content-Type":"application/json",Authorization:we?`Bearer ${we}`:""}})},[]);if(b.useEffect(()=>(Ie.current&&clearTimeout(Ie.current),C&&!L?Ie.current=setTimeout(()=>{P(!0)},5e3):C||P(!1),()=>{Ie.current&&clearTimeout(Ie.current)}),[C,L]),b.useEffect(()=>{if(!e||!t||!(p!=null&&p._id))return;const we=xt=>{var mn;if(xt.userId!==t._id)return;cn.debug(`Received incoming call from ${xt.userId}`,xt),Re({callId:xt.callId,callerName:((mn=xt.caller)==null?void 0:mn.name)||t.nickname,callerId:xt.userId,timestamp:xt.timestamp});const Ht={_id:Kn(),sender:"system",content:`${t.nickname} is calling you.`,createdAt:new Date().toISOString(),type:"system"};q(is=>[...is,Ht])},_e=xt=>{if(xt.userId!==t._id)return;cn.debug(`Call accepted by ${t.nickname}`);const Ht={_id:Kn(),sender:"system",content:`${t.nickname} accepted your call.`,createdAt:new Date().toISOString(),type:"system"};q(mn=>[...mn,Ht]),ne.success(`${t.nickname} accepted your call`)},Le=xt=>{if(xt.userId!==t._id)return;cn.debug(`Call declined by ${t.nickname}`);const Ht={_id:Kn(),sender:"system",content:`${t.nickname} declined your call.`,createdAt:new Date().toISOString(),type:"system"};q(mn=>[...mn,Ht]),Ue(!1),ne.info(`${t.nickname} declined your call`)},Ye=xt=>{xt.userId===t._id&&(cn.debug(`Call hung up by ${t.nickname}`),he&&_())},Bt=[Be.on("incomingCall",we),Be.on("callAccepted",_e),Be.on("callDeclined",Le),Be.on("videoHangup",Ye)];return()=>{Bt.forEach(xt=>xt())}},[e,t,p==null?void 0:p._id,he]),b.useEffect(()=>{if(Array.isArray(w)){const we=new Map,_e=w.filter(Le=>{if(!Le||!Le._id&&!Le.tempId)return!1;const Ye=Le._id||Le.tempId;return we.has(Ye)?(cn.warn(`Filtering out duplicate message with ID: ${Ye}`),!1):(we.set(Ye,!0),!0)});_e.length!==w.length&&cn.debug(`Filtered out ${w.length-_e.length} duplicate messages`),q(_e),cn.debug(`Received ${_e.length} unique messages from hook`)}else cn.warn(`Received non-array messages from hook: ${typeof w}`);!C&&Array.isArray(w)&&w.length===0&&cn.debug("Loading complete with no messages")},[w,C]),b.useEffect(()=>{jt()},[K]),b.useEffect(()=>{e&&(t!=null&&t._id)&&(p!=null&&p._id)&&Ct()},[e,t,p]),b.useEffect(()=>{e&&t&&!c&&!d&&setTimeout(()=>{Ge.current&&Ge.current.focus()},300)},[e,t,c,d]),b.useEffect(()=>()=>{yt.current&&clearTimeout(yt.current),Ie.current&&clearTimeout(Ie.current),q([])},[]),!e)return null;const jt=()=>{Qe.current&&Qe.current.scrollIntoView({behavior:"smooth"})},Ct=async()=>{var we;try{const Le=await qe().get("/api/users/photos/permissions",{params:{requestedBy:t==null?void 0:t._id,status:"pending"}});if((we=Le.data)!=null&&we.success){const Ye=Le.data.data||[];re(Ye.length),ge(Ye)}else re(0)}catch(_e){cn.error("Error checking photo permissions:",_e),re(0)}},Rt=async we=>{var _e;if(we&&we.stopPropagation(),J!==0){Se(!0);try{const Le=qe();if(Ve.length>0){const Bt=(await Promise.allSettled(Ve.map(xt=>Le.put(`/api/users/photos/permissions/${xt._id}`,{status:"approved"})))).filter(xt=>xt.status==="fulfilled"&&xt.value.data.success).length;if(Bt>0){ne.success(`Approved ${Bt} photo request${Bt!==1?"s":""}`);const xt={_id:Kn(),sender:"system",content:`Photo access approved for ${Bt} photo${Bt!==1?"s":""}.`,createdAt:new Date().toISOString(),type:"system"};q(Ht=>[...Ht,xt]),N&&await N("I've approved your request to view my private photos.","text"),re(0),ge([])}else ne.error("Failed to approve photo requests")}else{const Ye=await Le.post("/api/users/photos/approve-all",{requesterId:t._id});if((_e=Ye.data)!=null&&_e.success){const Bt=Ye.data.approvedCount||1;ne.success(`Approved ${Bt} photo request${Bt!==1?"s":""}`);const xt={_id:Kn(),sender:"system",content:"Photo access approved.",createdAt:new Date().toISOString(),type:"system"};q(Ht=>[...Ht,xt]),N&&await N("I've approved your request to view my private photos.","text"),re(0)}else throw new Error("Approval failed")}}catch{ne.error("Error approving photo requests. Please try again.")}finally{Se(!1)}}},pe=we=>{A(we.target.value),yt.current&&clearTimeout(yt.current),we.target.value.trim()&&(t!=null&&t._id)&&D&&(yt.current=setTimeout(()=>{D()},300))},je=async we=>{var _e;if(we&&we.preventDefault(),G)return Je();if(!(!O.trim()||ze||!(t!=null&&t._id))){if(!I){ne.error("Chat system is initializing. Please wait a moment and try again.");return}if(!V){ne.error("You appear to be offline. Please check your connection and try again.");return}if((p==null?void 0:p.accountTier)==="FREE"&&O.trim()!=="😉")return ne.error("Free accounts can only send winks. Upgrade to send messages.");try{const Le=O.trim();A(""),Xe(!0),await N(Le,"text"),cn.debug(`Message sent successfully to ${t.nickname||t._id}`)}catch(Le){cn.error("Failed to send message:",Le),ne.error(Le.message||"Failed to send message")}finally{Xe(!1),(_e=Ge.current)==null||_e.focus()}}},Je=async()=>{if(!(!G||!(t!=null&&t._id)||z)){ae(!0);try{const we=new FormData;we.append("file",G),we.append("recipient",t._id),we.append("messageType","file");const _e=setInterval(()=>{Ee(Le=>{const Ye=Le+Math.floor(Math.random()*15);return Ye>95?95:Ye})},300);try{await new Promise(Ye=>setTimeout(Ye,2e3)),clearInterval(_e),Ee(100);const Le={fileName:G.name,fileSize:G.size,fileType:G.type,fileUrl:URL.createObjectURL(G)};await N("File attachment","file",Le),ne.success("File sent successfully")}catch(Le){throw clearInterval(_e),Le}Q(null),Ee(0),at.current&&(at.current.value="")}catch(we){cn.error("Failed to send file:",we),ne.error(we.message||"Failed to send file. Please try again.")}finally{ae(!1)}}},_t=async()=>{if(!(ze||!(t!=null&&t._id))){if(!I){ne.error("Chat system is initializing. Please wait a moment and try again.");return}if(!V){ne.error("You appear to be offline. Please check your connection and try again.");return}try{Xe(!0),await N("😉","wink"),cn.debug(`Wink sent successfully to ${t.nickname||t._id}`)}catch(we){cn.error("Failed to send wink:",we),ne.error(we.message||"Failed to send wink")}finally{Xe(!1)}}},ke=()=>{if((p==null?void 0:p.accountTier)==="FREE")return ne.error("Free accounts cannot send files. Upgrade to send files.");at.current&&at.current.click()},Ke=we=>{var Ye;const _e=(Ye=we.target.files)==null?void 0:Ye[0];if(!_e)return;if(_e.size>5*1024*1024){ne.error("File is too large. Maximum size is 5MB."),we.target.value=null;return}if(!["image/jpeg","image/jpg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","audio/mpeg","audio/wav","video/mp4","video/quicktime"].includes(_e.type)){ne.error("File type not supported."),we.target.value=null;return}Q(_e),ne.info(`Selected file: ${_e.name}`),we.target.value=null},ht=()=>{Q(null),Ee(0),at.current&&(at.current.value="")},B=["😊","😂","😍","❤️","👍","🙌","🔥","✨","🎉","🤔","😉","🥰"],R=we=>{A(_e=>_e+we),E(!1),Ge.current&&Ge.current.focus()},Y=async we=>{if(we&&we.stopPropagation(),!Be.isConnected()){const _e={_id:Kn(),sender:"system",content:"Cannot start call: socket is not connected. Please refresh the page and try again.",createdAt:new Date().toISOString(),type:"system",error:!0};q(Le=>[...Le,_e]),cn.error("Cannot initiate call - socket not connected");return}if(!(t!=null&&t.isOnline)){const _e={_id:Kn(),sender:"system",content:`${t.nickname} is currently offline. You can only call users who are online.`,createdAt:new Date().toISOString(),type:"system",error:!0};q(Le=>[...Le,_e]);return}if((p==null?void 0:p.accountTier)==="FREE"){const _e={_id:Kn(),sender:"system",content:"Free accounts cannot make video calls. Upgrade for video calls.",createdAt:new Date().toISOString(),type:"system",error:!0};q(Le=>[...Le,_e]);return}try{const _e={_id:Kn(),sender:"system",content:`Initiating call to ${t.nickname}...`,createdAt:new Date().toISOString(),type:"system"};q(Bt=>[...Bt,_e]),cn.debug(`Initiating video call to ${t._id}`);const Le=`call-${Date.now()}-${Math.random().toString(36).substring(2,9)}`;Ue(!0);const Ye={_id:Kn(),sender:"system",content:`You started a video call with ${t.nickname}.`,createdAt:new Date().toISOString(),type:"system"};q(Bt=>[...Bt,Ye]),Be.initiateVideoCall(t._id).then(Bt=>{cn.debug("Call initiation successful:",Bt)}).catch(Bt=>{cn.error("Background call initiation error:",Bt)})}catch(_e){cn.error("Video call initiation error:",_e);const Le={_id:Kn(),sender:"system",content:_e.message||"Could not start video call. Please try again.",createdAt:new Date().toISOString(),type:"system",error:!0};q(Ye=>[...Ye,Le])}},_=we=>{we&&we.stopPropagation(),he&&Be.emit("videoHangup",{recipientId:t._id}),Ue(!1),Re(null);const _e={_id:Kn(),sender:"system",content:`Video call with ${t.nickname} ended.`,createdAt:new Date().toISOString(),type:"system"};q(Le=>[...Le,_e])},v=we=>{we.key==="Enter"&&!we.shiftKey&&(we.preventDefault(),je())},x=we=>{if(!we)return"";try{return new Date(we).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}},T=we=>{if(!we)return"Unknown date";try{const _e=new Date(we),Le=new Date,Ye=new Date;return Ye.setDate(Ye.getDate()-1),_e.toDateString()===Le.toDateString()?"Today":_e.toDateString()===Ye.toDateString()?"Yesterday":_e.toLocaleDateString()}catch{return"Unknown date"}},U=()=>{const we={};return Array.isArray(K)&&K.forEach(_e=>{if(_e&&_e.createdAt){const Le=T(_e.createdAt);we[Le]=we[Le]||[],we[Le].push(_e)}}),we},X=we=>{if(!we)return o.jsx(d5,{});const _e=we.type||"";return _e.startsWith("image/")?o.jsx(du,{}):_e.startsWith("video/")?o.jsx($0,{}):_e.startsWith("audio/")?o.jsx(z0,{}):_e==="application/pdf"?o.jsx(P0,{}):o.jsx(B0,{})},le=we=>{var Ye,Bt,xt;const{metadata:_e}=we;if(!_e||!_e.fileUrl)return o.jsx("p",{className:$e.messageContent,children:"Attachment unavailable"});const Le=(Ye=_e.fileType)==null?void 0:Ye.startsWith("image/");return we.type==="system"?o.jsxs("div",{className:$e.systemMessageContent,children:[o.jsx("p",{children:we.content}),o.jsx("span",{className:$e.messageTime,children:x(we.createdAt)})]}):o.jsx("div",{className:$e.fileMessage,children:Le?o.jsx("img",{src:_e.fileUrl||"/placeholder.svg",alt:_e.fileName||"Image",className:$e.imageAttachment,onError:Ht=>{Ht.target.onerror=null,Ht.target.src="/placeholder.svg"}}):o.jsxs("div",{className:$e.fileAttachment,children:[(Bt=_e.fileType)!=null&&Bt.startsWith("video/")?o.jsx($0,{className:$e.fileIcon}):(xt=_e.fileType)!=null&&xt.startsWith("audio/")?o.jsx(z0,{className:$e.fileIcon}):_e.fileType==="application/pdf"?o.jsx(P0,{className:$e.fileIcon}):o.jsx(B0,{className:$e.fileIcon}),o.jsx("span",{className:$e.fileName,children:_e.fileName||"File"}),o.jsx("span",{className:$e.fileSize,children:_e.fileSize?`(${Math.round(_e.fileSize/1024)} KB)`:""}),o.jsx("a",{href:_e.fileUrl,target:"_blank",rel:"noopener noreferrer",className:$e.downloadLink,onClick:Ht=>Ht.stopPropagation(),children:"Download"})]})})};return o.jsxs("div",{className:`${$e.chatContainer} ${e?$e.opening:""}`,children:[o.jsxs("div",{className:$e.chatHeader,children:[o.jsxs("div",{className:$e.chatUser,children:[(Ze=t==null?void 0:t.photos)!=null&&Ze.length?o.jsx("img",{src:t.photos[0].url||"/placeholder.svg",alt:t.nickname,className:$e.chatAvatar,onError:we=>{we.target.onerror=null,we.target.src="/placeholder.svg"}}):o.jsx("div",{className:$e.chatAvatarPlaceholder}),o.jsxs("div",{className:$e.chatUserInfo,children:[o.jsx("h3",{children:t.nickname}),o.jsxs("div",{className:$e.statusContainer,children:[o.jsx("span",{className:t.isOnline?$e.statusOnline:$e.statusOffline,children:t.isOnline?"Online":"Offline"}),!V&&o.jsxs("span",{className:$e.connectionStatus,children:[o.jsx(D0,{className:$e.statusIcon}),o.jsx("span",{children:"Disconnected"})]})]})]})]}),o.jsxs("div",{className:$e.chatHeaderActions,children:[J>0&&o.jsx("button",{className:$e.chatHeaderBtn,onClick:Rt,title:"Approve photo requests","aria-label":"Approve photo requests",disabled:Ne,children:Ne?o.jsx(ws,{className:"fa-spin"}):o.jsx(Ss,{})}),(p==null?void 0:p.accountTier)!=="FREE"&&o.jsx(o.Fragment,{children:he?o.jsx("button",{className:$e.chatHeaderBtn,onClick:_,title:"End call","aria-label":"End call",children:o.jsx(Qc,{})}):o.jsx("button",{className:$e.chatHeaderBtn,onClick:Y,title:t.isOnline?"Start Video Call":`${t.nickname} is offline`,"aria-label":"Start video call",disabled:z||ze||!t.isOnline,children:o.jsx(xa,{})})}),o.jsx("button",{className:$e.chatHeaderBtn,onClick:i,"aria-label":"Close chat",title:"Close chat",children:o.jsx(Vn,{})})]})]}),(p==null?void 0:p.accountTier)==="FREE"&&!c&&o.jsxs("div",{className:$e.premiumBanner,children:[o.jsxs("div",{children:[o.jsx(gb,{className:$e.premiumIcon}),o.jsx("span",{children:"Upgrade to send messages and make calls"})]}),o.jsx("button",{className:$e.upgradeBtn,onClick:()=>g("/subscription"),"aria-label":"Upgrade to premium",children:"Upgrade"})]}),he&&!c&&o.jsxs("div",{className:$e.activeCallBanner,children:[o.jsxs("div",{children:[o.jsx(xa,{className:$e.callIcon}),o.jsxs("span",{children:["Call with ",t.nickname]})]}),o.jsxs("button",{className:$e.endCallBtn,onClick:_,"aria-label":"End call",children:[o.jsx(Qc,{})," End"]})]}),o.jsxs("div",{className:$e.messagesContainer,ref:mt,children:[ee&&!he&&o.jsxs("div",{className:$e.incomingCallBanner,children:[o.jsxs("div",{className:$e.incomingCallInfo,children:[o.jsx(xa,{className:`${$e.callIcon} pulse`}),o.jsxs("span",{children:[t.nickname," is calling you"]})]}),o.jsxs("div",{className:$e.incomingCallActions,children:[o.jsx("button",{className:$e.declineCallBtnSmall,onClick:()=>{Be.answerVideoCall(ee.callerId,!1,ee.callId);const we={_id:Kn(),sender:"system",content:`You declined a video call from ${t.nickname}.`,createdAt:new Date().toISOString(),type:"system"};q(_e=>[..._e,we]),Re(null)},"aria-label":"Decline call",children:o.jsx(Vn,{})}),o.jsx("button",{className:$e.acceptCallBtnSmall,onClick:()=>{Be.answerVideoCall(ee.callerId,!0,ee.callId);const we={_id:Kn(),sender:"system",content:`You accepted a video call from ${t.nickname}.`,createdAt:new Date().toISOString(),type:"system"};q(_e=>[..._e,we]),Ue(!0)},"aria-label":"Accept call",children:o.jsx(xa,{})})]})]}),C?o.jsxs("div",{className:$e.loadingMessages,children:[o.jsx("div",{className:$e.spinner}),o.jsx("p",{children:L?"This is taking longer than expected. Please wait...":"Loading messages..."}),L&&o.jsx("button",{className:$e.refreshButton,onClick:()=>F(),"aria-label":"Retry loading messages",children:"Retry"})]}):j?o.jsxs("div",{className:$e.messageError,children:[o.jsx(D0,{}),o.jsx("p",{children:j}),o.jsxs("div",{className:$e.errorActions,children:[o.jsx("button",{onClick:()=>F(),className:$e.retryButton,"aria-label":"Retry loading messages",children:"Retry Loading"}),!I&&o.jsx("button",{onClick:()=>{if(p&&y){console.log("Forcing chat service re-initialization...");const we={...p,_id:p._id||p.id,id:p.id||p._id};Pn(()=>Promise.resolve().then(()=>Pj),void 0).then(_e=>{_e.default.initialize(we).then(()=>{console.log("Chat service manually initialized"),F()}).catch(Ye=>{console.error("Manual initialization failed:",Ye),ne.error("Chat initialization failed. Please refresh the page.")})})}else ne.error("Cannot initialize chat: not authenticated. Please log in again.")},className:$e.initButton,"aria-label":"Force initialization",children:"Force Init"})]})]}):I?!K||K.length===0?o.jsx("div",{className:$e.noMessages,children:o.jsx("p",{children:"No messages yet. Say hello!"})}):Object.entries(U()).map(([we,_e])=>o.jsxs(ba.Fragment,{children:[o.jsx("div",{className:$e.messageDate,children:we}),_e.map(Le=>o.jsxs("div",{className:`${$e.message} ${Le.sender===(p==null?void 0:p._id)?$e.sent:$e.received} ${Le.type==="system"?$e.systemMessage:""} ${Le.error?$e.error:""} ${Le.pending?$e.pending:""}`,children:[Le.type==="text"&&o.jsxs(o.Fragment,{children:[o.jsx("p",{className:$e.messageContent,children:Le.content}),o.jsxs("span",{className:$e.messageTime,children:[x(Le.createdAt),Le.sender===(p==null?void 0:p._id)&&(Le.pending?o.jsx("span",{className:$e.pendingIndicator,children:"●"}):Le.error?o.jsx("span",{className:$e.errorIndicator,children:"!"}):Le.read?o.jsx(a5,{className:$e.readIndicator}):o.jsx(Lt,{className:$e.readIndicator}))]})]}),Le.type==="wink"&&o.jsxs("div",{className:$e.winkMessage,children:[o.jsx("p",{className:$e.messageContent,children:"😉"}),o.jsx("span",{className:$e.messageLabel,children:"Wink"})]}),Le.type==="video"&&o.jsxs("div",{className:$e.videoCallMessage,children:[o.jsx(xa,{className:$e.videoIcon}),o.jsx("p",{className:$e.messageContent,children:"Video Call"}),o.jsx("span",{className:$e.messageTime,children:x(Le.createdAt)})]}),Le.type==="file"&&le(Le),Le.type==="system"&&o.jsxs("div",{className:`${$e.systemMessageContent} ${Le.error?$e.errorContent:""}`,children:[o.jsx("p",{children:Le.content}),o.jsx("span",{className:$e.messageTime,children:x(Le.createdAt)})]})]},Le._id||Le.tempId))]},we)):o.jsxs("div",{className:$e.loadingMessages,children:[o.jsx("div",{className:$e.spinner}),o.jsx("p",{children:"Initializing chat..."})]}),M&&o.jsxs("div",{className:$e.typingIndicator,children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsx("div",{ref:Qe})]}),G&&o.jsxs("div",{className:$e.attachmentPreview,children:[o.jsxs("div",{className:$e.attachmentInfo,children:[X(G),o.jsx("span",{className:$e.attachmentName,children:G.name}),o.jsxs("span",{className:$e.attachmentSize,children:["(",Math.round(G.size/1024)," KB)"]})]}),z?o.jsxs("div",{className:$e.uploadProgressContainer,children:[o.jsx("div",{className:$e.uploadProgressBar,style:{width:`${Pe}%`}}),o.jsxs("span",{className:$e.uploadProgressText,children:[Pe,"%"]})]}):o.jsx("button",{className:$e.removeAttachment,onClick:ht,disabled:z,children:o.jsx(Vn,{})})]}),o.jsxs("form",{className:$e.messageInput,onSubmit:je,children:[o.jsx("button",{type:"button",className:$e.inputEmoji,onClick:()=>E(!H),title:"Add Emoji","aria-label":"Add emoji",disabled:z||ze,children:o.jsx(N5,{})}),H&&o.jsxs("div",{className:$e.emojiPicker,children:[o.jsxs("div",{className:$e.emojiHeader,children:[o.jsx("h4",{children:"Emojis"}),o.jsx("button",{onClick:()=>E(!1),"aria-label":"Close emoji picker",children:o.jsx(Vn,{})})]}),o.jsx("div",{className:$e.emojiList,children:B.map(we=>o.jsx("button",{type:"button",onClick:()=>R(we),"aria-label":`Emoji ${we}`,children:we},we))})]}),o.jsx("input",{type:"text",placeholder:(p==null?void 0:p.accountTier)==="FREE"?"Free users can only send winks":"Type a message...",value:O,onChange:pe,onKeyPress:v,ref:Ge,disabled:ze||z||(p==null?void 0:p.accountTier)==="FREE","aria-label":"Message input",title:(p==null?void 0:p.accountTier)==="FREE"?"Upgrade to send text messages":"Type a message"}),o.jsx("button",{type:"button",className:$e.inputAttachment,onClick:ke,disabled:ze||z||(p==null?void 0:p.accountTier)==="FREE",title:(p==null?void 0:p.accountTier)==="FREE"?"Upgrade to send files":"Attach File","aria-label":"Attach file",children:o.jsx(v5,{})}),o.jsx("input",{type:"file",ref:at,style:{display:"none"},onChange:Ke,"aria-hidden":"true",accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,audio/mpeg,audio/wav,video/mp4,video/quicktime"}),o.jsx("button",{type:"button",className:$e.inputWink,onClick:_t,disabled:ze||z,title:"Send Wink","aria-label":"Send wink",children:o.jsx(vi,{})}),o.jsx("button",{type:"submit",className:$e.inputSend,disabled:!O.trim()&&!G||ze||z,title:"Send Message","aria-label":"Send message",children:ze||z?o.jsx(ws,{className:"fa-spin"}):o.jsx(y5,{})})]}),he&&o.jsx("div",{className:`${$e.videoCallOverlay} ${he?$e.active:""}`,children:o.jsx(Gj,{isActive:he,userId:p==null?void 0:p._id,recipientId:t==null?void 0:t._id,onEndCall:_,isIncoming:ee!==null,callId:ee==null?void 0:ee.callId})})]})},Yj=Object.freeze(Object.defineProperty({__proto__:null,default:ul},Symbol.toStringTag,{value:"Module"}));var $f={exports:{}},Uf,ey;function Xj(){if(ey)return Uf;ey=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Uf=t,Uf}var If,ty;function Kj(){if(ty)return If;ty=1;var t=Xj();function e(){}function i(){}return i.resetWarningCache=e,If=function(){function a(d,h,p,y,g,w){if(w!==t){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}a.isRequired=a;function c(){return a}var u={array:a,bigint:a,bool:a,func:a,number:a,object:a,string:a,symbol:a,any:a,arrayOf:c,element:a,elementType:a,instanceOf:c,node:a,objectOf:c,oneOf:c,oneOfType:c,shape:c,exact:c,checkPropTypes:i,resetWarningCache:e};return u.PropTypes=u,u},If}var ny;function Qj(){return ny||(ny=1,$f.exports=Kj()()),$f.exports}var Wj=Qj();const Ce=Rv(Wj),kc=An.create("Avatar"),Hb=({src:t,alt:e,size:i="medium",status:a=null,className:c="",onClick:u,online:d=!1,placeholder:h="/default-avatar1.png",statusPosition:p="bottom-right",showFallback:y=!0})=>{const[g,w]=ba.useState(t),[C,j]=ba.useState(!1),[N,M]=ba.useState(""),D=ba.useRef(new Map),I=`${window.location.origin}/default-avatar1.png`;ba.useEffect(()=>{if(t!==g||!t&&!C){if(t&&D.current.has(t)){const H=D.current.get(t);if(H.error){w(H.fallback),j(!0);return}}if(t&&typeof t=="string"&&t.includes("unsplash.com")){w(I),j(!0);return}w(t||I),j(!1),t&&typeof t=="string"&&/^[0-9a-f]{24}$/i.test(t)&&kc.debug(`Avatar for user ID: ${t}`)}},[t,I,g,C]);const V=H=>{const E=H.target.src;if(M(`Failed to load image: ${E}`),E.includes("unsplash.com")||kc.error(`Image failed to load: ${E}`,{originalSrc:t}),!C&&y){const L=I;t&&(D.current.set(t,{error:!0,fallback:L}),E&&ob(E)),w(L),j(!0)}};let F;try{g&&typeof g=="string"&&/^[0-9a-f]{24}$/i.test(g)?(F=`${window.location.origin}/api/avatars/${g}`,kc.debug(`Using direct avatar API path: ${F}`)):F=rb(g)}catch(H){kc.error(`Error normalizing URL: ${H.message}`,{src:g}),F=I}const O={tiny:"avatar-xs",small:"avatar-sm",medium:"avatar-md",large:"avatar-lg",xlarge:"avatar-xl"},A={backgroundImage:`url(${F})`,backgroundSize:"cover",backgroundPosition:"center"};return o.jsxs("div",{className:`avatar ${O[i]||""} ${d?"avatar-online":""} ${c}`,onClick:u,style:A,role:u?"button":void 0,tabIndex:u?0:void 0,"data-debug":N,children:[o.jsx("img",{src:F,alt:e,onError:V,style:{display:"none"},crossOrigin:"anonymous"}),a&&o.jsx("span",{className:`avatar-status status-${a} status-${p}`})]})};Hb.propTypes={src:Ce.string,alt:Ce.string,size:Ce.oneOf(["tiny","small","medium","large","xlarge"]),status:Ce.oneOf([null,"online","offline","busy","away"]),className:Ce.string,onClick:Ce.func,online:Ce.bool,placeholder:Ce.string,statusPosition:Ce.oneOf(["top-right","top-left","bottom-right","bottom-left"]),showFallback:Ce.bool};const Rs=({children:t,onClick:e,type:i="button",variant:a="primary",size:c="medium",className:u="",disabled:d=!1,fullWidth:h=!1,icon:p,iconPosition:y="left",isLoading:g=!1,loadingText:w="Loading...",...C})=>{const j=`btn btn-${a} btn-${c} ${h?"btn-full-width":""}`,N=p?`btn-with-icon icon-${y}`:"",M=g?"btn-loading":"";return o.jsx("button",{type:i,className:`${j} ${N} ${M} ${u}`,onClick:e,disabled:d||g,...C,children:g?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"loading-spinner"}),w]}):o.jsxs(o.Fragment,{children:[p&&y==="left"&&o.jsx("span",{className:"btn-icon",children:p}),o.jsx("span",{className:"btn-text",children:t}),p&&y==="right"&&o.jsx("span",{className:"btn-icon",children:p})]})})};Rs.propTypes={children:Ce.node.isRequired,onClick:Ce.func,type:Ce.oneOf(["button","submit","reset"]),variant:Ce.oneOf(["primary","secondary","success","danger","warning","info","light","dark","link"]),size:Ce.oneOf(["small","medium","large"]),className:Ce.string,disabled:Ce.bool,fullWidth:Ce.bool,icon:Ce.node,iconPosition:Ce.oneOf(["left","right"]),isLoading:Ce.bool,loadingText:Ce.string};const Gb=({children:t,title:e,subtitle:i,className:a="",headerClassName:c="",bodyClassName:u="",footerClassName:d="",footer:h,noPadding:p=!1,onClick:y,hover:g=!1})=>o.jsxs("div",{className:`card ${g?"hover-effect":""} ${a}`,onClick:y,role:y?"button":void 0,tabIndex:y?0:void 0,children:[(e||i)&&o.jsxs("div",{className:`card-header ${c}`,children:[e&&o.jsx("h3",{className:"card-title",children:e}),i&&o.jsx("p",{className:"card-subtitle",children:i})]}),o.jsx("div",{className:`card-body ${p?"no-padding":""} ${u}`,children:t}),h&&o.jsx("div",{className:`card-footer ${d}`,children:h})]});Gb.propTypes={children:Ce.node.isRequired,title:Ce.node,subtitle:Ce.node,className:Ce.string,headerClassName:Ce.string,bodyClassName:Ce.string,footerClassName:Ce.string,footer:Ce.node,noPadding:Ce.bool,onClick:Ce.func,hover:Ce.bool};Ce.oneOfType([Ce.string,Ce.object]).isRequired,Ce.string,Ce.oneOf(["error","warning","info"]),Ce.func,Ce.bool,Ce.string,Ce.object;Ce.string,Ce.node,Ce.node,Ce.node.isRequired,Ce.bool,Ce.node,Ce.string,Ce.string,Ce.string,Ce.bool,Ce.oneOf(["top","left","right"]);const mu=({size:t="medium",color:e="primary",centered:i=!1,fullPage:a=!1,text:c="",className:u="",overlay:d=!1})=>{const h=t==="small"?"spinner-sm":t==="large"?"spinner-lg":"",p=`spinner-${e}`,y=`spinner-container 
    ${i?"centered":""} 
    ${a?"full-page":""} 
    ${d?"with-overlay":""} 
    ${u}`;return o.jsxs("div",{className:y,children:[d&&o.jsx("div",{className:"spinner-overlay"}),o.jsxs("div",{className:`spinner ${h} ${p}`,children:[o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"}),o.jsx("div",{className:"spinner-blade"})]}),c&&o.jsx("p",{className:"spinner-text",children:c})]})};mu.propTypes={size:Ce.oneOf(["small","medium","large"]),color:Ce.oneOf(["primary","secondary","light","dark"]),centered:Ce.bool,fullPage:Ce.bool,text:Ce.string,className:Ce.string,overlay:Ce.bool};Ce.bool,Ce.oneOfType([Ce.string,Ce.object]),Ce.node,Ce.string,Ce.string,Ce.oneOf(["small","medium","large"]),Ce.object,Ce.func,Ce.bool,Ce.bool,Ce.string,Ce.func;const tm=(t={})=>{const[e,i]=b.useState(!1),[a,c]=b.useState(null),[u,d]=b.useState(null),h=b.useRef({}),p=b.useCallback(()=>{Object.values(h.current).forEach(V=>{typeof V=="function"&&V()}),h.current={}},[]),y=b.useCallback(async(V,F={})=>{const{onSuccess:O,onError:A,key:H="default"}=F;i(!0),c(null);try{const E=await V();if(!E)return t.logErrors!==!1&&console.warn("API response is null or undefined"),delete h.current[H],null;if(!E.success)throw new Error(E.error||"API request failed");return E.data!==void 0&&d(E.data),delete h.current[H],O&&O(E.data),E.data}catch(E){const L=E.error||E.message||"An error occurred";return c(L),delete h.current[H],A&&A(L),t.logErrors!==!1&&console.error(`API error: ${L}`),null}finally{i(!1)}},[t.logErrors]),g=(V={})=>{const F={...V};if(!F.Authorization&&!F["x-auth-token"]){const O=localStorage.getItem("token")||sessionStorage.getItem("token")||localStorage.getItem("authToken")||sessionStorage.getItem("authToken");O&&(F.Authorization=`Bearer ${O}`,F["x-auth-token"]=O)}return F},w=b.useCallback((V,F,O={})=>{const A=O.key||V;h.current[A]&&t.cancelDuplicates&&h.current[A]();const{request:H,cancel:E}=st.createCancelableRequest();return h.current[A]=E,y(()=>{const L=g();return st.get(V,F,{request:H,headers:L})},{...O,key:A})},[y,t.cancelDuplicates]),C=b.useCallback((V,F,O={})=>{const A=O.key||V;h.current[A]&&t.cancelDuplicates&&h.current[A]();const{request:H,cancel:E}=st.createCancelableRequest();return h.current[A]=E,y(()=>{const L=g();return st.post(V,F,{request:H,headers:L})},{...O,key:A})},[y,t.cancelDuplicates]),j=b.useCallback((V,F,O={})=>{const A=O.key||V;h.current[A]&&t.cancelDuplicates&&h.current[A]();const{request:H,cancel:E}=st.createCancelableRequest();return h.current[A]=E,y(()=>{const L=g();return st.put(V,F,{request:H,headers:L})},{...O,key:A})},[y,t.cancelDuplicates]),N=b.useCallback((V,F,O={})=>{const A=O.key||V;h.current[A]&&t.cancelDuplicates&&h.current[A]();const{request:H,cancel:E}=st.createCancelableRequest();return h.current[A]=E,y(()=>{const L=g();return st.delete(V,F,{request:H,headers:L})},{...O,key:A})},[y,t.cancelDuplicates]),M=b.useCallback((V,F,O,A={})=>{const H=A.key||V;h.current[H]&&t.cancelDuplicates&&h.current[H]();const{request:E,cancel:L}=st.createCancelableRequest();return h.current[H]=L,y(()=>st.upload(V,F,O,{request:E}),{...A,key:H})},[y,t.cancelDuplicates]),D=b.useCallback(()=>{c(null)},[]),I=b.useCallback(()=>{i(!1),c(null),d(null)},[]);return{loading:e,error:a,data:u,get:w,post:C,put:j,delete:N,upload:M,clearError:D,reset:I,cancelAllRequests:p}},Yb=()=>{const t=b.useRef(!1);return b.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),{isMounted:()=>t.current}},Zj=t=>{const e=b.useRef(null);return b.useEffect(()=>{const i=a=>{e.current&&!e.current.contains(a.target)&&t()};return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[t]),e},Uo=({isOpen:t,onClose:e,title:i,children:a,footer:c,size:u="medium",closeOnClickOutside:d=!0,closeOnEsc:h=!0,showCloseButton:p=!0,className:y="",contentClassName:g="",headerClassName:w="",bodyClassName:C="",footerClassName:j="",modalRoot:N=document.body})=>{const M=b.useRef(null),D=b.useRef(null),I=Zj(()=>{d&&t&&e()});b.useEffect(()=>{if(!t)return;D.current=document.activeElement;const O=A=>{var H;if(h&&A.key==="Escape"&&e(),A.key==="Tab"){const E=((H=M.current)==null?void 0:H.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'))||[];if(E.length===0)return;const L=E[0],P=E[E.length-1];A.shiftKey?document.activeElement===L&&(P.focus(),A.preventDefault()):document.activeElement===P&&(L.focus(),A.preventDefault())}};return document.addEventListener("keydown",O),document.body.style.overflow="hidden",setTimeout(()=>{var H;const A=(H=M.current)==null?void 0:H.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');A!=null&&A[0]&&A[0].focus()},0),()=>{document.removeEventListener("keydown",O),document.body.style.overflow="",D.current&&D.current.focus()}},[t,h,e,d]);const V={small:"modal-sm",medium:"modal-md",large:"modal-lg",xlarge:"modal-xl",fullscreen:"modal-fullscreen"};if(!t)return null;const F=o.jsx("div",{className:`modal-overlay ${t?"open":""}`,onClick:d?e:void 0,children:o.jsxs("div",{className:`modal ${V[u]||""} ${y}`,ref:O=>{M.current=O,I&&(I.current=O)},onClick:O=>O.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":i?"modal-title":void 0,children:[o.jsxs("div",{className:`modal-header ${w}`,children:[i&&o.jsx("h2",{className:"modal-title",id:"modal-title",children:i}),p&&o.jsx("button",{className:"modal-close",onClick:e,"aria-label":"Close modal",children:o.jsx(Vn,{})})]}),o.jsx("div",{className:`modal-body ${C}`,children:a}),c&&o.jsx("div",{className:`modal-footer ${j}`,children:c})]})});return Bw.createPortal(F,N)};Uo.propTypes={isOpen:Ce.bool.isRequired,onClose:Ce.func.isRequired,title:Ce.node,children:Ce.node.isRequired,footer:Ce.node,size:Ce.oneOf(["small","medium","large","xlarge","fullscreen"]),closeOnClickOutside:Ce.bool,closeOnEsc:Ce.bool,showCloseButton:Ce.bool,className:Ce.string,contentClassName:Ce.string,headerClassName:Ce.string,bodyClassName:Ce.string,footerClassName:Ce.string,modalRoot:Ce.object};const Jj=(t,e,i={})=>{const{debug:a=!1}=i,c=a?(h,p)=>{const y=e?e(h,p):!0;if(!y){const g=Object.keys(p).filter(C=>h[C]!==p[C]),w=t.displayName||t.name||"Component";An.debug(`[withMemo] ${w} re-rendering due to props changes:`,g)}return y}:e,u=b.memo(t,c),d=t.displayName||t.name||"Component";return u.displayName=`withMemo(${d})`,u},fr=An.create("NotificationsComponent");let Es;try{Es=new BroadcastChannel("notifications_sync")}catch{fr.warn("BroadcastChannel not supported in this browser")}const eC=({showHeader:t=!0,showFilters:e=!0,isDropdown:i=!1,isMobile:a=!1,onClose:c,maxHeight:u=400,className:d="",style:h={},customFilters:p=null})=>{const{notifications:y,unreadCount:g,isLoading:w,socketConnected:C,markAllAsRead:j,addTestNotification:N,handleNotificationClick:M,refreshNotifications:D}=qb(),[I,V]=b.useState("all"),[F,O]=b.useState([]),[A,H]=b.useState(!1),[E,L]=b.useState(document.visibilityState),P=tm(),{isMounted:G}=Yb(),Q=b.useRef(null),z=b.useRef(Date.now()),ae=b.useRef(null);b.useEffect(()=>{const ge=()=>{const ee=document.visibilityState;L(ee),ee==="visible"&&Date.now()-z.current>3e4&&(D(),z.current=Date.now())};return document.addEventListener("visibilitychange",ge),()=>{document.removeEventListener("visibilitychange",ge)}},[D]),b.useEffect(()=>{const ge=ee=>{const{type:Re,data:he}=ee.data||{};(Re==="NOTIFICATION_READ"||Re==="NOTIFICATION_RECEIVED")&&D()};return Es&&Es.addEventListener("message",ge),()=>{Es&&Es.removeEventListener("message",ge)}},[D]),b.useEffect(()=>{const ge=ee=>{fr.debug("⚡ DIRECT NOTIFICATION RECEIVED IN COMPONENT:",ee),D(),z.current=Date.now(),Es&&Es.postMessage({type:"NOTIFICATION_RECEIVED",data:ee})};return Be.socket&&(fr.debug("📱 Setting up direct socket handlers in NotificationsComponent"),Be.socket.on("notification",ge),Be.socket.on("newMessage",ge),Be.socket.on("newLike",ge),Be.socket.on("photoPermissionRequestReceived",ge),Be.socket.on("photoPermissionResponseReceived",ge),Be.socket.on("newComment",ge),Be.socket.on("incomingCall",ge),fr.debug("Socket connected:",Be.isConnected()),fr.debug("Socket ID:",Be.socket.id)),()=>{Be.socket&&(Be.socket.off("notification",ge),Be.socket.off("newMessage",ge),Be.socket.off("newLike",ge),Be.socket.off("photoPermissionRequestReceived",ge),Be.socket.off("photoPermissionResponseReceived",ge),Be.socket.off("newComment",ge),Be.socket.off("incomingCall",ge)),ae.current&&clearTimeout(ae.current)}},[D]),b.useEffect(()=>{let ge=C;if(C&&!ge&&(D(),z.current=Date.now()),!C&&ge){const Re=()=>{D(),z.current=Date.now(),ae.current=setTimeout(Re,6e4)};ae.current=setTimeout(Re,5e3)}return ge=C,()=>{ae.current&&clearTimeout(ae.current)}},[C,D]);const Pe=b.useRef((y==null?void 0:y.length)||0);b.useEffect(()=>{(y==null?void 0:y.length)>Pe.current&&Q.current&&(Q.current.scrollTop=0),Pe.current=(y==null?void 0:y.length)||0},[y]);const Ee=async ge=>{if(ge&&(ge.preventDefault(),ge.stopPropagation()),!A){H(!0);try{await D(),z.current=Date.now(),ne.success("Notifications refreshed")}catch{ne.error("Failed to refresh notifications")}finally{setTimeout(()=>{G()&&H(!1)},500)}}};b.useEffect(()=>{if(!y){O([]);return}let ge=[...y];I!=="all"&&(I==="unread"?ge=ge.filter(he=>!he.read):ge=ge.filter(he=>he.type===I));const ee=[],Re={};ge.forEach(he=>{var Xe,Qe,Ge,at,yt;const ze=`${((Xe=he.sender)==null?void 0:Xe._id)||((Ge=(Qe=he.data)==null?void 0:Qe.sender)==null?void 0:Ge._id)||((yt=(at=he.data)==null?void 0:at.requester)==null?void 0:yt._id)||"unknown"}_${he.type}`;Re[ze]?(Re[ze].count+=1,Re[ze].originalItems.push(he),new Date(he.createdAt)>new Date(Re[ze].createdAt)&&(Re[ze].createdAt=he.createdAt)):Re[ze]={...he,count:1,originalItems:[he]}}),Object.values(Re).forEach(he=>{ee.push(he)}),ee.sort((he,Ue)=>new Date(Ue.createdAt)-new Date(he.createdAt)),O(ee)},[y,I]);const K=ge=>{V(ge)},q=async()=>{try{const ge=await P.delete("/notifications/clear-all");ne.success(`Cleared ${(ge==null?void 0:ge.count)||0} notifications`),D(),z.current=Date.now()}catch(ge){fr.error("Error clearing notifications:",ge),ne.error("Error clearing notifications")}},J=ge=>{ge&&(ge.preventDefault(),ge.stopPropagation()),j(),Es&&Es.postMessage({type:"NOTIFICATION_READ",data:{all:!0}}),ne.success("All notifications marked as read")},re=ge=>{M(ge),!ge.read&&Es&&Es.postMessage({type:"NOTIFICATION_READ",data:{id:ge._id}}),i&&c&&c()},Ne=ge=>{ge&&(ge.preventDefault(),ge.stopPropagation()),N()},Se=()=>{const ge=[{id:"all",label:"All"},{id:"unread",label:"Unread"},{id:"message",label:"Messages"},{id:"like",label:"Likes"},{id:"photoRequest",label:"Photos"},{id:"story",label:"Stories"}];return p&&Array.isArray(p)&&p.length>0?ge.filter(ee=>p.includes(ee.id)):ge},Ve=()=>{const ge=Se();return o.jsx("div",{className:"notification-filters",children:ge.map(ee=>o.jsx(Rs,{className:`filter-btn ${I===ee.id?"active":""}`,onClick:()=>K(ee.id),variant:I===ee.id?"primary":"light",size:"small",children:ee.label},ee.id))})};return w?o.jsx("div",{className:`notification-loading ${d}`,style:h,children:o.jsx(mu,{size:"medium",text:"Loading notifications...",centered:!0})}):!F||F.length===0?o.jsxs("div",{className:`notification-empty ${d}`,style:h,children:[o.jsx(Nr,{size:32}),o.jsxs("p",{children:["No ",I!=="all"?`${I} `:"","notifications yet"]}),o.jsxs("div",{className:"notification-empty-actions",children:[o.jsx(Rs,{onClick:Ee,disabled:A,isLoading:A,variant:"secondary",size:"small",icon:o.jsx(F0,{}),children:A?"Refreshing...":"Refresh"}),i&&o.jsx(Rs,{onClick:Ne,variant:"primary",size:"small",className:"mt-3 ml-2",children:"Add Test Notification"})]}),!C&&o.jsxs("div",{className:"notification-connection-status",children:[o.jsx("span",{className:"dot disconnected"}),o.jsx("small",{children:"Real-time updates disconnected"})]})]}):o.jsxs("div",{className:`notification-container ${d}`,style:h,children:[t&&o.jsxs("div",{className:"notification-header",children:[o.jsxs("div",{className:"notification-header-title",children:[o.jsx("span",{children:"Notifications"}),I!=="all"&&o.jsxs("span",{className:"notification-filter-indicator",children:["(",I,")"]}),o.jsx("div",{className:"notification-connection-indicator",children:o.jsx("span",{className:`connection-dot ${C?"connected":"disconnected"}`})})]}),o.jsxs("div",{className:"notification-header-actions",children:[o.jsx(Rs,{className:"notification-header-action",onClick:Ee,title:"Refresh notifications",variant:"link",size:"small",icon:o.jsx(F0,{className:A?"spin":""})}),g>0&&o.jsx(Rs,{className:"notification-header-action",onClick:J,variant:"link",size:"small",children:"Mark all read"}),!i&&o.jsxs(o.Fragment,{children:[o.jsx(Rs,{className:"notification-header-action",onClick:()=>K(I==="all"?"unread":"all"),variant:"link",size:"small",icon:o.jsx(Xh,{}),children:I==="all"?"Show unread":"Show all"}),o.jsx(Rs,{className:"notification-header-action",onClick:q,variant:"link",size:"small",icon:o.jsx(_r,{}),children:"Clear all"})]}),i&&c&&o.jsx(Rs,{className:"notification-close-btn",onClick:c,variant:"light",size:"small",icon:o.jsx(Vn,{}),"aria-label":"Close notifications"})]})]}),e&&!a&&Ve(),o.jsx("div",{ref:Q,className:"notification-list",style:{maxHeight:`${u}px`},children:F.map(ge=>o.jsx(tC,{notification:ge,onClick:re},ge._id||ge.id||`notification-${Math.random()}`))}),e&&a&&o.jsx("div",{className:"notification-footer",children:Ve()})]})},tC=({notification:t,onClick:e})=>{if(!t)return null;const i=nC(t.type),a=Kc(t.createdAt,{showRelative:!0,showTime:!1,showDate:!1}),c=t.count>1?t.count:null,u=sC(t),d=p=>{p.preventDefault(),p.stopPropagation(),e&&e(t)},h=iC(t);return o.jsxs("div",{className:`notification-item ${t.read?"":"unread"}`,onClick:d,children:[o.jsx("div",{className:"notification-icon",children:o.jsx(i,{})}),o.jsxs("div",{className:"notification-content",children:[o.jsxs("div",{className:"notification-title",children:[o.jsx("span",{className:"notification-sender",children:u})," ",h,c&&o.jsxs("span",{className:"notification-count",children:[" (",c,")"]})]}),o.jsx("div",{className:"notification-message",children:t.message||t.content||t.title}),o.jsxs("div",{className:"notification-time",children:[a,!t.read&&o.jsx("span",{className:"notification-status",children:"• New"})]})]})]})};function nC(t){switch(t){case"message":return Yh;case"like":case"match":return vi;case"photoRequest":case"photoResponse":return Wo;case"story":return du;case"comment":return Ta;case"call":return x5;default:return Nr}}function sC(t){var e,i,a,c,u,d,h,p,y;return((e=t.sender)==null?void 0:e.nickname)||((a=(i=t.data)==null?void 0:i.sender)==null?void 0:a.nickname)||((u=(c=t.data)==null?void 0:c.requester)==null?void 0:u.nickname)||((h=(d=t.data)==null?void 0:d.owner)==null?void 0:h.nickname)||((y=(p=t.data)==null?void 0:p.user)==null?void 0:y.nickname)||"Someone"}function iC(t){var e;switch(t.type){case"message":return t.count>1?`sent you ${t.count} messages`:"sent you a message";case"like":return"liked your profile";case"match":return"matched with you";case"photoRequest":return"requested access to your photo";case"photoResponse":return(((e=t.data)==null?void 0:e.status)||"")==="approved"?"approved your photo request":"declined your photo request";case"story":return t.count>1?`shared ${t.count} new stories`:"shared a new story";case"comment":return t.count>1?`left ${t.count} comments on your post`:"commented on your post";case"call":return"called you";default:return"sent a notification"}}function gu(){const{theme:t,toggleTheme:e}=Tb(),[i,a]=b.useState(!1);return b.useEffect(()=>{a(!0)},[]),i?o.jsx("button",{onClick:e,className:"theme-toggle-btn","aria-label":t==="dark"?"Switch to light mode":"Switch to dark mode",children:t==="dark"?o.jsx(E5,{}):o.jsx(p5,{})}):null}const kr=()=>{var O;const[t,e]=b.useState(!1),[i,a]=b.useState(!1),[c,u]=b.useState(!1),d=b.useRef(null),h=b.useRef(null),p=b.useRef(null),{unreadCount:y,addTestNotification:g}=qb(),{isAuthenticated:w,logout:C,user:j}=Sn(),N=In(),M=async A=>{A.preventDefault(),await C()},D=()=>{N("/profile")},I=A=>{A&&(A.preventDefault(),A.stopPropagation()),console.log("Toggle notification dropdown"),e(H=>!H),a(!1)},V=A=>{A.preventDefault(),A.stopPropagation(),a(!i),e(!1)};b.useEffect(()=>{const A=H=>{const E=H.target.closest(".notification-button");d.current&&!d.current.contains(H.target)&&!E&&e(!1),h.current&&!h.current.contains(H.target)&&!H.target.closest(".user-menu")&&a(!1)};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[]);const F=()=>{e(!1)};return o.jsx("header",{className:"app-header",children:o.jsxs("div",{className:"header-inner",children:[o.jsx("div",{className:"header-logo",onClick:()=>N("/"),children:o.jsx("span",{children:"Mandarin"})}),w&&o.jsx("nav",{className:"header-nav",children:o.jsxs("ul",{className:"nav-tabs",children:[o.jsx("li",{children:o.jsxs("button",{className:`nav-tab ${window.location.pathname==="/dashboard"?"active":""}`,onClick:()=>N("/dashboard"),children:[o.jsx(Kh,{}),o.jsx("span",{className:"nav-text",children:"Discover"})]})}),o.jsx("li",{children:o.jsxs("button",{className:`nav-tab ${window.location.pathname==="/messages"?"active":""}`,onClick:()=>N("/messages"),children:[o.jsx(c5,{}),o.jsx("span",{className:"nav-text",children:"Messages"})]})})]})}),o.jsxs("div",{className:"header-actions",children:[o.jsx(gu,{}),w?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"notification-wrapper",children:[o.jsxs("button",{ref:p,"aria-label":"Notifications",className:`notification-button ${c?"notification-pulse":""}`,onClick:A=>{A.stopPropagation(),A.preventDefault(),console.log("Notification button clicked"),I(A)},style:{position:"relative",zIndex:102,cursor:"pointer"},children:[o.jsx(Nr,{}),y>0&&o.jsx("span",{className:"notification-badge",children:y>9?"9+":y})]}),t&&o.jsx("div",{ref:d,className:"notification-dropdown",children:o.jsx(eC,{isDropdown:!0,maxHeight:400,onClose:F,className:"notification-dropdown-content",customFilters:["all","unread"]})})]}),o.jsx("div",{className:"user-menu",children:o.jsxs("div",{className:"user-avatar-container",children:[((O=j==null?void 0:j.photos)==null?void 0:O.length)>0?o.jsx("img",{src:j.photos[0].url||"/placeholder.svg?height=32&width=32",alt:j.nickname,className:"user-avatar",onClick:V}):o.jsx(Zo,{className:"user-avatar-icon",onClick:V}),i&&o.jsxs("div",{ref:h,className:"user-dropdown",children:[o.jsxs("div",{className:"user-dropdown-item",onClick:D,children:[o.jsx(Zo,{}),"Profile"]}),o.jsxs("div",{className:"user-dropdown-item",onClick:()=>N("/settings"),children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"12",r:"3"}),o.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]}),"Settings"]}),o.jsxs("div",{className:"user-dropdown-item",onClick:()=>N("/subscription"),children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("circle",{cx:"12",cy:"8",r:"7"}),o.jsx("polyline",{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"})]}),"Subscription"]}),o.jsx("div",{className:"user-dropdown-divider"}),o.jsxs("div",{className:"user-dropdown-item danger",onClick:M,children:[o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),o.jsx("polyline",{points:"16 17 21 12 16 7"}),o.jsx("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]}),"Logout"]})]})]})})]}):o.jsxs("div",{className:"auth-buttons",children:[o.jsx(_n,{to:"/login",className:"btn btn-outline me-2",children:"Login"}),o.jsx(_n,{to:"/register",className:"btn btn-primary",children:"Register"})]})]})]})})},aC="_storiesCarouselContainer_16v5u_55",rC="_storiesCarousel_16v5u_55",oC="_carouselNavButton_16v5u_82",lC="_carouselNavButtonLeft_16v5u_113",cC="_carouselNavButtonRight_16v5u_117",uC="_storyThumbnail_16v5u_122",dC="_avatarBorder_16v5u_136",fC="_avatarBorderViewed_16v5u_148",hC="_imageContainer_16v5u_156",mC="_thumbnailImage_16v5u_169",gC="_thumbnailPlaceholder_16v5u_176",pC="_username_16v5u_188",yC="_comingSoonBadge_16v5u_205",vC="_mediaTypeIcon_16v5u_233",En={storiesCarouselContainer:aC,storiesCarousel:rC,carouselNavButton:oC,carouselNavButtonLeft:lC,carouselNavButtonRight:cC,storyThumbnail:uC,avatarBorder:dC,avatarBorderViewed:fC,imageContainer:hC,thumbnailImage:mC,thumbnailPlaceholder:gC,username:pC,comingSoonBadge:yC,mediaTypeIcon:vC},nm=({story:t,onClick:e,hasUnviewedStories:i,user:a,mediaType:c})=>{const{user:u}=ka(),[d,h]=b.useState(!1),p=b.useRef(new Set),y=b.useMemo(()=>a||(t?typeof t.user=="object"?t.user:t.userData&&typeof t.userData=="object"?t.userData:typeof t.user=="string"?{_id:t.user}:{}:{}),[t,a]),g=y._id,w=y.nickname||y.username||y.name||"User",C=y.profilePicture||y.avatar||null,j=b.useMemo(()=>{const V=window.location.origin,F=C||(g?`${V}/api/avatars/${g}`:`${V}/placeholder.svg`);return p.current.has(F)?`${V}/placeholder.svg`:F},[C,g]);b.useEffect(()=>{p.current.has(j)||h(!1)},[j]);const N=b.useMemo(()=>typeof i<"u"?!i:!u||!u._id||!(t!=null&&t.viewers)||!Array.isArray(t.viewers)?!1:t.viewers.includes(u._id),[i,u,t]),M=b.useMemo(()=>c==="video"||c==="image",[c]),D=()=>{const V=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6"],F=g?g.split("").reduce((H,E)=>H+E.charCodeAt(0),0)%V.length:0,O=V[F],A=w.charAt(0).toUpperCase();return o.jsx("div",{className:En.thumbnailPlaceholder,style:{backgroundColor:O},children:A})},I=V=>{if(M){V.preventDefault(),V.stopPropagation();return}V.preventDefault(),V.stopPropagation(),typeof e=="function"&&e()};return!t&&!a?null:o.jsxs("div",{className:En.storyThumbnail,onClick:I,children:[o.jsx("div",{className:`${En.avatarBorder} ${N?En.avatarBorderViewed:""}`,children:o.jsxs("div",{className:En.imageContainer,children:[d?D():o.jsx("img",{className:En.thumbnailImage,src:j,alt:`${w}'s avatar`,onError:V=>{p.current.add(j),h(!0)},crossOrigin:"anonymous",loading:"lazy"}),c==="video"&&o.jsx("div",{className:En.mediaTypeIcon,children:o.jsx(xa,{})}),c==="image"&&o.jsx("div",{className:En.mediaTypeIcon,children:o.jsx(du,{})})]})}),M&&o.jsxs("div",{className:En.comingSoonBadge,children:[o.jsx(T5,{size:8,style:{marginRight:"2px"}})," Coming Soon"]}),o.jsx("div",{className:En.username,children:w})]})},bC=(t,e)=>{let i;return function(){const a=arguments;i||(t.apply(this,a),i=!0,setTimeout(()=>i=!1,e))}},xC=({onStoryClick:t})=>{const e=Lr()||{},{stories:i=[],loadStories:a,loading:c,hasUnviewedStories:u}=e,[d,h]=b.useState(!0),[p,y]=b.useState(null),[g,w]=b.useState([]),[C,j]=b.useState(!1),N=b.useRef(!1),M=b.useRef(null),D=[{_id:"coming-soon-video",mediaType:"video",user:{_id:"video-user",nickname:"Video Stories"}},{_id:"coming-soon-image",mediaType:"image",user:{_id:"image-user",nickname:"Image Stories"}}];b.useEffect(()=>{if(i&&i.length>0){const F=[],O=new Set,A=new Set;i.forEach(P=>{P&&P._id&&!O.has(P._id)&&(O.add(P._id),F.push(P))});const H=[];[...F].sort((P,G)=>new Date(G.createdAt||0)-new Date(P.createdAt||0)).forEach(P=>{const G=P.user?typeof P.user=="string"?P.user:P.user._id:P.userData?P.userData._id:null;G&&!A.has(G)&&(A.add(G),H.push(P))});const L=[...H,...D];w(L)}else w(D)},[i]),b.useEffect(()=>{const F=async()=>{if(!N.current){N.current=!0,h(!0),y(null);try{typeof a=="function"?await a(!1):console.warn("Stories functionality is not available - loadStories function not found")}catch(O){console.error("Error loading stories:",O),y("Failed to load stories")}finally{h(!1),N.current=!1,j(!0)}}};!C&&!N.current&&typeof a=="function"&&F()},[a,C]);const I=b.useCallback(bC(F=>{typeof t=="function"?t(F):console.warn("Story click handler not provided")},300),[t]),V=b.useCallback(F=>{if(!M.current)return;const O=300,A=M.current.scrollLeft;M.current.scrollTo({left:F==="right"?A+O:A-O,behavior:"smooth"})},[]);return(d||c)&&!C?o.jsx("div",{className:En.storiesCarouselContainer,children:o.jsxs("div",{className:"stories-carousel-loading",children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{children:"Loading stories..."})]})}):p?o.jsx("div",{className:En.storiesCarouselContainer,children:o.jsx("div",{className:"stories-carousel-error",children:o.jsx("p",{children:p})})}):o.jsxs("div",{className:En.storiesCarouselContainer,children:[g.length>4&&o.jsx("button",{className:`${En.carouselNavButton} ${En.carouselNavButtonLeft}`,onClick:()=>V("left"),"aria-label":"Scroll left",children:"‹"}),o.jsx("div",{className:En.storiesCarousel,ref:M,children:g.map(F=>o.jsx(nm,{story:F,onClick:()=>I(F._id),hasUnviewedStories:typeof u=="function"&&F.user?u(typeof F.user=="string"?F.user:F.user._id):!1,mediaType:F.mediaType},F._id||`story-${Math.random()}`))}),g.length>4&&o.jsx("button",{className:`${En.carouselNavButton} ${En.carouselNavButtonRight}`,onClick:()=>V("right"),"aria-label":"Scroll right",children:"›"})]})},sm=({storyId:t,userId:e,onClose:i})=>{const{stories:a=[],viewStory:c,loadUserStories:u,loadStories:d,reactToStory:h}=Lr()||{},{user:p}=ka()||{},{user:y,isAuthenticated:g}=Sn()||{},w=y||p,[C,j]=b.useState(0),[N,M]=b.useState(0),[D,I]=b.useState(!1),[V,F]=b.useState(!1),[O,A]=b.useState(null),[H,E]=b.useState([]),[L,P]=b.useState(!0),[G,Q]=b.useState(!1),[z,ae]=b.useState(!1),[Pe,Ee]=b.useState(!1),K=b.useRef(null),J=100/(5e3/100),re=b.useRef(null),Ne=b.useRef(null),Se=e?H:a;b.useEffect(()=>{(!a||!a.length)&&d&&d(!0).catch(B=>console.error("Error loading stories:",B))},[a,d]),b.useEffect(()=>{(async()=>{if(!(!e||!u)){F(!0);try{const R=await u(e),Y=[],_=new Set;(Array.isArray(R)?R:a.filter(x=>{var U;return(typeof x.user=="string"?x.user:(U=x.user)==null?void 0:U._id)===e})).forEach(x=>{x._id&&!_.has(x._id)&&(_.add(x._id),Y.push(x))}),Y.length||A("No stories available for this user"),E(Y)}catch(R){console.error("Error loading user stories:",R),A("Failed to load stories")}finally{F(!1)}}})()},[e,u,a]),b.useEffect(()=>{if(Se.length>0&&C>=0&&C<Se.length){const B=Se[C];if(console.log("Checking reactions for story:",B==null?void 0:B._id,"User:",w==null?void 0:w._id),B&&B.reactions&&Array.isArray(B.reactions)&&w){const R=B.reactions.some(Y=>Y.user===w._id||Y.user&&Y.user._id===w._id);console.log("Has user reacted:",R,"Reactions:",B.reactions),Q(R)}else Q(!1)}},[C,Se,w]),b.useEffect(()=>{if(t&&(e?H:a).length){const R=(e?H:a).findIndex(Y=>Y._id===t);R!==-1&&j(R)}},[t,e,H,a]),b.useEffect(()=>{if(!c||!Se.length)return;const B=Se[C];B&&w&&B._id&&c(B._id).catch(R=>{console.error("Error marking story as viewed:",R)})},[C,Se,w,c]),b.useEffect(()=>{if(re.current)if(D)re.current.pause();else{const B=re.current.play();B!==void 0&&B.catch(R=>{console.error("Error playing video:",R),R.name==="NotAllowedError"&&!L&&(P(!0),re.current.muted=!0,re.current.play().catch(Y=>console.error("Still couldn't play even with mute:",Y)))})}},[D,C,L]),b.useEffect(()=>{if(D||V||O||!Se.length){K.current&&(clearInterval(K.current),K.current=null);return}M(0),K.current&&(clearInterval(K.current),K.current=null);const B=Se[C];if(!(B&&(B.mediaType==="video"||B.type==="video")&&re.current))return K.current=setInterval(()=>{M(R=>R>=100?(clearInterval(K.current),K.current=null,C<Se.length-1?j(Y=>Y+1):i==null||i(),0):R+J)},100),()=>{K.current&&(clearInterval(K.current),K.current=null)}},[C,Se,D,i,V,O,J]);const Ve=b.useCallback(()=>{if(re.current){const B=re.current.duration,R=re.current.currentTime;if(B>0){const Y=R/B*100;M(Y),Y>=99.5&&(C<Se.length-1?j(_=>_+1):i==null||i())}}},[C,Se.length,i]),ge=b.useCallback(B=>{if(B==null||B.stopPropagation(),B==null||B.preventDefault(),Pe){Ee(!1);return}z||C>0&&(ae(!0),j(R=>R-1),M(0),setTimeout(()=>ae(!1),300))},[C,z,Pe]),ee=b.useCallback(B=>{if(B==null||B.stopPropagation(),B==null||B.preventDefault(),Pe){Ee(!1);return}z||(ae(!0),C<Se.length-1?(j(R=>R+1),M(0)):i==null||i(),setTimeout(()=>ae(!1),300))},[C,Se,i,z,Pe]),Re=b.useCallback(B=>{B.stopPropagation(),B.preventDefault(),Ee(!0),P(R=>{const Y=!R;return re.current&&(re.current.muted=Y),Y}),setTimeout(()=>Ee(!1),300)},[]),he=b.useCallback(B=>{if(console.log("React button clicked"),B.stopPropagation(),B.preventDefault(),Ee(!0),G){console.log("Already reacted to this story"),setTimeout(()=>Ee(!1),300);return}if(!g||!w){console.log("User authentication status:",g,"User:",w),ne.error("You must be logged in to react to stories"),setTimeout(()=>Ee(!1),300);return}if(!Se||C>=Se.length){setTimeout(()=>Ee(!1),300);return}const R=Se[C];if(!R||!R._id){setTimeout(()=>Ee(!1),300);return}const Y=R._id;Y&&h?(Q(!0),h(Y,"like").then(_=>{if(!_||!_.success)throw new Error((_==null?void 0:_.message)||"Failed to react to story");if(console.log("Successfully reacted to story"),_.data&&Array.isArray(_.data)){const v=[...Se];v[C]&&(v[C].reactions=_.data,e&&E(v))}}).catch(_=>{console.error("Error reacting to story:",_),Q(!1),ne.error("Failed to react to story")}).finally(()=>{setTimeout(()=>Ee(!1),300)})):setTimeout(()=>Ee(!1),300)},[w,g,Se,C,h,G,e]),Ue=b.useCallback(B=>{Ne.current&&Ne.current.contains(B.target)||(B.stopPropagation(),B.preventDefault(),I(R=>!R))},[]);b.useEffect(()=>{const B=R=>{z||(R.key==="ArrowLeft"?ge():R.key==="ArrowRight"||R.key===" "||R.key==="Spacebar"?ee():R.key==="Escape"&&(i==null||i()))};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[ge,ee,i,z]);const ze=b.useCallback(()=>i==null?void 0:i(),[i]),Xe=b.useMemo(()=>({position:"absolute",bottom:"80px",right:"20px",display:"flex",flexDirection:"column",gap:"16px",zIndex:9999,pointerEvents:"auto"}),[]),Qe=b.useMemo(()=>({width:"46px",height:"46px",borderRadius:"50%",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white",border:"none",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.2s ease",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)",pointerEvents:"auto",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.3)"}),[]),Ge=b.useMemo(()=>({...Qe,color:"var(--primary, #ff3366)",backgroundColor:"rgba(255, 51, 102, 0.2)",transform:"scale(1.1)"}),[Qe]),at=b.useMemo(()=>({pointerEvents:"auto",zIndex:900}),[]),yt=b.useMemo(()=>({zIndex:950}),[]),mt=b.useMemo(()=>Se&&Se.length>0&&C<Se.length?Se[C]:null,[Se,C]),Ie=b.useMemo(()=>({marginTop:"20px",padding:"10px 20px",background:"#ff3366",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"}),[]),qe=b.useMemo(()=>({justifyContent:"center",alignItems:"center"}),[]),jt=b.useMemo(()=>V?"loading":O?"error":!Se.length||C>=Se.length?"empty":mt?"normal":"notAvailable",[V,O,Se,C,mt]),Ct=b.useCallback(()=>{if(!Se||!Se.length||C>=Se.length)return"Unknown User";const B=Se[C];if(!B)return"Unknown User";const R=B.user||B.userData||{};return!R||typeof R=="string"?"Unknown User":R.nickname||R.username||R.name||"User"},[Se,C]),Rt=b.useCallback(()=>{if(!Se||!Se.length||C>=Se.length)return"/api/avatars/default";const B=Se[C];if(!B)return"/api/avatars/default";const R=B.user||B.userData||{};return!R||typeof R=="string"?"/api/avatars/default":R.profilePicture||R.avatar||`/api/avatars/${R._id||"default"}`},[Se,C]),pe=b.useCallback(()=>{if(!Se||!Se.length||C>=Se.length)return"Recently";const B=Se[C];if(!B||!B.createdAt)return"Recently";try{return new Date(B.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return"Recently"}},[Se,C]),je=b.useCallback(()=>{var R,Y;if(!Se||!Se.length||C>=Se.length)return o.jsx("div",{className:"stories-text-content",children:o.jsx("p",{children:"No story available"})});const B=Se[C];if(!B)return o.jsx("div",{className:"stories-text-content",children:o.jsx("p",{children:"Story not found"})});if(B.mediaType==="text"||B.type==="text"){const _={};return B.backgroundStyle?_.background=B.backgroundStyle:B.backgroundColor&&(_.background=B.backgroundColor),B.fontStyle&&(_.fontFamily=B.fontStyle),o.jsxs("div",{className:"stories-text-content",style:_,children:[o.jsx("div",{className:"story-user-overlay",children:o.jsx("span",{className:"story-nickname",children:Ct()})}),B.text||B.content||"",D&&o.jsx("div",{className:"pause-indicator",children:o.jsx(Lo,{size:24})})]})}if(((R=B.mediaType)!=null&&R.startsWith("image")||B.type==="image")&&(B.mediaUrl||B.media)){const _=B.mediaUrl||B.media;return o.jsxs("div",{className:"stories-image-container",children:[o.jsx("div",{className:"story-user-overlay",children:o.jsx("span",{className:"story-nickname",children:Ct()})}),o.jsx("img",{src:_||"/placeholder.svg",alt:"Story",className:"stories-media",crossOrigin:"anonymous",loading:"lazy",decoding:"async",onError:v=>{v.target.onerror=null,v.target.src="/placeholder.svg"}}),D&&o.jsx("div",{className:"pause-indicator",children:o.jsx(Lo,{size:24})}),B.content&&B.content.trim()&&o.jsx("div",{className:"story-caption",children:B.content})]})}if(((Y=B.mediaType)!=null&&Y.startsWith("video")||B.type==="video")&&(B.mediaUrl||B.media)){const _=B.mediaUrl||B.media;return o.jsxs("div",{className:"stories-video-container",children:[o.jsx("div",{className:"story-user-overlay",children:o.jsx("span",{className:"story-nickname",children:Ct()})}),o.jsx("video",{ref:re,src:_,className:"stories-media",autoPlay:!0,muted:L,loop:!1,playsInline:!0,crossOrigin:"anonymous",onTimeUpdate:Ve,onError:v=>{console.error("Video failed to load:",v)}}),D&&o.jsx("div",{className:"pause-indicator",children:o.jsx(Lo,{size:24})}),o.jsx("button",{className:"video-control mute-button",onClick:Re,"aria-label":L?"Unmute video":"Mute video",children:L?o.jsx(O5,{size:16}):o.jsx(D5,{size:16})}),B.content&&B.content.trim()&&o.jsx("div",{className:"story-caption",children:B.content})]})}return o.jsxs("div",{className:"stories-text-content",children:[o.jsx("div",{className:"story-user-overlay",children:o.jsx("span",{className:"story-nickname",children:Ct()})}),o.jsx("p",{children:B.text||B.content||"No content available"}),D&&o.jsx("div",{className:"pause-indicator",children:o.jsx(Lo,{size:24})})]})},[Se,C,D,L,Ct,Ve,Re]);b.useCallback(()=>je(),[je]);const Je=b.useMemo(()=>o.jsxs("div",{className:"stories-viewer-container",style:qe,children:[o.jsx("div",{className:"spinner"}),o.jsx("p",{style:{color:"white"},children:"Loading stories..."})]}),[qe]),_t=b.useMemo(()=>o.jsxs("div",{className:"stories-viewer-container",style:qe,children:[o.jsx("p",{style:{color:"white"},children:O}),o.jsx("button",{onClick:ze,style:Ie,children:"Close"})]}),[O,ze,qe,Ie]),ke=b.useMemo(()=>o.jsxs("div",{className:"stories-viewer-container",style:qe,children:[o.jsx("p",{style:{color:"white"},children:"No stories available"}),o.jsx("button",{onClick:ze,style:Ie,children:"Close"})]}),[ze,qe,Ie]),Ke=b.useMemo(()=>o.jsxs("div",{className:"stories-viewer-container",style:qe,children:[o.jsx("p",{style:{color:"white"},children:"Story not available"}),o.jsx("button",{onClick:ze,style:Ie,children:"Close"})]}),[ze,qe,Ie]),ht=b.useMemo(()=>o.jsxs("div",{className:"stories-viewer-container",children:[o.jsxs("div",{className:"stories-viewer-header",children:[o.jsx("div",{className:"stories-progress-container",children:Se.map((B,R)=>o.jsx("div",{className:`stories-progress-bar ${R<C?"completed":""}`,children:R===C&&o.jsx("div",{className:"stories-progress-fill",style:{width:`${N}%`}})},R))}),o.jsxs("div",{className:"stories-user-info",children:[o.jsx("img",{src:Rt()||"/placeholder.svg",alt:Ct(),className:"stories-user-avatar",loading:"lazy",crossOrigin:"anonymous",onError:B=>{B.target.onerror=null,B.target.src="/placeholder.svg"}}),o.jsxs("div",{className:"stories-user-details",children:[o.jsx("span",{className:"stories-username",children:Ct()}),o.jsx("span",{className:"stories-timestamp",children:pe()})]})]}),o.jsx("button",{className:"stories-close-btn",onClick:ze,"aria-label":"Close stories",children:"×"})]}),o.jsx("div",{className:"stories-viewer-content",onClick:B=>{B.target===B.currentTarget&&Ue(B)},children:je()}),o.jsxs("div",{className:"stories-viewer-navigation",style:at,children:[o.jsx("div",{className:"stories-nav-left",onClick:ge,"aria-label":"Previous story",style:yt}),o.jsx("div",{className:"stories-nav-right",onClick:ee,"aria-label":"Next story",style:yt})]}),o.jsxs("div",{ref:Ne,className:"stories-actions",style:Xe,onClick:B=>{B.stopPropagation(),B.preventDefault(),Ee(!0)},children:[o.jsx("button",{className:`story-action-button ${G?"active":""}`,style:G?Ge:Qe,onClick:he,"aria-label":"Like story",children:G?o.jsx(vi,{size:20}):o.jsx(jb,{size:20})}),o.jsx("button",{className:"story-action-button",style:Qe,onClick:B=>{B.stopPropagation(),B.preventDefault(),Ee(!0),ne.info("Comments feature coming soon!"),setTimeout(()=>Ee(!1),300)},"aria-label":"Comment on story",children:o.jsx(Ta,{size:20})}),o.jsx("button",{className:"story-action-button",style:Qe,onClick:B=>{B.stopPropagation(),B.preventDefault(),Ee(!0),ne.info("Share feature coming soon!"),setTimeout(()=>Ee(!1),300)},"aria-label":"Share story",children:o.jsx(_5,{size:20})}),o.jsx("button",{className:"story-action-button",style:Qe,onClick:B=>{B.stopPropagation(),B.preventDefault(),Ee(!0),Ue(B),setTimeout(()=>Ee(!1),300)},"aria-label":D?"Play story":"Pause story",children:D?o.jsx(Lo,{size:20}):o.jsx(b5,{size:20})})]})]}),[Se,C,N,Rt,Ct,pe,ze,Ue,je,at,ge,ee,yt,Xe,Ee,G,Ge,Qe,he,D]);return o.jsxs("div",{className:"stories-viewer-overlay",children:[jt==="loading"&&Je,jt==="error"&&_t,jt==="empty"&&ke,jt==="notAvailable"&&Ke,jt==="normal"&&ht]})},sy=[{id:"gradient-1",name:"Sunset",style:"linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%)"},{id:"gradient-2",name:"Ocean",style:"linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%)"},{id:"gradient-3",name:"Passion",style:"linear-gradient(135deg, #f6d365 0%, #fda085 100%)"},{id:"gradient-4",name:"Midnight",style:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)"},{id:"gradient-5",name:"Forest",style:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)"},{id:"gradient-6",name:"Berry",style:"linear-gradient(135deg, #c471f5 0%, #fa71cd 100%)"},{id:"gradient-7",name:"Dusk",style:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"},{id:"gradient-8",name:"Fire",style:"linear-gradient(135deg, #f83600 0%, #f9d423 100%)"}],iy=[{id:"font-1",name:"Classic",style:"'Helvetica', sans-serif"},{id:"font-2",name:"Elegant",style:"'Georgia', serif"},{id:"font-3",name:"Modern",style:"'Montserrat', sans-serif"},{id:"font-4",name:"Playful",style:"'Comic Sans MS', cursive"},{id:"font-5",name:"Bold",style:"'Impact', sans-serif"}],wC=({onClose:t,onSubmit:e})=>{const{user:i}=Sn(),{createStory:a}=Lr(),[c,u]=b.useState(""),[d,h]=b.useState(sy[0]),[p,y]=b.useState(iy[0]),[g,w]=b.useState(!1),[C,j]=b.useState(0),[N,M]=b.useState(""),[D,I]=b.useState("text"),[V,F]=b.useState(null),[O,A]=b.useState(null),[H,E]=b.useState("text"),[L,P]=b.useState(!1),G=b.useRef(null),Q=b.useRef(null),z=q=>{if(L||g)return;const J=q.target.files[0];if(!J)return;if(J.type.startsWith("image/"))E("image");else if(J.type.startsWith("video/"))E("video");else{ne.error("Unsupported file type. Please upload an image or video.");return}if(J.size>10*1024*1024){ne.error("File is too large. Maximum size is 10MB.");return}F(J);const re=new FileReader;re.onloadend=()=>{A(re.result)},re.readAsDataURL(J),I(J.type.startsWith("image/")?"image":"video")},ae=async()=>{if(L||g){ne.info("Please wait, your story is being created...");return}if(!c.trim()){ne.error("Please add some text to your story");return}if(!i){ne.error("You must be logged in to create a story");return}M(""),w(!0),P(!0),j(0);try{const q={content:c.trim(),text:c.trim(),backgroundStyle:d.style,backgroundColor:d.style,fontStyle:p.style,mediaType:"text",type:"text"},J=await a(q,Pe);J&&J.success?(ne.success("Story created successfully!"),e&&J.data?e(J.data):e&&e(J),t==null||t()):M((J==null?void 0:J.message)||"Failed to create story")}catch(q){console.error("Error creating story:",q),M(q.message||"An error occurred"),ne.error(q.message||"An error occurred")}finally{w(!1),P(!1)}},Pe=q=>{if(q&&typeof q=="number")j(q);else if(q&&q.total>0){const J=Math.round(q.loaded*100/q.total);j(J)}},Ee=b.useCallback(q=>({background:q.style}),[]),K=b.useCallback(q=>({fontFamily:q.style}),[]);return b.useEffect(()=>{const q=J=>{J.key==="Escape"&&!g&&!L&&(t==null||t())};return document.addEventListener("keydown",q),()=>document.removeEventListener("keydown",q)},[t,g,L]),o.jsxs("div",{className:"story-creator-container",children:[o.jsx("div",{className:"story-creator-overlay",onClick:g||L?null:t}),o.jsxs("div",{className:"story-creator",children:[o.jsxs("div",{className:"creator-header",children:[o.jsx("h2",{children:"Create Story"}),o.jsx("button",{className:"close-button",onClick:g||L?null:t,disabled:g||L,children:o.jsx(Vn,{})})]}),o.jsxs("div",{className:"creator-content",children:[o.jsx("div",{className:"story-preview",ref:G,style:{...Ee(d),...K(p)},children:c?o.jsx("div",{className:"story-text-content",children:c}):o.jsx("div",{className:"story-placeholder",children:"Type something amazing..."})}),o.jsxs("div",{className:"story-creator-tabs",children:[o.jsxs("button",{className:`tab-button ${D==="text"?"active":""}`,onClick:q=>{q.stopPropagation(),!L&&!g&&(I("text"),E("text"),F(null),A(null))},disabled:L||g,children:[o.jsx(U0,{})," Text"]}),o.jsxs("button",{className:`tab-button ${D==="background"?"active":""}`,onClick:q=>{q.stopPropagation(),!L&&!g&&I("background")},disabled:L||g,children:[o.jsx(fh,{})," Background"]}),o.jsxs("button",{className:`tab-button ${D==="font"?"active":""}`,onClick:q=>{q.stopPropagation(),!L&&!g&&I("font")},disabled:L||g,children:[o.jsx(U0,{})," Font"]})]}),o.jsx("input",{type:"file",ref:Q,style:{display:"none"},onChange:z,accept:"image/*,video/*",disabled:L||g}),D==="text"&&o.jsx("div",{className:"tab-content",children:o.jsxs("div",{className:"text-tab",children:[o.jsx("textarea",{value:c,onChange:q=>u(q.target.value),placeholder:"What's on your mind?",maxLength:150,rows:3,disabled:L||g}),o.jsxs("small",{className:"character-count",children:[c.length,"/150"]})]})}),D==="background"&&H==="text"&&o.jsx("div",{className:"tab-content",children:o.jsx("div",{className:"background-options",children:sy.map(q=>o.jsx("div",{className:`background-option ${d.id===q.id?"selected":""}`,style:Ee(q),onClick:()=>{!L&&!g&&h(q)},title:q.name},q.id))})}),D==="font"&&H==="text"&&o.jsx("div",{className:"tab-content",children:o.jsx("div",{className:"font-options",children:iy.map(q=>o.jsx("div",{className:`font-option ${p.id===q.id?"selected":""}`,style:K(q),onClick:()=>{!L&&!g&&y(q)},children:q.name},q.id))})}),N&&o.jsx("div",{className:"error-message",children:N})]}),o.jsxs("div",{className:"creator-footer",children:[g?o.jsxs("div",{className:"upload-progress",children:[o.jsx("div",{className:"progress-bar-container",children:o.jsx("div",{className:"progress-bar",style:{width:`${C}%`}})}),o.jsxs("span",{children:[C,"%"]})]}):o.jsx("button",{className:"btn btn-primary create-button",onClick:ae,disabled:g||L||!c.trim(),children:L?o.jsxs(o.Fragment,{children:[o.jsx(ws,{className:"spinner-icon"}),o.jsx("span",{children:"Creating..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Lt,{}),o.jsx("span",{children:"Create Story"})]})}),o.jsx("button",{className:"btn btn-outline cancel-button",onClick:t,disabled:g||L,children:"Cancel"})]})]})]})},_C="_userCard_7pj0o_4",SC="_cardHeader_7pj0o_24",jC="_cardPhoto_7pj0o_31",CC="_cardBody_7pj0o_74",NC="_userInfo_7pj0o_78",TC="_userName_7pj0o_82",kC="_userAge_7pj0o_96",EC="_lastActive_7pj0o_105",AC="_location_7pj0o_118",RC="_icon_7pj0o_131",MC="_tagsContainer_7pj0o_141",LC="_detailsRow_7pj0o_145",OC="_detailItem_7pj0o_152",DC="_detailLabel_7pj0o_158",BC="_tagCategory_7pj0o_168",zC="_categoryTitle_7pj0o_172",PC="_interestTags_7pj0o_183",$C="_tag_7pj0o_141",UC="_lookingForTag_7pj0o_209",IC="_intoTag_7pj0o_218",FC="_identityTag_7pj0o_227",qC="_identityWoman_7pj0o_236",VC="_identityMan_7pj0o_245",HC="_identityCouple_7pj0o_254",GC="_moreCount_7pj0o_263",YC="_toggleBtn_7pj0o_275",XC="_actions_7pj0o_294",KC="_actionBtn_7pj0o_300",QC="_likeBtn_7pj0o_315",WC="_active_7pj0o_328",ZC="_messageBtn_7pj0o_333",JC="_unreadBadge_7pj0o_346",eN="_listItem_7pj0o_360",tN="_listPhotoContainer_7pj0o_388",nN="_listInfo_7pj0o_431",sN="_listHeader_7pj0o_436",iN="_listName_7pj0o_442",aN="_listLastActive_7pj0o_452",rN="_listActions_7pj0o_465",Ae={userCard:_C,cardHeader:SC,cardPhoto:jC,cardBody:CC,userInfo:NC,userName:TC,userAge:kC,lastActive:EC,location:AC,icon:RC,tagsContainer:MC,detailsRow:LC,detailItem:OC,detailLabel:DC,tagCategory:BC,categoryTitle:zC,interestTags:PC,tag:$C,lookingForTag:UC,intoTag:IC,identityTag:FC,identityWoman:qC,identityMan:VC,identityCouple:HC,moreCount:GC,toggleBtn:YC,actions:XC,actionBtn:KC,likeBtn:QC,active:WC,messageBtn:ZC,unreadBadge:JC,listItem:eN,listPhotoContainer:tN,listInfo:nN,listHeader:sN,listName:iN,listLastActive:aN,listActions:rN},Ff={LOOKING_FOR:"lookingFor",INTO:"into",INTEREST:"interest"},Xb=({user:t,isLiked:e=!1,onLike:i,viewMode:a="grid",onMessage:c,onClick:u,showExtendedDetails:d=!0,unreadMessageCount:h=0,hasUnreadMessages:p=!1})=>{var L,P,G,Q;const[y,g]=b.useState(!1),[w,C]=b.useState(!1),j=In();b.useCallback(z=>{switch(z){case Ff.LOOKING_FOR:return"looking-for-tag";case Ff.INTO:return"into-tag";case Ff.INTEREST:return"interest-tag";default:return"interest-tag"}},[]);const N=b.useCallback(z=>{var ae;if((ae=z==null?void 0:z.target)!=null&&ae.closest("button")){console.log("Skipping card click - clicked on a button");return}console.log("UserCard clicked:",t==null?void 0:t._id,t==null?void 0:t.nickname),u?(console.log("Using provided onClick handler"),u()):(console.log("Navigating to user profile:",`/user/${t._id}`),j(`/user/${t._id}`))},[u,j,t==null?void 0:t._id]),M=b.useCallback(z=>{z.stopPropagation(),z.preventDefault(),i&&(An.debug(`Like button clicked for user ${t._id}, current isLiked: ${e}`),i(t._id,t.nickname))},[i,t==null?void 0:t._id,t==null?void 0:t.nickname,e]),D=b.useCallback(z=>{if(z.stopPropagation(),z.preventDefault(),c)c(z,t);else{const ae=new CustomEvent("openChat",{detail:{recipient:t}});window.dispatchEvent(ae),console.log("Dispatched openChat event with recipient:",t),console.log("User data in event:",JSON.stringify(t))}},[c,t]),I=b.useCallback(z=>{z==null||z.stopPropagation(),g(ae=>!ae)},[]),V=b.useCallback(z=>{z==null||z.stopPropagation(),C(ae=>!ae)},[]),F=b.useMemo(()=>{var ae,Pe;if(!((ae=t==null?void 0:t.photos)!=null&&ae.length))return"/default-avatar.png";const z=(Pe=t.photos[0])==null?void 0:Pe.url;return z?z.startsWith("http")||z.startsWith("/")&&!z.startsWith("/public/")?z:z.startsWith("/public/")?z.replace("/public/","/"):z:"/default-avatar.png"},[t==null?void 0:t.photos]);b.useMemo(()=>{if(!(t!=null&&t.details))return"";const{age:z,gender:ae,location:Pe}=t.details,Ee=[];return z&&Ee.push(z),ae&&Ee.push(ae),Pe&&Ee.push(Pe),Ee.join(" • ")},[t==null?void 0:t.details]);const O=b.useMemo(()=>{if(!(t!=null&&t.details))return{status:null,identity:null};const z={status:null,identity:null},{maritalStatus:ae,iAm:Pe}=t.details;return ae&&(z.status=ae),Pe&&(z.identity=Pe),z},[t==null?void 0:t.details]),A=b.useMemo(()=>{if(!(t!=null&&t.details))return[];const z={lookingFor:[],into:[],interests:[]},{lookingFor:ae=[],intoTags:Pe=[],interests:Ee=[]}=t.details;return ae.forEach(K=>z.lookingFor.push(K)),Pe.forEach(K=>z.into.push(K)),Ee.forEach(K=>z.interests.push(K)),z},[t==null?void 0:t.details]),H=b.useMemo(()=>t!=null&&t.isOnline?"Active now":t!=null&&t.lastActive?Kc(t.lastActive,{showRelative:!0,showTime:!1,showDate:!1}):"Never active",[t==null?void 0:t.lastActive,t==null?void 0:t.isOnline]);if(!t)return null;const E=()=>o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:M,"aria-label":`${e?"Unlike":"Like"} ${t.nickname}`,className:`${Ae.actionBtn} ${Ae.likeBtn} ${e?Ae.active:""}`,children:[o.jsx(vi,{size:18}),e?"Liked":"Like"]}),o.jsxs("button",{onClick:D,"aria-label":`Message ${t.nickname}`,className:`${Ae.actionBtn} ${Ae.messageBtn}`,children:[o.jsx(Ta,{size:18}),"Message"]})]});return a==="grid"?o.jsxs(Gb,{className:Ae.userCard,onClick:N,hover:!0,noPadding:!0,headerClassName:Ae.cardHeader,bodyClassName:Ae.cardBody,"data-userid":t._id,children:[o.jsxs("div",{className:Ae.cardPhoto,children:[o.jsx("img",{src:F||"/default-avatar.png",alt:t.nickname,onError:z=>{z.target.onerror=null,z.target.src="/default-avatar.png"}}),t.isOnline&&o.jsx("span",{className:"status-indicator online"})]}),o.jsxs("div",{className:Ae.userInfo,children:[o.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[o.jsxs("h3",{className:Ae.userName,children:[t.nickname,((L=t.details)==null?void 0:L.age)&&o.jsxs("span",{className:Ae.userAge,children:[", ",t.details.age]})]}),p&&o.jsx("span",{className:Ae.unreadBadge,children:h})]}),o.jsxs("p",{className:Ae.lastActive,children:[o.jsx(O0,{className:Ae.icon}),H]}),o.jsxs("p",{className:Ae.location,children:[o.jsx(Tr,{className:Ae.icon}),((P=t.details)==null?void 0:P.location)||"Unknown location"]}),d&&o.jsx("div",{className:Ae.tagsContainer,children:o.jsxs("div",{className:Ae.detailsRow,children:[O.identity&&o.jsxs("div",{className:Ae.detailItem,children:[o.jsx("span",{className:Ae.detailLabel,children:"I am:"}),o.jsx("span",{className:`${Ae.tag} ${Ae.identityTag} ${O.identity.toLowerCase().includes("woman")?Ae.identityWoman:O.identity.toLowerCase().includes("man")?Ae.identityMan:O.identity.toLowerCase().includes("couple")?Ae.identityCouple:""}`,children:O.identity})]}),A.lookingFor.length>0&&o.jsxs("div",{className:Ae.detailItem,children:[o.jsx("span",{className:Ae.detailLabel,children:"Into:"}),o.jsx("span",{className:`${Ae.tag} ${A.lookingFor[0].toLowerCase().includes("women")||A.lookingFor[0].toLowerCase().includes("woman")?Ae.identityWoman:A.lookingFor[0].toLowerCase().includes("men")||A.lookingFor[0].toLowerCase().includes("man")?Ae.identityMan:A.lookingFor[0].toLowerCase().includes("couple")?Ae.identityCouple:Ae.lookingForTag}`,children:A.lookingFor[0]}),A.lookingFor.length>1&&o.jsxs("span",{className:Ae.moreCount,children:["+",A.lookingFor.length-1]})]})]})}),d&&o.jsxs("div",{className:Ae.tagsContainer,children:[(A.lookingFor.length>0||A.into.length>0||A.interests.length>0)&&o.jsx("div",{className:Ae.tagsToggle,children:o.jsx("span",{className:Ae.toggleBtn,onClick:V,children:w?o.jsxs(o.Fragment,{children:["Show less ",o.jsx(jc,{size:12,style:{marginLeft:"4px"}})]}):o.jsxs(o.Fragment,{children:["Show more ",o.jsx(Sc,{size:12,style:{marginLeft:"4px"}})]})})}),w&&o.jsxs(o.Fragment,{children:[A.interests.length>0&&o.jsxs("div",{className:Ae.tagCategory,children:[o.jsx("h4",{className:Ae.categoryTitle,children:"Interests"}),o.jsxs("div",{className:Ae.interestTags,children:[(y?A.interests:A.interests.slice(0,3)).map((z,ae)=>o.jsx("span",{className:`${Ae.tag} ${z.toLowerCase().includes("women")||z.toLowerCase().includes("woman")?Ae.identityWoman:z.toLowerCase().includes("men")||z.toLowerCase().includes("man")?Ae.identityMan:z.toLowerCase().includes("couple")?Ae.identityCouple:""}`,children:z},`interest-${ae}`)),A.interests.length>3&&!y&&o.jsxs("span",{className:Ae.moreCount,onClick:I,children:["+",A.interests.length-3]})]})]}),A.into.length>0&&o.jsxs("div",{className:Ae.tagCategory,children:[o.jsx("h4",{className:Ae.categoryTitle,children:"Preferences"}),o.jsxs("div",{className:Ae.interestTags,children:[(y?A.into:A.into.slice(0,3)).map((z,ae)=>o.jsx("span",{className:`${Ae.tag} ${z.toLowerCase().includes("women")||z.toLowerCase().includes("woman")?Ae.identityWoman:z.toLowerCase().includes("men")||z.toLowerCase().includes("man")?Ae.identityMan:z.toLowerCase().includes("couple")?Ae.identityCouple:Ae.intoTag}`,children:z},`into-${ae}`)),A.into.length>3&&!y&&o.jsxs("span",{className:Ae.moreCount,onClick:I,children:["+",A.into.length-3]})]})]}),(A.lookingFor.length>3||A.into.length>3||A.interests.length>3)&&o.jsx("div",{className:Ae.tagsToggle,children:o.jsx("span",{className:Ae.toggleBtn,onClick:I,children:y?o.jsxs(o.Fragment,{children:["Show less tags ",o.jsx(jc,{size:12,style:{marginLeft:"4px"}})]}):o.jsxs(o.Fragment,{children:["Show all tags ",o.jsx(Sc,{size:12,style:{marginLeft:"4px"}})]})})})]})]}),o.jsx("div",{className:Ae.actions,children:E()})]})]}):o.jsxs("div",{className:Ae.listItem,onClick:N,"data-userid":t._id,children:[o.jsxs("div",{className:Ae.listPhotoContainer,children:[o.jsx("img",{src:F||"/default-avatar.png",alt:t.nickname,onError:z=>{z.target.onerror=null,z.target.src="/default-avatar.png"}}),t.isOnline&&o.jsx("span",{className:"status-indicator online-small"})]}),o.jsxs("div",{className:Ae.listInfo,children:[o.jsxs("div",{className:Ae.listHeader,children:[o.jsxs("h3",{className:Ae.listName,children:[t.nickname,((G=t.details)==null?void 0:G.age)&&o.jsxs("span",{className:Ae.userAge,children:[", ",t.details.age]})]}),p&&o.jsx("span",{className:Ae.unreadBadge,children:h})]}),o.jsxs("p",{className:Ae.listLastActive,children:[o.jsx(O0,{className:Ae.icon}),H]}),o.jsxs("p",{className:Ae.location,children:[o.jsx(Tr,{className:Ae.icon}),((Q=t.details)==null?void 0:Q.location)||"Unknown location"]}),d&&o.jsx("div",{className:Ae.tagsContainer,children:o.jsxs("div",{className:Ae.detailsRow,children:[O.identity&&o.jsxs("div",{className:Ae.detailItem,children:[o.jsx("span",{className:Ae.detailLabel,children:"I am:"}),o.jsx("span",{className:`${Ae.tag} ${Ae.identityTag} ${O.identity.toLowerCase().includes("woman")?Ae.identityWoman:O.identity.toLowerCase().includes("man")?Ae.identityMan:O.identity.toLowerCase().includes("couple")?Ae.identityCouple:""}`,children:O.identity})]}),A.lookingFor.length>0&&o.jsxs("div",{className:Ae.detailItem,children:[o.jsx("span",{className:Ae.detailLabel,children:"Into:"}),o.jsx("span",{className:`${Ae.tag} ${A.lookingFor[0].toLowerCase().includes("women")||A.lookingFor[0].toLowerCase().includes("woman")?Ae.identityWoman:A.lookingFor[0].toLowerCase().includes("men")||A.lookingFor[0].toLowerCase().includes("man")?Ae.identityMan:A.lookingFor[0].toLowerCase().includes("couple")?Ae.identityCouple:Ae.lookingForTag}`,children:A.lookingFor[0]}),A.lookingFor.length>1&&o.jsxs("span",{className:Ae.moreCount,children:["+",A.lookingFor.length-1]})]})]})}),d&&o.jsxs("div",{className:Ae.tagsContainer,children:[(A.lookingFor.length>0||A.into.length>0||A.interests.length>0)&&o.jsx("div",{className:Ae.tagsToggle,children:o.jsx("span",{className:Ae.toggleBtn,onClick:V,children:w?o.jsxs(o.Fragment,{children:["Show less ",o.jsx(jc,{size:12,style:{marginLeft:"4px"}})]}):o.jsxs(o.Fragment,{children:["Show more ",o.jsx(Sc,{size:12,style:{marginLeft:"4px"}})]})})}),w&&o.jsxs(o.Fragment,{children:[A.interests.length>0&&o.jsxs("div",{className:Ae.tagCategory,children:[o.jsx("h4",{className:Ae.categoryTitle,children:"Interests"}),o.jsxs("div",{className:Ae.interestTags,children:[(y?A.interests:A.interests.slice(0,2)).map((z,ae)=>o.jsx("span",{className:`${Ae.tag} ${z.toLowerCase().includes("women")||z.toLowerCase().includes("woman")?Ae.identityWoman:z.toLowerCase().includes("men")||z.toLowerCase().includes("man")?Ae.identityMan:z.toLowerCase().includes("couple")?Ae.identityCouple:""}`,children:z},`interest-${ae}`)),A.interests.length>2&&!y&&o.jsxs("span",{className:Ae.moreCount,onClick:I,children:["+",A.interests.length-2]})]})]}),A.into.length>0&&o.jsxs("div",{className:Ae.tagCategory,children:[o.jsx("h4",{className:Ae.categoryTitle,children:"Preferences"}),o.jsxs("div",{className:Ae.interestTags,children:[(y?A.into:A.into.slice(0,2)).map((z,ae)=>o.jsx("span",{className:`${Ae.tag} ${z.toLowerCase().includes("women")||z.toLowerCase().includes("woman")?Ae.identityWoman:z.toLowerCase().includes("men")||z.toLowerCase().includes("man")?Ae.identityMan:z.toLowerCase().includes("couple")?Ae.identityCouple:Ae.intoTag}`,children:z},`into-${ae}`)),A.into.length>2&&!y&&o.jsxs("span",{className:Ae.moreCount,onClick:I,children:["+",A.into.length-2]})]})]}),(A.lookingFor.length>2||A.into.length>2||A.interests.length>2)&&o.jsx("div",{className:Ae.tagsToggle,children:o.jsx("span",{className:Ae.toggleBtn,onClick:I,children:y?o.jsxs(o.Fragment,{children:["Show less tags ",o.jsx(jc,{size:12,style:{marginLeft:"4px"}})]}):o.jsxs(o.Fragment,{children:["Show all tags ",o.jsx(Sc,{size:12,style:{marginLeft:"4px"}})]})})})]})]})]}),o.jsx("div",{className:Ae.listActions,children:E()})]})};Xb.propTypes={user:Ce.shape({_id:Ce.string.isRequired,nickname:Ce.string.isRequired,isOnline:Ce.bool,lastActive:Ce.string,photos:Ce.arrayOf(Ce.shape({url:Ce.string})),details:Ce.shape({age:Ce.oneOfType([Ce.number,Ce.string]),gender:Ce.string,location:Ce.string,maritalStatus:Ce.string,iAm:Ce.string,lookingFor:Ce.arrayOf(Ce.string),intoTags:Ce.arrayOf(Ce.string),interests:Ce.arrayOf(Ce.string)})}).isRequired,isLiked:Ce.bool,onLike:Ce.func,viewMode:Ce.oneOf(["grid","list"]),onMessage:Ce.func,onClick:Ce.func,showExtendedDetails:Ce.bool,unreadMessageCount:Ce.number,hasUnreadMessages:Ce.bool};const oN=Jj(Xb,(t,e)=>t.user._id===e.user._id&&t.isLiked===e.isLiked&&t.viewMode===e.viewMode&&t.hasUnreadMessages===e.hasUnreadMessages&&t.unreadMessageCount===e.unreadMessageCount&&t.user.isOnline===e.user.isOnline,{debug:!1}),lN="_modalContainer_cb97z_4",cN="_modalHeader_cb97z_13",uN="_profileContent_cb97z_57",dN="_profileLayout_cb97z_63",fN="_photosSection_cb97z_76",hN="_storiesThumbnail_cb97z_85",mN="_galleryContainer_cb97z_92",gN="_gallery_cb97z_92",pN="_imageContainer_cb97z_108",yN="_galleryImage_cb97z_115",vN="_nav_cb97z_123",bN="_navPrev_cb97z_148",xN="_navNext_cb97z_152",wN="_thumbnails_cb97z_157",_N="_thumbnail_cb97z_157",SN="_thumbnailActive_cb97z_192",jN="_thumbnailImg_cb97z_197",CN="_privatePhoto_cb97z_204",NN="_lockIcon_cb97z_216",TN="_privateThumbnail_cb97z_222",kN="_permissionStatus_cb97z_233",EN="_pending_cb97z_244",AN="_approved_cb97z_249",RN="_rejected_cb97z_254",MN="_requestAccessBtn_cb97z_259",LN="_onlineBadge_cb97z_282",ON="_pulse_cb97z_299",DN="_actions_cb97z_332",BN="_actionBtn_cb97z_344",zN="_likeBtn_cb97z_359",PN="_likedBtn_cb97z_369",$N="_messageBtn_cb97z_379",UN="_moreActions_cb97z_391",IN="_toggleBtn_cb97z_395",FN="_dropdown_cb97z_412",qN="_dropdownItem_cb97z_424",VN="_detailsSection_cb97z_444",HN="_headline_cb97z_453",GN="_headlineTitle_cb97z_460",YN="_premiumBadge_cb97z_467",XN="_location_cb97z_480",KN="_icon_cb97z_489",QN="_onlineStatus_cb97z_493",WN="_isOnline_cb97z_502",ZN="_activity_cb97z_507",JN="_activityItem_cb97z_515",e7="_compatibilitySection_cb97z_523",t7="_sectionTitle_cb97z_531",n7="_compatibilityScore_cb97z_538",s7="_scoreCircle_cb97z_544",i7="_scoreBg_cb97z_556",a7="_scoreFill_cb97z_562",r7="_scoreValue_cb97z_570",o7="_compatibilityDetails_cb97z_580",l7="_compatibilityFactor_cb97z_584",c7="_factorLabel_cb97z_588",u7="_factorBar_cb97z_596",d7="_factorFill_cb97z_603",f7="_section_cb97z_531",h7="_aboutText_cb97z_616",m7="_tagsContainer_cb97z_624",g7="_tag_cb97z_624",p7="_lookingForTag_cb97z_646",y7="_intoTag_cb97z_651",v7="_turnOnTag_cb97z_656",b7="_identityTag_cb97z_661",x7="_statusTag_cb97z_666",w7="_identityWoman_cb97z_671",_7="_identityMan_cb97z_676",S7="_identityCouple_cb97z_681",j7="_interestsTags_cb97z_687",C7="_moreCount_cb97z_694",N7="_interestTag_cb97z_705",T7="_commonTag_cb97z_722",k7="_commonIcon_cb97z_727",E7="_showMoreBtn_cb97z_731",A7="_requestNotification_cb97z_747",R7="_notificationContent_cb97z_758",M7="_notificationIcon_cb97z_764",L7="_notificationText_cb97z_769",O7="_notificationActions_cb97z_775",D7="_approveBtn_cb97z_781",B7="_rejectBtn_cb97z_801",z7="_spinner_cb97z_822",P7="_spin_cb97z_822",$7="_loadingContainer_cb97z_836",U7="_errorContainer_cb97z_837",I7="_notFoundContainer_cb97z_838",F7="_loadingTitle_cb97z_848",q7="_errorTitle_cb97z_849",V7="_notFoundTitle_cb97z_850",H7="_errorText_cb97z_857",G7="_notFoundText_cb97z_858",Y7="_chatOverlay_cb97z_926",ye={modalContainer:lN,modalHeader:cN,profileContent:uN,profileLayout:dN,photosSection:fN,storiesThumbnail:hN,galleryContainer:mN,gallery:gN,imageContainer:pN,galleryImage:yN,nav:vN,navPrev:bN,navNext:xN,thumbnails:wN,thumbnail:_N,thumbnailActive:SN,thumbnailImg:jN,privatePhoto:CN,lockIcon:NN,privateThumbnail:TN,permissionStatus:kN,pending:EN,approved:AN,rejected:RN,requestAccessBtn:MN,onlineBadge:LN,pulse:ON,actions:DN,actionBtn:BN,likeBtn:zN,likedBtn:PN,messageBtn:$N,moreActions:UN,toggleBtn:IN,dropdown:FN,dropdownItem:qN,detailsSection:VN,headline:HN,headlineTitle:GN,premiumBadge:YN,location:XN,icon:KN,onlineStatus:QN,isOnline:WN,activity:ZN,activityItem:JN,compatibilitySection:e7,sectionTitle:t7,compatibilityScore:n7,scoreCircle:s7,scoreBg:i7,scoreFill:a7,scoreValue:r7,compatibilityDetails:o7,compatibilityFactor:l7,factorLabel:c7,factorBar:u7,factorFill:d7,section:f7,aboutText:h7,tagsContainer:m7,tag:g7,lookingForTag:p7,intoTag:y7,turnOnTag:v7,identityTag:b7,statusTag:x7,identityWoman:w7,identityMan:_7,identityCouple:S7,interestsTags:j7,moreCount:C7,interestTag:N7,commonTag:T7,commonIcon:k7,showMoreBtn:E7,requestNotification:A7,notificationContent:R7,notificationIcon:M7,notificationText:L7,notificationActions:O7,approveBtn:D7,rejectBtn:B7,spinner:z7,spin:P7,loadingContainer:$7,errorContainer:U7,notFoundContainer:I7,loadingTitle:F7,errorTitle:q7,notFoundTitle:V7,errorText:H7,notFoundText:G7,chatOverlay:Y7},X7=({userId:t,isOpen:e,onClose:i})=>{var mn,is,Ds,fe,Me,He,dt,Et,oe,We,bt,vt,ft,rt,sn,Gn;const{user:a}=Sn(),{getUser:c,currentUser:u,likeUser:d,unlikeUser:h,isUserLiked:p,error:y,blockUser:g,reportUser:w,sendMessage:C}=ka(),{loadUserStories:j,hasUnviewedStories:N}=Lr(),[M,D]=b.useState([]),[I,V]=b.useState(!1),[F,O]=b.useState(0),[A,H]=b.useState(!1),[E,L]=b.useState(!1),[P,G]=b.useState(!1),[Q,z]=b.useState({}),[ae,Pe]=b.useState(!1),[Ee,K]=b.useState(!1),[q,J]=b.useState([]),[re,Ne]=b.useState(!1),[Se,Ve]=b.useState(!1),[ge,ee]=b.useState(null),[Re,he]=b.useState(!1),[Ue,ze]=b.useState({status:null,isLoading:!1}),Xe=b.useRef(null),Qe=b.useRef(!1),Ge=b.useRef(!1),at=b.useRef(!1),yt=In(),mt=tm(),{isMounted:Ie}=Yb(),qe=An.create("UserProfileModal"),jt=b.useMemo(()=>a&&u&&a._id===u._id,[a,u]),Ct=b.useMemo(()=>!u||!a?0:Bt(),[u,a]),Rt=b.useMemo(()=>{var Oe;return!u||!a||!((Oe=u.details)!=null&&Oe.interests)?[]:u.details.interests.filter(nt=>{var wt,an;return(an=(wt=a.details)==null?void 0:wt.interests)==null?void 0:an.includes(nt)})},[u,a]),pe=b.useMemo(()=>q.some(Oe=>Oe.user&&u&&Oe.user._id===u._id),[q,u]),je=b.useMemo(()=>q.find(Oe=>Oe.user&&u&&Oe.user._id===u._id),[q,u]),Je=Ue.status==="approved",_t=b.useRef(null);b.useEffect(()=>!t||!e||_t.current===t?void 0:((async()=>{he(!0),_t.current=t;try{await new Promise(wt=>setTimeout(wt,50));const nt=await c(t);if(!Ie())return;qe.debug("User data received:",nt),ee(nt)}catch(nt){Ie()&&(qe.error("Error fetching user:",nt),he(!1))}finally{Ie()&&he(!1)}})(),()=>{e||(_t.current=null)}),[t,e,Ie]),b.useCallback(()=>{console.log("This function is no longer used - direct API call is made instead")},[]);const ke=b.useCallback(async()=>{if(!(!a||at.current||!Ie())){at.current=!0,Ne(!0);try{qe.debug("Fetching pending photo access requests");const Oe=await mt.get("/users/photos/permissions?status=pending");if(!Ie())return;if(Oe&&Oe.success){const nt=Array.isArray(Oe)?Oe:Array.isArray(Oe.data)?Oe.data:null;if(nt){const wt={};nt.forEach(Wt=>{if(Wt&&Wt.requestedBy&&Wt.requestedBy._id){const Wn=Wt.requestedBy._id;wt[Wn]||(wt[Wn]={user:Wt.requestedBy,requests:[]}),wt[Wn].requests.push(Wt)}});const an=Object.values(wt);J(Wt=>{if(Wt.length!==an.length)return an;try{const Wn=JSON.stringify(Wt),Js=JSON.stringify(an);return Wn===Js?Wt:an}catch(Wn){return qe.warn("JSON comparison failed:",Wn),an}}),qe.debug(`Processed ${an.length} pending request groups`)}else qe.warn("No valid requests data in response:",Oe),J(wt=>wt.length>0?[]:wt)}else qe.warn("Failed to fetch pending requests:",Oe),J(nt=>nt.length>0?[]:nt)}catch(Oe){if(!Ie())return;qe.error("Error fetching pending requests:",Oe),Oe.message&&!Oe.message.includes("no pending requests")&&ne.error("Failed to load photo access requests"),J(nt=>nt.length>0?[]:nt)}finally{Ie()&&(Ne(!1),at.current=!1)}}},[a,mt,Ie]),Ke=b.useRef(!1),ht=b.useRef(!1),B=b.useRef(!1),R=b.useRef(!1);b.useEffect(()=>{if(!t||!e){B.current&&(B.current=!1,Ke.current=!1,ht.current=!1,Ge.current=!1,Qe.current=!1,at.current=!1,R.current=!1,V(!1),G(!1),ze({status:null,isLoading:!1}),z({}),Pe(!1),K(!1),O(0),D([]),J([]),qe.debug(`Modal cleanup ran for userId: ${t}`));return}B.current||(B.current=!0,qe.debug(`Modal opened for userId: ${t}, dataLoadedRef: ${Ke.current}`),O(0),L(!1),H(!1),z({}),V(!1),G(!1),ze({status:null,isLoading:!1}),he(!1),Pe(!1),K(!1),Ne(!1),Ve(!1)),!Qe.current&&!Ke.current&&(Qe.current=!0,Promise.resolve(j==null?void 0:j(t)).then(Oe=>{Ie()&&Oe&&Array.isArray(Oe)&&D(Oe)}).catch(Oe=>{qe.error("Error loading stories:",Oe)}).finally(()=>{Ie()&&(Qe.current=!1)})),!Ge.current&&!R.current&&(R.current=!0,Ge.current=!0,mt.get(`/users/${t}/photo-access-status`).then(Oe=>{if(Ie())if(qe.debug("Received photo access status response:",Oe),Oe&&Oe.success){const nt=Oe.status||Oe.data&&Oe.data.status||null;nt?Ie()&&ze(wt=>wt.status!==nt?{status:nt,isLoading:!1}:wt):(ze({status:"none",isLoading:!1}),qe.debug("No status value in response, defaulting to 'none'"))}else Oe?(qe.warn("Unsuccessful photo access status response:",Oe),ze({status:"none",isLoading:!1})):(qe.warn("Empty photo access status response"),ze({status:"none",isLoading:!1}))}).catch(Oe=>{Ie()&&(qe.error("Error loading photo access status:",Oe),ze({status:"none",isLoading:!1}))}).finally(()=>{Ie()&&(Ge.current=!1)})),a&&a._id===t&&!at.current&&!Ke.current&&ke(),Ke.current||(Ke.current=!0)},[t,j,a,e,Ie,mt,ke]);const Y=async()=>{if(!u||!u._id||Ue.isLoading){qe.warn("Cannot request photo access: missing user ID or already loading");return}if(!Ue.isLoading){ze(nt=>({...nt,isLoading:!0}));try{qe.debug(`Requesting photo access for user ${u._id}`),ze({status:"pending",isLoading:!1}),ne.success("Access to photos requested");try{const nt=await mt.post(`/users/${u._id}/request-photo-access`);if(!Ie())return;nt&&nt.success?qe.debug("Photo access request successful:",nt.message||"Request processed"):nt?qe.info("Photo access request partially successful:",nt):qe.warn("Photo access request returned empty response but UI shows success")}catch(nt){qe.error("Backend error in photo access request (UI unaffected):",nt)}}catch(nt){if(!Ie())return;qe.error("Error in photo access request flow:",nt),ze({status:"pending",isLoading:!1}),ne.success("Access to photos requested")}}},_=async(Oe,nt)=>{if(!Oe||!Ht(Oe)||!nt||!Array.isArray(nt)||nt.length===0){qe.warn("Invalid user ID or empty requests array for approval");return}if(Se){qe.warn("Already processing approval/rejection request");return}Ve(!0);try{qe.debug(`Approving all photo requests from user ${Oe}`);const wt=await mt.put(`/users/${Oe}/approve-photo-access`);if(!Ie())return;wt&&wt.success?(ne.success("Approved all photo requests from this user"),qe.debug("Successfully approved photo requests"),J(an=>an.filter(Wt=>!Wt.user||Wt.user._id!==Oe))):(qe.warn("Failed to approve photo requests:",wt),ne.error((wt==null?void 0:wt.error)||"Failed to approve photo requests"))}catch(wt){if(!Ie())return;qe.error("Error approving requests:",wt),ne.error((wt==null?void 0:wt.error)||"Failed to approve photo requests")}finally{Ie()&&Ve(!1)}},v=async(Oe,nt)=>{if(!Oe||!Ht(Oe)||!nt||!Array.isArray(nt)||nt.length===0){qe.warn("Invalid user ID or empty requests array for rejection");return}if(Se){qe.warn("Already processing approval/rejection request");return}Ve(!0);try{qe.debug(`Rejecting all photo requests from user ${Oe}`);const wt=await mt.put(`/users/${Oe}/reject-photo-access`);if(!Ie())return;wt&&wt.success?(ne.success("Rejected all photo requests from this user"),qe.debug("Successfully rejected photo requests"),J(an=>an.filter(Wt=>!Wt.user||Wt.user._id!==Oe))):(qe.warn("Failed to reject photo requests:",wt),ne.error((wt==null?void 0:wt.error)||"Failed to reject photo requests"))}catch(wt){if(!Ie())return;qe.error("Error rejecting requests:",wt),ne.error((wt==null?void 0:wt.error)||"Failed to reject photo requests")}finally{Ie()&&Ve(!1)}},x=b.useCallback(Oe=>{var wt;qe.debug(`Image with ID ${Oe} failed to load`),z(an=>({...an,[Oe]:!0}));const nt=(wt=u==null?void 0:u.photos)==null?void 0:wt.find(an=>an._id===Oe);nt&&nt.url&&(nt.url.includes("unsplash.com")||!nt.url.startsWith(window.location.origin))&&ob(nt.url)},[u]),T=async()=>{if(!(!u||ae)){Pe(!0);try{p&&p(u._id)?await h(u._id,u.nickname):await d(u._id,u.nickname)}catch(Oe){qe.error("Error toggling like:",Oe),ne.error("Failed to update like status")}finally{Ie()&&Pe(!1)}}},U=async()=>{if(t)try{await g(t),ne.success("User blocked successfully"),i()}catch(Oe){qe.error("Error blocking user:",Oe),ne.error("Failed to block user")}},X=async()=>{if(t)try{await w(t),ne.success("User reported successfully"),i()}catch(Oe){qe.error("Error reporting user:",Oe),ne.error("Failed to report user")}},le=async()=>{if(t){K(!0);try{await C(t),yt("/messages"),i()}catch(Oe){qe.error("Error sending message:",Oe),ne.error("Failed to start conversation")}finally{Ie()&&K(!1)}}},Ze=()=>G(!0),we=()=>G(!1),_e=()=>V(!1),Le=()=>{u!=null&&u.photos&&F<u.photos.length-1&&O(F+1)},Ye=()=>{F>0&&O(F-1)};function Bt(){if(!(u!=null&&u.details)||!(a!=null&&a.details))return 0;let Oe=0;u.details.location===a.details.location&&(Oe+=25);const nt=Math.abs((u.details.age||0)-(a.details.age||0));nt<=5?Oe+=25:nt<=10?Oe+=15:Oe+=5;const wt=u.details.interests||[],an=a.details.interests||[],Wt=wt.filter(Wn=>an.includes(Wn)).length;return Oe+=Math.min(50,Wt*10),Math.min(100,Oe)}const xt=Oe=>!Oe||typeof Oe!="string"?"":Oe.charAt(0).toUpperCase()+Oe.slice(1),Ht=Oe=>Oe&&typeof Oe=="string"&&/^[0-9a-fA-F]{24}$/.test(Oe);return e?Re?o.jsx(Uo,{isOpen:e,onClose:i,size:"large",children:o.jsx("div",{className:ye.loadingContainer,children:o.jsx(mu,{text:"Loading profile...",size:"large",centered:!0})})}):y?o.jsx(Uo,{isOpen:e,onClose:i,size:"small",children:o.jsxs("div",{className:ye.errorContainer,children:[o.jsx("h3",{className:ye.errorTitle,children:"Error Loading Profile"}),o.jsx("p",{className:ye.errorText,children:y}),o.jsx(Rs,{variant:"primary",onClick:i,children:"Close"})]})}):u?o.jsx(Uo,{isOpen:e,onClose:i,size:"xlarge",className:ye.modalContainer,showCloseButton:!0,headerClassName:ye.modalHeader,bodyClassName:"modern-user-profile",closeOnClickOutside:!0,children:o.jsxs("div",{className:ye.profileContent,ref:Xe,children:[!jt&&pe&&je&&o.jsxs("div",{className:ye.requestNotification,children:[o.jsxs("div",{className:ye.notificationContent,children:[o.jsx(wr,{className:ye.notificationIcon}),o.jsxs("p",{className:ye.notificationText,children:[o.jsx("strong",{children:u.nickname})," has requested access to your private photos"]})]}),o.jsxs("div",{className:ye.notificationActions,children:[o.jsxs("button",{className:ye.approveBtn,onClick:()=>_(u._id,je.requests),disabled:Se,children:[Se?o.jsx(ws,{className:ye.spinner}):o.jsx(Lt,{}),"Approve"]}),o.jsxs("button",{className:ye.rejectBtn,onClick:()=>v(u._id,je.requests),disabled:Se,children:[Se?o.jsx(ws,{className:ye.spinner}):o.jsx(dh,{}),"Reject"]})]})]}),o.jsxs("div",{className:ye.profileLayout,children:[o.jsxs("div",{className:ye.photosSection,children:[M&&M.length>0&&o.jsx("div",{className:ye.storiesThumbnail,children:o.jsx(nm,{user:u,hasUnviewedStories:N&&N(u._id),onClick:Ze})}),u&&u.photos&&u.photos.length>0?o.jsxs("div",{className:ye.galleryContainer,children:[o.jsxs("div",{className:ye.gallery,children:[u.photos[F]&&u.photos[F].isPrivate&&!Je?o.jsxs("div",{className:ye.privatePhoto,children:[o.jsx(Ss,{className:ye.lockIcon}),o.jsx("p",{children:"Private Photo"}),Ue.status==="pending"&&o.jsx("p",{className:`${ye.permissionStatus} ${ye.pending}`,children:"Access Request Pending"}),Ue.status==="rejected"&&o.jsx("p",{className:`${ye.permissionStatus} ${ye.rejected}`,children:"Access Denied"}),(!Ue.status||Ue.status==="none")&&o.jsxs("button",{className:ye.requestAccessBtn,onClick:Y,disabled:Ue.isLoading,children:[Ue.isLoading?o.jsx(ws,{className:ye.spinner}):null,"Request Photo Access"]})]}):u.photos[F]&&o.jsx("div",{className:ye.imageContainer,children:o.jsx("img",{src:u.photos[F].url,alt:`${u.nickname}'s photo`,className:ye.galleryImage,onError:()=>x(u.photos[F]._id)})}),u.isOnline&&o.jsxs("div",{className:ye.onlineBadge,children:[o.jsx("span",{className:ye.pulse}),"Online Now"]}),u.photos.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:`${ye.nav} ${ye.navPrev}`,onClick:Ye,disabled:F===0,"aria-label":"Previous photo",children:o.jsx(Gh,{})}),o.jsx("button",{className:`${ye.nav} ${ye.navNext}`,onClick:Le,disabled:F===u.photos.length-1,"aria-label":"Next photo",children:o.jsx(mb,{})})]})]}),u.photos.length>1&&o.jsx("div",{className:ye.thumbnails,children:u.photos.map((Oe,nt)=>o.jsx("div",{className:`${ye.thumbnail} ${nt===F?ye.thumbnailActive:""}`,onClick:()=>O(nt),children:Oe.isPrivate&&!Je?o.jsxs("div",{className:ye.privateThumbnail,children:[o.jsx(Ss,{}),Ue.status&&o.jsxs("div",{className:`${ye.permissionStatus} ${ye[Ue.status]}`,children:[Ue.status==="pending"&&"Pending",Ue.status==="approved"&&"Granted",Ue.status==="rejected"&&"Denied"]})]}):o.jsx("img",{src:Oe.url,alt:`${u.nickname} ${nt+1}`,className:ye.thumbnailImg,onError:()=>x(Oe._id)})},Oe._id||nt))})]}):o.jsxs("div",{className:ye.gallery,children:[o.jsx(Hb,{size:"xlarge",placeholder:"/default-avatar.png",alt:u.nickname,status:u.isOnline?"online":null}),o.jsx("p",{children:"No photos available"})]}),o.jsxs("div",{className:ye.actions,children:[!jt&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:`${ye.actionBtn} ${p&&p(u._id)?ye.likedBtn:ye.likeBtn}`,onClick:T,disabled:ae,children:[ae?o.jsx(ws,{className:ye.spinner}):o.jsx(vi,{}),p&&p(u._id)?"Liked":"Like"]}),o.jsxs("button",{className:`${ye.actionBtn} ${ye.messageBtn}`,onClick:le,disabled:Ee,children:[Ee?o.jsx(ws,{className:ye.spinner}):o.jsx(Ta,{}),"Message"]})]}),o.jsxs("div",{className:ye.moreActions,children:[o.jsx("button",{className:ye.toggleBtn,onClick:()=>H(!A),"aria-label":"More actions",children:o.jsx(yb,{})}),A&&o.jsxs("div",{className:ye.dropdown,children:[o.jsxs("button",{className:ye.dropdownItem,onClick:X,children:[o.jsx(bb,{}),"Report User"]}),o.jsxs("button",{className:ye.dropdownItem,onClick:U,children:[o.jsx(dh,{}),"Block User"]})]})]})]})]}),o.jsxs("div",{className:ye.detailsSection,children:[o.jsxs("div",{className:ye.headline,children:[o.jsxs("h1",{className:ye.headlineTitle,children:[u.nickname,", ",((mn=u.details)==null?void 0:mn.age)||"?"]}),u.role==="premium"&&o.jsxs("div",{className:ye.premiumBadge,children:[o.jsx(_b,{})," Premium"]})]}),o.jsxs("div",{className:ye.location,children:[o.jsx(Tr,{className:ye.icon}),o.jsx("span",{children:((is=u.details)==null?void 0:is.location)||"Unknown location"}),o.jsx("div",{className:`${ye.onlineStatus} ${u.isOnline?ye.isOnline:""}`,children:u.isOnline?"Online now":"Offline"})]}),o.jsxs("div",{className:ye.activity,children:[o.jsxs("div",{className:ye.activityItem,children:[o.jsx(Sb,{className:ye.icon}),o.jsx("span",{children:u.isOnline?"Active now":`Last active ${Kc(u.lastActive,{showTime:!1})}`})]}),o.jsxs("div",{className:ye.activityItem,children:[o.jsx(Hh,{className:ye.icon}),o.jsxs("span",{children:["Member since ",Kc(u.createdAt,{showTime:!1})]})]})]}),!jt&&o.jsxs("div",{className:ye.compatibilitySection,children:[o.jsx("h2",{className:ye.sectionTitle,children:"Compatibility"}),o.jsxs("div",{className:ye.compatibilityScore,children:[o.jsxs("div",{className:ye.scoreCircle,children:[o.jsxs("svg",{viewBox:"0 0 100 100",children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"compatibility-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[o.jsx("stop",{offset:"0%",stopColor:"#ff3366"}),o.jsx("stop",{offset:"100%",stopColor:"#ff6b98"})]})}),o.jsx("circle",{className:ye.scoreBg,cx:"50",cy:"50",r:"45"}),o.jsx("circle",{className:ye.scoreFill,cx:"50",cy:"50",r:"45",strokeDasharray:"283",strokeDashoffset:283-283*Ct/100})]}),o.jsxs("div",{className:ye.scoreValue,children:[Ct,"%"]})]}),o.jsxs("div",{className:ye.compatibilityDetails,children:[o.jsxs("div",{className:ye.compatibilityFactor,children:[o.jsx("span",{className:ye.factorLabel,children:"Location"}),o.jsx("div",{className:ye.factorBar,children:o.jsx("div",{className:ye.factorFill,style:{width:((Ds=u.details)==null?void 0:Ds.location)===((fe=a==null?void 0:a.details)==null?void 0:fe.location)?"100%":"30%"}})})]}),o.jsxs("div",{className:ye.compatibilityFactor,children:[o.jsx("span",{className:ye.factorLabel,children:"Age"}),o.jsx("div",{className:ye.factorBar,children:o.jsx("div",{className:ye.factorFill,style:{width:Math.abs((((Me=u.details)==null?void 0:Me.age)||0)-(((He=a==null?void 0:a.details)==null?void 0:He.age)||0))<=5?"90%":Math.abs((((dt=u.details)==null?void 0:dt.age)||0)-(((Et=a==null?void 0:a.details)==null?void 0:Et.age)||0))<=10?"60%":"30%"}})})]}),o.jsxs("div",{className:ye.compatibilityFactor,children:[o.jsx("span",{className:ye.factorLabel,children:"Interests"}),o.jsx("div",{className:ye.factorBar,children:o.jsx("div",{className:ye.factorFill,style:{width:`${Math.min(100,Rt.length*20)}%`}})})]})]})]})]}),((oe=u.details)==null?void 0:oe.bio)&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"About Me"}),o.jsx("p",{className:ye.aboutText,children:u.details.bio})]}),((We=u.details)==null?void 0:We.iAm)&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"I am a"}),o.jsx("div",{className:ye.tagsContainer,children:o.jsx("span",{className:`${ye.tag} ${ye.identityTag}`,children:xt(u.details.iAm)})})]}),((bt=u.details)==null?void 0:bt.maritalStatus)&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"Marital Status"}),o.jsx("div",{className:ye.tagsContainer,children:o.jsx("span",{className:`${ye.tag} ${ye.statusTag}`,children:u.details.maritalStatus})})]}),((vt=u.details)==null?void 0:vt.lookingFor)&&u.details.lookingFor.length>0&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"Looking For"}),o.jsx("div",{className:ye.tagsContainer,children:u.details.lookingFor.map((Oe,nt)=>o.jsx("span",{className:`${ye.tag} ${ye.lookingForTag}`,children:Oe},nt))})]}),((ft=u.details)==null?void 0:ft.intoTags)&&u.details.intoTags.length>0&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"I'm Into"}),o.jsx("div",{className:ye.tagsContainer,children:u.details.intoTags.map((Oe,nt)=>o.jsx("span",{className:`${ye.tag} ${ye.intoTag}`,children:Oe},nt))})]}),((rt=u.details)==null?void 0:rt.turnOns)&&u.details.turnOns.length>0&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"It Turns Me On"}),o.jsx("div",{className:ye.tagsContainer,children:u.details.turnOns.map((Oe,nt)=>o.jsx("span",{className:`${ye.tag} ${ye.turnOnTag}`,children:Oe},nt))})]}),((Gn=(sn=u.details)==null?void 0:sn.interests)==null?void 0:Gn.length)>0&&o.jsxs("div",{className:ye.section,children:[o.jsx("h2",{className:ye.sectionTitle,children:"Interests"}),o.jsxs("div",{className:ye.interestsTags,children:[(E?u.details.interests:u.details.interests.slice(0,8)).map(Oe=>o.jsxs("span",{className:`${ye.interestTag} ${Rt.includes(Oe)?ye.commonTag:""}`,children:[Oe,Rt.includes(Oe)&&o.jsx(Lt,{className:ye.commonIcon})]},Oe)),!E&&u.details.interests.length>8&&o.jsxs("button",{className:ye.showMoreBtn,onClick:()=>L(!0),children:["+",u.details.interests.length-8," more"]})]})]})]})]}),I&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:ye.chatOverlay,onClick:_e}),o.jsx(ul,{recipient:u,isOpen:I,onClose:_e})]}),P&&o.jsx(sm,{userId:u._id,onClose:we})]})}):o.jsx(Uo,{isOpen:e,onClose:i,size:"small",children:o.jsxs("div",{className:ye.notFoundContainer,children:[o.jsx("h3",{className:ye.notFoundTitle,children:"User Not Found"}),o.jsx("p",{className:ye.notFoundText,children:"The user you're looking for doesn't exist or has been removed."}),o.jsx(Rs,{variant:"primary",onClick:i,children:"Close"})]})}):null},K7="_dashboardPage_cwaag_3",Q7="_dashboardContent_cwaag_20",W7="_container_cwaag_30",Z7="_gradientBar_cwaag_56",J7="_storiesSection_cwaag_67",eT="_storiesHeader_cwaag_84",tT="_storiesTitle_cwaag_97",nT="_dashboardHeader_cwaag_108",sT="_dashboardTitle_cwaag_124",iT="_dashboardSubtitle_cwaag_134",aT="_dashboardActions_cwaag_140",rT="_viewToggle_cwaag_146",oT="_viewToggleButton_cwaag_158",lT="_active_cwaag_177",cT="_filterButton_cwaag_184",uT="_filterPanel_cwaag_214",dT="_filterSection_cwaag_227",fT="_filterOptions_cwaag_242",hT="_rangeSlider_cwaag_248",mT="_rangeValues_cwaag_253",gT="_rangeValue_cwaag_253",pT="_rangeInput_cwaag_268",yT="_filterOption_cwaag_242",vT="_tagsContainer_cwaag_350",bT="_filterTag_cwaag_357",xT="_filterActions_cwaag_398",wT="_usersSection_cwaag_406",_T="_usersGrid_cwaag_417",ST="_usersList_cwaag_424",jT="_userCardWrapper_cwaag_431",CT="_contentLoader_cwaag_441",NT="_loadingContainer_cwaag_450",TT="_spinner_cwaag_455",kT="_loadingText_cwaag_466",ET="_noResultsIcon_cwaag_472",AT="_chatOverlay_cwaag_484",ct={dashboardPage:K7,dashboardContent:Q7,container:W7,gradientBar:Z7,storiesSection:J7,storiesHeader:eT,storiesTitle:tT,dashboardHeader:nT,dashboardTitle:sT,dashboardSubtitle:iT,dashboardActions:aT,viewToggle:rT,viewToggleButton:oT,active:lT,filterButton:cT,filterPanel:uT,filterSection:dT,filterOptions:fT,rangeSlider:hT,rangeValues:mT,rangeValue:gT,rangeInput:pT,filterOption:yT,tagsContainer:vT,filterTag:bT,filterActions:xT,usersSection:wT,usersGrid:_T,usersList:ST,userCardWrapper:jT,contentLoader:CT,loadingContainer:NT,spinner:TT,loadingText:kT,noResultsIcon:ET,chatOverlay:AT},RT=()=>{In();const{user:t}=Sn(),{users:e,getUsers:i,loading:a,likeUser:c,unlikeUser:u,isUserLiked:d,likesLoading:h,getLikedUsers:p}=ka(),y=0,{createStory:g}=Lr(),[w,C]=b.useState(1),[j,N]=b.useState(!0),[M,D]=b.useState(!1),I=b.useRef(),V=b.useRef(null),[F,O]=b.useState("discover"),[A,H]=b.useState(!1),[E,L]=b.useState({ageMin:18,ageMax:99,distance:100,online:!1,verified:!1,withPhotos:!1,interests:[]}),[P,G]=b.useState(null),[Q,z]=b.useState(!1),[ae,Pe]=b.useState("grid"),[Ee,K]=b.useState({}),[q,J]=b.useState(!1),[re,Ne]=b.useState(null),[Se,Ve]=b.useState(!1),[ge,ee]=b.useState(null),[Re,he]=b.useState(!1),[Ue,ze]=b.useState(!1);b.useCallback(ke=>{K(Ke=>({...Ke,[ke]:!0}))},[]),b.useEffect(()=>{Xe(1).then(()=>{ze(!0)})},[E]);const Xe=b.useCallback(async ke=>{D(ke!==1);try{const Ke=await i(ke,20);return N(Ke.hasMore),C(ke),Ke}catch(Ke){return console.error("Error loading users:",Ke),ne.error("Failed to load users. Please try again."),null}finally{D(!1)}},[i]),Qe=b.useCallback(()=>{!M&&j&&Xe(w+1)},[M,j,w,Xe]);b.useEffect(()=>{const ke=I.current;return ke&&ke.disconnect(),I.current=new IntersectionObserver(Ke=>{Ke[0].isIntersecting&&j&&!M&&!a&&Qe()},{root:null,threshold:.1,rootMargin:"100px"}),V.current&&j&&I.current.observe(V.current),()=>{ke&&ke.disconnect()}},[j,M,a,Qe,e.length]),b.useEffect(()=>{const ke=setInterval(()=>{document.visibilityState==="visible"&&Xe(1)},3e5),Ke=()=>{document.visibilityState==="visible"&&Xe(1)};return document.addEventListener("visibilitychange",Ke),()=>{clearInterval(ke),document.removeEventListener("visibilitychange",Ke),z(!1),G(null)}},[Xe]);const Ge=b.useMemo(()=>e.filter(ke=>{var ht,B;if(ke._id===(t==null?void 0:t._id))return!1;const Ke=((ht=ke.details)==null?void 0:ht.age)||25;if(Ke<E.ageMin||Ke>E.ageMax||E.online&&!ke.isOnline||E.withPhotos&&(!ke.photos||ke.photos.length===0))return!1;if(E.interests.length>0){const R=((B=ke.details)==null?void 0:B.interests)||[];if(!E.interests.some(_=>R.includes(_)))return!1}return!0}),[e,t,E]),at=b.useMemo(()=>{const ke=new Map;return Ge.forEach(ht=>{ht&&ht._id&&ke.set(ht._id,ht)}),Array.from(ke.values()).sort((ht,B)=>ht.isOnline&&!B.isOnline?-1:!ht.isOnline&&B.isOnline?1:new Date(B.lastActive)-new Date(ht.lastActive))},[Ge]),yt=["Dating","Casual","Friendship","Long-term","Travel","Outdoors","Movies","Music","Fitness","Food","Art"],mt=ke=>{L(Ke=>Ke.interests.includes(ke)?{...Ke,interests:Ke.interests.filter(ht=>ht!==ke)}:{...Ke,interests:[...Ke.interests,ke]})},Ie=ke=>{ee(ke),he(!0)},qe=(ke,Ke)=>{ke.stopPropagation(),G(Ke),z(!0)},jt=()=>{z(!1),G(null)},Ct=ke=>{if(!g||Se){ne.info(Se?"Story creation in progress, please wait...":"Story creation is not available right now");return}Ve(!0),g(ke).then(Ke=>{Ke.success?(ne.success("Your story has been created!"),J(!1)):ne.error(Ke.error||"Failed to create story")}).catch(Ke=>{ne.error("An error occurred while creating your story"),console.error("Story creation error:",Ke)}).finally(()=>{Ve(!1)})};b.useEffect(()=>{K({})},[E]);const Rt=b.useCallback(ke=>Array.isArray(y)&&y.some(Ke=>Ke.sender===ke),[y]),pe=b.useCallback(ke=>Array.isArray(y)?y.filter(Ke=>Ke.sender===ke).length:0,[y]),je=b.useCallback(()=>{L({ageMin:18,ageMax:99,distance:100,online:!1,verified:!1,withPhotos:!1,interests:[]}),C(1),N(!0)},[]);b.useEffect(()=>{const ke=()=>{window.innerHeight+document.documentElement.scrollTop>=document.documentElement.scrollHeight-300&&j&&!M&&!a&&Qe()};return window.addEventListener("scroll",ke),()=>window.removeEventListener("scroll",ke)},[j,M,a,Qe]);const Je=b.useCallback((ke,Ke)=>{d(ke)?u(ke,Ke).then(B=>{B&&setTimeout(()=>p(!0),300)}):c(ke,Ke).then(B=>{B&&setTimeout(()=>p(!0),300)})},[d,u,c,p]),_t=(a||h)&&w===1&&!Ue;return o.jsxs("div",{className:ct.dashboardPage,children:[o.jsx(kr,{}),o.jsx("main",{className:ct.dashboardContent,children:o.jsxs("div",{className:ct.container,children:[o.jsx("div",{className:ct.gradientBar}),o.jsxs("div",{className:ct.storiesSection,children:[o.jsxs("div",{className:ct.storiesHeader,children:[o.jsx("h2",{className:ct.storiesTitle,children:"Stories"}),o.jsxs("button",{className:"btn btn-primary btn-sm",onClick:()=>!Se&&J(!0),"aria-label":"Create a new story",disabled:Se,children:[o.jsx(xb,{}),o.jsx("span",{children:Se?"Creating...":"Create Story"})]})]}),o.jsx(xC,{onStoryClick:ke=>{re||Ne(ke)}})]}),o.jsxs("div",{className:ct.dashboardHeader,children:[o.jsxs("div",{children:[o.jsx("h1",{className:ct.dashboardTitle,children:F==="discover"?"Discover People":"Your Matches"}),o.jsx("p",{className:ct.dashboardSubtitle,children:"Find the perfect match for you"})]}),o.jsxs("div",{className:ct.dashboardActions,children:[o.jsxs("div",{className:ct.viewToggle,children:[o.jsx("button",{className:`${ct.viewToggleButton} ${ae==="grid"?ct.active:""}`,onClick:()=>Pe("grid"),title:"Grid View","aria-label":"Grid view",children:o.jsx(A5,{})}),o.jsx("button",{className:`${ct.viewToggleButton} ${ae==="list"?ct.active:""}`,onClick:()=>Pe("list"),title:"List View","aria-label":"List view",children:o.jsx(h5,{})})]}),o.jsxs("button",{className:`${ct.filterButton} ${A?ct.active:""}`,onClick:()=>H(!A),"aria-expanded":A,"aria-label":"Toggle filters",children:[o.jsx(Xh,{}),o.jsx("span",{children:"Filters"})]})]})]}),A&&o.jsxs("div",{className:`${ct.filterPanel} animate-fade-in`,children:[o.jsxs("div",{className:ct.filterSection,children:[o.jsx("h3",{children:"Age Range"}),o.jsx("div",{className:ct.filterOptions,children:o.jsxs("div",{className:ct.rangeSlider,children:[o.jsxs("div",{className:ct.rangeValues,children:[o.jsx("span",{children:E.ageMin}),o.jsx("span",{children:E.ageMax})]}),o.jsx("input",{type:"range",min:"18",max:"99",value:E.ageMin,onChange:ke=>L({...E,ageMin:Number.parseInt(ke.target.value)}),className:ct.rangeInput,"aria-label":"Minimum age"}),o.jsx("input",{type:"range",min:"18",max:"99",value:E.ageMax,onChange:ke=>L({...E,ageMax:Number.parseInt(ke.target.value)}),className:ct.rangeInput,"aria-label":"Maximum age"})]})})]}),o.jsxs("div",{className:ct.filterSection,children:[o.jsx("h3",{children:"Distance"}),o.jsx("div",{className:ct.filterOptions,children:o.jsxs("div",{className:ct.rangeSlider,children:[o.jsx("div",{className:ct.rangeValue,children:o.jsxs("span",{children:[E.distance," km"]})}),o.jsx("input",{type:"range",min:"5",max:"100",value:E.distance,onChange:ke=>L({...E,distance:Number.parseInt(ke.target.value)}),className:ct.rangeInput,"aria-label":"Maximum distance"})]})})]}),o.jsxs("div",{className:ct.filterSection,children:[o.jsx("h3",{children:"Show Only"}),o.jsxs("div",{className:`${ct.filterOptions} d-flex flex-column`,children:[o.jsxs("label",{className:ct.filterOption,children:[o.jsx("input",{type:"checkbox",checked:E.online,onChange:()=>L({...E,online:!E.online}),"aria-label":"Show only online users"}),o.jsx("span",{children:"Online Now"})]}),o.jsxs("label",{className:ct.filterOption,children:[o.jsx("input",{type:"checkbox",checked:E.verified,onChange:()=>L({...E,verified:!E.verified}),"aria-label":"Show only verified profiles"}),o.jsx("span",{children:"Verified Profiles"})]}),o.jsxs("label",{className:ct.filterOption,children:[o.jsx("input",{type:"checkbox",checked:E.withPhotos,onChange:()=>L({...E,withPhotos:!E.withPhotos}),"aria-label":"Show only profiles with photos"}),o.jsx("span",{children:"With Photos"})]})]})]}),o.jsxs("div",{className:ct.filterSection,children:[o.jsx("h3",{children:"Interests"}),o.jsx("div",{className:ct.tagsContainer,children:yt.map(ke=>o.jsx("button",{className:`${ct.filterTag} ${E.interests.includes(ke)?ct.active:""}`,onClick:()=>mt(ke),"aria-pressed":E.interests.includes(ke),children:ke},ke))})]}),o.jsxs("div",{className:ct.filterActions,children:[o.jsx("button",{className:"btn btn-outline",onClick:je,"aria-label":"Reset filters",children:"Reset"}),o.jsx("button",{className:"btn btn-primary",onClick:()=>H(!1),"aria-label":"Apply filters",children:"Apply Filters"})]})]}),o.jsx("div",{className:ct.usersSection,children:o.jsx("div",{className:ae==="grid"?ct.usersGrid:ct.usersList,children:_t?o.jsx("div",{className:ct.contentLoader,children:o.jsxs("div",{className:ct.loadingContainer,children:[o.jsx("div",{className:ct.spinner}),o.jsx("p",{className:ct.loadingText,children:"Loading users..."})]})}):at.length>0?o.jsxs(o.Fragment,{children:[at.map((ke,Ke)=>{const ht=Ke===at.length-1;return o.jsx("div",{className:ct.userCardWrapper,ref:ht?V:null,children:o.jsx(oN,{user:ke,isLiked:d(ke._id),onLike:Je,viewMode:ae,onMessage:B=>qe(B,ke),onClick:()=>Ie(ke._id),showExtendedDetails:!0,hasUnreadMessages:Rt(ke._id),unreadMessageCount:pe(ke._id)})},ke._id)}),M&&o.jsx("div",{className:ct.contentLoader,style:{minHeight:"100px"},children:o.jsxs("div",{className:ct.loadingContainer,children:[o.jsx("div",{className:ct.spinner}),o.jsx("p",{className:ct.loadingText,children:"Loading more users..."})]})})]}):o.jsx("div",{className:ct.contentLoader,children:o.jsxs("div",{className:ct.loadingContainer,children:[o.jsx("div",{className:ct.noResultsIcon,children:o.jsx(Kh,{})}),o.jsx("h3",{children:"No matches found"}),o.jsx("p",{children:"Try adjusting your filters to see more people"}),o.jsx("button",{className:"btn btn-primary",onClick:je,"aria-label":"Reset filters",children:"Reset Filters"})]})})})})]})}),Q&&P&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:ct.chatOverlay,onClick:jt}),o.jsx(ul,{recipient:P,isOpen:Q,onClose:jt})]}),q&&o.jsx(wC,{onClose:()=>J(!1),onSubmit:Ct}),re&&o.jsx(sm,{storyId:re,onClose:()=>Ne(null)}),Re&&o.jsx(X7,{userId:ge,isOpen:Re,onClose:()=>he(!1)})]})},qc={getUserSettings:async()=>{try{console.log("Fetching user settings from /auth/me endpoint");const t=await st.get("/auth/me");if(t.success&&t.data){const e=t.data.settings||{notifications:{messages:!0,calls:!0,stories:!0,likes:!0,comments:!0},privacy:{showOnlineStatus:!0,showReadReceipts:!0,showLastSeen:!0,allowStoryReplies:"everyone"}};return console.log("Successfully fetched user settings from /auth/me:",e),{success:!0,data:e}}else return console.error("API returned unsuccessful response:",t),{success:!1,error:t.error||"Failed to fetch settings",data:null}}catch(t){return console.error("Error fetching user settings:",t),{success:!1,error:t.message||"Failed to fetch settings",data:null}}},updateSettings:async t=>{try{console.log("Updating settings via /users/profile endpoint",t);const e=await st.put("/users/profile",{settings:t});return console.log("Settings update API response:",e),e.success?{success:!0,data:t}:(console.error("API returned unsuccessful settings update response:",e),{success:!1,error:e.error||"Failed to update settings",data:null})}catch(e){return console.error("Error updating settings:",e),{success:!1,error:e.message||"Failed to update settings",data:null}}},updateNotificationSettings:async t=>{try{console.log("Updating notification settings via /users/profile endpoint",t);const e=await st.put("/users/profile",{settings:{notifications:t}});return console.log("Notification settings update API response:",e),e.success?{success:!0,data:{notifications:t}}:(console.error("API returned unsuccessful notification settings update response:",e),{success:!1,error:e.error||"Failed to update notification settings",data:null})}catch(e){return console.error("Error updating notification settings:",e),{success:!1,error:e.message||"Failed to update notification settings",data:null}}},updatePrivacySettings:async t=>{try{console.log("Updating privacy settings via /users/profile endpoint",t);const e=await st.put("/users/profile",{settings:{privacy:t}});return console.log("Privacy settings update API response:",e),e.success?{success:!0,data:{privacy:t}}:(console.error("API returned unsuccessful privacy settings update response:",e),{success:!1,error:e.error||"Failed to update privacy settings",data:null})}catch(e){return console.error("Error updating privacy settings:",e),{success:!1,error:e.message||"Failed to update privacy settings",data:null}}},deleteAccount:async t=>{try{return(await st.delete("/users/account",{data:{password:t}})).data}catch(e){throw console.error("Error deleting account:",e),e}}},MT=Object.freeze(Object.defineProperty({__proto__:null,default:qc},Symbol.toStringTag,{value:"Module"})),bh={getSubscriptionStatus:async()=>{try{console.log("Fetching subscription status...");const t=await st.get("/subscription/status");return console.log("Subscription status response:",t),t}catch(t){return console.error("Error fetching subscription status:",t),{success:!0,data:{accountTier:"FREE",isPaid:!1,dailyLikesRemaining:3,canSendMessages:!1,canCreateStory:!0}}}},upgradeSubscription:async t=>{try{if(!t||!["monthly","yearly"].includes(t))throw new Error("Invalid subscription plan. Please choose monthly or yearly.");console.log(`Upgrading to ${t} plan...`);const e=await st.post("/subscription/upgrade",{plan:t});if(console.log("Upgrade response:",e),e.success)return ne.success(`Successfully upgraded to ${t} plan!`),e;throw new Error(e.error||"Failed to upgrade subscription")}catch(e){throw console.error("Error upgrading subscription:",e),ne.error(e.message||"Failed to upgrade subscription"),e}},cancelSubscription:async()=>{try{const t=await st.post("/subscription/cancel");if(t.success)return ne.info(t.message||"Subscription successfully canceled"),t;throw new Error(t.error||"Failed to cancel subscription")}catch(t){throw console.error("Error canceling subscription:",t),ne.error(t.message||"Failed to cancel subscription"),t}},checkActionPermission:async t=>{try{if(!["message","like","story"].includes(t))throw new Error("Invalid action type");const e=await bh.getSubscriptionStatus();if(!e.success)throw new Error("Could not verify subscription status");const{data:i}=e;switch(t){case"message":return{allowed:i.canSendMessages,reason:i.canSendMessages?null:"Messaging requires a premium account"};case"like":return{allowed:i.accountTier!=="FREE"||i.dailyLikesRemaining>0,reason:i.dailyLikesRemaining>0?null:"You have used all your daily likes",remaining:i.dailyLikesRemaining};case"story":return{allowed:i.canCreateStory,reason:i.canCreateStory?null:`Story creation available in ${i.storyCooldown} hours`,cooldown:i.storyCooldown};default:return{allowed:!1,reason:"Unknown action type"}}}catch(e){return console.error(`Error checking permission for ${t}:`,e),{allowed:!1,reason:e.message||"Could not verify permissions"}}}};class LT{constructor(e){this.socket=e}requestPhotoPermission(e,i){return new Promise((a,c)=>{var w;if(!this.socket.isConnected())return c(new Error("Socket not connected"));if(!e||!i)return c(new Error("Owner ID and Photo ID are required"));const u={ownerId:e,photoId:i},d=`req-${i}-${(w=this.socket.socket)==null?void 0:w.userId}`,h=C=>{C.requestId===d&&(y(),C.success?a(C):c(new Error(C.error||"Failed to request permission")))},p=C=>{C.requestId===d&&(y(),c(new Error(C.error||"Permission request failed")))},y=()=>{this.socket.off("photoPermissionRequested",h),this.socket.off("photoPermissionError",p)};this.socket.on("photoPermissionRequested",h),this.socket.on("photoPermissionError",p),this.socket.emit("requestPhotoPermission",u)||(y(),c(new Error("Failed to send permission request event"))),setTimeout(()=>{y(),c(new Error("Permission request timed out"))},1e4)})}respondToPhotoPermission(e,i){return new Promise((a,c)=>{var w;if(!this.socket.isConnected())return c(new Error("Socket not connected"));if(!e||!i)return c(new Error("Permission ID and status are required"));if(!["approved","rejected"].includes(i))return c(new Error("Invalid status provided"));const u={permissionId:e,status:i},d=`res-${e}-${(w=this.socket.socket)==null?void 0:w.userId}`,h=C=>{C.requestId===d&&(y(),C.success?a(C):c(new Error(C.error||"Failed to respond to permission")))},p=C=>{C.requestId===d&&(y(),c(new Error(C.error||"Permission response failed")))},y=()=>{this.socket.off("photoPermissionResponded",h),this.socket.off("photoPermissionError",p)};this.socket.on("photoPermissionResponded",h),this.socket.on("photoPermissionError",p),this.socket.emit("respondToPhotoPermission",u)||(y(),c(new Error("Failed to send permission response event"))),setTimeout(()=>{y(),c(new Error("Permission response timed out"))},1e4)})}}const qf=new LT(Be),Vf=t=>t?t.startsWith("http")?t:t.includes("/images/")||t.includes("/photos/")?t.startsWith("/uploads")?t:`/uploads${t.startsWith("/")?"":"/"}${t}`:t.startsWith("/uploads/")?t:`/uploads/images/${t.split("/").pop()}`:"/placeholder.svg",OT=()=>{var X,le,Ze,we,_e,Le,Ye,Bt,xt,Ht,mn,is,Ds,fe,Me,He,dt,Et;const{id:t}=Mv(),e=In(),{user:i}=Sn(),{loading:a,likeUser:c,unlikeUser:u,isUserLiked:d,error:h,blockUser:p,reportUser:y}=ka()||{},{initiateChat:g}=useChatContext()||{},{loadUserStories:w,hasUnviewedStories:C}=Lr()||{},[j,N]=b.useState(null),[M,D]=b.useState(!0),[I,V]=b.useState(null),[F,O]=b.useState([]),[A,H]=b.useState(!1),[E,L]=b.useState(0),[P,G]=b.useState(!1),[Q,z]=b.useState(!1),[ae,Pe]=b.useState(!1),[Ee,K]=b.useState({}),[q,J]=b.useState({}),[re,Ne]=b.useState({}),[Se,Ve]=b.useState(!1),[ge,ee]=b.useState(!1),Re=b.useRef(null),[he,Ue]=b.useState(!1),[ze,Xe]=b.useState([]),[Qe,Ge]=b.useState(!1),[at,yt]=b.useState(!1),mt=i&&j&&i._id===j._id,Ie=b.useRef(!0);b.useEffect(()=>(Ie.current=!0,()=>{Ie.current=!1}),[]);const qe=b.useCallback(async()=>{var oe;if(!t){V("No user ID provided in URL."),D(!1);return}D(!0),V(null),N(null),J({}),console.log(`UserProfile page fetching data for user: ${t}`);try{const We=[];We.push({url:`/users/${t}`,type:"user-profile"}),i&&i._id!==t&&We.push({url:`/users/${t}/photo-permissions`,type:"permissions"});const bt=Date.now(),vt=await Promise.all(We.map(rt=>st.get(rt.url,{_t:bt,_req:Math.random().toString(36).substring(2,10)})));if(!Ie.current)return;const ft=vt[0];if(!ft.success||!((oe=ft.data)!=null&&oe.user))throw new Error(ft.error||"User not found");if(N(ft.data.user),vt.length>1&&vt[1].success){const rt=vt[1],sn={};(rt.data||[]).forEach(Gn=>{sn[Gn.photo]=Gn.status}),J(sn)}if(w)try{const rt=await w(t);Ie.current&&Array.isArray(rt)&&O(rt)}catch(rt){console.error("Error loading stories:",rt)}i&&i._id===t&&jt()}catch(We){console.error(`Error fetching initial data for user ${t}:`,We),Ie.current&&V(We.message||"Failed to load profile")}finally{Ie.current&&D(!1)}},[t,i,w]);b.useEffect(()=>{qe(),L(0),z(!1),G(!1),Ne({}),Xe([]),H(!1),Pe(!1)},[t,qe]);const jt=b.useCallback(async()=>{if(!(!i||!mt)){Ge(!0);try{const oe=await st.get("/users/photos/permissions?status=pending");if(oe.success&&Ie.current){const We={};(oe.data||[]).forEach(bt=>{var ft;if(!((ft=bt==null?void 0:bt.requestedBy)!=null&&ft._id))return;const vt=bt.requestedBy._id;We[vt]||(We[vt]={user:bt.requestedBy,requests:[]}),We[vt].requests.push(bt)}),Xe(Object.values(We))}}catch{ne.error("Failed to load photo access requests")}finally{Ie.current&&Ge(!1)}}},[i,mt]),Ct=async(oe,We)=>{var bt;if(We&&We.stopPropagation(),!(!j||!oe||!i||mt)){K(vt=>({...vt,[oe]:!0}));try{const vt=await qf.requestPhotoPermission(j._id,oe);Ie.current&&(vt.success?(J(ft=>({...ft,[oe]:vt.status||"pending"})),ne.info(vt.message||"Request sent/pending.")):ne.error(vt.error||"Failed request."))}catch(vt){Ie.current&&((bt=vt.message)!=null&&bt.includes("already")?(J(ft=>({...ft,[oe]:"pending"})),ne.info("Request already sent.")):ne.error(vt.message||"Failed request."))}finally{Ie.current&&K(vt=>({...vt,[oe]:!1}))}}},Rt=async()=>{if(!(j!=null&&j.photos)||!i||mt)return;const oe=j.photos.filter(rt=>rt.isPrivate&&q[rt._id]!=="approved"&&q[rt._id]!=="pending");if(oe.length===0){ne.info("No new requests needed.");return}Ue(!0);let We=0,bt=0,vt=0;(await Promise.allSettled(oe.map(rt=>qf.requestPhotoPermission(j._id,rt._id)))).forEach((rt,sn)=>{var Oe;const Gn=oe[sn];rt.status==="fulfilled"&&rt.value.success?(Ie.current&&J(nt=>({...nt,[Gn._id]:"pending"})),(Oe=rt.value.message)!=null&&Oe.includes("already")?bt++:We++):vt++}),Ie.current&&(We>0?ne.success(`Requested ${We} photo(s).`+(bt>0?` ${bt} pending.`:"")):bt>0&&ne.info(`Requests pending/sent for ${bt} photos.`),vt>0&&ne.error(`Failed for ${vt} photo(s).`),Ue(!1))},pe=async(oe,We,bt)=>{if(!(!mt||!(We!=null&&We.length))){yt(!0);try{let vt=0;await Promise.allSettled(We.map(ft=>qf.respondToPhotoPermission(ft._id,bt))).then(ft=>ft.forEach(rt=>{rt.status==="fulfilled"&&rt.value.success&&vt++})),vt>0?ne.success(`Successfully ${bt} ${vt} request(s).`):We.length>0&&ne.error(`Failed to ${bt} requests.`),jt()}catch{ne.error(`Server error processing ${bt}.`)}finally{Ie.current&&yt(!1)}}},je=(oe,We)=>pe(oe,We,"approved"),Je=(oe,We)=>pe(oe,We,"rejected"),_t=b.useCallback(oe=>{Ie.current&&Ne(We=>({...We,[oe]:!0}))},[]),ke=async()=>{if(!(!j||Se||!c||!u||!d)){Ve(!0);try{await(d(j._id)?u:c)(j._id,j.nickname)}catch(oe){ne.error(oe.message||"Like failed.")}finally{Ie.current&&Ve(!1)}}},Ke=async()=>{if(!(!j||!p)&&window.confirm(`Block ${j.nickname}?`))try{await p(j._id),ne.info(`${j.nickname} blocked.`),e("/dashboard")}catch(oe){ne.error(oe.message||"Block failed.")}},ht=async()=>{if(!j||!y)return;const oe=prompt(`Reason for reporting ${j.nickname}:`);if(oe!=null&&oe.trim())try{await y(j._id,oe),ne.success(`${j.nickname} reported.`),e("/dashboard")}catch(We){ne.error(We.message||"Report failed.")}else oe!==null&&ne.warning("Reason required.")},B=async()=>{if(!(!j||!g)){ee(!0);try{await g(j),e("/messages")}catch(oe){ne.error(oe.message||"Chat start failed.")}finally{Ie.current&&ee(!1)}}},R=()=>{(F==null?void 0:F.length)>0&&Pe(!0)},Y=()=>Pe(!1),_=()=>{var oe;((oe=j==null?void 0:j.photos)==null?void 0:oe.length)>E+1&&L(We=>We+1)},v=()=>{E>0&&L(oe=>oe-1)};b.useEffect(()=>{const oe=We=>{var ft;const{photoId:bt,status:vt}=We.detail;(ft=j==null?void 0:j.photos)!=null&&ft.some(rt=>rt._id===bt)&&Ie.current&&J(rt=>({...rt,[bt]:vt}))};return window.addEventListener("permissionStatusUpdated",oe),()=>window.removeEventListener("permissionStatusUpdated",oe)},[j]);const x=b.useMemo(()=>{var vt,ft;if(!(j!=null&&j.details)||!(i!=null&&i.details))return 0;let oe=0;((vt=j.details.location)==null?void 0:vt.toLowerCase())===((ft=i.details.location)==null?void 0:ft.toLowerCase())&&(oe+=25);const We=Math.abs((j.details.age||0)-(i.details.age||0));We<=5?oe+=25:We<=10?oe+=15:oe+=5;const bt=(j.details.interests||[]).filter(rt=>(i.details.interests||[]).includes(rt)).length;return oe+=Math.min(45,bt*10),Math.min(100,Math.max(0,oe))},[j,i]),T=b.useMemo(()=>{var oe,We;return!((oe=j==null?void 0:j.details)!=null&&oe.interests)||!((We=i==null?void 0:i.details)!=null&&We.interests)?[]:j.details.interests.filter(bt=>i.details.interests.includes(bt))},[j,i]);if(M||a)return o.jsx("div",{className:"min-vh-100 d-flex flex-column align-items-center justify-content-center p-5 text-center bg-light-subtle",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-5 max-w-md animate-pulse",children:[o.jsx(ws,{className:"text-5xl text-primary mb-4 animate-spin"}),o.jsx("h3",{className:"font-weight-bold text-xl mb-3",children:"Loading Profile"}),o.jsx("p",{className:"text-opacity-70 mb-0",children:"Please wait while we load this user's profile..."})]})});if(I||h)return o.jsx("div",{className:"min-vh-100 d-flex flex-column align-items-center justify-content-center p-5 text-center bg-light-subtle",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-5 max-w-md border-danger",children:[o.jsx(FaExclamationTriangle,{className:"text-5xl text-danger mb-4"}),o.jsx("h3",{className:"font-weight-bold text-xl mb-3",children:"Error Loading Profile"}),o.jsx("p",{className:"text-opacity-70 mb-4",children:I||h||"An unexpected error occurred while loading this profile."}),o.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-primary rounded-pill d-inline-flex align-items-center gap-2 px-4 py-2 shadow-sm hover-scale transition-all",children:[o.jsx(br,{})," ",o.jsx("span",{children:"Go to Dashboard"})]})]})});if(!j)return o.jsx("div",{className:"min-vh-100 d-flex flex-column align-items-center justify-content-center p-5 text-center bg-light-subtle",children:o.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-5 max-w-md",children:[o.jsx(Cc,{className:"text-5xl text-opacity-50 mb-4"}),o.jsx("h3",{className:"font-weight-bold text-xl mb-3",children:"User Not Found"}),o.jsx("p",{className:"text-opacity-70 mb-4",children:"We couldn't find the user you're looking for. They may have deactivated their account or the URL might be incorrect."}),o.jsxs("button",{onClick:()=>e("/dashboard"),className:"btn btn-primary rounded-pill d-inline-flex align-items-center gap-2 px-4 py-2 shadow-sm hover-scale transition-all",children:[o.jsx(br,{})," ",o.jsx("span",{children:"Go to Dashboard"})]})]})});const U=(oe="")=>oe.charAt(0).toUpperCase()+oe.slice(1);return o.jsxs("div",{className:"min-vh-100 bg-light-subtle",ref:Re,children:[o.jsx(kr,{})," ",o.jsxs("div",{className:"container max-w-xl py-4 px-3",children:[o.jsxs("button",{className:"btn btn-outline-secondary rounded-pill d-inline-flex align-items-center gap-2 mb-4 shadow-sm hover-scale transition-all",onClick:()=>e(-1),children:[o.jsx(br,{})," ",o.jsx("span",{children:"Back"})]}),mt&&ze.length>0&&o.jsxs("div",{className:"bg-warning-50 border border-warning-200 rounded-lg p-4 mb-4 shadow-sm animate-fade-in",children:[o.jsxs("h2",{className:"font-weight-bold text-xl mb-3 d-flex align-items-center gap-2 text-warning-700",children:[o.jsx(wr,{})," Photo Access Requests"]}),o.jsx("div",{className:"d-flex flex-column gap-3",children:ze.map(oe=>{var We,bt;return o.jsxs("div",{className:"d-flex justify-content-between align-items-center bg-white p-3 rounded-lg shadow-sm hover-shadow-md transition-all",children:[o.jsxs("div",{className:"d-flex align-items-center gap-3",children:[o.jsx("div",{className:"w-50px h-50px rounded-circle overflow-hidden bg-light flex-shrink-0 d-flex align-items-center justify-content-center",children:(bt=(We=oe.user.photos)==null?void 0:We[0])!=null&&bt.url?o.jsx("img",{src:Vf(oe.user.photos[0].url),alt:oe.user.nickname,className:"w-100 h-100 object-cover",onError:vt=>{vt.target.src="/placeholder.svg"}}):o.jsx(Cc,{className:"text-xl text-opacity-50"})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-weight-medium mb-1",children:oe.user.nickname}),o.jsxs("p",{className:"text-sm text-opacity-70 mb-0",children:["Requests: ",oe.requests.length]})]})]}),o.jsxs("div",{className:"d-flex gap-2",children:[o.jsxs("button",{className:"btn btn-sm btn-success d-flex align-items-center gap-1 rounded-pill shadow-sm hover-scale transition-all",onClick:()=>je(oe.user._id,oe.requests),disabled:at,children:[o.jsx(Lt,{})," ",o.jsx("span",{children:"Approve"})]}),o.jsxs("button",{className:"btn btn-sm btn-danger d-flex align-items-center gap-1 rounded-pill shadow-sm hover-scale transition-all",onClick:()=>Je(oe.user._id,oe.requests),disabled:at,children:[o.jsx(Vn,{})," ",o.jsx("span",{children:"Reject"})]})]})]},oe.user._id)})})]}),o.jsxs("div",{className:"d-grid grid-cols-1 grid-cols-lg-2 bg-white rounded-lg shadow-lg overflow-hidden",children:[o.jsxs("div",{className:"position-relative overflow-hidden bg-gray-100 d-flex flex-column",children:[(F==null?void 0:F.length)>0&&(C==null?void 0:C(j._id))&&o.jsx("div",{className:"position-absolute top-4 left-4 z-10",children:o.jsx(nm,{user:j,hasUnviewedStories:!0,onClick:R})}),((X=j.photos)==null?void 0:X.length)>0?o.jsxs("div",{className:"flex-grow-1 overflow-hidden position-relative w-100 bg-gradient-to-br",children:[o.jsxs("div",{className:"position-relative w-100 h-100 min-h-480px d-flex align-items-center justify-content-center",children:[(le=j.photos[E])!=null&&le.isPrivate&&q[j.photos[E]._id]!=="approved"&&!mt?o.jsxs("div",{className:"w-100 h-100 d-flex flex-column align-items-center justify-content-center bg-light-subtle text-opacity-70 text-center p-5",children:[o.jsx(Ss,{className:"text-4xl mb-4 text-opacity-60"}),o.jsx("p",{className:"mb-3 font-weight-medium",children:"Private Photo"}),q[j.photos[E]._id]==="pending"&&o.jsx("p",{className:"bg-warning text-white px-3 py-1 rounded-pill text-sm font-weight-medium",children:"Request Pending"}),q[j.photos[E]._id]==="rejected"&&o.jsx("p",{className:"bg-danger text-white px-3 py-1 rounded-pill text-sm font-weight-medium",children:"Access Denied"}),!q[j.photos[E]._id]&&o.jsx("button",{className:"btn btn-primary rounded-pill px-4 py-2 mt-4 d-inline-flex align-items-center gap-2 shadow-md hover-scale transition-all",onClick:oe=>Ct(j.photos[E]._id,oe),disabled:Ee[j.photos[E]._id]||he,children:Ee[j.photos[E]._id]?o.jsx(ws,{className:"animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(wr,{}),o.jsx("span",{children:"Request Access"})]})})]}):j.photos[E]&&o.jsx("img",{src:Vf(j.photos[E].url),alt:j.nickname,className:"w-100 h-100 object-cover transition-transform hover-scale",onError:()=>_t(j.photos[E]._id),style:{display:re[(Ze=j.photos[E])==null?void 0:Ze._id]?"none":"block"}}),j.photos[E]&&re[(we=j.photos[E])==null?void 0:we._id]&&o.jsxs("div",{className:"w-100 h-100 d-flex flex-column align-items-center justify-content-center bg-light-subtle",children:[o.jsx(Wo,{className:"text-4xl mb-3 text-opacity-60"}),o.jsx("p",{className:"text-opacity-70",children:"Image could not be loaded"})]}),j.isOnline&&o.jsxs("div",{className:"position-absolute top-4 right-4 bg-success-gradient text-white px-3 py-1 rounded-pill d-flex align-items-center gap-2 shadow-sm z-5 font-weight-medium text-sm",children:[o.jsx("span",{className:"d-inline-block w-8px h-8px rounded-circle bg-white position-relative animate-pulse"}),o.jsx("span",{children:"Online"})]}),j.photos.length>1&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"position-absolute top-50 transform-translateY--50 left-4 bg-white-90 text-dark border-0 w-48px h-48px rounded-circle d-flex align-items-center justify-content-center shadow-md z-5 hover-scale transition-all",onClick:v,disabled:E===0,children:o.jsx(Gh,{})}),o.jsx("button",{className:"position-absolute top-50 transform-translateY--50 right-4 bg-white-90 text-dark border-0 w-48px h-48px rounded-circle d-flex align-items-center justify-content-center shadow-md z-5 hover-scale transition-all",onClick:_,disabled:E===j.photos.length-1,children:o.jsx(mb,{})})]})]}),j.photos.length>1&&o.jsx("div",{className:"d-flex p-4 gap-3 justify-content-center position-absolute bottom-0 left-0 right-0 backdrop-blur-md bg-white-80 border-top z-10",children:j.photos.map((oe,We)=>o.jsxs("div",{className:`w-70px h-70px rounded-lg overflow-hidden cursor-pointer shadow-sm transition-all hover-transform-y-n3 ${We===E?"border-2 border-primary shadow-md":"border opacity-70"}`,onClick:()=>L(We),children:[oe.isPrivate&&q[oe._id]!=="approved"&&!mt?o.jsxs("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center bg-light-subtle text-opacity-60 position-relative",children:[o.jsx(Ss,{}),q[oe._id]&&o.jsx("div",{className:`position-absolute bottom-0 left-0 right-0 p-1 text-xs text-center font-weight-medium text-white 
                                        ${q[oe._id]==="pending"?"bg-warning":q[oe._id]==="approved"?"bg-success":"bg-danger"}`})]}):o.jsx("img",{src:Vf(oe.url),alt:`${We+1}`,className:"w-100 h-100 object-cover transition-transform hover-scale",onError:()=>_t(oe._id),style:{display:re[oe._id]?"none":"block"}}),re[oe._id]&&o.jsx("div",{className:"w-100 h-100 d-flex align-items-center justify-content-center bg-light-subtle",children:o.jsx(Cc,{className:"text-opacity-50"})})]},oe._id))})]}):o.jsxs("div",{className:"w-100 h-100 min-h-480px d-flex flex-column align-items-center justify-content-center bg-light-subtle p-5",children:[o.jsx(Cc,{className:"text-5xl mb-4 text-opacity-50"}),o.jsx("p",{className:"text-opacity-70 font-weight-medium",children:"No photos available"})]}),o.jsxs("div",{className:"position-absolute bottom-20 left-0 right-0 d-flex gap-3 justify-content-center z-20 px-4",children:[!mt&&o.jsxs(o.Fragment,{children:[o.jsxs("button",{className:`btn rounded-pill d-inline-flex align-items-center gap-2 px-4 py-2 shadow-lg hover-scale transition-all font-weight-medium ${d!=null&&d(j._id)?"btn-danger":"btn-outline-danger"}`,onClick:ke,disabled:Se,children:[o.jsx(vi,{})," ",o.jsx("span",{children:d!=null&&d(j._id)?"Liked":"Like"})]}),o.jsxs("button",{className:"btn btn-primary rounded-pill d-inline-flex align-items-center gap-2 px-4 py-2 shadow-lg hover-scale transition-all font-weight-medium",onClick:B,disabled:ge,children:[o.jsx(Ta,{})," ",o.jsx("span",{children:"Message"})]}),((_e=j.photos)==null?void 0:_e.some(oe=>oe.isPrivate&&q[oe._id]!=="approved"))&&o.jsxs("button",{className:"btn btn-secondary rounded-pill d-inline-flex align-items-center gap-2 px-4 py-2 shadow-lg hover-scale transition-all font-weight-medium",onClick:Rt,disabled:he,children:[o.jsx(wr,{})," ",o.jsx("span",{children:"Request Photos"})]})]}),o.jsxs("div",{className:"position-relative",children:[o.jsx("button",{className:"btn btn-light rounded-circle d-flex align-items-center justify-content-center w-46px h-46px shadow-lg hover-scale transition-all",onClick:()=>G(oe=>!oe),children:o.jsx(yb,{})}),P&&o.jsxs("div",{className:"position-absolute bottom-100 right-0 bg-white rounded-lg shadow-lg z-20 overflow-hidden border animate-fade-in w-200px",children:[o.jsxs("button",{className:"d-flex align-items-center gap-3 w-100 text-left border-0 bg-transparent px-4 py-3 hover-bg-light-subtle transition-all",onClick:ht,children:[o.jsx(bb,{className:"text-danger"})," ",o.jsx("span",{children:"Report"})]}),!mt&&o.jsxs("button",{className:"d-flex align-items-center gap-3 w-100 text-left border-0 bg-transparent px-4 py-3 hover-bg-light-subtle transition-all",onClick:Ke,children:[o.jsx(dh,{className:"text-danger"})," ",o.jsx("span",{children:"Block"})]})]})]})]})]}),o.jsxs("div",{className:"p-5 overflow-y-auto max-h-80vh border-left",children:[o.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 border-bottom pb-3",children:[o.jsxs("h1",{className:"font-weight-bold text-3xl m-0 letter-spacing-n-1",children:[j.nickname,", ",((Le=j.details)==null?void 0:Le.age)||"?"]}),j.accountTier!=="FREE"&&o.jsxs("div",{className:"gradient-gold text-dark px-3 py-1 rounded-pill d-flex align-items-center gap-2 shadow-sm font-weight-bold text-sm",children:[o.jsx(_b,{})," ",U(j.accountTier)]})]}),o.jsxs("div",{className:"d-flex align-items-center gap-3 mb-2 text-opacity-70",children:[o.jsx(Tr,{className:"text-primary"}),o.jsx("span",{children:((Ye=j.details)==null?void 0:Ye.location)||"N/A"}),o.jsx("div",{className:`px-2 py-1 rounded-pill text-xs font-weight-medium ${j.isOnline?"bg-success-50 text-success-700":"bg-gray-200 text-opacity-50"}`,children:j.isOnline?"Online":"Offline"})]}),o.jsxs("div",{className:"d-flex flex-wrap gap-4 mb-5 text-sm text-opacity-60",children:[o.jsxs("div",{className:"d-flex align-items-center gap-2",children:[o.jsx(Sb,{className:"text-opacity-50"}),o.jsxs("span",{children:["Last active ",j.lastActive?new Date(j.lastActive).toLocaleDateString():"N/A"]})]}),o.jsxs("div",{className:"d-flex align-items-center gap-2",children:[o.jsx(Hh,{className:"text-opacity-50"}),o.jsxs("span",{children:["Member since ",j.createdAt?new Date(j.createdAt).toLocaleDateString():"N/A"]})]})]}),!mt&&i&&o.jsxs("div",{className:"bg-light-subtle rounded-lg p-4 mb-5 shadow-sm border",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3",children:"Compatibility"}),o.jsx("div",{className:"text-center",children:o.jsxs("div",{className:"d-inline-block p-3 rounded-circle bg-primary-gradient text-white font-weight-bold text-2xl w-80px h-80px d-flex align-items-center justify-content-center mb-2 shadow-sm animate-pulse",children:[x,"%"]})})]}),((Bt=j.details)==null?void 0:Bt.bio)&&o.jsxs("div",{className:"mb-5 animate-fade-in",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3 pb-2 border-bottom",children:"About"}),o.jsx("p",{className:"line-height-relaxed text-opacity-80",children:j.details.bio})]}),o.jsxs("div",{className:"d-grid grid-cols-1 grid-cols-md-2 gap-4 mb-5",children:[((xt=j.details)==null?void 0:xt.iAm)&&o.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border",children:[o.jsx("h3",{className:"font-weight-medium text-sm text-opacity-60 mb-2",children:"I am a"}),o.jsx("p",{className:"m-0 font-weight-medium",children:U(j.details.iAm)})]}),((Ht=j.details)==null?void 0:Ht.maritalStatus)&&o.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm border",children:[o.jsx("h3",{className:"font-weight-medium text-sm text-opacity-60 mb-2",children:"Status"}),o.jsx("p",{className:"m-0 font-weight-medium",children:j.details.maritalStatus})]})]}),((is=(mn=j.details)==null?void 0:mn.lookingFor)==null?void 0:is.length)>0&&o.jsxs("div",{className:"mb-5 animate-fade-in",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3 pb-2 border-bottom",children:"Looking For"}),o.jsx("div",{className:"d-flex flex-wrap gap-2",children:j.details.lookingFor.map(oe=>o.jsx("span",{className:"bg-primary-50 text-primary border border-primary-100 px-3 py-2 rounded-pill text-sm font-weight-medium shadow-sm hover-transform-y-n1 transition-all",children:oe},oe))})]}),((fe=(Ds=j.details)==null?void 0:Ds.intoTags)==null?void 0:fe.length)>0&&o.jsxs("div",{className:"mb-5 animate-fade-in",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3 pb-2 border-bottom",children:"Into"}),o.jsx("div",{className:"d-flex flex-wrap gap-2",children:j.details.intoTags.map(oe=>o.jsx("span",{className:"bg-secondary-50 text-secondary border border-secondary-100 px-3 py-2 rounded-pill text-sm font-weight-medium shadow-sm hover-transform-y-n1 transition-all",children:oe},oe))})]}),((He=(Me=j.details)==null?void 0:Me.turnOns)==null?void 0:He.length)>0&&o.jsxs("div",{className:"mb-5 animate-fade-in",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3 pb-2 border-bottom",children:"Turns Me On"}),o.jsx("div",{className:"d-flex flex-wrap gap-2",children:j.details.turnOns.map(oe=>o.jsx("span",{className:"bg-danger-50 text-danger border border-danger-100 px-3 py-2 rounded-pill text-sm font-weight-medium shadow-sm hover-transform-y-n1 transition-all",children:oe},oe))})]}),((Et=(dt=j.details)==null?void 0:dt.interests)==null?void 0:Et.length)>0&&o.jsxs("div",{className:"mb-5 animate-fade-in",children:[o.jsx("h2",{className:"font-weight-bold text-xl mb-3 pb-2 border-bottom",children:"Interests"}),o.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[(Q?j.details.interests:j.details.interests.slice(0,8)).map(oe=>o.jsxs("span",{className:`px-3 py-2 rounded-pill text-sm font-weight-medium shadow-sm hover-transform-y-n1 transition-all d-inline-flex align-items-center gap-2 ${T.includes(oe)?"bg-success-50 text-success-700 border border-success-100":"bg-light text-opacity-70 border"}`,children:[oe," ",T.includes(oe)&&o.jsx(Lt,{className:"text-xs"})]},oe)),!Q&&j.details.interests.length>8&&o.jsxs("button",{className:"border-0 bg-transparent text-primary text-sm font-weight-medium px-3 py-2 hover-bg-primary-50 rounded-pill transition-all",onClick:()=>z(!0),children:["+",j.details.interests.length-8," more"]})]})]}),T.length>0&&!mt&&o.jsxs("div",{className:"bg-success-50 border border-success-100 rounded-lg p-4 mb-5 shadow-sm",children:[o.jsxs("h2",{className:"font-weight-bold text-xl mb-3 d-flex align-items-center gap-2 text-success-700",children:[o.jsx(Lt,{})," Common Interests"]}),o.jsx("div",{className:"d-flex flex-wrap gap-2",children:T.map(oe=>o.jsxs("div",{className:"bg-white px-3 py-2 rounded-pill d-flex align-items-center gap-2 text-sm shadow-sm",children:[o.jsx(Lt,{className:"text-success text-xs"}),o.jsx("span",{children:oe})]},oe))})]})]})]}),A&&!mt&&o.jsx(ul,{recipient:j,isOpen:A,onClose:()=>H(!1)}),ae&&j&&o.jsx(sm,{userId:j._id,onClose:Y})]})]})},DT="_profilePage_1opo9_3",BT="_dashboardContent_1opo9_18",zT="_photoSection_1opo9_34",PT="_profilePhotoWrapper_1opo9_74",$T="_profilePhoto_1opo9_74",UT="_photoGallery_1opo9_190",IT="_galleryItem_1opo9_215",FT="_profileGalleryItem_1opo9_245",qT="_galleryImage_1opo9_250",VT="_galleryItemLoading_1opo9_261",HT="_galleryItemUploading_1opo9_278",GT="_photoControls_1opo9_296",YT="_photoControlBtn_1opo9_314",XT="_profileBadge_1opo9_328",KT="_addPhotoItem_1opo9_342",QT="_profileInfo_1opo9_371",WT="_profileHeader_1opo9_397",ZT="_profileTitle_1opo9_411",JT="_infoSection_1opo9_423",ek="_sectionTitle_1opo9_450",tk="_infoGrid_1opo9_480",nk="_formGroup_1opo9_486",sk="_formLabel_1opo9_490",ik="_formControl_1opo9_498",ak="_borderDanger_1opo9_542",rk="_textArea_1opo9_546",ok="_errorMessage_1opo9_551",lk="_textMuted_1opo9_560",ck="_textRight_1opo9_564",uk="_mt1_1opo9_572",dk="_mt2_1opo9_576",fk="_mt4_1opo9_584",hk="_mb2_1opo9_588",mk="_fstItalic_1opo9_597",gk="_interestsTags_1opo9_602",pk="_interestTag_1opo9_608",yk="_selected_1opo9_625",vk="_btn_1opo9_710",bk="_btnPrimary_1opo9_724",xk="_btnOutline_1opo9_736",wk="_spinner_1opo9_757",_k="_spinnerSmall_1opo9_767",Sk="_spinnerLarge_1opo9_773",jk="_spinnerDark_1opo9_779",Ck="_flexDisplay_1opo9_845",Nk="_flexWrap_1opo9_846",Tk="_gap2_1opo9_849",ve={profilePage:DT,dashboardContent:BT,photoSection:zT,profilePhotoWrapper:PT,profilePhoto:$T,photoGallery:UT,galleryItem:IT,profileGalleryItem:FT,galleryImage:qT,galleryItemLoading:VT,galleryItemUploading:HT,photoControls:GT,photoControlBtn:YT,profileBadge:XT,addPhotoItem:KT,profileInfo:QT,profileHeader:WT,profileTitle:ZT,infoSection:JT,sectionTitle:ek,infoGrid:tk,formGroup:nk,formLabel:sk,formControl:ik,borderDanger:ak,textArea:rk,errorMessage:ok,textMuted:lk,textRight:ck,mt1:uk,mt2:dk,mt4:fk,mb2:hk,fstItalic:mk,interestsTags:gk,interestTag:pk,selected:yk,"identity-woman":"_identity-woman_1opo9_631","identity-man":"_identity-man_1opo9_644","identity-couple":"_identity-couple_1opo9_657",btn:vk,btnPrimary:bk,btnOutline:xk,spinner:wk,spinnerSmall:_k,spinnerLarge:Sk,spinnerDark:jk,flexDisplay:Ck,flexWrap:Nk,gap2:Tk},kk=()=>{var B;const{user:t}=Sn(),{updateProfile:e,uploadPhoto:i,refreshUserData:a}=ka(),[c,u]=b.useState(!1),[d,h]=b.useState({nickname:"",details:{age:"",gender:"",location:"",bio:"",interests:[],iAm:"",lookingFor:[],intoTags:[],turnOns:[],maritalStatus:""}}),[p,y]=b.useState([]),[g,w]=b.useState(0),[C,j]=b.useState(0),[N,M]=b.useState(!1),[D,I]=b.useState(!1),[V]=b.useState(["Dating","Casual","Friendship","Long-term","Travel","Outdoors","Movies","Music","Fitness","Food","Art","Reading","Gaming","Photography","Dancing","Cooking"]),[F]=b.useState(["woman","man","couple"]),[O]=b.useState(["women","men","couples"]),[A]=b.useState(["Meetups","Power play","Threesomes","Online fun","Hot chat","Photo sharing","Camera chat","Cuckold","Golden showers","Strap-on","Forced bi","Erotic domination","Humiliation","Crossdressing","Worship","Foot fetish","Oral","From behind","Role-play","Toys","Massages","Foreplay","Casual meetups","Fantasy fulfillment","Bizarre","Education","Experiences","Tantra"]),[H]=b.useState(["Sexy ass","Dirty talk","Aggressive","Slow and gentle","In a public place","Pampering","Sexy clothing","Leather/latex clothing","Watching porn","Fit body","Bathing together","Erotic writing","Eye contact","Being pampered","Sexy legs","Teasing","Pushing boundaries"]),[E]=b.useState(["Single","Married","Divorced","Separated","Widowed","In a relationship","It's complicated","Open relationship","Polyamorous"]),[L,P]=b.useState({}),[G,Q]=b.useState(!1),z=b.useRef(null);In();const[ae,Pe]=b.useState(!1),[Ee,K]=b.useState(null),[q,J]=b.useState(null),[re,Ne]=b.useState(null),[Se,Ve]=b.useState(!1),[ge,ee]=b.useState(!1),[Re,he]=b.useState(!0),[Ue,ze]=b.useState({});b.useEffect(()=>{var R,Y,_,v,x,T,U,X,le,Ze;if(he(!0),t)if(h({nickname:t.nickname||"",details:{age:((R=t.details)==null?void 0:R.age)||"",gender:((Y=t.details)==null?void 0:Y.gender)||"",location:((_=t.details)==null?void 0:_.location)||"",bio:((v=t.details)==null?void 0:v.bio)||"",interests:((x=t.details)==null?void 0:x.interests)||[],iAm:((T=t.details)==null?void 0:T.iAm)||"",lookingFor:((U=t.details)==null?void 0:U.lookingFor)||[],intoTags:((X=t.details)==null?void 0:X.intoTags)||[],turnOns:((le=t.details)==null?void 0:le.turnOns)||[],maritalStatus:((Ze=t.details)==null?void 0:Ze.maritalStatus)||""}}),t.photos&&t.photos.length>0){const we=t.photos.map(_e=>({..._e,isPrivate:_e.isPrivate??!1,isProfile:!1}));we.length>0&&(we[0].isProfile=!0,w(0)),y(we)}else y([]),w(-1);he(!1)},[t]);const Xe=b.useRef(!0);b.useEffect(()=>()=>{Xe.current=!1},[]),b.useEffect(()=>()=>{z.current&&(z.current.value="")},[]);const[Qe,Ge]=b.useState({nickname:"",details:{age:"",gender:"",location:"",bio:"",interests:[]}}),at=R=>{const{name:Y,value:_,type:v,checked:x}=R.target;if(v==="checkbox")h({...d,[Y]:x});else if(v==="number"){if(_===""||!isNaN(Number.parseInt(_)))if(Y.includes("details.")){const T=Y.split(".")[1];h({...d,details:{...d.details,[T]:_}})}else h({...d,[Y]:_})}else if(Y.includes("details.")){const T=Y.split(".")[1];h({...d,details:{...d.details,[T]:_}})}else h({...d,[Y]:_});L[Y.split(".").pop()]&&P(T=>{const U={...T};return delete U[Y.split(".").pop()],U})},yt=R=>{const Y=d.details.interests;if(!Y.includes(R)&&Y.length>=10){ne.warning("You can select up to 10 interests");return}const _=Y.includes(R)?Y.filter(v=>v!==R):[...Y,R];h(v=>({...v,details:{...v.details,interests:_}}))},mt=R=>{h(Y=>({...Y,details:{...Y.details,iAm:Y.details.iAm===R?"":R}}))},Ie=R=>{const Y=d.details.lookingFor;let _;if(Y.includes(R))_=Y.filter(v=>v!==R);else{if(Y.length>=3){ne.warning("You can select up to 3 options");return}_=[...Y,R]}h(v=>({...v,details:{...v.details,lookingFor:_}}))},qe=R=>{const Y=d.details.intoTags;if(!Y.includes(R)&&Y.length>=20){ne.warning("You can select up to 20 'I'm into' tags");return}const _=Y.includes(R)?Y.filter(v=>v!==R):[...Y,R];h(v=>({...v,details:{...v.details,intoTags:_}}))},jt=R=>{const Y=d.details.turnOns;if(!Y.includes(R)&&Y.length>=20){ne.warning("You can select up to 20 'Turn ons' tags");return}const _=Y.includes(R)?Y.filter(v=>v!==R):[...Y,R];h(v=>({...v,details:{...v.details,turnOns:_}}))},Ct=R=>{h(Y=>({...Y,details:{...Y.details,maritalStatus:Y.details.maritalStatus===R?"":R}}))},Rt=()=>{const R={};return d.nickname.trim()?d.nickname.length<3?R.nickname="Nickname must be at least 3 characters":d.nickname.length>50&&(R.nickname="Nickname cannot exceed 50 characters"):R.nickname="Nickname is required",!d.details.age&&d.details.age!==0?R.age="Age is required":isNaN(d.details.age)?R.age="Age must be a number":d.details.age<18?R.age="You must be at least 18 years old":d.details.age>120&&(R.age="Please enter a valid age"),d.details.location.trim()?d.details.location.length<2&&(R.location="Location must be at least 2 characters"):R.location="Location is required",d.details.bio&&d.details.bio.length>500&&(R.bio="Bio cannot exceed 500 characters"),R},pe=async R=>{R==null||R.preventDefault();const Y=Rt();if(Object.keys(Y).length>0){P(Y);const _=document.querySelector(`.${ve.errorMessage}`);_&&_.scrollIntoView({behavior:"smooth",block:"center"});return}P({}),Q(!0);try{const _={nickname:d.nickname.trim(),details:{...d.details,age:Number(d.details.age),location:d.details.location.trim(),bio:d.details.bio?d.details.bio.trim():"",interests:Array.isArray(d.details.interests)?d.details.interests:[],iAm:d.details.iAm||"",lookingFor:Array.isArray(d.details.lookingFor)?d.details.lookingFor:[],intoTags:Array.isArray(d.details.intoTags)?d.details.intoTags:[],turnOns:Array.isArray(d.details.turnOns)?d.details.turnOns:[],maritalStatus:d.details.maritalStatus||""}};console.log("Submitting profile data:",_);const v=await e(_);if(v)console.log("Profile updated successfully, refreshing user data..."),await a(v._id)?console.log("User data refresh successful"):console.warn("User data refresh may not have been complete, but continuing"),u(!1);else throw new Error("Failed to update profile")}catch(_){console.error("Failed to update profile:",_),ne.error(_.message||"Failed to update profile. Please try again.")}finally{Q(!1)}},je=async R=>{const Y=R.target.files[0];if(!Y)return;if(Y.type.split("/")[0]!=="image"){ne.error("Please upload an image file");return}const v=5*1024*1024;if(Y.size>v){ne.error("Image size should be less than 5MB");return}M(!0),j(0);const x=`temp-${Date.now()}`;y(T=>[...T,{_id:x,url:URL.createObjectURL(Y),isPrivate:!1,isProfile:!1,isLoading:!0}]);try{if(await i(Y,!1,U=>{j(U)}))ne.success("Photo uploaded successfully"),y(U=>U.filter(X=>X._id!==x)),await a(),j(0),z.current&&(z.current.value="");else throw new Error("Failed to upload photo")}catch(T){console.error("Failed to upload photo:",T),ne.error(T.message||"Failed to upload photo. Please try again."),y(U=>U.filter(X=>X._id!==x))}finally{M(!1)}},Je=()=>{var R;(R=z.current)==null||R.click()},_t=async(R,Y)=>{if(Y==null||Y.stopPropagation(),D)return;if(R.toString().startsWith("temp-")){ne.warning("Please wait for the upload to complete before changing privacy settings");return}const _=p.findIndex(x=>x._id===R);if(_===-1)return;const v=!p[_].isPrivate;y(x=>x.map(T=>T._id===R?{...T,isPrivate:v}:T)),I(!0);try{const T=await(await fetch(`/api/users/photos/${R}/privacy`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("token")}`},body:JSON.stringify({isPrivate:v})})).json();if(!T.success)throw new Error(T.error||"Failed to update photo privacy");ne.success(`Photo is now ${v?"private":"public"}`),await a()}catch(x){console.error("Failed to update photo privacy:",x),ne.error(x.message||"Failed to update privacy setting"),y(T=>T.map(U=>U._id===R?{...U,isPrivate:!v}:U))}finally{I(!1)}},ke=async R=>{if(D)return;if(R.toString().startsWith("temp-")){ne.warning("Please wait for the upload to complete before setting as profile photo");return}const Y=p.findIndex(_=>_._id===R);if(Y!==-1&&g!==Y){w(Y),y(_=>_.map((v,x)=>({...v,isProfile:x===Y}))),I(!0);try{const v=await(await fetch(`/api/users/photos/${R}/profile`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("token")}`}})).json();if(!v.success)throw new Error(v.error||"Failed to set profile photo");ne.success("Profile photo updated"),await a()}catch(_){console.error("Failed to set profile photo:",_),ne.error(_.message||"Failed to set profile photo");const v=p.findIndex(x=>x.isProfile);v!==-1&&(w(v),y(x=>x.map((T,U)=>({...T,isProfile:U===v}))))}finally{I(!1)}}},Ke=async(R,Y)=>{if(Y==null||Y.stopPropagation(),D)return;if(R.toString().startsWith("temp-")){y(x=>x.filter(T=>T._id!==R));return}if(!window.confirm("Are you sure you want to delete this photo?"))return;const _=p.findIndex(x=>x._id===R);if(_===-1)return;if(p.length===1){ne.error("You cannot delete your only photo");return}if(p[_].isProfile){ne.error("You cannot delete your profile photo. Please set another photo as profile first.");return}const v=p.filter(x=>x._id!==R);y(v),_<g&&w(g-1),I(!0);try{const T=await(await fetch(`/api/users/photos/${R}`,{method:"DELETE",headers:{Authorization:`Bearer ${sessionStorage.getItem("token")}`}})).json();if(!T.success)throw new Error(T.error||"Failed to delete photo");ne.success("Photo deleted"),await a()}catch(x){console.error("Failed to delete photo:",x),ne.error(x.message||"Failed to delete photo"),await a()}finally{I(!1)}},ht=()=>{var R,Y,_,v,x,T,U,X,le,Ze;t&&h({nickname:t.nickname||"",details:{age:((R=t.details)==null?void 0:R.age)||"",gender:((Y=t.details)==null?void 0:Y.gender)||"",location:((_=t.details)==null?void 0:_.location)||"",bio:((v=t.details)==null?void 0:v.bio)||"",interests:((x=t.details)==null?void 0:x.interests)||[],iAm:((T=t.details)==null?void 0:T.iAm)||"",lookingFor:((U=t.details)==null?void 0:U.lookingFor)||[],intoTags:((X=t.details)==null?void 0:X.intoTags)||[],turnOns:((le=t.details)==null?void 0:le.turnOns)||[],maritalStatus:((Ze=t.details)==null?void 0:Ze.maritalStatus)||""}}),P({}),u(!1)};return b.useEffect(()=>{(async()=>{try{Pe(!0);const Y=sessionStorage.getItem("token");if(!Y){K("Authentication required"),Pe(!1);return}const _=re?`/api/users/${re}`:"/api/users",v=await Mt.get(_,{headers:{Authorization:`Bearer ${Y}`}});J(v.data)}catch(Y){console.error("Failed to fetch profile:",Y),K("Could not load profile data")}finally{Pe(!1)}})()},[re]),o.jsxs("div",{className:`${ve.profilePage} min-vh-100 w-100 overflow-hidden bg-light-subtle transition-all`,children:[o.jsx(kr,{}),o.jsx("main",{className:`${ve.dashboardContent} py-5`,children:o.jsx("div",{className:"container max-w-xl mx-auto px-4 d-flex flex-column gap-5",children:Re?o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center py-5 text-center",children:[o.jsx("div",{className:`${ve.spinner} ${ve.spinnerLarge} text-primary mb-4`}),o.jsx("p",{className:"text-opacity-70 font-weight-medium",children:"Loading your profile..."})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`${ve.photoSection} text-center bg-white shadow-lg rounded-lg border py-4 transform-gpu hover-shadow-xl transition-all`,children:[p.length>0&&g>=0?o.jsxs("div",{className:`${ve.profilePhotoWrapper} position-relative d-inline-block`,children:[o.jsx("img",{src:p[g].url||"/placeholder.svg?height=200&width=200",alt:"Profile",className:`${ve.profilePhoto} w-300px h-300px object-cover rounded-circle shadow-lg border-4 border-white transform-gpu transition-transform hover-scale`,onLoad:()=>{var R;(R=p[g])!=null&&R.isLoading&&y(Y=>Y.map((_,v)=>v===g?{..._,isLoading:!1}:_))}}),((B=p[g])==null?void 0:B.isLoading)&&o.jsx("div",{className:"position-absolute top-0 left-0 w-100 h-100 rounded-circle d-flex align-items-center justify-content-center bg-overlay-light",children:o.jsx("div",{className:`${ve.spinner} ${ve.spinnerLarge}`})}),p[g].isPrivate&&o.jsx("div",{className:"position-absolute top-0 left-0 w-100 h-100 rounded-circle d-flex align-items-center justify-content-center bg-overlay-dark",children:o.jsx(Ss,{className:"text-3xl text-white"})}),o.jsx("div",{className:"position-absolute bottom-0 left-0 w-100 py-1 bg-overlay-dark text-white text-xs rounded-bottom-circle",children:"Profile Photo"})]}):o.jsx("div",{className:"w-300px h-300px rounded-circle bg-light d-flex align-items-center justify-content-center mx-auto border-4 border-white",children:o.jsx(Zo,{className:"text-7xl text-gray-400"})}),o.jsx("div",{className:"mt-4",children:N?o.jsxs("div",{className:"mx-auto w-200px",children:[o.jsx("div",{className:"h-8px bg-gray-800 rounded-pill overflow-hidden mb-2",children:o.jsx("div",{className:"h-100 bg-primary transition-width",role:"progressbar",style:{width:`${C}%`},"aria-valuenow":C,"aria-valuemin":"0","aria-valuemax":"100"})}),o.jsxs("div",{className:"text-center text-opacity-70",children:["Uploading... ",C,"%"]})]}):o.jsxs("button",{className:"btn btn-outline-primary rounded-pill d-inline-flex align-items-center gap-2 hover-scale shadow-sm transition-all px-4 py-2",onClick:Je,disabled:D,"aria-label":"Add photo",children:[o.jsx(Wo,{})," ",o.jsx("span",{children:"Add Photo"}),o.jsx("input",{type:"file",ref:z,onChange:je,accept:"image/*",style:{display:"none"},"aria-hidden":"true"})]})})]}),p.length>0&&o.jsxs("div",{className:ve.photoGallery,children:[p.map(R=>o.jsxs("div",{className:`${ve.galleryItem} ${R.isProfile?ve.profileGalleryItem:""}`,style:{cursor:R._id.toString().startsWith("temp-")?"not-allowed":"pointer"},onClick:()=>ke(R._id),children:[o.jsx("img",{src:R.url||"/placeholder.svg?height=100&width=100",alt:"Gallery",className:ve.galleryImage}),R.isLoading&&o.jsx("div",{className:ve.galleryItemLoading,children:o.jsx("div",{className:`${ve.spinner} ${ve.spinnerSmall}`})}),R._id.toString().startsWith("temp-")&&o.jsx("div",{className:ve.galleryItemUploading,children:"Uploading..."}),o.jsxs("div",{className:ve.photoControls,children:[o.jsx("button",{onClick:Y=>_t(R._id,Y),className:ve.photoControlBtn,title:R.isPrivate?"Make public":"Make private",disabled:D||R.isLoading||R._id.toString().startsWith("temp-"),"aria-label":R.isPrivate?"Make photo public":"Make photo private",children:R.isPrivate?o.jsx(Ss,{style:{fontSize:"14px"}}):o.jsx(m5,{style:{fontSize:"14px"}})}),!R.isProfile&&o.jsx("button",{onClick:Y=>{Y.stopPropagation(),ke(R._id)},className:ve.photoControlBtn,title:"Set as profile photo",disabled:D||R.isLoading||R._id.toString().startsWith("temp-"),"aria-label":"Set as profile photo",children:o.jsx(k5,{style:{fontSize:"14px"}})}),!R.isProfile&&o.jsx("button",{onClick:Y=>Ke(R._id,Y),className:ve.photoControlBtn,title:"Delete photo",disabled:D||R.isLoading,"aria-label":"Delete photo",children:o.jsx(_r,{style:{fontSize:"14px"}})})]}),R.isProfile&&o.jsx("div",{className:ve.profileBadge,children:"Profile"})]},R._id)),o.jsx("button",{type:"button",className:ve.addPhotoItem,onClick:Je,disabled:N||D,"aria-label":"Add new photo",children:o.jsx(Wo,{style:{fontSize:"24px",color:"#555"}})})]}),o.jsxs("div",{className:ve.profileInfo,children:[o.jsxs("div",{className:ve.profileHeader,children:[o.jsx("h2",{className:ve.profileTitle,children:"My Profile"}),c?o.jsxs("div",{className:`${ve.flexDisplay} ${ve.gap2}`,children:[o.jsxs("button",{className:`${ve.btn} ${ve.btnOutline}`,onClick:ht,disabled:G,"aria-label":"Cancel editing",children:[o.jsx(Vn,{})," ",o.jsx("span",{children:"Cancel"})]}),o.jsx("button",{className:`${ve.btn} ${ve.btnPrimary}`,onClick:pe,disabled:G,"aria-label":"Save profile changes",children:G?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:`${ve.spinner} ${ve.spinnerDark}`}),o.jsx("span",{children:"Saving..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(Lt,{})," ",o.jsx("span",{children:"Save"})]})})]}):o.jsxs("button",{className:`${ve.btn} ${ve.btnPrimary}`,onClick:()=>u(!0),"aria-label":"Edit profile",children:[o.jsx(pb,{})," ",o.jsx("span",{children:"Edit"})]})]}),o.jsxs("form",{className:"mt-4",onSubmit:pe,children:[o.jsxs("div",{className:`${ve.infoSection} animate-fade-in`,children:[o.jsx("h3",{className:ve.sectionTitle,children:"Basic Information"}),o.jsxs("div",{className:ve.infoGrid,children:[o.jsxs("div",{className:ve.formGroup,children:[o.jsx("label",{className:ve.formLabel,htmlFor:"nickname",children:"Nickname"}),o.jsx("input",{type:"text",id:"nickname",name:"nickname",className:`${ve.formControl} ${L.nickname?ve.borderDanger:""}`,value:d.nickname,onChange:at,disabled:!c,maxLength:50,"aria-invalid":L.nickname?"true":"false","aria-describedby":L.nickname?"nickname-error":void 0}),L.nickname&&o.jsxs("p",{id:"nickname-error",className:ve.errorMessage,children:[o.jsx(Kt,{className:"mr-1"}),L.nickname]})]}),o.jsxs("div",{className:ve.formGroup,children:[o.jsx("label",{className:ve.formLabel,htmlFor:"details.age",children:"Age"}),o.jsx("input",{type:"number",id:"details.age",name:"details.age",className:`${ve.formControl} ${L.age?ve.borderDanger:""}`,value:d.details.age,onChange:at,disabled:!c,min:"18",max:"120","aria-invalid":L.age?"true":"false","aria-describedby":L.age?"age-error":void 0}),L.age&&o.jsxs("p",{id:"age-error",className:ve.errorMessage,children:[o.jsx(Kt,{className:"mr-1"}),L.age]})]}),o.jsxs("div",{className:ve.formGroup,children:[o.jsx("label",{className:ve.formLabel,htmlFor:"details.location",children:"Location"}),o.jsx("input",{type:"text",id:"details.location",name:"details.location",className:`${ve.formControl} ${L.location?ve.borderDanger:""}`,value:d.details.location,onChange:at,disabled:!c,maxLength:100,"aria-invalid":L.location?"true":"false","aria-describedby":L.location?"location-error":void 0}),L.location&&o.jsxs("p",{id:"location-error",className:ve.errorMessage,children:[o.jsx(Kt,{className:"mr-1"}),L.location]})]})]}),o.jsxs("div",{className:ve.mt4,children:[o.jsx("label",{className:ve.formLabel,children:"I am a"}),o.jsx("div",{className:`${ve.flexDisplay} ${ve.flexWrap} ${ve.gap2}`,children:F.map(R=>{const Y=R==="woman"?ve["identity-woman"]:R==="man"?ve["identity-man"]:R==="couple"?ve["identity-couple"]:"";return o.jsxs("button",{type:"button",className:`${ve.interestTag} ${d.details.iAm===R?`${ve.selected} ${Y}`:Y}`,onClick:()=>c&&mt(R),disabled:!c,"aria-pressed":d.details.iAm===R,children:[R.charAt(0).toUpperCase()+R.slice(1),d.details.iAm===R&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R)})}),!d.details.iAm&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"Not specified"})]}),o.jsxs("div",{className:ve.mt4,children:[o.jsx("label",{className:ve.formLabel,children:"Marital Status"}),o.jsx("div",{className:`${ve.flexDisplay} ${ve.flexWrap} ${ve.gap2}`,children:E.map(R=>o.jsxs("button",{type:"button",className:`${ve.interestTag} ${d.details.maritalStatus===R?ve.selected:""}`,onClick:()=>c&&Ct(R),disabled:!c,"aria-pressed":d.details.maritalStatus===R,children:[R,d.details.maritalStatus===R&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R))}),!d.details.maritalStatus&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"Not specified"})]})]}),o.jsxs("div",{className:ve.infoSection,children:[o.jsx("h3",{className:ve.sectionTitle,children:"About Me"}),o.jsx("textarea",{name:"details.bio",rows:"5",className:`${ve.formControl} ${ve.textArea} ${L.bio?ve.borderDanger:""}`,value:d.details.bio||"",onChange:at,disabled:!c,maxLength:500,placeholder:c?"Tell others about yourself...":"No bio provided","aria-invalid":L.bio?"true":"false","aria-describedby":L.bio?"bio-error":void 0}),L.bio&&o.jsxs("p",{id:"bio-error",className:ve.errorMessage,children:[o.jsx(Kt,{style:{marginRight:"4px"}}),L.bio]}),c&&o.jsxs("div",{className:`${ve.textMuted} ${ve.textRight} ${ve.mt1}`,children:[d.details.bio?d.details.bio.length:0,"/500"]})]}),o.jsxs("div",{className:ve.infoSection,children:[o.jsx("h3",{className:ve.sectionTitle,children:"Interests"}),c&&o.jsx("div",{className:`${ve.textMuted} ${ve.mb2}`,children:"Select up to 10 interests"}),o.jsx("div",{className:ve.interestsTags,children:V.map(R=>{const Y=d.details.interests.includes(R);return o.jsxs("button",{type:"button",className:`${ve.interestTag} ${Y?ve.selected:""}`,onClick:()=>c&&yt(R),disabled:!c||!Y&&d.details.interests.length>=10,"aria-pressed":Y,"aria-label":`Interest: ${R}`,children:[R,Y&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R)})}),d.details.interests.length===0&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"No interests selected"})]}),o.jsxs("div",{className:ve.infoSection,children:[o.jsx("h3",{className:ve.sectionTitle,children:"Looking For"}),c&&o.jsx("div",{className:`${ve.textMuted} ${ve.mb2}`,children:"Select up to 3 options"}),o.jsx("div",{className:ve.interestsTags,children:O.map(R=>{const Y=d.details.lookingFor.includes(R),_=R.toLowerCase().includes("women")||R.toLowerCase().includes("woman")?ve["identity-woman"]:R.toLowerCase().includes("men")||R.toLowerCase().includes("man")?ve["identity-man"]:R.toLowerCase().includes("couple")?ve["identity-couple"]:"";return o.jsxs("button",{type:"button",className:`${ve.interestTag} ${Y?`${ve.selected} ${_}`:_}`,onClick:()=>c&&Ie(R),disabled:!c||!Y&&d.details.lookingFor.length>=3,"aria-pressed":Y,children:[R.charAt(0).toUpperCase()+R.slice(1),Y&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R)})}),d.details.lookingFor.length===0&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"Not specified"})]}),o.jsxs("div",{className:ve.infoSection,children:[o.jsx("h3",{className:ve.sectionTitle,children:"I'm Into"}),c&&o.jsx("div",{className:`${ve.textMuted} ${ve.mb2}`,children:"Select up to 20 tags"}),o.jsx("div",{className:ve.interestsTags,children:A.map(R=>{const Y=d.details.intoTags.includes(R);return o.jsxs("button",{type:"button",className:`${ve.interestTag} ${Y?ve.selected:""}`,onClick:()=>c&&qe(R),disabled:!c||!Y&&d.details.intoTags.length>=20,"aria-pressed":Y,children:[R,Y&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R)})}),d.details.intoTags.length===0&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"No tags selected"})]}),o.jsxs("div",{className:ve.infoSection,children:[o.jsx("h3",{className:ve.sectionTitle,children:"It Turns Me On"}),c&&o.jsx("div",{className:`${ve.textMuted} ${ve.mb2}`,children:"Select up to 20 tags"}),o.jsx("div",{className:ve.interestsTags,children:H.map(R=>{const Y=d.details.turnOns.includes(R);return o.jsxs("button",{type:"button",className:`${ve.interestTag} ${Y?ve.selected:""}`,onClick:()=>c&&jt(R),disabled:!c||!Y&&d.details.turnOns.length>=20,"aria-pressed":Y,children:[R,Y&&o.jsx(Lt,{style:{marginLeft:"4px"}})]},R)})}),d.details.turnOns.length===0&&!c&&o.jsx("p",{className:`${ve.textMuted} ${ve.fstItalic} ${ve.mt2}`,children:"No tags selected"})]})]})]})]})})})]})},Ek="_settingsPage_1s5cj_3",Ak="_settingsContent_1s5cj_20",Rk="_settingsContainer_1s5cj_30",Mk="_gradientBar_1s5cj_55",Lk="_settingsTitle_1s5cj_65",Ok="_settingsNavigation_1s5cj_76",Dk="_navItem_1s5cj_88",Bk="_active_1s5cj_118",zk="_navIcon_1s5cj_133",Pk="_settingsPanel_1s5cj_143",$k="_sectionHeader_1s5cj_149",Uk="_sectionIcon_1s5cj_163",Ik="_sectionTitle_1s5cj_168",Fk="_settingsOption_1s5cj_185",qk="_optionContent_1s5cj_213",Vk="_optionTitle_1s5cj_217",Hk="_optionDescription_1s5cj_228",Gk="_toggleWrapper_1s5cj_239",Yk="_toggleInput_1s5cj_246",Xk="_toggleSlider_1s5cj_252",Kk="_radioGroup_1s5cj_290",Qk="_radioOption_1s5cj_296",Wk="_radioInput_1s5cj_310",Zk="_themeOptions_1s5cj_345",Jk="_themeOption_1s5cj_345",eE="_themePreview_1s5cj_386",tE="_light_1s5cj_399",nE="_dark_1s5cj_15",sE="_system_1s5cj_451",iE="_themeName_1s5cj_477",aE="_accountInfo_1s5cj_488",rE="_accountDetail_1s5cj_513",oE="_accountLabel_1s5cj_530",lE="_accountActions_1s5cj_541",cE="_actionButton_1s5cj_547",uE="_editButton_1s5cj_566",dE="_logoutButton_1s5cj_570",fE="_deleteButton_1s5cj_574",hE="_actionIcon_1s5cj_578",mE="_saveSection_1s5cj_588",gE="_saveButton_1s5cj_594",pE="_hasChanges_1s5cj_621",yE="_modalOverlay_1s5cj_638",vE="_modalContainer_1s5cj_652",bE="_modalHeader_1s5cj_669",xE="_modalTitle_1s5cj_681",wE="_closeButton_1s5cj_691",_E="_modalContent_1s5cj_713",SE="_warningBox_1s5cj_717",jE="_warningIcon_1s5cj_731",CE="_warningText_1s5cj_739",NE="_warningList_1s5cj_749",TE="_warningItem_1s5cj_759",kE="_passwordSection_1s5cj_763",EE="_passwordLabel_1s5cj_767",AE="_passwordInput_1s5cj_778",RE="_error_1s5cj_803",ME="_errorMessage_1s5cj_807",LE="_modalActions_1s5cj_816",OE="_buttonCancel_1s5cj_828",DE="_buttonDelete_1s5cj_854",BE="_loadingState_1s5cj_882",zE="_spinner_1s5cj_890",PE="_loadingText_1s5cj_900",ie={settingsPage:Ek,settingsContent:Ak,settingsContainer:Rk,gradientBar:Mk,settingsTitle:Lk,settingsNavigation:Ok,navItem:Dk,active:Bk,navIcon:zk,settingsPanel:Pk,sectionHeader:$k,sectionIcon:Uk,sectionTitle:Ik,settingsOption:Fk,optionContent:qk,optionTitle:Vk,optionDescription:Hk,toggleWrapper:Gk,toggleInput:Yk,toggleSlider:Xk,radioGroup:Kk,radioOption:Qk,radioInput:Wk,themeOptions:Zk,themeOption:Jk,themePreview:eE,light:tE,dark:nE,system:sE,themeName:iE,accountInfo:aE,accountDetail:rE,accountLabel:oE,accountActions:lE,actionButton:cE,editButton:uE,logoutButton:dE,deleteButton:fE,actionIcon:hE,saveSection:mE,saveButton:gE,hasChanges:pE,modalOverlay:yE,modalContainer:vE,modalHeader:bE,modalTitle:xE,closeButton:wE,modalContent:_E,warningBox:SE,warningIcon:jE,warningText:CE,warningList:NE,warningItem:TE,passwordSection:kE,passwordLabel:EE,passwordInput:AE,error:RE,errorMessage:ME,modalActions:LE,buttonCancel:OE,buttonDelete:DE,loadingState:BE,spinner:zE,loadingText:PE},$E=()=>{const t=In(),{user:e,logout:i,getCurrentUser:a}=Sn(),{theme:c,setTheme:u}=Tb(),{currentUser:d,updateProfile:h,getUser:p}=ka(),y=b.useRef(null),g={notifications:{messages:!0,calls:!0,stories:!0,likes:!0,comments:!0},privacy:{showOnlineStatus:!0,showReadReceipts:!0,showLastSeen:!0,allowStoryReplies:"everyone"}},[w,C]=b.useState(g),[j,N]=b.useState("notifications"),[M,D]=b.useState(!1),[I,V]=b.useState(!1),[F,O]=b.useState(""),[A,H]=b.useState(""),[E,L]=b.useState(!1),[P,G]=b.useState(!1),[Q,z]=b.useState(!0),[ae,Pe]=b.useState(null);b.useEffect(()=>{if(P&&d)return;console.log("useEffect for settings loading triggered"),d?(async()=>{var Re,he,Ue,ze,Xe,Qe,Ge,at,yt,mt,Ie,qe,jt,Ct,Rt,pe,je,Je,_t,ke,Ke,ht,B,R,Y,_,v,x,T,U;try{console.log("Fetching fresh settings from the server");const X=await qc.getUserSettings();if(X&&X.success&&X.data){console.log("Successfully loaded settings from server:",X.data),console.log("Message notifications from server:",(Re=X.data.notifications)==null?void 0:Re.messages,"typeof:",typeof((he=X.data.notifications)==null?void 0:he.messages));const le={notifications:{messages:((Ue=X.data.notifications)==null?void 0:Ue.messages)===!1?!1:!!((ze=X.data.notifications)!=null&&ze.messages),calls:((Xe=X.data.notifications)==null?void 0:Xe.calls)===!1?!1:!!((Qe=X.data.notifications)!=null&&Qe.calls),stories:((Ge=X.data.notifications)==null?void 0:Ge.stories)===!1?!1:!!((at=X.data.notifications)!=null&&at.stories),likes:((yt=X.data.notifications)==null?void 0:yt.likes)===!1?!1:!!((mt=X.data.notifications)!=null&&mt.likes),comments:((Ie=X.data.notifications)==null?void 0:Ie.comments)===!1?!1:!!((qe=X.data.notifications)!=null&&qe.comments)},privacy:{showOnlineStatus:((jt=X.data.privacy)==null?void 0:jt.showOnlineStatus)??g.privacy.showOnlineStatus,showReadReceipts:((Ct=X.data.privacy)==null?void 0:Ct.showReadReceipts)??g.privacy.showReadReceipts,showLastSeen:((Rt=X.data.privacy)==null?void 0:Rt.showLastSeen)??g.privacy.showLastSeen,allowStoryReplies:((pe=X.data.privacy)==null?void 0:pe.allowStoryReplies)??g.privacy.allowStoryReplies}};console.log("Normalized settings to apply:",le),console.log("Message notifications in normalized settings:",le.notifications.messages,"typeof:",typeof le.notifications.messages),C(le),G(!0);return}}catch(X){console.error("Error fetching settings from server:",X)}if(d&&d.settings){console.log("Falling back to currentUser settings:",d.settings);const X=d.settings||{},le={notifications:{messages:((je=X.notifications)==null?void 0:je.messages)===!1?!1:!!((Je=X.notifications)!=null&&Je.messages),calls:((_t=X.notifications)==null?void 0:_t.calls)===!1?!1:!!((ke=X.notifications)!=null&&ke.calls),stories:((Ke=X.notifications)==null?void 0:Ke.stories)===!1?!1:!!((ht=X.notifications)!=null&&ht.stories),likes:((B=X.notifications)==null?void 0:B.likes)===!1?!1:!!((R=X.notifications)!=null&&R.likes),comments:((Y=X.notifications)==null?void 0:Y.comments)===!1?!1:!!((_=X.notifications)!=null&&_.comments)},privacy:{showOnlineStatus:((v=X.privacy)==null?void 0:v.showOnlineStatus)??g.privacy.showOnlineStatus,showReadReceipts:((x=X.privacy)==null?void 0:x.showReadReceipts)??g.privacy.showReadReceipts,showLastSeen:((T=X.privacy)==null?void 0:T.showLastSeen)??g.privacy.showLastSeen,allowStoryReplies:((U=X.privacy)==null?void 0:U.allowStoryReplies)??g.privacy.allowStoryReplies}};console.log("Normalized settings from user object:",le),console.log("Message notifications in normalized user settings:",le.notifications.messages,"typeof:",typeof le.notifications.messages),C(le),G(!0)}else console.log("No settings available, using defaults"),G(!0)})():console.log("No currentUser available, skipping settings load")},[d,g,P]);const Ee=(ee,Re)=>{const he=!!w[ee][Re];console.log(`Toggling ${ee}.${Re}:`,`Current value: ${he} (${typeof w[ee][Re]})`,`New value: ${!he}`),C(Ue=>{const ze={...Ue,[ee]:{...Ue[ee],[Re]:!he}};return console.log("New settings after toggle:",ze),ze}),L(!0)},K=(ee,Re,he)=>{C(Ue=>({...Ue,[ee]:{...Ue[ee],[Re]:he}})),L(!0)},q=ee=>{u(ee)},J=async()=>{try{V(!0),console.log("Saving settings:",w);const ee={notifications:{messages:w.notifications.messages===!1?!1:!!w.notifications.messages,calls:w.notifications.calls===!1?!1:!!w.notifications.calls,stories:w.notifications.stories===!1?!1:!!w.notifications.stories,likes:w.notifications.likes===!1?!1:!!w.notifications.likes,comments:w.notifications.comments===!1?!1:!!w.notifications.comments},privacy:{...w.privacy}};console.log("Normalized settings before saving:",ee),console.log("Messages notification specifically:",ee.notifications.messages);const Re=await qc.updateSettings(ee);if(!Re.success)throw new Error(Re.error||"Failed to save settings");d&&(console.log("Updating user profile with normalized settings"),await h({settings:ee})||console.warn("User profile update returned empty response")),Promise.all([Pn(()=>Promise.resolve().then(()=>Cr),void 0),Pn(()=>Promise.resolve().then(()=>jr),void 0)]).then(([he,Ue])=>{const ze=he.default,Xe=Ue.default;console.log("Updating notification service with normalized settings:",ee.notifications),ze.updateSettings(ee.notifications),console.log("Updating socket service with settings:",ee.privacy),Xe.updatePrivacySettings(ee.privacy),console.log("Services updated with new settings")}).catch(he=>{console.error("Error updating services with settings:",he)}),ne.success("Settings saved successfully"),L(!1),console.log("Setting current UI state to match saved settings"),C(ee)}catch(ee){console.error("Error saving settings:",ee),ne.error(ee.message||"Failed to save settings. Please try again.")}finally{V(!1)}},re=()=>{E?window.confirm("You have unsaved changes. Are you sure you want to log out?")&&(i(),t("/login")):(i(),t("/login"))},Ne=()=>{D(!0)},Se=async()=>{try{if(H(""),!F){H("Please enter your password to confirm account deletion");return}const ee=await qc.deleteAccount({password:F});ee.success?(ne.success("Account deleted successfully"),i(),t("/login")):H(ee.error||"Failed to delete account")}catch(ee){console.error("Error deleting account:",ee),H(ee.error||"Failed to delete account. Please try again.")}},Ve=()=>{D(!1),O(""),H("")};b.useEffect(()=>{if(P){z(!1);return}console.log("Combined loading effect running"),console.log("User available:",!!e,"currentUser available:",!!d),(async()=>{if(e&&!d&&e._id){console.log("User exists but currentUser is not available yet - fetching user profile");try{typeof p=="function"&&(console.log("Using getUser from UserContext to fetch profile"),await p(e._id)),!d&&typeof a=="function"&&(console.log("Using getCurrentUser from AuthContext to fetch profile"),await a())}catch(Re){console.error("Error fetching user profile:",Re)}}d&&z(!1)})()},[e,d,a,p,P]),b.useEffect(()=>{var ze,Xe,Qe,Ge,at,yt,mt,Ie,qe,jt,Ct,Rt,pe,je,Je;if(!P||!d||!d.settings)return;const ee=!y.current||y.current._id!==d._id,Re=(ze=y.current)==null?void 0:ze.settings,he=d.settings;if(!ee&&Re&&JSON.stringify(Re)===JSON.stringify(he))return;console.log("Detected meaningful change in currentUser settings, updating UI state");const Ue={notifications:{messages:((Xe=he.notifications)==null?void 0:Xe.messages)===!1?!1:!!((Qe=he.notifications)!=null&&Qe.messages),calls:((Ge=he.notifications)==null?void 0:Ge.calls)===!1?!1:!!((at=he.notifications)!=null&&at.calls),stories:((yt=he.notifications)==null?void 0:yt.stories)===!1?!1:!!((mt=he.notifications)!=null&&mt.stories),likes:((Ie=he.notifications)==null?void 0:Ie.likes)===!1?!1:!!((qe=he.notifications)!=null&&qe.likes),comments:((jt=he.notifications)==null?void 0:jt.comments)===!1?!1:!!((Ct=he.notifications)!=null&&Ct.comments)},privacy:{showOnlineStatus:((Rt=he.privacy)==null?void 0:Rt.showOnlineStatus)??g.privacy.showOnlineStatus,showReadReceipts:((pe=he.privacy)==null?void 0:pe.showReadReceipts)??g.privacy.showReadReceipts,showLastSeen:((je=he.privacy)==null?void 0:je.showLastSeen)??g.privacy.showLastSeen,allowStoryReplies:((Je=he.privacy)==null?void 0:Je.allowStoryReplies)??g.privacy.allowStoryReplies}};y.current=d,C(Ue)},[d,g,P]);const ge=()=>{var ee;switch(j){case"notifications":return o.jsxs("div",{className:ie.settingsContent,children:[o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Message Notifications"}),o.jsx("p",{className:ie.optionDescription,children:"Get notified when you receive new messages"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.notifications.messages,onChange:()=>Ee("notifications","messages"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Call Notifications"}),o.jsx("p",{className:ie.optionDescription,children:"Get notified for incoming calls"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.notifications.calls,onChange:()=>Ee("notifications","calls"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Story Notifications"}),o.jsx("p",{className:ie.optionDescription,children:"Get notified when friends post new stories"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.notifications.stories,onChange:()=>Ee("notifications","stories"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Like Notifications"}),o.jsx("p",{className:ie.optionDescription,children:"Get notified when someone likes your content"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.notifications.likes,onChange:()=>Ee("notifications","likes"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Comment Notifications"}),o.jsx("p",{className:ie.optionDescription,children:"Get notified when someone comments on your content"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.notifications.comments,onChange:()=>Ee("notifications","comments"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]})]});case"privacy":return o.jsxs("div",{className:ie.settingsContent,children:[o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Online Status"}),o.jsx("p",{className:ie.optionDescription,children:"Show when you're active on the app"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.privacy.showOnlineStatus,onChange:()=>Ee("privacy","showOnlineStatus"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Read Receipts"}),o.jsx("p",{className:ie.optionDescription,children:"Let others know when you've read their messages"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.privacy.showReadReceipts,onChange:()=>Ee("privacy","showReadReceipts"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Last Seen"}),o.jsx("p",{className:ie.optionDescription,children:"Show when you were last active"})]}),o.jsxs("label",{className:ie.toggleWrapper,children:[o.jsx("input",{type:"checkbox",checked:w.privacy.showLastSeen,onChange:()=>Ee("privacy","showLastSeen"),className:ie.toggleInput}),o.jsx("span",{className:ie.toggleSlider})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Story Replies"}),o.jsx("p",{className:ie.optionDescription,children:"Control who can reply to your stories"})]}),o.jsxs("div",{className:ie.radioGroup,children:[o.jsxs("label",{className:ie.radioOption,children:[o.jsx("input",{type:"radio",name:"storyReplies",value:"everyone",checked:w.privacy.allowStoryReplies==="everyone",onChange:()=>K("privacy","allowStoryReplies","everyone"),className:ie.radioInput}),"Everyone"]}),o.jsxs("label",{className:ie.radioOption,children:[o.jsx("input",{type:"radio",name:"storyReplies",value:"friends",checked:w.privacy.allowStoryReplies==="friends",onChange:()=>K("privacy","allowStoryReplies","friends"),className:ie.radioInput}),"Friends only"]}),o.jsxs("label",{className:ie.radioOption,children:[o.jsx("input",{type:"radio",name:"storyReplies",value:"none",checked:w.privacy.allowStoryReplies==="none",onChange:()=>K("privacy","allowStoryReplies","none"),className:ie.radioInput}),"No one"]})]})]})]});case"appearance":return o.jsxs("div",{className:ie.settingsContent,children:[o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Theme"}),o.jsx("p",{className:ie.optionDescription,children:"Choose your preferred app theme"})]}),o.jsxs("div",{className:ie.themeOptions,children:[o.jsxs("button",{className:`${ie.themeOption} ${c==="light"?ie.active:""}`,onClick:()=>q("light"),children:[o.jsx("div",{className:`${ie.themePreview} ${ie.light}`}),o.jsx("span",{className:ie.themeName,children:"Light"})]}),o.jsxs("button",{className:`${ie.themeOption} ${c==="dark"?ie.active:""}`,onClick:()=>q("dark"),children:[o.jsx("div",{className:`${ie.themePreview} ${ie.dark}`}),o.jsx("span",{className:ie.themeName,children:"Dark"})]}),o.jsxs("button",{className:`${ie.themeOption} ${c==="system"?ie.active:""}`,onClick:()=>q("system"),children:[o.jsx("div",{className:`${ie.themePreview} ${ie.system}`}),o.jsx("span",{className:ie.themeName,children:"System"})]})]})]}),o.jsxs("div",{className:ie.settingsOption,children:[o.jsxs("div",{className:ie.optionContent,children:[o.jsx("h3",{className:ie.optionTitle,children:"Quick Theme Toggle"}),o.jsx("p",{className:ie.optionDescription,children:"Quickly switch between light and dark mode"})]}),o.jsx(gu,{})]})]});case"account":return o.jsxs("div",{className:ie.settingsContent,children:[o.jsxs("div",{className:ie.accountInfo,children:[o.jsxs("div",{className:ie.accountDetail,children:[o.jsx("span",{className:ie.accountLabel,children:"Username:"})," ",(e==null?void 0:e.username)||"Not available"]}),o.jsxs("div",{className:ie.accountDetail,children:[o.jsx("span",{className:ie.accountLabel,children:"Email:"})," ",(e==null?void 0:e.email)||"Not available"]}),o.jsxs("div",{className:ie.accountDetail,children:[o.jsx("span",{className:ie.accountLabel,children:"Member since:"})," ",e!=null&&e.createdAt?new Date(e.createdAt).toLocaleDateString():"Not available"]}),o.jsxs("div",{className:ie.accountDetail,children:[o.jsx("span",{className:ie.accountLabel,children:"Subscription:"})," ",((ee=e==null?void 0:e.subscription)==null?void 0:ee.plan)||"Free"]})]}),o.jsxs("div",{className:ie.accountActions,children:[o.jsxs("button",{className:`${ie.actionButton} ${ie.editButton}`,onClick:()=>t("/profile"),children:[o.jsx(Bc,{className:ie.actionIcon}),o.jsx("span",{children:"Edit Profile"})]}),o.jsxs("button",{className:`${ie.actionButton} ${ie.logoutButton}`,onClick:re,children:[o.jsx(j5,{className:ie.actionIcon}),o.jsx("span",{children:"Log out"})]}),o.jsxs("button",{className:`${ie.actionButton} ${ie.deleteButton}`,onClick:Ne,children:[o.jsx(_r,{className:ie.actionIcon}),o.jsx("span",{children:"Delete Account"})]})]})]});default:return null}};return!d&&Q&&!ae?o.jsxs("div",{className:ie.settingsPage,children:[o.jsx(kr,{}),o.jsx("div",{className:ie.settingsContent,children:o.jsxs("div",{className:ie.settingsContainer,children:[o.jsx("div",{className:ie.gradientBar}),o.jsx("h1",{className:ie.settingsTitle,children:"Settings"}),o.jsxs("div",{className:ie.loadingState,children:[o.jsx("div",{className:ie.spinner}),o.jsx("p",{className:ie.loadingText,children:"Loading your settings..."})]})]})})]}):o.jsxs("div",{className:ie.settingsPage,children:[o.jsx(kr,{}),o.jsx("div",{className:ie.settingsContent,children:o.jsxs("div",{className:ie.settingsContainer,children:[o.jsx("div",{className:ie.gradientBar}),o.jsx("h1",{className:ie.settingsTitle,children:"Settings"}),o.jsxs("div",{className:ie.settingsNavigation,children:[o.jsxs("button",{className:`${ie.navItem} ${j==="notifications"?ie.active:""}`,onClick:()=>N("notifications"),children:[o.jsx(Nr,{className:ie.navIcon}),o.jsx("span",{children:"Notifications"})]}),o.jsxs("button",{className:`${ie.navItem} ${j==="privacy"?ie.active:""}`,onClick:()=>N("privacy"),children:[o.jsx(Ss,{className:ie.navIcon}),o.jsx("span",{children:"Privacy"})]}),o.jsxs("button",{className:`${ie.navItem} ${j==="appearance"?ie.active:""}`,onClick:()=>N("appearance"),children:[o.jsx(fh,{className:ie.navIcon}),o.jsx("span",{children:"Appearance"})]}),o.jsxs("button",{className:`${ie.navItem} ${j==="account"?ie.active:""}`,onClick:()=>N("account"),children:[o.jsx(Bc,{className:ie.navIcon}),o.jsx("span",{children:"Account"})]})]}),o.jsxs("div",{className:ie.settingsPanel,children:[o.jsxs("div",{className:ie.sectionHeader,children:[j==="notifications"&&o.jsx(Nr,{className:ie.sectionIcon}),j==="privacy"&&o.jsx(Ss,{className:ie.sectionIcon}),j==="appearance"&&o.jsx(fh,{className:ie.sectionIcon}),j==="account"&&o.jsx(Bc,{className:ie.sectionIcon}),o.jsxs("h2",{className:ie.sectionTitle,children:[j==="notifications"&&"Notification Settings",j==="privacy"&&"Privacy Settings",j==="appearance"&&"Appearance Settings",j==="account"&&"Account Settings"]})]}),ge(),(j==="notifications"||j==="privacy")&&o.jsx("div",{className:ie.saveSection,children:o.jsxs("button",{className:`${ie.saveButton} ${E?ie.hasChanges:""}`,onClick:J,disabled:I||!E,children:[o.jsx(w5,{}),I?"Saving...":"Save Changes"]})})]})]})}),M&&o.jsx("div",{className:ie.modalOverlay,children:o.jsxs("div",{className:ie.modalContainer,children:[o.jsxs("div",{className:ie.modalHeader,children:[o.jsxs("h2",{className:ie.modalTitle,children:[o.jsx(_r,{})," Delete Account"]}),o.jsx("button",{className:ie.closeButton,onClick:Ve,children:o.jsx(Vn,{})})]}),o.jsxs("div",{className:ie.modalContent,children:[o.jsxs("div",{className:ie.warningBox,children:[o.jsx(S5,{className:ie.warningIcon}),o.jsxs("p",{className:ie.warningText,children:["This action ",o.jsx("strong",{children:"cannot be undone"}),". All your data will be permanently deleted, including:"]}),o.jsxs("ul",{className:ie.warningList,children:[o.jsx("li",{className:ie.warningItem,children:"Your profile information"}),o.jsx("li",{className:ie.warningItem,children:"All messages and conversations"}),o.jsx("li",{className:ie.warningItem,children:"Photos and media you've shared"}),o.jsx("li",{className:ie.warningItem,children:"Stories and other content"})]})]}),o.jsxs("div",{className:ie.passwordSection,children:[o.jsx("label",{className:ie.passwordLabel,htmlFor:"delete-password",children:"Enter your password to confirm:"}),o.jsx("input",{id:"delete-password",type:"password",value:F,onChange:ee=>O(ee.target.value),placeholder:"Your password",className:`${ie.passwordInput} ${A?ie.error:""}`}),A&&o.jsxs("div",{className:ie.errorMessage,children:[o.jsx(Kt,{})," ",A]})]})]}),o.jsxs("div",{className:ie.modalActions,children:[o.jsxs("button",{className:ie.buttonCancel,onClick:Ve,children:[o.jsx(Vn,{})," Cancel"]}),o.jsxs("button",{className:ie.buttonDelete,onClick:Se,disabled:!F,children:[o.jsx(_r,{})," Delete My Account"]})]})]})})]})},UE=()=>{const t=In();return o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center",style:{height:"80vh",textAlign:"center"},children:[o.jsx("h1",{style:{fontSize:"3rem",marginBottom:"16px"},children:"404"}),o.jsx("p",{style:{marginBottom:"24px"},children:"Oops! The page you're looking for doesn't exist."}),o.jsx("button",{className:"btn btn-primary",onClick:()=>t("/"),children:"Go Home"})]})},IE=()=>{const t=In(),[e,i]=b.useState(""),[a,c]=b.useState([]);b.useEffect(()=>{c([{id:1,name:"Emma",age:28,location:"New York",image:"https://images.unsplash.com/photo-1534528741775-53994a69daeb?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:2,name:"Michael",age:32,location:"Los Angeles",image:"https://images.unsplash.com/photo-1539571696357-5a69c17a67c6?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:3,name:"Sophia",age:26,location:"Chicago",image:"https://images.unsplash.com/photo-1517841905240-472988babdf9?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:4,name:"James",age:30,location:"Miami",image:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:5,name:"Olivia",age:29,location:"San Francisco",image:"https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:6,name:"Daniel",age:31,location:"Boston",image:"https://images.unsplash.com/photo-1500048993953-d23a436266cf?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:7,name:"Sarah",age:27,location:"Seattle",image:"https://images.unsplash.com/photo-1524504388940-b1c1722653e1?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:8,name:"Alex",age:33,location:"Austin",image:"https://images.unsplash.com/photo-1504257432389-52343af06ae3?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:9,name:"Jessica",age:25,location:"Denver",image:"https://images.unsplash.com/photo-1488426862026-3ee34a7d66df?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:10,name:"Ryan",age:34,location:"Portland",image:"https://images.unsplash.com/photo-1499996860823-5214fcc65f8f?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:11,name:"Lisa",age:29,location:"Phoenix",image:"https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"},{id:12,name:"Chris",age:31,location:"Atlanta",image:"https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80",status:"online"}])},[]);const u=()=>{t("/register")},d=h=>{h.preventDefault(),t("/register",{state:{email:e}})};return o.jsxs("div",{className:"modern-home-page w-100 overflow-hidden",children:[o.jsx("header",{className:"modern-header glass-effect sticky-top shadow-sm",children:o.jsxs("div",{className:"container d-flex justify-content-between align-items-center py-2",children:[o.jsx("div",{className:"logo gradient-text font-weight-bold text-nowrap",children:"Mandarin"}),o.jsxs("nav",{className:"d-none d-md-flex main-tabs gap-4",children:[o.jsx(_n,{to:"/about",className:"tab-button hover-opacity transition-all",children:"About"}),o.jsx(_n,{to:"/safety",className:"tab-button hover-opacity transition-all",children:"Safety"}),o.jsx(_n,{to:"/support",className:"tab-button hover-opacity transition-all",children:"Support"})]}),o.jsxs("div",{className:"header-actions d-flex align-items-center gap-2",children:[o.jsx(gu,{}),o.jsx(_n,{to:"/login",className:"btn btn-outline btn-sm hover-scale transition-all",children:"Login"}),o.jsx(_n,{to:"/register",className:"btn btn-primary btn-sm hover-scale transition-all",children:"Register"})]})]})}),o.jsxs("section",{className:"hero-section animate-fade-in py-5 position-relative overflow-hidden",children:[o.jsxs("div",{className:"hero-content mx-auto text-center p-4 max-w-lg",children:[o.jsx("h1",{className:"animate-slide-up mb-4 text-shadow font-weight-bold",children:"Find Your Perfect Connection"}),o.jsx("p",{className:"animate-slide-up delay-200 mb-4 text-md opacity-90 line-height-relaxed",children:"Discover genuine connections in a safe, discreet environment designed for adults seeking meaningful encounters."}),o.jsx("div",{className:"hero-actions animate-slide-up delay-300 mx-auto max-w-md",children:o.jsxs("form",{onSubmit:d,className:"email-signup-form d-flex gap-2 shadow-md rounded-lg overflow-hidden",children:[o.jsx("input",{type:"email",placeholder:"Enter your email",className:"form-control border-0 py-3 flex-grow-1",value:e,onChange:h=>i(h.target.value),required:!0}),o.jsxs("button",{type:"submit",className:"btn btn-primary btn-lg d-flex align-items-center gap-2 transition-transform hover-scale",children:[o.jsx("span",{children:"Get Started"})," ",o.jsx(xr,{})]})]})})]}),o.jsx("div",{className:"hero-image position-relative mt-5",children:o.jsxs("div",{className:"image-collage d-flex justify-content-center",children:[o.jsx("div",{className:"collage-image image1 rounded-lg shadow-lg transform-gpu scale-up-hover transition-transform"}),o.jsx("div",{className:"collage-image image2 rounded-lg shadow-lg transform-gpu scale-up-hover transition-transform"}),o.jsx("div",{className:"collage-image image3 rounded-lg shadow-lg transform-gpu scale-up-hover transition-transform"})]})})]}),o.jsx("section",{className:"online-users-section animate-fade-in py-5 my-4",children:o.jsxs("div",{className:"container",children:[o.jsxs("div",{className:"section-header text-center mb-5",children:[o.jsxs("h2",{className:"gradient-text animate-slide-up mb-3 d-flex align-items-center justify-content-center gap-2",children:[o.jsx(M5,{className:"text-primary"})," ",o.jsx("span",{children:"People Online Now"})]}),o.jsx("p",{className:"section-subtitle animate-slide-up delay-100 text-opacity-80 max-w-md mx-auto",children:"Connect with these amazing people who are currently active on Mandarin"})]}),o.jsx("div",{className:"online-users-grid grid-cols-2 grid-cols-md-3 grid-cols-lg-4 gap-3 animate-slide-up delay-200",children:a.map((h,p)=>o.jsxs("div",{className:"online-user-card staggered-item shadow-sm hover-shadow-md rounded-lg overflow-hidden transition-all cursor-pointer transform-gpu hover-scale",onClick:()=>t("/register"),children:[o.jsxs("div",{className:"user-card-photo position-relative",children:[o.jsx("img",{src:h.image,alt:h.name,className:"w-100 h-auto object-cover aspect-ratio-1"}),o.jsx("div",{className:"user-status online position-absolute rounded-circle pulse-animation"})]}),o.jsxs("div",{className:"user-card-info p-3",children:[o.jsxs("h3",{className:"user-name mb-1 font-weight-medium text-truncate",children:[h.name,", ",h.age]}),o.jsxs("p",{className:"user-location text-sm mb-2 d-flex align-items-center gap-1 text-opacity-70",children:[o.jsx(Tr,{className:"location-icon text-primary-light"})," ",h.location]}),o.jsxs("div",{className:"user-actions d-flex gap-2 justify-content-end",children:[o.jsx("button",{className:"mini-action-btn like-btn d-flex align-items-center justify-content-center rounded-circle shadow-sm hover-scale transition-transform",onClick:y=>{y.stopPropagation(),t("/register")},children:o.jsx(jb,{className:"text-danger"})}),o.jsx("button",{className:"mini-action-btn message-btn d-flex align-items-center justify-content-center rounded-circle shadow-sm hover-scale transition-transform",onClick:y=>{y.stopPropagation(),t("/register")},children:o.jsx(Ta,{className:"text-primary"})})]})]})]},h.id))}),o.jsx("div",{className:"view-more-container animate-slide-up delay-400 text-center mt-5",children:o.jsxs("button",{className:"btn btn-secondary btn-lg d-inline-flex align-items-center gap-2 shadow-md hover-scale transition-all px-4 py-3",onClick:u,children:[o.jsx("span",{children:"Join to See More"})," ",o.jsx(xr,{})]})})]})}),o.jsx("section",{className:"features-section animate-fade-in bg-light-subtle py-5 my-4 rounded-lg mx-3",children:o.jsx("div",{className:"container",children:o.jsxs("div",{className:"features-grid grid-cols-1 grid-cols-md-3 gap-4",children:[o.jsxs("div",{className:"feature-card animate-slide-up bg-white p-4 rounded-lg shadow-sm hover-shadow-md transition-all text-center",children:[o.jsx("div",{className:"feature-icon privacy d-flex justify-content-center align-items-center mx-auto mb-3 rounded-circle bg-primary-50"}),o.jsx("h3",{className:"font-weight-medium mb-3",children:"Privacy First"}),o.jsx("p",{className:"text-opacity-70 line-height-relaxed",children:"Your privacy is our top priority. Control who sees your profile and what information you share."})]}),o.jsxs("div",{className:"feature-card animate-slide-up delay-100 bg-white p-4 rounded-lg shadow-sm hover-shadow-md transition-all text-center",children:[o.jsx("div",{className:"feature-icon secure d-flex justify-content-center align-items-center mx-auto mb-3 rounded-circle bg-primary-50"}),o.jsx("h3",{className:"font-weight-medium mb-3",children:"Secure Communication"}),o.jsx("p",{className:"text-opacity-70 line-height-relaxed",children:"End-to-end encrypted messaging ensures your conversations remain private and secure."})]}),o.jsxs("div",{className:"feature-card animate-slide-up delay-200 bg-white p-4 rounded-lg shadow-sm hover-shadow-md transition-all text-center",children:[o.jsx("div",{className:"feature-icon match d-flex justify-content-center align-items-center mx-auto mb-3 rounded-circle bg-primary-50"}),o.jsx("h3",{className:"font-weight-medium mb-3",children:"Smart Matching"}),o.jsx("p",{className:"text-opacity-70 line-height-relaxed",children:"Our advanced algorithm connects you with people who match your preferences and interests."})]})]})})}),o.jsxs("footer",{className:"modern-footer mt-5 border-top pt-5",children:[o.jsxs("div",{className:"container footer-content d-flex flex-column flex-md-row justify-content-between align-items-center gap-4 mb-4",children:[o.jsx("div",{className:"footer-logo gradient-text font-weight-bold text-xl",children:"Mandarin"}),o.jsxs("div",{className:"footer-links d-flex flex-wrap justify-content-center gap-3 gap-md-4",children:[o.jsx(_n,{to:"/about",className:"text-decoration-none text-body hover-text-primary transition-all",children:"About Us"}),o.jsx(_n,{to:"/safety",className:"text-decoration-none text-body hover-text-primary transition-all",children:"Safety"}),o.jsx(_n,{to:"/support",className:"text-decoration-none text-body hover-text-primary transition-all",children:"Support"}),o.jsx(_n,{to:"/terms",className:"text-decoration-none text-body hover-text-primary transition-all",children:"Terms"}),o.jsx(_n,{to:"/privacy",className:"text-decoration-none text-body hover-text-primary transition-all",children:"Privacy"})]}),o.jsxs("div",{className:"footer-social d-flex gap-3",children:[o.jsx("a",{href:"#",className:"social-icon d-flex align-items-center justify-content-center rounded-circle bg-light hover-bg-primary hover-text-white transition-all shadow-sm",children:"FB"}),o.jsx("a",{href:"#",className:"social-icon d-flex align-items-center justify-content-center rounded-circle bg-light hover-bg-primary hover-text-white transition-all shadow-sm",children:"IG"}),o.jsx("a",{href:"#",className:"social-icon d-flex align-items-center justify-content-center rounded-circle bg-light hover-bg-primary hover-text-white transition-all shadow-sm",children:"TW"})]})]}),o.jsx("div",{className:"footer-bottom border-top py-3 text-center",children:o.jsxs("p",{className:"text-sm text-opacity-70 mb-0",children:["© ",new Date().getFullYear()," Mandarin Dating. All rights reserved."]})})]})]})},ay=6e4,ry=525600,oy=43200,ly=1440,cy=Symbol.for("constructDateFrom");function im(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&cy in t?t[cy](e):t instanceof Date?new t.constructor(e):new Date(e)}function xh(t,e){return im(t,t)}let FE={};function qE(){return FE}function uy(t){const e=xh(t),i=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return i.setUTCFullYear(e.getFullYear()),+t-+i}function VE(t,...e){const i=im.bind(null,t||e.find(a=>typeof a=="object"));return e.map(i)}function HE(t,e){const i=+xh(t)-+xh(e);return i<0?-1:i>0?1:i}function GE(t){return im(t,Date.now())}function YE(t){return e=>{const a=(t?Math[t]:Math.trunc)(e);return a===0?0:a}}const XE={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},KE=(t,e,i)=>{let a;const c=XE[t];return typeof c=="string"?a=c:e===1?a=c.one:a=c.other.replace("{{count}}",e.toString()),i!=null&&i.addSuffix?i.comparison&&i.comparison>0?"in "+a:a+" ago":a};function Hf(t){return(e={})=>{const i=e.width?String(e.width):t.defaultWidth;return t.formats[i]||t.formats[t.defaultWidth]}}const QE={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},WE={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ZE={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},JE={date:Hf({formats:QE,defaultWidth:"full"}),time:Hf({formats:WE,defaultWidth:"full"}),dateTime:Hf({formats:ZE,defaultWidth:"full"})},e9={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},t9=(t,e,i,a)=>e9[t];function Bo(t){return(e,i)=>{const a=i!=null&&i.context?String(i.context):"standalone";let c;if(a==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,h=i!=null&&i.width?String(i.width):d;c=t.formattingValues[h]||t.formattingValues[d]}else{const d=t.defaultWidth,h=i!=null&&i.width?String(i.width):t.defaultWidth;c=t.values[h]||t.values[d]}const u=t.argumentCallback?t.argumentCallback(e):e;return c[u]}}const n9={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},s9={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},i9={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},a9={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},r9={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o9={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l9=(t,e)=>{const i=Number(t),a=i%100;if(a>20||a<10)switch(a%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},c9={ordinalNumber:l9,era:Bo({values:n9,defaultWidth:"wide"}),quarter:Bo({values:s9,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Bo({values:i9,defaultWidth:"wide"}),day:Bo({values:a9,defaultWidth:"wide"}),dayPeriod:Bo({values:r9,defaultWidth:"wide",formattingValues:o9,defaultFormattingWidth:"wide"})};function zo(t){return(e,i={})=>{const a=i.width,c=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],u=e.match(c);if(!u)return null;const d=u[0],h=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],p=Array.isArray(h)?d9(h,w=>w.test(d)):u9(h,w=>w.test(d));let y;y=t.valueCallback?t.valueCallback(p):p,y=i.valueCallback?i.valueCallback(y):y;const g=e.slice(d.length);return{value:y,rest:g}}}function u9(t,e){for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return i}function d9(t,e){for(let i=0;i<t.length;i++)if(e(t[i]))return i}function f9(t){return(e,i={})=>{const a=e.match(t.matchPattern);if(!a)return null;const c=a[0],u=e.match(t.parsePattern);if(!u)return null;let d=t.valueCallback?t.valueCallback(u[0]):u[0];d=i.valueCallback?i.valueCallback(d):d;const h=e.slice(c.length);return{value:d,rest:h}}}const h9=/^(\d+)(th|st|nd|rd)?/i,m9=/\d+/i,g9={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},p9={any:[/^b/i,/^(a|c)/i]},y9={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},v9={any:[/1/i,/2/i,/3/i,/4/i]},b9={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},x9={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},w9={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},_9={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},S9={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},j9={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},C9={ordinalNumber:f9({matchPattern:h9,parsePattern:m9,valueCallback:t=>parseInt(t,10)}),era:zo({matchPatterns:g9,defaultMatchWidth:"wide",parsePatterns:p9,defaultParseWidth:"any"}),quarter:zo({matchPatterns:y9,defaultMatchWidth:"wide",parsePatterns:v9,defaultParseWidth:"any",valueCallback:t=>t+1}),month:zo({matchPatterns:b9,defaultMatchWidth:"wide",parsePatterns:x9,defaultParseWidth:"any"}),day:zo({matchPatterns:w9,defaultMatchWidth:"wide",parsePatterns:_9,defaultParseWidth:"any"}),dayPeriod:zo({matchPatterns:S9,defaultMatchWidth:"any",parsePatterns:j9,defaultParseWidth:"any"})},N9={code:"en-US",formatDistance:KE,formatLong:JE,formatRelative:t9,localize:c9,match:C9,options:{weekStartsOn:0,firstWeekContainsDate:1}};function T9(t,e,i){const a=qE(),c=(i==null?void 0:i.locale)??a.locale??N9,u=HE(t,e);if(isNaN(u))throw new RangeError("Invalid time value");const d=Object.assign({},i,{addSuffix:i==null?void 0:i.addSuffix,comparison:u}),[h,p]=VE(i==null?void 0:i.in,...u>0?[e,t]:[t,e]),y=YE((i==null?void 0:i.roundingMethod)??"round"),g=p.getTime()-h.getTime(),w=g/ay,C=uy(p)-uy(h),j=(g-C)/ay,N=i==null?void 0:i.unit;let M;if(N?M=N:w<1?M="second":w<60?M="minute":w<ly?M="hour":j<oy?M="day":j<ry?M="month":M="year",M==="second"){const D=y(g/1e3);return c.formatDistance("xSeconds",D,d)}else if(M==="minute"){const D=y(w);return c.formatDistance("xMinutes",D,d)}else if(M==="hour"){const D=y(w/60);return c.formatDistance("xHours",D,d)}else if(M==="day"){const D=y(j/ly);return c.formatDistance("xDays",D,d)}else if(M==="month"){const D=y(j/oy);return D===12&&N!=="month"?c.formatDistance("xYears",1,d):c.formatDistance("xMonths",D,d)}else{const D=y(j/ry);return c.formatDistance("xYears",D,d)}}function k9(t,e){return T9(t,GE(t),e)}const am=b.createContext({});function rm(t){const e=b.useRef(null);return e.current===null&&(e.current=t()),e.current}const om=typeof window<"u",Kb=om?b.useLayoutEffect:b.useEffect,pu=b.createContext(null),lm=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class E9 extends b.Component{getSnapshotBeforeUpdate(e){const i=this.props.childRef.current;if(i&&e.isPresent&&!this.props.isPresent){const a=i.offsetParent,c=a instanceof HTMLElement&&a.offsetWidth||0,u=this.props.sizeRef.current;u.height=i.offsetHeight||0,u.width=i.offsetWidth||0,u.top=i.offsetTop,u.left=i.offsetLeft,u.right=c-u.width-u.left}return null}componentDidUpdate(){}render(){return this.props.children}}function A9({children:t,isPresent:e,anchorX:i}){const a=b.useId(),c=b.useRef(null),u=b.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=b.useContext(lm);return b.useInsertionEffect(()=>{const{width:h,height:p,top:y,left:g,right:w}=u.current;if(e||!c.current||!h||!p)return;const C=i==="left"?`left: ${g}`:`right: ${w}`;c.current.dataset.motionPopId=a;const j=document.createElement("style");return d&&(j.nonce=d),document.head.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${p}px !important;
            ${C}px !important;
            top: ${y}px !important;
          }
        `),()=>{document.head.removeChild(j)}},[e]),o.jsx(E9,{isPresent:e,childRef:c,sizeRef:u,children:b.cloneElement(t,{ref:c})})}const R9=({children:t,initial:e,isPresent:i,onExitComplete:a,custom:c,presenceAffectsLayout:u,mode:d,anchorX:h})=>{const p=rm(M9),y=b.useId(),g=b.useCallback(C=>{p.set(C,!0);for(const j of p.values())if(!j)return;a&&a()},[p,a]),w=b.useMemo(()=>({id:y,initial:e,isPresent:i,custom:c,onExitComplete:g,register:C=>(p.set(C,!1),()=>p.delete(C))}),u?[Math.random(),g]:[i,g]);return b.useMemo(()=>{p.forEach((C,j)=>p.set(j,!1))},[i]),b.useEffect(()=>{!i&&!p.size&&a&&a()},[i]),d==="popLayout"&&(t=o.jsx(A9,{isPresent:i,anchorX:h,children:t})),o.jsx(pu.Provider,{value:w,children:t})};function M9(){return new Map}function Qb(t=!0){const e=b.useContext(pu);if(e===null)return[!0,null];const{isPresent:i,onExitComplete:a,register:c}=e,u=b.useId();b.useEffect(()=>{if(t)return c(u)},[t]);const d=b.useCallback(()=>t&&a&&a(u),[u,a,t]);return!i&&a?[!1,d]:[!0]}const Ec=t=>t.key||"";function dy(t){const e=[];return b.Children.forEach(t,i=>{b.isValidElement(i)&&e.push(i)}),e}const fy=({children:t,custom:e,initial:i=!0,onExitComplete:a,presenceAffectsLayout:c=!0,mode:u="sync",propagate:d=!1,anchorX:h="left"})=>{const[p,y]=Qb(d),g=b.useMemo(()=>dy(t),[t]),w=d&&!p?[]:g.map(Ec),C=b.useRef(!0),j=b.useRef(g),N=rm(()=>new Map),[M,D]=b.useState(g),[I,V]=b.useState(g);Kb(()=>{C.current=!1,j.current=g;for(let A=0;A<I.length;A++){const H=Ec(I[A]);w.includes(H)?N.delete(H):N.get(H)!==!0&&N.set(H,!1)}},[I,w.length,w.join("-")]);const F=[];if(g!==M){let A=[...g];for(let H=0;H<I.length;H++){const E=I[H],L=Ec(E);w.includes(L)||(A.splice(H,0,E),F.push(E))}return u==="wait"&&F.length&&(A=F),V(dy(A)),D(g),null}const{forceRender:O}=b.useContext(am);return o.jsx(o.Fragment,{children:I.map(A=>{const H=Ec(A),E=d&&!p?!1:g===I||w.includes(H),L=()=>{if(N.has(H))N.set(H,!0);else return;let P=!0;N.forEach(G=>{G||(P=!1)}),P&&(O==null||O(),V(j.current),d&&(y==null||y()),a&&a())};return o.jsx(R9,{isPresent:E,initial:!C.current||i?void 0:!1,custom:e,presenceAffectsLayout:c,mode:u,onExitComplete:E?void 0:L,anchorX:h,children:A},H)})})};function cm(t,e){t.indexOf(e)===-1&&t.push(e)}function um(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}let Wb=()=>{};const L9={useManualTiming:!1};function dm(t){let e;return()=>(e===void 0&&(e=t()),e)}const _s=t=>t,Jo=(t,e,i)=>{const a=e-t;return a===0?1:(i-t)/a};class fm{constructor(){this.subscriptions=[]}add(e){return cm(this.subscriptions,e),()=>um(this.subscriptions,e)}notify(e,i,a){const c=this.subscriptions.length;if(c)if(c===1)this.subscriptions[0](e,i,a);else for(let u=0;u<c;u++){const d=this.subscriptions[u];d&&d(e,i,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Gs=t=>t*1e3,Ys=t=>t/1e3;function Zb(t,e){return e?t*(1e3/e):0}const O9=dm(()=>window.ScrollTimeline!==void 0);class D9{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>e.finished))}getAll(e){return this.animations[0][e]}setAll(e,i){for(let a=0;a<this.animations.length;a++)this.animations[a][e]=i}attachTimeline(e,i){const a=this.animations.map(c=>{if(O9()&&c.attachTimeline)return c.attachTimeline(e);if(typeof i=="function")return i(c)});return()=>{a.forEach((c,u)=>{c&&c(),this.animations[u].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let i=0;i<this.animations.length;i++)e=Math.max(e,this.animations[i].duration);return e}runAll(e){this.animations.forEach(i=>i[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class B9 extends D9{then(e,i){return this.finished.finally(e).then(()=>{})}}const hy={value:null},hm=t=>Array.isArray(t)&&typeof t[0]=="number",z9={};function P9(t,e){const i=dm(t);return()=>z9[e]??i()}const el=P9(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Jb=(t,e,i=10)=>{let a="";const c=Math.max(Math.round(e/i),2);for(let u=0;u<c;u++)a+=t(u/(c-1))+", ";return`linear(${a.substring(0,a.length-2)})`},Io=([t,e,i,a])=>`cubic-bezier(${t}, ${e}, ${i}, ${a})`,wh={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Io([0,.65,.55,1]),circOut:Io([.55,0,1,.45]),backIn:Io([.31,.01,.66,-.59]),backOut:Io([.33,1.53,.69,.99])};function e2(t,e){if(t)return typeof t=="function"&&el()?Jb(t,e):hm(t)?Io(t):Array.isArray(t)?t.map(i=>e2(i,e)||wh.easeOut):wh[t]}function $9(t,e,i,{delay:a=0,duration:c=300,repeat:u=0,repeatType:d="loop",ease:h="easeInOut",times:p}={},y=void 0){const g={[e]:i};p&&(g.offset=p);const w=e2(h,c);return Array.isArray(w)&&(g.easing=w),t.animate(g,{delay:a,duration:c,easing:Array.isArray(w)?"linear":w,fill:"both",iterations:u+1,direction:d==="reverse"?"alternate":"normal",pseudoElement:y})}function mm(t){return typeof t=="function"&&"applyToOptions"in t}function gm(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const Wc=2e4;function pm(t){let e=0;const i=50;let a=t.next(e);for(;!a.done&&e<Wc;)e+=i,a=t.next(e);return e>=Wc?1/0:e}function U9(t,e=100,i){const a=i({...t,keyframes:[0,e]}),c=Math.min(pm(a),Wc);return{type:"keyframes",ease:u=>a.next(c*u).value/e,duration:Ys(c)}}function t2(t){return!!(typeof t=="function"&&el()||!t||typeof t=="string"&&(t in wh||el())||hm(t)||Array.isArray(t)&&t.every(t2))}function my(t,e){t.timeline=e,t.onfinish=null}const Ac=["read","resolveKeyframes","update","preRender","render","postRender"];function I9(t,e){let i=new Set,a=new Set,c=!1,u=!1;const d=new WeakSet;let h={delta:0,timestamp:0,isProcessing:!1},p=0;function y(w){d.has(w)&&(g.schedule(w),t()),p++,w(h)}const g={schedule:(w,C=!1,j=!1)=>{const M=j&&c?i:a;return C&&d.add(w),M.has(w)||M.add(w),w},cancel:w=>{a.delete(w),d.delete(w)},process:w=>{if(h=w,c){u=!0;return}c=!0,[i,a]=[a,i],i.forEach(y),e&&hy.value&&hy.value.frameloop[e].push(p),p=0,i.clear(),c=!1,u&&(u=!1,g.process(w))}};return g}const F9=40;function n2(t,e){let i=!1,a=!0;const c={delta:0,timestamp:0,isProcessing:!1},u=()=>i=!0,d=Ac.reduce((I,V)=>(I[V]=I9(u,e?V:void 0),I),{}),{read:h,resolveKeyframes:p,update:y,preRender:g,render:w,postRender:C}=d,j=()=>{const I=performance.now();i=!1,c.delta=a?1e3/60:Math.max(Math.min(I-c.timestamp,F9),1),c.timestamp=I,c.isProcessing=!0,h.process(c),p.process(c),y.process(c),g.process(c),w.process(c),C.process(c),c.isProcessing=!1,i&&e&&(a=!1,t(j))},N=()=>{i=!0,a=!0,c.isProcessing||t(j)};return{schedule:Ac.reduce((I,V)=>{const F=d[V];return I[V]=(O,A=!1,H=!1)=>(i||N(),F.schedule(O,A,H)),I},{}),cancel:I=>{for(let V=0;V<Ac.length;V++)d[Ac[V]].cancel(I)},state:c,steps:d}}const{schedule:Qt,cancel:Gi,state:On,steps:Gf}=n2(typeof requestAnimationFrame<"u"?requestAnimationFrame:_s,!0),{schedule:ym}=n2(queueMicrotask,!1);let Vc;function q9(){Vc=void 0}const Xs={now:()=>(Vc===void 0&&Xs.set(On.isProcessing||L9.useManualTiming?On.timestamp:performance.now()),Vc),set:t=>{Vc=t,queueMicrotask(q9)}},As={x:!1,y:!1};function s2(){return As.x||As.y}function V9(t){return t==="x"||t==="y"?As[t]?null:(As[t]=!0,()=>{As[t]=!1}):As.x||As.y?null:(As.x=As.y=!0,()=>{As.x=As.y=!1})}function H9(t,e,i){if(t instanceof EventTarget)return[t];if(typeof t=="string"){const c=document.querySelectorAll(t);return c?Array.from(c):[]}return Array.from(t)}function i2(t,e){const i=H9(t),a=new AbortController,c={passive:!0,...e,signal:a.signal};return[i,c,()=>a.abort()]}function gy(t){return!(t.pointerType==="touch"||s2())}function G9(t,e,i={}){const[a,c,u]=i2(t,i),d=h=>{if(!gy(h))return;const{target:p}=h,y=e(p,h);if(typeof y!="function"||!p)return;const g=w=>{gy(w)&&(y(w),p.removeEventListener("pointerleave",g))};p.addEventListener("pointerleave",g,c)};return a.forEach(h=>{h.addEventListener("pointerenter",d,c)}),u}const a2=(t,e)=>e?t===e?!0:a2(t,e.parentElement):!1,vm=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Y9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function X9(t){return Y9.has(t.tagName)||t.tabIndex!==-1}const Fo=new WeakSet;function py(t){return e=>{e.key==="Enter"&&t(e)}}function Yf(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const K9=(t,e)=>{const i=t.currentTarget;if(!i)return;const a=py(()=>{if(Fo.has(i))return;Yf(i,"down");const c=py(()=>{Yf(i,"up")}),u=()=>Yf(i,"cancel");i.addEventListener("keyup",c,e),i.addEventListener("blur",u,e)});i.addEventListener("keydown",a,e),i.addEventListener("blur",()=>i.removeEventListener("keydown",a),e)};function yy(t){return vm(t)&&!s2()}function Q9(t,e,i={}){const[a,c,u]=i2(t,i),d=h=>{const p=h.currentTarget;if(!yy(h)||Fo.has(p))return;Fo.add(p);const y=e(p,h),g=(j,N)=>{window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",C),!(!yy(j)||!Fo.has(p))&&(Fo.delete(p),typeof y=="function"&&y(j,{success:N}))},w=j=>{g(j,p===window||p===document||i.useGlobalTarget||a2(p,j.target))},C=j=>{g(j,!1)};window.addEventListener("pointerup",w,c),window.addEventListener("pointercancel",C,c)};return a.forEach(h=>{(i.useGlobalTarget?window:h).addEventListener("pointerdown",d,c),h instanceof HTMLElement&&(h.addEventListener("focus",y=>K9(y,c)),!X9(h)&&!h.hasAttribute("tabindex")&&(h.tabIndex=0))}),u}const vy=30,W9=t=>!isNaN(parseFloat(t));class Z9{constructor(e,i={}){this.version="12.6.3",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(a,c=!0)=>{const u=Xs.now();this.updatedAt!==u&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),c&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=i.owner}setCurrent(e){this.current=e,this.updatedAt=Xs.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=W9(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,i){this.events[e]||(this.events[e]=new fm);const a=this.events[e].add(i);return e==="change"?()=>{a(),Qt.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,i){this.passiveEffect=e,this.stopPassiveEffect=i}set(e,i=!0){!i||!this.passiveEffect?this.updateAndNotify(e,i):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,i,a){this.set(i),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-a}jump(e,i=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,i&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Xs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>vy)return 0;const i=Math.min(this.updatedAt-this.prevUpdatedAt,vy);return Zb(parseFloat(this.current)-parseFloat(this.prevFrameValue),i)}start(e){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=e(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function tl(t,e){return new Z9(t,e)}const r2=b.createContext({strict:!1}),by={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Er={};for(const t in by)Er[t]={isEnabled:e=>by[t].some(i=>!!e[i])};function J9(t){for(const e in t)Er[e]={...Er[e],...t[e]}}const eA=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Zc(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||eA.has(t)}let o2=t=>!Zc(t);function tA(t){t&&(o2=e=>e.startsWith("on")?!Zc(e):t(e))}try{tA(require("@emotion/is-prop-valid").default)}catch{}function nA(t,e,i){const a={};for(const c in t)c==="values"&&typeof t.values=="object"||(o2(c)||i===!0&&Zc(c)||!e&&!Zc(c)||t.draggable&&c.startsWith("onDrag"))&&(a[c]=t[c]);return a}function sA(t){if(typeof Proxy>"u")return t;const e=new Map,i=(...a)=>t(...a);return new Proxy(i,{get:(a,c)=>c==="create"?t:(e.has(c)||e.set(c,t(c)),e.get(c))})}const yu=b.createContext({});function vu(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function nl(t){return typeof t=="string"||Array.isArray(t)}const bm=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],xm=["initial",...bm];function bu(t){return vu(t.animate)||xm.some(e=>nl(t[e]))}function l2(t){return!!(bu(t)||t.variants)}function iA(t,e){if(bu(t)){const{initial:i,animate:a}=t;return{initial:i===!1||nl(i)?i:void 0,animate:nl(a)?a:void 0}}return t.inherit!==!1?e:{}}function aA(t){const{initial:e,animate:i}=iA(t,b.useContext(yu));return b.useMemo(()=>({initial:e,animate:i}),[xy(e),xy(i)])}function xy(t){return Array.isArray(t)?t.join(" "):t}const rA=Symbol.for("motionComponentSymbol");function hr(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function oA(t,e,i){return b.useCallback(a=>{a&&t.onMount&&t.onMount(a),e&&(a?e.mount(a):e.unmount()),i&&(typeof i=="function"?i(a):hr(i)&&(i.current=a))},[e])}const wm=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),lA="framerAppearId",c2="data-"+wm(lA),u2=b.createContext({});function cA(t,e,i,a,c){var M,D;const{visualElement:u}=b.useContext(yu),d=b.useContext(r2),h=b.useContext(pu),p=b.useContext(lm).reducedMotion,y=b.useRef(null);a=a||d.renderer,!y.current&&a&&(y.current=a(t,{visualState:e,parent:u,props:i,presenceContext:h,blockInitialAnimation:h?h.initial===!1:!1,reducedMotionConfig:p}));const g=y.current,w=b.useContext(u2);g&&!g.projection&&c&&(g.type==="html"||g.type==="svg")&&uA(y.current,i,c,w);const C=b.useRef(!1);b.useInsertionEffect(()=>{g&&C.current&&g.update(i,h)});const j=i[c2],N=b.useRef(!!j&&!((M=window.MotionHandoffIsComplete)!=null&&M.call(window,j))&&((D=window.MotionHasOptimisedAnimation)==null?void 0:D.call(window,j)));return Kb(()=>{g&&(C.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),ym.render(g.render),N.current&&g.animationState&&g.animationState.animateChanges())}),b.useEffect(()=>{g&&(!N.current&&g.animationState&&g.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{var I;(I=window.MotionHandoffMarkAsComplete)==null||I.call(window,j)}),N.current=!1))}),g}function uA(t,e,i,a){const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:p,layoutRoot:y}=e;t.projection=new i(t.latestValues,e["data-framer-portal-id"]?void 0:d2(t.parent)),t.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&hr(h),visualElement:t,animationType:typeof u=="string"?u:"both",initialPromotionConfig:a,layoutScroll:p,layoutRoot:y})}function d2(t){if(t)return t.options.allowProjection!==!1?t.projection:d2(t.parent)}function dA({preloadedFeatures:t,createVisualElement:e,useRender:i,useVisualState:a,Component:c}){t&&J9(t);function u(h,p){let y;const g={...b.useContext(lm),...h,layoutId:fA(h)},{isStatic:w}=g,C=aA(h),j=a(h,w);if(!w&&om){hA();const N=mA(g);y=N.MeasureLayout,C.visualElement=cA(c,j,g,e,N.ProjectionNode)}return o.jsxs(yu.Provider,{value:C,children:[y&&C.visualElement?o.jsx(y,{visualElement:C.visualElement,...g}):null,i(c,h,oA(j,C.visualElement,p),j,w,C.visualElement)]})}u.displayName=`motion.${typeof c=="string"?c:`create(${c.displayName??c.name??""})`}`;const d=b.forwardRef(u);return d[rA]=c,d}function fA({layoutId:t}){const e=b.useContext(am).id;return e&&t!==void 0?e+"-"+t:t}function hA(t,e){b.useContext(r2).strict}function mA(t){const{drag:e,layout:i}=Er;if(!e&&!i)return{};const a={...e,...i};return{MeasureLayout:e!=null&&e.isEnabled(t)||i!=null&&i.isEnabled(t)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}const f2=t=>e=>typeof e=="string"&&e.startsWith(t),_m=f2("--"),gA=f2("var(--"),Sm=t=>gA(t)?pA.test(t.split("/*")[0].trim()):!1,pA=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,sl={};function yA(t){for(const e in t)sl[e]=t[e],_m(e)&&(sl[e].isCSSVariable=!0)}const Dr=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ea=new Set(Dr);function h2(t,{layout:e,layoutId:i}){return Ea.has(t)||t.startsWith("origin")||(e||i!==void 0)&&(!!sl[t]||t==="opacity")}const Un=t=>!!(t&&t.getVelocity),m2=(t,e)=>e&&typeof t=="number"?e.transform(t):t,yi=(t,e,i)=>i>e?e:i<t?t:i,Br={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},il={...Br,transform:t=>yi(0,1,t)},Rc={...Br,default:1},dl=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Fi=dl("deg"),Ks=dl("%"),pt=dl("px"),vA=dl("vh"),bA=dl("vw"),wy={...Ks,parse:t=>Ks.parse(t)/100,transform:t=>Ks.transform(t*100)},xA={borderWidth:pt,borderTopWidth:pt,borderRightWidth:pt,borderBottomWidth:pt,borderLeftWidth:pt,borderRadius:pt,radius:pt,borderTopLeftRadius:pt,borderTopRightRadius:pt,borderBottomRightRadius:pt,borderBottomLeftRadius:pt,width:pt,maxWidth:pt,height:pt,maxHeight:pt,top:pt,right:pt,bottom:pt,left:pt,padding:pt,paddingTop:pt,paddingRight:pt,paddingBottom:pt,paddingLeft:pt,margin:pt,marginTop:pt,marginRight:pt,marginBottom:pt,marginLeft:pt,backgroundPositionX:pt,backgroundPositionY:pt},wA={rotate:Fi,rotateX:Fi,rotateY:Fi,rotateZ:Fi,scale:Rc,scaleX:Rc,scaleY:Rc,scaleZ:Rc,skew:Fi,skewX:Fi,skewY:Fi,distance:pt,translateX:pt,translateY:pt,translateZ:pt,x:pt,y:pt,z:pt,perspective:pt,transformPerspective:pt,opacity:il,originX:wy,originY:wy,originZ:pt},_y={...Br,transform:Math.round},jm={...xA,...wA,zIndex:_y,size:pt,fillOpacity:il,strokeOpacity:il,numOctaves:_y},_A={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},SA=Dr.length;function jA(t,e,i){let a="",c=!0;for(let u=0;u<SA;u++){const d=Dr[u],h=t[d];if(h===void 0)continue;let p=!0;if(typeof h=="number"?p=h===(d.startsWith("scale")?1:0):p=parseFloat(h)===0,!p||i){const y=m2(h,jm[d]);if(!p){c=!1;const g=_A[d]||d;a+=`${g}(${y}) `}i&&(e[d]=y)}}return a=a.trim(),i?a=i(e,c?"":a):c&&(a="none"),a}function Cm(t,e,i){const{style:a,vars:c,transformOrigin:u}=t;let d=!1,h=!1;for(const p in e){const y=e[p];if(Ea.has(p)){d=!0;continue}else if(_m(p)){c[p]=y;continue}else{const g=m2(y,jm[p]);p.startsWith("origin")?(h=!0,u[p]=g):a[p]=g}}if(e.transform||(d||i?a.transform=jA(e,t.transform,i):a.transform&&(a.transform="none")),h){const{originX:p="50%",originY:y="50%",originZ:g=0}=u;a.transformOrigin=`${p} ${y} ${g}`}}const Nm=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function g2(t,e,i){for(const a in e)!Un(e[a])&&!h2(a,i)&&(t[a]=e[a])}function CA({transformTemplate:t},e){return b.useMemo(()=>{const i=Nm();return Cm(i,e,t),Object.assign({},i.vars,i.style)},[e])}function NA(t,e){const i=t.style||{},a={};return g2(a,i,t),Object.assign(a,CA(t,e)),a}function TA(t,e){const i={},a=NA(t,e);return t.drag&&t.dragListener!==!1&&(i.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(i.tabIndex=0),i.style=a,i}const kA=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Tm(t){return typeof t!="string"||t.includes("-")?!1:!!(kA.indexOf(t)>-1||/[A-Z]/u.test(t))}const EA={offset:"stroke-dashoffset",array:"stroke-dasharray"},AA={offset:"strokeDashoffset",array:"strokeDasharray"};function RA(t,e,i=1,a=0,c=!0){t.pathLength=1;const u=c?EA:AA;t[u.offset]=pt.transform(-a);const d=pt.transform(e),h=pt.transform(i);t[u.array]=`${d} ${h}`}function Sy(t,e,i){return typeof t=="string"?t:pt.transform(e+i*t)}function MA(t,e,i){const a=Sy(e,t.x,t.width),c=Sy(i,t.y,t.height);return`${a} ${c}`}function km(t,{attrX:e,attrY:i,attrScale:a,originX:c,originY:u,pathLength:d,pathSpacing:h=1,pathOffset:p=0,...y},g,w){if(Cm(t,y,w),g){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:C,style:j,dimensions:N}=t;C.transform&&(N&&(j.transform=C.transform),delete C.transform),N&&(c!==void 0||u!==void 0||j.transform)&&(j.transformOrigin=MA(N,c!==void 0?c:.5,u!==void 0?u:.5)),e!==void 0&&(C.x=e),i!==void 0&&(C.y=i),a!==void 0&&(C.scale=a),d!==void 0&&RA(C,d,h,p,!1)}const p2=()=>({...Nm(),attrs:{}}),Em=t=>typeof t=="string"&&t.toLowerCase()==="svg";function LA(t,e,i,a){const c=b.useMemo(()=>{const u=p2();return km(u,e,Em(a),t.transformTemplate),{...u.attrs,style:{...u.style}}},[e]);if(t.style){const u={};g2(u,t.style,t),c.style={...u,...c.style}}return c}function OA(t=!1){return(i,a,c,{latestValues:u},d)=>{const p=(Tm(i)?LA:TA)(a,u,d,i),y=nA(a,typeof i=="string",t),g=i!==b.Fragment?{...y,...p,ref:c}:{},{children:w}=a,C=b.useMemo(()=>Un(w)?w.get():w,[w]);return b.createElement(i,{...g,children:C})}}function jy(t){const e=[{},{}];return t==null||t.values.forEach((i,a)=>{e[0][a]=i.get(),e[1][a]=i.getVelocity()}),e}function Am(t,e,i,a){if(typeof e=="function"){const[c,u]=jy(a);e=e(i!==void 0?i:t.custom,c,u)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[c,u]=jy(a);e=e(i!==void 0?i:t.custom,c,u)}return e}const _h=t=>Array.isArray(t),DA=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),BA=t=>_h(t)?t[t.length-1]||0:t;function Hc(t){const e=Un(t)?t.get():t;return DA(e)?e.toValue():e}function zA({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:i},a,c,u){const d={latestValues:PA(a,c,u,t),renderState:e()};return i&&(d.onMount=h=>i({props:a,current:h,...d}),d.onUpdate=h=>i(h)),d}const y2=t=>(e,i)=>{const a=b.useContext(yu),c=b.useContext(pu),u=()=>zA(t,e,a,c);return i?u():rm(u)};function PA(t,e,i,a){const c={},u=a(t,{});for(const C in u)c[C]=Hc(u[C]);let{initial:d,animate:h}=t;const p=bu(t),y=l2(t);e&&y&&!p&&t.inherit!==!1&&(d===void 0&&(d=e.initial),h===void 0&&(h=e.animate));let g=i?i.initial===!1:!1;g=g||d===!1;const w=g?h:d;if(w&&typeof w!="boolean"&&!vu(w)){const C=Array.isArray(w)?w:[w];for(let j=0;j<C.length;j++){const N=Am(t,C[j]);if(N){const{transitionEnd:M,transition:D,...I}=N;for(const V in I){let F=I[V];if(Array.isArray(F)){const O=g?F.length-1:0;F=F[O]}F!==null&&(c[V]=F)}for(const V in M)c[V]=M[V]}}}return c}function Rm(t,e,i){var u;const{style:a}=t,c={};for(const d in a)(Un(a[d])||e.style&&Un(e.style[d])||h2(d,t)||((u=i==null?void 0:i.getValue(d))==null?void 0:u.liveStyle)!==void 0)&&(c[d]=a[d]);return c}const $A={useVisualState:y2({scrapeMotionValuesFromProps:Rm,createRenderState:Nm})};function v2(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}function b2(t,{style:e,vars:i},a,c){Object.assign(t.style,e,c&&c.getProjectionStyles(a));for(const u in i)t.style.setProperty(u,i[u])}const x2=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function w2(t,e,i,a){b2(t,e,void 0,a);for(const c in e.attrs)t.setAttribute(x2.has(c)?c:wm(c),e.attrs[c])}function _2(t,e,i){const a=Rm(t,e,i);for(const c in t)if(Un(t[c])||Un(e[c])){const u=Dr.indexOf(c)!==-1?"attr"+c.charAt(0).toUpperCase()+c.substring(1):c;a[u]=t[c]}return a}const Cy=["x","y","width","height","cx","cy","r"],UA={useVisualState:y2({scrapeMotionValuesFromProps:_2,createRenderState:p2,onUpdate:({props:t,prevProps:e,current:i,renderState:a,latestValues:c})=>{if(!i)return;let u=!!t.drag;if(!u){for(const h in c)if(Ea.has(h)){u=!0;break}}if(!u)return;let d=!e;if(e)for(let h=0;h<Cy.length;h++){const p=Cy[h];t[p]!==e[p]&&(d=!0)}d&&Qt.read(()=>{v2(i,a),Qt.render(()=>{km(a,c,Em(i.tagName),t.transformTemplate),w2(i,a)})})}})};function IA(t,e){return function(a,{forwardMotionProps:c}={forwardMotionProps:!1}){const d={...Tm(a)?UA:$A,preloadedFeatures:t,useRender:OA(c),createVisualElement:e,Component:a};return dA(d)}}function al(t,e,i){const a=t.getProps();return Am(a,e,i!==void 0?i:a.custom,t)}const S2=new Set(["width","height","top","left","right","bottom",...Dr]);function FA(t,e,i){t.hasValue(e)?t.getValue(e).set(i):t.addValue(e,tl(i))}function qA(t,e){const i=al(t,e);let{transitionEnd:a={},transition:c={},...u}=i||{};u={...u,...a};for(const d in u){const h=BA(u[d]);FA(t,d,h)}}function VA(t){return!!(Un(t)&&t.add)}function Sh(t,e){const i=t.getValue("willChange");if(VA(i))return i.add(e)}function j2(t){return t.props[c2]}const C2=(t,e,i)=>(((1-3*i+3*e)*t+(3*i-6*e))*t+3*e)*t,HA=1e-7,GA=12;function YA(t,e,i,a,c){let u,d,h=0;do d=e+(i-e)/2,u=C2(d,a,c)-t,u>0?i=d:e=d;while(Math.abs(u)>HA&&++h<GA);return d}function fl(t,e,i,a){if(t===e&&i===a)return _s;const c=u=>YA(u,0,1,t,i);return u=>u===0||u===1?u:C2(c(u),e,a)}const N2=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,T2=t=>e=>1-t(1-e),k2=fl(.33,1.53,.69,.99),Mm=T2(k2),E2=N2(Mm),A2=t=>(t*=2)<1?.5*Mm(t):.5*(2-Math.pow(2,-10*(t-1))),Lm=t=>1-Math.sin(Math.acos(t)),R2=T2(Lm),M2=N2(Lm),L2=t=>/^0[^.\s]+$/u.test(t);function XA(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||L2(t):!0}const Ho=t=>Math.round(t*1e5)/1e5,Om=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function KA(t){return t==null}const QA=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Dm=(t,e)=>i=>!!(typeof i=="string"&&QA.test(i)&&i.startsWith(t)||e&&!KA(i)&&Object.prototype.hasOwnProperty.call(i,e)),O2=(t,e,i)=>a=>{if(typeof a!="string")return a;const[c,u,d,h]=a.match(Om);return{[t]:parseFloat(c),[e]:parseFloat(u),[i]:parseFloat(d),alpha:h!==void 0?parseFloat(h):1}},WA=t=>yi(0,255,t),Xf={...Br,transform:t=>Math.round(WA(t))},_a={test:Dm("rgb","red"),parse:O2("red","green","blue"),transform:({red:t,green:e,blue:i,alpha:a=1})=>"rgba("+Xf.transform(t)+", "+Xf.transform(e)+", "+Xf.transform(i)+", "+Ho(il.transform(a))+")"};function ZA(t){let e="",i="",a="",c="";return t.length>5?(e=t.substring(1,3),i=t.substring(3,5),a=t.substring(5,7),c=t.substring(7,9)):(e=t.substring(1,2),i=t.substring(2,3),a=t.substring(3,4),c=t.substring(4,5),e+=e,i+=i,a+=a,c+=c),{red:parseInt(e,16),green:parseInt(i,16),blue:parseInt(a,16),alpha:c?parseInt(c,16)/255:1}}const jh={test:Dm("#"),parse:ZA,transform:_a.transform},mr={test:Dm("hsl","hue"),parse:O2("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:i,alpha:a=1})=>"hsla("+Math.round(t)+", "+Ks.transform(Ho(e))+", "+Ks.transform(Ho(i))+", "+Ho(il.transform(a))+")"},zn={test:t=>_a.test(t)||jh.test(t)||mr.test(t),parse:t=>_a.test(t)?_a.parse(t):mr.test(t)?mr.parse(t):jh.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?_a.transform(t):mr.transform(t)},JA=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function eR(t){var e,i;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Om))==null?void 0:e.length)||0)+(((i=t.match(JA))==null?void 0:i.length)||0)>0}const D2="number",B2="color",tR="var",nR="var(",Ny="${}",sR=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function rl(t){const e=t.toString(),i=[],a={color:[],number:[],var:[]},c=[];let u=0;const h=e.replace(sR,p=>(zn.test(p)?(a.color.push(u),c.push(B2),i.push(zn.parse(p))):p.startsWith(nR)?(a.var.push(u),c.push(tR),i.push(p)):(a.number.push(u),c.push(D2),i.push(parseFloat(p))),++u,Ny)).split(Ny);return{values:i,split:h,indexes:a,types:c}}function z2(t){return rl(t).values}function P2(t){const{split:e,types:i}=rl(t),a=e.length;return c=>{let u="";for(let d=0;d<a;d++)if(u+=e[d],c[d]!==void 0){const h=i[d];h===D2?u+=Ho(c[d]):h===B2?u+=zn.transform(c[d]):u+=c[d]}return u}}const iR=t=>typeof t=="number"?0:t;function aR(t){const e=z2(t);return P2(t)(e.map(iR))}const Yi={test:eR,parse:z2,createTransformer:P2,getAnimatableNone:aR},rR=new Set(["brightness","contrast","saturate","opacity"]);function oR(t){const[e,i]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[a]=i.match(Om)||[];if(!a)return t;const c=i.replace(a,"");let u=rR.has(e)?1:0;return a!==i&&(u*=100),e+"("+u+c+")"}const lR=/\b([a-z-]*)\(.*?\)/gu,Ch={...Yi,getAnimatableNone:t=>{const e=t.match(lR);return e?e.map(oR).join(" "):t}},cR={...jm,color:zn,backgroundColor:zn,outlineColor:zn,fill:zn,stroke:zn,borderColor:zn,borderTopColor:zn,borderRightColor:zn,borderBottomColor:zn,borderLeftColor:zn,filter:Ch,WebkitFilter:Ch},$2=t=>cR[t];function U2(t,e){let i=$2(t);return i!==Ch&&(i=Yi),i.getAnimatableNone?i.getAnimatableNone(e):void 0}const uR=new Set(["auto","none","0"]);function dR(t,e,i){let a=0,c;for(;a<t.length&&!c;){const u=t[a];typeof u=="string"&&!uR.has(u)&&rl(u).values.length&&(c=t[a]),a++}if(c&&i)for(const u of e)t[u]=U2(i,c)}const Sa=t=>t*180/Math.PI,Nh=t=>{const e=Sa(Math.atan2(t[1],t[0]));return Th(e)},fR={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Nh,rotateZ:Nh,skewX:t=>Sa(Math.atan(t[1])),skewY:t=>Sa(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Th=t=>(t=t%360,t<0&&(t+=360),t),Ty=Nh,ky=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),Ey=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),hR={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ky,scaleY:Ey,scale:t=>(ky(t)+Ey(t))/2,rotateX:t=>Th(Sa(Math.atan2(t[6],t[5]))),rotateY:t=>Th(Sa(Math.atan2(-t[2],t[0]))),rotateZ:Ty,rotate:Ty,skewX:t=>Sa(Math.atan(t[4])),skewY:t=>Sa(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Ay(t){return t.includes("scale")?1:0}function kh(t,e){if(!t||t==="none")return Ay(e);const i=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,c;if(i)a=hR,c=i;else{const h=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=fR,c=h}if(!c)return Ay(e);const u=a[e],d=c[1].split(",").map(gR);return typeof u=="function"?u(d):d[u]}const mR=(t,e)=>{const{transform:i="none"}=getComputedStyle(t);return kh(i,e)};function gR(t){return parseFloat(t.trim())}const Ry=t=>t===Br||t===pt,pR=new Set(["x","y","z"]),yR=Dr.filter(t=>!pR.has(t));function vR(t){const e=[];return yR.forEach(i=>{const a=t.getValue(i);a!==void 0&&(e.push([i,a.get()]),a.set(i.startsWith("scale")?1:0))}),e}const Ar={width:({x:t},{paddingLeft:e="0",paddingRight:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),height:({y:t},{paddingTop:e="0",paddingBottom:i="0"})=>t.max-t.min-parseFloat(e)-parseFloat(i),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>kh(e,"x"),y:(t,{transform:e})=>kh(e,"y")};Ar.translateX=Ar.x;Ar.translateY=Ar.y;const Ca=new Set;let Eh=!1,Ah=!1;function I2(){if(Ah){const t=Array.from(Ca).filter(a=>a.needsMeasurement),e=new Set(t.map(a=>a.element)),i=new Map;e.forEach(a=>{const c=vR(a);c.length&&(i.set(a,c),a.render())}),t.forEach(a=>a.measureInitialState()),e.forEach(a=>{a.render();const c=i.get(a);c&&c.forEach(([u,d])=>{var h;(h=a.getValue(u))==null||h.set(d)})}),t.forEach(a=>a.measureEndState()),t.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}Ah=!1,Eh=!1,Ca.forEach(t=>t.complete()),Ca.clear()}function F2(){Ca.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Ah=!0)})}function bR(){F2(),I2()}class Bm{constructor(e,i,a,c,u,d=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=i,this.name=a,this.motionValue=c,this.element=u,this.isAsync=d}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ca.add(this),Eh||(Eh=!0,Qt.read(F2),Qt.resolveKeyframes(I2))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:i,element:a,motionValue:c}=this;for(let u=0;u<e.length;u++)if(e[u]===null)if(u===0){const d=c==null?void 0:c.get(),h=e[e.length-1];if(d!==void 0)e[0]=d;else if(a&&i){const p=a.readValue(i,h);p!=null&&(e[0]=p)}e[0]===void 0&&(e[0]=h),c&&d===void 0&&c.set(e[0])}else e[u]=e[u-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ca.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ca.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const q2=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),xR=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function wR(t){const e=xR.exec(t);if(!e)return[,];const[,i,a,c]=e;return[`--${i??a}`,c]}function V2(t,e,i=1){const[a,c]=wR(t);if(!a)return;const u=window.getComputedStyle(e).getPropertyValue(a);if(u){const d=u.trim();return q2(d)?parseFloat(d):d}return Sm(c)?V2(c,e,i+1):c}const H2=t=>e=>e.test(t),_R={test:t=>t==="auto",parse:t=>t},G2=[Br,pt,Ks,Fi,bA,vA,_R],My=t=>G2.find(H2(t));class Y2 extends Bm{constructor(e,i,a,c,u){super(e,i,a,c,u,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:i,name:a}=this;if(!i||!i.current)return;super.readKeyframes();for(let p=0;p<e.length;p++){let y=e[p];if(typeof y=="string"&&(y=y.trim(),Sm(y))){const g=V2(y,i.current);g!==void 0&&(e[p]=g),p===e.length-1&&(this.finalKeyframe=y)}}if(this.resolveNoneKeyframes(),!S2.has(a)||e.length!==2)return;const[c,u]=e,d=My(c),h=My(u);if(d!==h)if(Ry(d)&&Ry(h))for(let p=0;p<e.length;p++){const y=e[p];typeof y=="string"&&(e[p]=parseFloat(y))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:i}=this,a=[];for(let c=0;c<e.length;c++)XA(e[c])&&a.push(c);a.length&&dR(e,a,i)}measureInitialState(){const{element:e,unresolvedKeyframes:i,name:a}=this;if(!e||!e.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ar[a](e.measureViewportBox(),window.getComputedStyle(e.current)),i[0]=this.measuredOrigin;const c=i[i.length-1];c!==void 0&&e.getValue(a,c).jump(c,!1)}measureEndState(){var h;const{element:e,name:i,unresolvedKeyframes:a}=this;if(!e||!e.current)return;const c=e.getValue(i);c&&c.jump(this.measuredOrigin,!1);const u=a.length-1,d=a[u];a[u]=Ar[i](e.measureViewportBox(),window.getComputedStyle(e.current)),d!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=d),(h=this.removedTransforms)!=null&&h.length&&this.removedTransforms.forEach(([p,y])=>{e.getValue(p).set(y)}),this.resolveNoneKeyframes()}}const Ly=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Yi.test(t)||t==="0")&&!t.startsWith("url("));function SR(t){const e=t[0];if(t.length===1)return!0;for(let i=0;i<t.length;i++)if(t[i]!==e)return!0}function jR(t,e,i,a){const c=t[0];if(c===null)return!1;if(e==="display"||e==="visibility")return!0;const u=t[t.length-1],d=Ly(c,e),h=Ly(u,e);return!d||!h?!1:SR(t)||(i==="spring"||mm(i))&&a}const CR=t=>t!==null;function xu(t,{repeat:e,repeatType:i="loop"},a){const c=t.filter(CR),u=e&&i!=="loop"&&e%2===1?0:c.length-1;return!u||a===void 0?c[u]:a}const NR=40;class X2{constructor({autoplay:e=!0,delay:i=0,type:a="keyframes",repeat:c=0,repeatDelay:u=0,repeatType:d="loop",...h}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Xs.now(),this.options={autoplay:e,delay:i,type:a,repeat:c,repeatDelay:u,repeatType:d,...h},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>NR?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&bR(),this._resolved}onKeyframesResolved(e,i){this.resolvedAt=Xs.now(),this.hasAttemptedResolve=!0;const{name:a,type:c,velocity:u,delay:d,onComplete:h,onUpdate:p,isGenerator:y}=this.options;if(!y&&!jR(e,a,c,u))if(d)this.options.duration=0;else{p&&p(xu(e,this.options,i)),h&&h(),this.resolveFinishedPromise();return}const g=this.initPlayback(e,i);g!==!1&&(this._resolved={keyframes:e,finalKeyframe:i,...g},this.onPostResolved())}onPostResolved(){}then(e,i){return this.currentFinishedPromise.then(e,i)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const nn=(t,e,i)=>t+(e-t)*i;function Kf(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function TR({hue:t,saturation:e,lightness:i,alpha:a}){t/=360,e/=100,i/=100;let c=0,u=0,d=0;if(!e)c=u=d=i;else{const h=i<.5?i*(1+e):i+e-i*e,p=2*i-h;c=Kf(p,h,t+1/3),u=Kf(p,h,t),d=Kf(p,h,t-1/3)}return{red:Math.round(c*255),green:Math.round(u*255),blue:Math.round(d*255),alpha:a}}function Jc(t,e){return i=>i>0?e:t}const Qf=(t,e,i)=>{const a=t*t,c=i*(e*e-a)+a;return c<0?0:Math.sqrt(c)},kR=[jh,_a,mr],ER=t=>kR.find(e=>e.test(t));function Oy(t){const e=ER(t);if(!e)return!1;let i=e.parse(t);return e===mr&&(i=TR(i)),i}const Dy=(t,e)=>{const i=Oy(t),a=Oy(e);if(!i||!a)return Jc(t,e);const c={...i};return u=>(c.red=Qf(i.red,a.red,u),c.green=Qf(i.green,a.green,u),c.blue=Qf(i.blue,a.blue,u),c.alpha=nn(i.alpha,a.alpha,u),_a.transform(c))},AR=(t,e)=>i=>e(t(i)),hl=(...t)=>t.reduce(AR),Rh=new Set(["none","hidden"]);function RR(t,e){return Rh.has(t)?i=>i<=0?t:e:i=>i>=1?e:t}function MR(t,e){return i=>nn(t,e,i)}function zm(t){return typeof t=="number"?MR:typeof t=="string"?Sm(t)?Jc:zn.test(t)?Dy:DR:Array.isArray(t)?K2:typeof t=="object"?zn.test(t)?Dy:LR:Jc}function K2(t,e){const i=[...t],a=i.length,c=t.map((u,d)=>zm(u)(u,e[d]));return u=>{for(let d=0;d<a;d++)i[d]=c[d](u);return i}}function LR(t,e){const i={...t,...e},a={};for(const c in i)t[c]!==void 0&&e[c]!==void 0&&(a[c]=zm(t[c])(t[c],e[c]));return c=>{for(const u in a)i[u]=a[u](c);return i}}function OR(t,e){const i=[],a={color:0,var:0,number:0};for(let c=0;c<e.values.length;c++){const u=e.types[c],d=t.indexes[u][a[u]],h=t.values[d]??0;i[c]=h,a[u]++}return i}const DR=(t,e)=>{const i=Yi.createTransformer(e),a=rl(t),c=rl(e);return a.indexes.var.length===c.indexes.var.length&&a.indexes.color.length===c.indexes.color.length&&a.indexes.number.length>=c.indexes.number.length?Rh.has(t)&&!c.values.length||Rh.has(e)&&!a.values.length?RR(t,e):hl(K2(OR(a,c),c.values),i):Jc(t,e)};function Q2(t,e,i){return typeof t=="number"&&typeof e=="number"&&typeof i=="number"?nn(t,e,i):zm(t)(t,e)}const BR=5;function W2(t,e,i){const a=Math.max(e-BR,0);return Zb(i-t(a),e-a)}const un={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},By=.001;function zR({duration:t=un.duration,bounce:e=un.bounce,velocity:i=un.velocity,mass:a=un.mass}){let c,u,d=1-e;d=yi(un.minDamping,un.maxDamping,d),t=yi(un.minDuration,un.maxDuration,Ys(t)),d<1?(c=y=>{const g=y*d,w=g*t,C=g-i,j=Mh(y,d),N=Math.exp(-w);return By-C/j*N},u=y=>{const w=y*d*t,C=w*i+i,j=Math.pow(d,2)*Math.pow(y,2)*t,N=Math.exp(-w),M=Mh(Math.pow(y,2),d);return(-c(y)+By>0?-1:1)*((C-j)*N)/M}):(c=y=>{const g=Math.exp(-y*t),w=(y-i)*t+1;return-.001+g*w},u=y=>{const g=Math.exp(-y*t),w=(i-y)*(t*t);return g*w});const h=5/t,p=$R(c,u,h);if(t=Gs(t),isNaN(p))return{stiffness:un.stiffness,damping:un.damping,duration:t};{const y=Math.pow(p,2)*a;return{stiffness:y,damping:d*2*Math.sqrt(a*y),duration:t}}}const PR=12;function $R(t,e,i){let a=i;for(let c=1;c<PR;c++)a=a-t(a)/e(a);return a}function Mh(t,e){return t*Math.sqrt(1-e*e)}const UR=["duration","bounce"],IR=["stiffness","damping","mass"];function zy(t,e){return e.some(i=>t[i]!==void 0)}function FR(t){let e={velocity:un.velocity,stiffness:un.stiffness,damping:un.damping,mass:un.mass,isResolvedFromDuration:!1,...t};if(!zy(t,IR)&&zy(t,UR))if(t.visualDuration){const i=t.visualDuration,a=2*Math.PI/(i*1.2),c=a*a,u=2*yi(.05,1,1-(t.bounce||0))*Math.sqrt(c);e={...e,mass:un.mass,stiffness:c,damping:u}}else{const i=zR(t);e={...e,...i,mass:un.mass},e.isResolvedFromDuration=!0}return e}function eu(t=un.visualDuration,e=un.bounce){const i=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:a,restDelta:c}=i;const u=i.keyframes[0],d=i.keyframes[i.keyframes.length-1],h={done:!1,value:u},{stiffness:p,damping:y,mass:g,duration:w,velocity:C,isResolvedFromDuration:j}=FR({...i,velocity:-Ys(i.velocity||0)}),N=C||0,M=y/(2*Math.sqrt(p*g)),D=d-u,I=Ys(Math.sqrt(p/g)),V=Math.abs(D)<5;a||(a=V?un.restSpeed.granular:un.restSpeed.default),c||(c=V?un.restDelta.granular:un.restDelta.default);let F;if(M<1){const A=Mh(I,M);F=H=>{const E=Math.exp(-M*I*H);return d-E*((N+M*I*D)/A*Math.sin(A*H)+D*Math.cos(A*H))}}else if(M===1)F=A=>d-Math.exp(-I*A)*(D+(N+I*D)*A);else{const A=I*Math.sqrt(M*M-1);F=H=>{const E=Math.exp(-M*I*H),L=Math.min(A*H,300);return d-E*((N+M*I*D)*Math.sinh(L)+A*D*Math.cosh(L))/A}}const O={calculatedDuration:j&&w||null,next:A=>{const H=F(A);if(j)h.done=A>=w;else{let E=0;M<1&&(E=A===0?Gs(N):W2(F,A,H));const L=Math.abs(E)<=a,P=Math.abs(d-H)<=c;h.done=L&&P}return h.value=h.done?d:H,h},toString:()=>{const A=Math.min(pm(O),Wc),H=Jb(E=>O.next(A*E).value,A,30);return A+"ms "+H},toTransition:()=>{}};return O}eu.applyToOptions=t=>{const e=U9(t,100,eu);return t.ease=el()?e.ease:"easeOut",t.duration=Gs(e.duration),t.type="keyframes",t};function Py({keyframes:t,velocity:e=0,power:i=.8,timeConstant:a=325,bounceDamping:c=10,bounceStiffness:u=500,modifyTarget:d,min:h,max:p,restDelta:y=.5,restSpeed:g}){const w=t[0],C={done:!1,value:w},j=L=>h!==void 0&&L<h||p!==void 0&&L>p,N=L=>h===void 0?p:p===void 0||Math.abs(h-L)<Math.abs(p-L)?h:p;let M=i*e;const D=w+M,I=d===void 0?D:d(D);I!==D&&(M=I-w);const V=L=>-M*Math.exp(-L/a),F=L=>I+V(L),O=L=>{const P=V(L),G=F(L);C.done=Math.abs(P)<=y,C.value=C.done?I:G};let A,H;const E=L=>{j(C.value)&&(A=L,H=eu({keyframes:[C.value,N(C.value)],velocity:W2(F,L,C.value),damping:c,stiffness:u,restDelta:y,restSpeed:g}))};return E(0),{calculatedDuration:null,next:L=>{let P=!1;return!H&&A===void 0&&(P=!0,O(L),E(L)),A!==void 0&&L>=A?H.next(L-A):(!P&&O(L),C)}}}const qR=fl(.42,0,1,1),VR=fl(0,0,.58,1),Z2=fl(.42,0,.58,1),HR=t=>Array.isArray(t)&&typeof t[0]!="number",GR={linear:_s,easeIn:qR,easeInOut:Z2,easeOut:VR,circIn:Lm,circInOut:M2,circOut:R2,backIn:Mm,backInOut:E2,backOut:k2,anticipate:A2},$y=t=>{if(hm(t)){Wb(t.length===4);const[e,i,a,c]=t;return fl(e,i,a,c)}else if(typeof t=="string")return GR[t];return t};function YR(t,e,i){const a=[],c=i||Q2,u=t.length-1;for(let d=0;d<u;d++){let h=c(t[d],t[d+1]);if(e){const p=Array.isArray(e)?e[d]||_s:e;h=hl(p,h)}a.push(h)}return a}function XR(t,e,{clamp:i=!0,ease:a,mixer:c}={}){const u=t.length;if(Wb(u===e.length),u===1)return()=>e[0];if(u===2&&e[0]===e[1])return()=>e[1];const d=t[0]===t[1];t[0]>t[u-1]&&(t=[...t].reverse(),e=[...e].reverse());const h=YR(e,a,c),p=h.length,y=g=>{if(d&&g<t[0])return e[0];let w=0;if(p>1)for(;w<t.length-2&&!(g<t[w+1]);w++);const C=Jo(t[w],t[w+1],g);return h[w](C)};return i?g=>y(yi(t[0],t[u-1],g)):y}function KR(t,e){const i=t[t.length-1];for(let a=1;a<=e;a++){const c=Jo(0,e,a);t.push(nn(i,1,c))}}function QR(t){const e=[0];return KR(e,t.length-1),e}function WR(t,e){return t.map(i=>i*e)}function ZR(t,e){return t.map(()=>e||Z2).splice(0,t.length-1)}function tu({duration:t=300,keyframes:e,times:i,ease:a="easeInOut"}){const c=HR(a)?a.map($y):$y(a),u={done:!1,value:e[0]},d=WR(i&&i.length===e.length?i:QR(e),t),h=XR(d,e,{ease:Array.isArray(c)?c:ZR(e,c)});return{calculatedDuration:t,next:p=>(u.value=h(p),u.done=p>=t,u)}}const JR=t=>{const e=({timestamp:i})=>t(i);return{start:()=>Qt.update(e,!0),stop:()=>Gi(e),now:()=>On.isProcessing?On.timestamp:Xs.now()}},eM={decay:Py,inertia:Py,tween:tu,keyframes:tu,spring:eu},tM=t=>t/100;class Pm extends X2{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:p}=this.options;p&&p()};const{name:i,motionValue:a,element:c,keyframes:u}=this.options,d=(c==null?void 0:c.KeyframeResolver)||Bm,h=(p,y)=>this.onKeyframesResolved(p,y);this.resolver=new d(u,h,i,a,c),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:i="keyframes",repeat:a=0,repeatDelay:c=0,repeatType:u,velocity:d=0}=this.options,h=mm(i)?i:eM[i]||tu;let p,y;h!==tu&&typeof e[0]!="number"&&(p=hl(tM,Q2(e[0],e[1])),e=[0,100]);const g=h({...this.options,keyframes:e});u==="mirror"&&(y=h({...this.options,keyframes:[...e].reverse(),velocity:-d})),g.calculatedDuration===null&&(g.calculatedDuration=pm(g));const{calculatedDuration:w}=g,C=w+c,j=C*(a+1)-c;return{generator:g,mirroredGenerator:y,mapPercentToKeyframes:p,calculatedDuration:w,resolvedDuration:C,totalDuration:j}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,i=!1){const{resolved:a}=this;if(!a){const{keyframes:L}=this.options;return{done:!0,value:L[L.length-1]}}const{finalKeyframe:c,generator:u,mirroredGenerator:d,mapPercentToKeyframes:h,keyframes:p,calculatedDuration:y,totalDuration:g,resolvedDuration:w}=a;if(this.startTime===null)return u.next(0);const{delay:C,repeat:j,repeatType:N,repeatDelay:M,onUpdate:D}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-g/this.speed,this.startTime)),i?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const I=this.currentTime-C*(this.speed>=0?1:-1),V=this.speed>=0?I<0:I>g;this.currentTime=Math.max(I,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=g);let F=this.currentTime,O=u;if(j){const L=Math.min(this.currentTime,g)/w;let P=Math.floor(L),G=L%1;!G&&L>=1&&(G=1),G===1&&P--,P=Math.min(P,j+1),!!(P%2)&&(N==="reverse"?(G=1-G,M&&(G-=M/w)):N==="mirror"&&(O=d)),F=yi(0,1,G)*w}const A=V?{done:!1,value:p[0]}:O.next(F);h&&(A.value=h(A.value));let{done:H}=A;!V&&y!==null&&(H=this.speed>=0?this.currentTime>=g:this.currentTime<=0);const E=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&H);return E&&c!==void 0&&(A.value=xu(p,this.options,c)),D&&D(A.value),E&&this.finish(),A}get duration(){const{resolved:e}=this;return e?Ys(e.calculatedDuration):0}get time(){return Ys(this.currentTime)}set time(e){e=Gs(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const i=this.playbackSpeed!==e;this.playbackSpeed=e,i&&(this.time=Ys(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=JR,onPlay:i,startTime:a}=this.options;this.driver||(this.driver=e(u=>this.tick(u))),i&&i();const c=this.driver.now();this.holdTime!==null?this.startTime=c-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=c):this.startTime=a??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=this.currentTime??0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}get finished(){return this.currentFinishedPromise}}const nM=new Set(["opacity","clipPath","filter","transform"]),sM=dm(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),nu=10,iM=2e4;function aM(t){return mm(t.type)||t.type==="spring"||!t2(t.ease)}function rM(t,e){const i=new Pm({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let a={done:!1,value:t[0]};const c=[];let u=0;for(;!a.done&&u<iM;)a=i.sample(u),c.push(a.value),u+=nu;return{times:void 0,keyframes:c,duration:u-nu,ease:"linear"}}const J2={anticipate:A2,backInOut:E2,circInOut:M2};function oM(t){return t in J2}class Uy extends X2{constructor(e){super(e);const{name:i,motionValue:a,element:c,keyframes:u}=this.options;this.resolver=new Y2(u,(d,h)=>this.onKeyframesResolved(d,h),i,a,c),this.resolver.scheduleResolve()}initPlayback(e,i){let{duration:a=300,times:c,ease:u,type:d,motionValue:h,name:p,startTime:y}=this.options;if(!h.owner||!h.owner.current)return!1;if(typeof u=="string"&&el()&&oM(u)&&(u=J2[u]),aM(this.options)){const{onComplete:w,onUpdate:C,motionValue:j,element:N,...M}=this.options,D=rM(e,M);e=D.keyframes,e.length===1&&(e[1]=e[0]),a=D.duration,c=D.times,u=D.ease,d="keyframes"}const g=$9(h.owner.current,p,e,{...this.options,duration:a,times:c,ease:u});return g.startTime=y??this.calcStartTime(),this.pendingTimeline?(my(g,this.pendingTimeline),this.pendingTimeline=void 0):g.onfinish=()=>{const{onComplete:w}=this.options;h.set(xu(e,this.options,i)),w&&w(),this.cancel(),this.resolveFinishedPromise()},{animation:g,duration:a,times:c,type:d,ease:u,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:i}=e;return Ys(i)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:i}=e;return Ys(i.currentTime||0)}set time(e){const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.currentTime=Gs(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:i}=e;return i.playbackRate}get finished(){return this.resolved.animation.finished}set speed(e){const{resolved:i}=this;if(!i)return;const{animation:a}=i;a.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:i}=e;return i.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:i}=e;return i.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:i}=this;if(!i)return _s;const{animation:a}=i;my(a,e)}return _s}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:i}=e;i.playState==="finished"&&this.updateFinishedPromise(),i.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:i}=e;i.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:i,keyframes:a,duration:c,type:u,ease:d,times:h}=e;if(i.playState==="idle"||i.playState==="finished")return;if(this.time){const{motionValue:y,onUpdate:g,onComplete:w,element:C,...j}=this.options,N=new Pm({...j,keyframes:a,duration:c,type:u,ease:d,times:h,isGenerator:!0}),M=Gs(this.time);y.setWithVelocity(N.sample(M-nu).value,N.sample(M).value,nu)}const{onStop:p}=this.options;p&&p(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:i,name:a,repeatDelay:c,repeatType:u,damping:d,type:h}=e;if(!i||!i.owner||!(i.owner.current instanceof HTMLElement))return!1;const{onUpdate:p,transformTemplate:y}=i.owner.getProps();return sM()&&a&&nM.has(a)&&(a!=="transform"||!y)&&!p&&!c&&u!=="mirror"&&d!==0&&h!=="inertia"}}const lM={type:"spring",stiffness:500,damping:25,restSpeed:10},cM=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),uM={type:"keyframes",duration:.8},dM={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},fM=(t,{keyframes:e})=>e.length>2?uM:Ea.has(t)?t.startsWith("scale")?cM(e[1]):lM:dM;function hM({when:t,delay:e,delayChildren:i,staggerChildren:a,staggerDirection:c,repeat:u,repeatType:d,repeatDelay:h,from:p,elapsed:y,...g}){return!!Object.keys(g).length}const $m=(t,e,i,a={},c,u)=>d=>{const h=gm(a,t)||{},p=h.delay||a.delay||0;let{elapsed:y=0}=a;y=y-Gs(p);let g={keyframes:Array.isArray(i)?i:[null,i],ease:"easeOut",velocity:e.getVelocity(),...h,delay:-y,onUpdate:C=>{e.set(C),h.onUpdate&&h.onUpdate(C)},onComplete:()=>{d(),h.onComplete&&h.onComplete()},name:t,motionValue:e,element:u?void 0:c};hM(h)||(g={...g,...fM(t,g)}),g.duration&&(g.duration=Gs(g.duration)),g.repeatDelay&&(g.repeatDelay=Gs(g.repeatDelay)),g.from!==void 0&&(g.keyframes[0]=g.from);let w=!1;if((g.type===!1||g.duration===0&&!g.repeatDelay)&&(g.duration=0,g.delay===0&&(w=!0)),g.allowFlatten=!h.type&&!h.ease,w&&!u&&e.get()!==void 0){const C=xu(g.keyframes,h);if(C!==void 0)return Qt.update(()=>{g.onUpdate(C),g.onComplete()}),new B9([])}return!u&&Uy.supports(g)?new Uy(g):new Pm(g)};function mM({protectedKeys:t,needsAnimating:e},i){const a=t.hasOwnProperty(i)&&e[i]!==!0;return e[i]=!1,a}function e4(t,e,{delay:i=0,transitionOverride:a,type:c}={}){let{transition:u=t.getDefaultTransition(),transitionEnd:d,...h}=e;a&&(u=a);const p=[],y=c&&t.animationState&&t.animationState.getState()[c];for(const g in h){const w=t.getValue(g,t.latestValues[g]??null),C=h[g];if(C===void 0||y&&mM(y,g))continue;const j={delay:i,...gm(u||{},g)};let N=!1;if(window.MotionHandoffAnimation){const D=j2(t);if(D){const I=window.MotionHandoffAnimation(D,g,Qt);I!==null&&(j.startTime=I,N=!0)}}Sh(t,g),w.start($m(g,w,C,t.shouldReduceMotion&&S2.has(g)?{type:!1}:j,t,N));const M=w.animation;M&&p.push(M)}return d&&Promise.all(p).then(()=>{Qt.update(()=>{d&&qA(t,d)})}),p}function Lh(t,e,i={}){var p;const a=al(t,e,i.type==="exit"?(p=t.presenceContext)==null?void 0:p.custom:void 0);let{transition:c=t.getDefaultTransition()||{}}=a||{};i.transitionOverride&&(c=i.transitionOverride);const u=a?()=>Promise.all(e4(t,a,i)):()=>Promise.resolve(),d=t.variantChildren&&t.variantChildren.size?(y=0)=>{const{delayChildren:g=0,staggerChildren:w,staggerDirection:C}=c;return gM(t,e,g+y,w,C,i)}:()=>Promise.resolve(),{when:h}=c;if(h){const[y,g]=h==="beforeChildren"?[u,d]:[d,u];return y().then(()=>g())}else return Promise.all([u(),d(i.delay)])}function gM(t,e,i=0,a=0,c=1,u){const d=[],h=(t.variantChildren.size-1)*a,p=c===1?(y=0)=>y*a:(y=0)=>h-y*a;return Array.from(t.variantChildren).sort(pM).forEach((y,g)=>{y.notify("AnimationStart",e),d.push(Lh(y,e,{...u,delay:i+p(g)}).then(()=>y.notify("AnimationComplete",e)))}),Promise.all(d)}function pM(t,e){return t.sortNodePosition(e)}function yM(t,e,i={}){t.notify("AnimationStart",e);let a;if(Array.isArray(e)){const c=e.map(u=>Lh(t,u,i));a=Promise.all(c)}else if(typeof e=="string")a=Lh(t,e,i);else{const c=typeof e=="function"?al(t,e,i.custom):e;a=Promise.all(e4(t,c,i))}return a.then(()=>{t.notify("AnimationComplete",e)})}function t4(t,e){if(!Array.isArray(e))return!1;const i=e.length;if(i!==t.length)return!1;for(let a=0;a<i;a++)if(e[a]!==t[a])return!1;return!0}const vM=xm.length;function n4(t){if(!t)return;if(!t.isControllingVariants){const i=t.parent?n4(t.parent)||{}:{};return t.props.initial!==void 0&&(i.initial=t.props.initial),i}const e={};for(let i=0;i<vM;i++){const a=xm[i],c=t.props[a];(nl(c)||c===!1)&&(e[a]=c)}return e}const bM=[...bm].reverse(),xM=bm.length;function wM(t){return e=>Promise.all(e.map(({animation:i,options:a})=>yM(t,i,a)))}function _M(t){let e=wM(t),i=Iy(),a=!0;const c=p=>(y,g)=>{var C;const w=al(t,g,p==="exit"?(C=t.presenceContext)==null?void 0:C.custom:void 0);if(w){const{transition:j,transitionEnd:N,...M}=w;y={...y,...M,...N}}return y};function u(p){e=p(t)}function d(p){const{props:y}=t,g=n4(t.parent)||{},w=[],C=new Set;let j={},N=1/0;for(let D=0;D<xM;D++){const I=bM[D],V=i[I],F=y[I]!==void 0?y[I]:g[I],O=nl(F),A=I===p?V.isActive:null;A===!1&&(N=D);let H=F===g[I]&&F!==y[I]&&O;if(H&&a&&t.manuallyAnimateOnMount&&(H=!1),V.protectedKeys={...j},!V.isActive&&A===null||!F&&!V.prevProp||vu(F)||typeof F=="boolean")continue;const E=SM(V.prevProp,F);let L=E||I===p&&V.isActive&&!H&&O||D>N&&O,P=!1;const G=Array.isArray(F)?F:[F];let Q=G.reduce(c(I),{});A===!1&&(Q={});const{prevResolvedValues:z={}}=V,ae={...z,...Q},Pe=q=>{L=!0,C.has(q)&&(P=!0,C.delete(q)),V.needsAnimating[q]=!0;const J=t.getValue(q);J&&(J.liveStyle=!1)};for(const q in ae){const J=Q[q],re=z[q];if(j.hasOwnProperty(q))continue;let Ne=!1;_h(J)&&_h(re)?Ne=!t4(J,re):Ne=J!==re,Ne?J!=null?Pe(q):C.add(q):J!==void 0&&C.has(q)?Pe(q):V.protectedKeys[q]=!0}V.prevProp=F,V.prevResolvedValues=Q,V.isActive&&(j={...j,...Q}),a&&t.blockInitialAnimation&&(L=!1),L&&(!(H&&E)||P)&&w.push(...G.map(q=>({animation:q,options:{type:I}})))}if(C.size){const D={};if(typeof y.initial!="boolean"){const I=al(t,Array.isArray(y.initial)?y.initial[0]:y.initial);I&&I.transition&&(D.transition=I.transition)}C.forEach(I=>{const V=t.getBaseTarget(I),F=t.getValue(I);F&&(F.liveStyle=!0),D[I]=V??null}),w.push({animation:D})}let M=!!w.length;return a&&(y.initial===!1||y.initial===y.animate)&&!t.manuallyAnimateOnMount&&(M=!1),a=!1,M?e(w):Promise.resolve()}function h(p,y){var w;if(i[p].isActive===y)return Promise.resolve();(w=t.variantChildren)==null||w.forEach(C=>{var j;return(j=C.animationState)==null?void 0:j.setActive(p,y)}),i[p].isActive=y;const g=d(p);for(const C in i)i[C].protectedKeys={};return g}return{animateChanges:d,setActive:h,setAnimateFunction:u,getState:()=>i,reset:()=>{i=Iy(),a=!0}}}function SM(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!t4(e,t):!1}function ya(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Iy(){return{animate:ya(!0),whileInView:ya(),whileHover:ya(),whileTap:ya(),whileDrag:ya(),whileFocus:ya(),exit:ya()}}class Xi{constructor(e){this.isMounted=!1,this.node=e}update(){}}class jM extends Xi{constructor(e){super(e),e.animationState||(e.animationState=_M(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vu(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:i}=this.node.prevProps||{};e!==i&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let CM=0;class NM extends Xi{constructor(){super(...arguments),this.id=CM++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:i}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===a)return;const c=this.node.animationState.setActive("exit",!e);i&&!e&&c.then(()=>{i(this.id)})}mount(){const{register:e,onExitComplete:i}=this.node.presenceContext||{};i&&i(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const TM={animation:{Feature:jM},exit:{Feature:NM}};function ol(t,e,i,a={passive:!0}){return t.addEventListener(e,i,a),()=>t.removeEventListener(e,i)}function ml(t){return{point:{x:t.pageX,y:t.pageY}}}const kM=t=>e=>vm(e)&&t(e,ml(e));function Go(t,e,i,a){return ol(t,e,kM(i),a)}function s4({top:t,left:e,right:i,bottom:a}){return{x:{min:e,max:i},y:{min:t,max:a}}}function EM({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function AM(t,e){if(!e)return t;const i=e({x:t.left,y:t.top}),a=e({x:t.right,y:t.bottom});return{top:i.y,left:i.x,bottom:a.y,right:a.x}}const i4=1e-4,RM=1-i4,MM=1+i4,a4=.01,LM=0-a4,OM=0+a4;function Hn(t){return t.max-t.min}function DM(t,e,i){return Math.abs(t-e)<=i}function Fy(t,e,i,a=.5){t.origin=a,t.originPoint=nn(e.min,e.max,t.origin),t.scale=Hn(i)/Hn(e),t.translate=nn(i.min,i.max,t.origin)-t.originPoint,(t.scale>=RM&&t.scale<=MM||isNaN(t.scale))&&(t.scale=1),(t.translate>=LM&&t.translate<=OM||isNaN(t.translate))&&(t.translate=0)}function Yo(t,e,i,a){Fy(t.x,e.x,i.x,a?a.originX:void 0),Fy(t.y,e.y,i.y,a?a.originY:void 0)}function qy(t,e,i){t.min=i.min+e.min,t.max=t.min+Hn(e)}function BM(t,e,i){qy(t.x,e.x,i.x),qy(t.y,e.y,i.y)}function Vy(t,e,i){t.min=e.min-i.min,t.max=t.min+Hn(e)}function Xo(t,e,i){Vy(t.x,e.x,i.x),Vy(t.y,e.y,i.y)}const Hy=()=>({translate:0,scale:1,origin:0,originPoint:0}),gr=()=>({x:Hy(),y:Hy()}),Gy=()=>({min:0,max:0}),fn=()=>({x:Gy(),y:Gy()});function vs(t){return[t("x"),t("y")]}function Wf(t){return t===void 0||t===1}function Oh({scale:t,scaleX:e,scaleY:i}){return!Wf(t)||!Wf(e)||!Wf(i)}function va(t){return Oh(t)||r4(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function r4(t){return Yy(t.x)||Yy(t.y)}function Yy(t){return t&&t!=="0%"}function su(t,e,i){const a=t-i,c=e*a;return i+c}function Xy(t,e,i,a,c){return c!==void 0&&(t=su(t,c,a)),su(t,i,a)+e}function Dh(t,e=0,i=1,a,c){t.min=Xy(t.min,e,i,a,c),t.max=Xy(t.max,e,i,a,c)}function o4(t,{x:e,y:i}){Dh(t.x,e.translate,e.scale,e.originPoint),Dh(t.y,i.translate,i.scale,i.originPoint)}const Ky=.999999999999,Qy=1.0000000000001;function zM(t,e,i,a=!1){const c=i.length;if(!c)return;e.x=e.y=1;let u,d;for(let h=0;h<c;h++){u=i[h],d=u.projectionDelta;const{visualElement:p}=u.options;p&&p.props.style&&p.props.style.display==="contents"||(a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&yr(t,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),d&&(e.x*=d.x.scale,e.y*=d.y.scale,o4(t,d)),a&&va(u.latestValues)&&yr(t,u.latestValues))}e.x<Qy&&e.x>Ky&&(e.x=1),e.y<Qy&&e.y>Ky&&(e.y=1)}function pr(t,e){t.min=t.min+e,t.max=t.max+e}function Wy(t,e,i,a,c=.5){const u=nn(t.min,t.max,c);Dh(t,e,i,u,a)}function yr(t,e){Wy(t.x,e.x,e.scaleX,e.scale,e.originX),Wy(t.y,e.y,e.scaleY,e.scale,e.originY)}function l4(t,e){return s4(AM(t.getBoundingClientRect(),e))}function PM(t,e,i){const a=l4(t,i),{scroll:c}=e;return c&&(pr(a.x,c.offset.x),pr(a.y,c.offset.y)),a}const c4=({current:t})=>t?t.ownerDocument.defaultView:null,Zy=(t,e)=>Math.abs(t-e);function $M(t,e){const i=Zy(t.x,e.x),a=Zy(t.y,e.y);return Math.sqrt(i**2+a**2)}class u4{constructor(e,i,{transformPagePoint:a,contextWindow:c,dragSnapToOrigin:u=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Jf(this.lastMoveEventInfo,this.history),C=this.startEvent!==null,j=$M(w.offset,{x:0,y:0})>=3;if(!C&&!j)return;const{point:N}=w,{timestamp:M}=On;this.history.push({...N,timestamp:M});const{onStart:D,onMove:I}=this.handlers;C||(D&&D(this.lastMoveEvent,w),this.startEvent=this.lastMoveEvent),I&&I(this.lastMoveEvent,w)},this.handlePointerMove=(w,C)=>{this.lastMoveEvent=w,this.lastMoveEventInfo=Zf(C,this.transformPagePoint),Qt.update(this.updatePoint,!0)},this.handlePointerUp=(w,C)=>{this.end();const{onEnd:j,onSessionEnd:N,resumeAnimation:M}=this.handlers;if(this.dragSnapToOrigin&&M&&M(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const D=Jf(w.type==="pointercancel"?this.lastMoveEventInfo:Zf(C,this.transformPagePoint),this.history);this.startEvent&&j&&j(w,D),N&&N(w,D)},!vm(e))return;this.dragSnapToOrigin=u,this.handlers=i,this.transformPagePoint=a,this.contextWindow=c||window;const d=ml(e),h=Zf(d,this.transformPagePoint),{point:p}=h,{timestamp:y}=On;this.history=[{...p,timestamp:y}];const{onSessionStart:g}=i;g&&g(e,Jf(h,this.history)),this.removeListeners=hl(Go(this.contextWindow,"pointermove",this.handlePointerMove),Go(this.contextWindow,"pointerup",this.handlePointerUp),Go(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Gi(this.updatePoint)}}function Zf(t,e){return e?{point:e(t.point)}:t}function Jy(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Jf({point:t},e){return{point:t,delta:Jy(t,d4(e)),offset:Jy(t,UM(e)),velocity:IM(e,.1)}}function UM(t){return t[0]}function d4(t){return t[t.length-1]}function IM(t,e){if(t.length<2)return{x:0,y:0};let i=t.length-1,a=null;const c=d4(t);for(;i>=0&&(a=t[i],!(c.timestamp-a.timestamp>Gs(e)));)i--;if(!a)return{x:0,y:0};const u=Ys(c.timestamp-a.timestamp);if(u===0)return{x:0,y:0};const d={x:(c.x-a.x)/u,y:(c.y-a.y)/u};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function FM(t,{min:e,max:i},a){return e!==void 0&&t<e?t=a?nn(e,t,a.min):Math.max(t,e):i!==void 0&&t>i&&(t=a?nn(i,t,a.max):Math.min(t,i)),t}function ev(t,e,i){return{min:e!==void 0?t.min+e:void 0,max:i!==void 0?t.max+i-(t.max-t.min):void 0}}function qM(t,{top:e,left:i,bottom:a,right:c}){return{x:ev(t.x,i,c),y:ev(t.y,e,a)}}function tv(t,e){let i=e.min-t.min,a=e.max-t.max;return e.max-e.min<t.max-t.min&&([i,a]=[a,i]),{min:i,max:a}}function VM(t,e){return{x:tv(t.x,e.x),y:tv(t.y,e.y)}}function HM(t,e){let i=.5;const a=Hn(t),c=Hn(e);return c>a?i=Jo(e.min,e.max-a,t.min):a>c&&(i=Jo(t.min,t.max-c,e.min)),yi(0,1,i)}function GM(t,e){const i={};return e.min!==void 0&&(i.min=e.min-t.min),e.max!==void 0&&(i.max=e.max-t.min),i}const Bh=.35;function YM(t=Bh){return t===!1?t=0:t===!0&&(t=Bh),{x:nv(t,"left","right"),y:nv(t,"top","bottom")}}function nv(t,e,i){return{min:sv(t,e),max:sv(t,i)}}function sv(t,e){return typeof t=="number"?t:t[e]||0}const XM=new WeakMap;class KM{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=fn(),this.visualElement=e}start(e,{snapToCursor:i=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const c=g=>{const{dragSnapToOrigin:w}=this.getProps();w?this.pauseAnimation():this.stopAnimation(),i&&this.snapToCursor(ml(g).point)},u=(g,w)=>{const{drag:C,dragPropagation:j,onDragStart:N}=this.getProps();if(C&&!j&&(this.openDragLock&&this.openDragLock(),this.openDragLock=V9(C),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),vs(D=>{let I=this.getAxisMotionValue(D).get()||0;if(Ks.test(I)){const{projection:V}=this.visualElement;if(V&&V.layout){const F=V.layout.layoutBox[D];F&&(I=Hn(F)*(parseFloat(I)/100))}}this.originPoint[D]=I}),N&&Qt.postRender(()=>N(g,w)),Sh(this.visualElement,"transform");const{animationState:M}=this.visualElement;M&&M.setActive("whileDrag",!0)},d=(g,w)=>{const{dragPropagation:C,dragDirectionLock:j,onDirectionLock:N,onDrag:M}=this.getProps();if(!C&&!this.openDragLock)return;const{offset:D}=w;if(j&&this.currentDirection===null){this.currentDirection=QM(D),this.currentDirection!==null&&N&&N(this.currentDirection);return}this.updateAxis("x",w.point,D),this.updateAxis("y",w.point,D),this.visualElement.render(),M&&M(g,w)},h=(g,w)=>this.stop(g,w),p=()=>vs(g=>{var w;return this.getAnimationState(g)==="paused"&&((w=this.getAxisMotionValue(g).animation)==null?void 0:w.play())}),{dragSnapToOrigin:y}=this.getProps();this.panSession=new u4(e,{onSessionStart:c,onStart:u,onMove:d,onSessionEnd:h,resumeAnimation:p},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:y,contextWindow:c4(this.visualElement)})}stop(e,i){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:c}=i;this.startAnimation(c);const{onDragEnd:u}=this.getProps();u&&Qt.postRender(()=>u(e,i))}cancel(){this.isDragging=!1;const{projection:e,animationState:i}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(e,i,a){const{drag:c}=this.getProps();if(!a||!Mc(e,c,this.currentDirection))return;const u=this.getAxisMotionValue(e);let d=this.originPoint[e]+a[e];this.constraints&&this.constraints[e]&&(d=FM(d,this.constraints[e],this.elastic[e])),u.set(d)}resolveConstraints(){var u;const{dragConstraints:e,dragElastic:i}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(u=this.visualElement.projection)==null?void 0:u.layout,c=this.constraints;e&&hr(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&a?this.constraints=qM(a.layoutBox,e):this.constraints=!1,this.elastic=YM(i),c!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&vs(d=>{this.constraints!==!1&&this.getAxisMotionValue(d)&&(this.constraints[d]=GM(a.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:i}=this.getProps();if(!e||!hr(e))return!1;const a=e.current,{projection:c}=this.visualElement;if(!c||!c.layout)return!1;const u=PM(a,c.root,this.visualElement.getTransformPagePoint());let d=VM(c.layout.layoutBox,u);if(i){const h=i(EM(d));this.hasMutatedConstraints=!!h,h&&(d=s4(h))}return d}startAnimation(e){const{drag:i,dragMomentum:a,dragElastic:c,dragTransition:u,dragSnapToOrigin:d,onDragTransitionEnd:h}=this.getProps(),p=this.constraints||{},y=vs(g=>{if(!Mc(g,i,this.currentDirection))return;let w=p&&p[g]||{};d&&(w={min:0,max:0});const C=c?200:1e6,j=c?40:1e7,N={type:"inertia",velocity:a?e[g]:0,bounceStiffness:C,bounceDamping:j,timeConstant:750,restDelta:1,restSpeed:10,...u,...w};return this.startAxisValueAnimation(g,N)});return Promise.all(y).then(h)}startAxisValueAnimation(e,i){const a=this.getAxisMotionValue(e);return Sh(this.visualElement,e),a.start($m(e,a,0,i,this.visualElement,!1))}stopAnimation(){vs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){vs(e=>{var i;return(i=this.getAxisMotionValue(e).animation)==null?void 0:i.pause()})}getAnimationState(e){var i;return(i=this.getAxisMotionValue(e).animation)==null?void 0:i.state}getAxisMotionValue(e){const i=`_drag${e.toUpperCase()}`,a=this.visualElement.getProps(),c=a[i];return c||this.visualElement.getValue(e,(a.initial?a.initial[e]:void 0)||0)}snapToCursor(e){vs(i=>{const{drag:a}=this.getProps();if(!Mc(i,a,this.currentDirection))return;const{projection:c}=this.visualElement,u=this.getAxisMotionValue(i);if(c&&c.layout){const{min:d,max:h}=c.layout.layoutBox[i];u.set(e[i]-nn(d,h,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:i}=this.getProps(),{projection:a}=this.visualElement;if(!hr(i)||!a||!this.constraints)return;this.stopAnimation();const c={x:0,y:0};vs(d=>{const h=this.getAxisMotionValue(d);if(h&&this.constraints!==!1){const p=h.get();c[d]=HM({min:p,max:p},this.constraints[d])}});const{transformTemplate:u}=this.visualElement.getProps();this.visualElement.current.style.transform=u?u({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),vs(d=>{if(!Mc(d,e,null))return;const h=this.getAxisMotionValue(d),{min:p,max:y}=this.constraints[d];h.set(nn(p,y,c[d]))})}addListeners(){if(!this.visualElement.current)return;XM.set(this.visualElement,this);const e=this.visualElement.current,i=Go(e,"pointerdown",p=>{const{drag:y,dragListener:g=!0}=this.getProps();y&&g&&this.start(p)}),a=()=>{const{dragConstraints:p}=this.getProps();hr(p)&&p.current&&(this.constraints=this.resolveRefConstraints())},{projection:c}=this.visualElement,u=c.addEventListener("measure",a);c&&!c.layout&&(c.root&&c.root.updateScroll(),c.updateLayout()),Qt.read(a);const d=ol(window,"resize",()=>this.scalePositionWithinConstraints()),h=c.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y})=>{this.isDragging&&y&&(vs(g=>{const w=this.getAxisMotionValue(g);w&&(this.originPoint[g]+=p[g].translate,w.set(w.get()+p[g].translate))}),this.visualElement.render())});return()=>{d(),i(),u(),h&&h()}}getProps(){const e=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:a=!1,dragPropagation:c=!1,dragConstraints:u=!1,dragElastic:d=Bh,dragMomentum:h=!0}=e;return{...e,drag:i,dragDirectionLock:a,dragPropagation:c,dragConstraints:u,dragElastic:d,dragMomentum:h}}}function Mc(t,e,i){return(e===!0||e===t)&&(i===null||i===t)}function QM(t,e=10){let i=null;return Math.abs(t.y)>e?i="y":Math.abs(t.x)>e&&(i="x"),i}class WM extends Xi{constructor(e){super(e),this.removeGroupControls=_s,this.removeListeners=_s,this.controls=new KM(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||_s}unmount(){this.removeGroupControls(),this.removeListeners()}}const iv=t=>(e,i)=>{t&&Qt.postRender(()=>t(e,i))};class ZM extends Xi{constructor(){super(...arguments),this.removePointerDownListener=_s}onPointerDown(e){this.session=new u4(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:c4(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:i,onPan:a,onPanEnd:c}=this.node.getProps();return{onSessionStart:iv(e),onStart:iv(i),onMove:a,onEnd:(u,d)=>{delete this.session,c&&Qt.postRender(()=>c(u,d))}}}mount(){this.removePointerDownListener=Go(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Gc={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function av(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Po={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(pt.test(t))t=parseFloat(t);else return t;const i=av(t,e.target.x),a=av(t,e.target.y);return`${i}% ${a}%`}},JM={correct:(t,{treeScale:e,projectionDelta:i})=>{const a=t,c=Yi.parse(t);if(c.length>5)return a;const u=Yi.createTransformer(t),d=typeof c[0]!="number"?1:0,h=i.x.scale*e.x,p=i.y.scale*e.y;c[0+d]/=h,c[1+d]/=p;const y=nn(h,p,.5);return typeof c[2+d]=="number"&&(c[2+d]/=y),typeof c[3+d]=="number"&&(c[3+d]/=y),u(c)}};class eL extends b.Component{componentDidMount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:a,layoutId:c}=this.props,{projection:u}=e;yA(tL),u&&(i.group&&i.group.add(u),a&&a.register&&c&&a.register(u),u.root.didUpdate(),u.addEventListener("animationComplete",()=>{this.safeToRemove()}),u.setOptions({...u.options,onExitComplete:()=>this.safeToRemove()})),Gc.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:i,visualElement:a,drag:c,isPresent:u}=this.props,d=a.projection;return d&&(d.isPresent=u,c||e.layoutDependency!==i||i===void 0||e.isPresent!==u?d.willUpdate():this.safeToRemove(),e.isPresent!==u&&(u?d.promote():d.relegate()||Qt.postRender(()=>{const h=d.getStack();(!h||!h.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),ym.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:i,switchLayoutGroup:a}=this.props,{projection:c}=e;c&&(c.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(c),a&&a.deregister&&a.deregister(c))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function f4(t){const[e,i]=Qb(),a=b.useContext(am);return o.jsx(eL,{...t,layoutGroup:a,switchLayoutGroup:b.useContext(u2),isPresent:e,safeToRemove:i})}const tL={borderRadius:{...Po,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Po,borderTopRightRadius:Po,borderBottomLeftRadius:Po,borderBottomRightRadius:Po,boxShadow:JM};function nL(t,e,i){const a=Un(t)?t:tl(t);return a.start($m("",a,e,i)),a.animation}function sL(t){return t instanceof SVGElement&&t.tagName!=="svg"}const iL=(t,e)=>t.depth-e.depth;class aL{constructor(){this.children=[],this.isDirty=!1}add(e){cm(this.children,e),this.isDirty=!0}remove(e){um(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(iL),this.isDirty=!1,this.children.forEach(e)}}function rL(t,e){const i=Xs.now(),a=({timestamp:c})=>{const u=c-i;u>=e&&(Gi(a),t(u-e))};return Qt.read(a,!0),()=>Gi(a)}const h4=["TopLeft","TopRight","BottomLeft","BottomRight"],oL=h4.length,rv=t=>typeof t=="string"?parseFloat(t):t,ov=t=>typeof t=="number"||pt.test(t);function lL(t,e,i,a,c,u){c?(t.opacity=nn(0,i.opacity!==void 0?i.opacity:1,cL(a)),t.opacityExit=nn(e.opacity!==void 0?e.opacity:1,0,uL(a))):u&&(t.opacity=nn(e.opacity!==void 0?e.opacity:1,i.opacity!==void 0?i.opacity:1,a));for(let d=0;d<oL;d++){const h=`border${h4[d]}Radius`;let p=lv(e,h),y=lv(i,h);if(p===void 0&&y===void 0)continue;p||(p=0),y||(y=0),p===0||y===0||ov(p)===ov(y)?(t[h]=Math.max(nn(rv(p),rv(y),a),0),(Ks.test(y)||Ks.test(p))&&(t[h]+="%")):t[h]=y}(e.rotate||i.rotate)&&(t.rotate=nn(e.rotate||0,i.rotate||0,a))}function lv(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const cL=m4(0,.5,R2),uL=m4(.5,.95,_s);function m4(t,e,i){return a=>a<t?0:a>e?1:i(Jo(t,e,a))}function cv(t,e){t.min=e.min,t.max=e.max}function ys(t,e){cv(t.x,e.x),cv(t.y,e.y)}function uv(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function dv(t,e,i,a,c){return t-=e,t=su(t,1/i,a),c!==void 0&&(t=su(t,1/c,a)),t}function dL(t,e=0,i=1,a=.5,c,u=t,d=t){if(Ks.test(e)&&(e=parseFloat(e),e=nn(d.min,d.max,e/100)-d.min),typeof e!="number")return;let h=nn(u.min,u.max,a);t===u&&(h-=e),t.min=dv(t.min,e,i,h,c),t.max=dv(t.max,e,i,h,c)}function fv(t,e,[i,a,c],u,d){dL(t,e[i],e[a],e[c],e.scale,u,d)}const fL=["x","scaleX","originX"],hL=["y","scaleY","originY"];function hv(t,e,i,a){fv(t.x,e,fL,i?i.x:void 0,a?a.x:void 0),fv(t.y,e,hL,i?i.y:void 0,a?a.y:void 0)}function mv(t){return t.translate===0&&t.scale===1}function g4(t){return mv(t.x)&&mv(t.y)}function gv(t,e){return t.min===e.min&&t.max===e.max}function mL(t,e){return gv(t.x,e.x)&&gv(t.y,e.y)}function pv(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function p4(t,e){return pv(t.x,e.x)&&pv(t.y,e.y)}function yv(t){return Hn(t.x)/Hn(t.y)}function vv(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class gL{constructor(){this.members=[]}add(e){cm(this.members,e),e.scheduleRender()}remove(e){if(um(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(e){const i=this.members.findIndex(c=>e===c);if(i===0)return!1;let a;for(let c=i;c>=0;c--){const u=this.members[c];if(u.isPresent!==!1){a=u;break}}return a?(this.promote(a),!0):!1}promote(e,i){const a=this.lead;if(e!==a&&(this.prevLead=a,this.lead=e,e.show(),a)){a.instance&&a.scheduleRender(),e.scheduleRender(),e.resumeFrom=a,i&&(e.resumeFrom.preserveOpacity=!0),a.snapshot&&(e.snapshot=a.snapshot,e.snapshot.latestValues=a.animationValues||a.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:c}=e.options;c===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:i,resumingFrom:a}=e;i.onExitComplete&&i.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function pL(t,e,i){let a="";const c=t.x.translate/e.x,u=t.y.translate/e.y,d=(i==null?void 0:i.z)||0;if((c||u||d)&&(a=`translate3d(${c}px, ${u}px, ${d}px) `),(e.x!==1||e.y!==1)&&(a+=`scale(${1/e.x}, ${1/e.y}) `),i){const{transformPerspective:y,rotate:g,rotateX:w,rotateY:C,skewX:j,skewY:N}=i;y&&(a=`perspective(${y}px) ${a}`),g&&(a+=`rotate(${g}deg) `),w&&(a+=`rotateX(${w}deg) `),C&&(a+=`rotateY(${C}deg) `),j&&(a+=`skewX(${j}deg) `),N&&(a+=`skewY(${N}deg) `)}const h=t.x.scale*e.x,p=t.y.scale*e.y;return(h!==1||p!==1)&&(a+=`scale(${h}, ${p})`),a||"none"}const eh=["","X","Y","Z"],yL={visibility:"hidden"},bv=1e3;let vL=0;function th(t,e,i,a){const{latestValues:c}=e;c[t]&&(i[t]=c[t],e.setStaticValue(t,0),a&&(a[t]=0))}function y4(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const i=j2(e);if(window.MotionHasOptimisedAnimation(i,"transform")){const{layout:c,layoutId:u}=t.options;window.MotionCancelOptimisedAnimation(i,"transform",Qt,!(c||u))}const{parent:a}=t;a&&!a.hasCheckedOptimisedAppear&&y4(a)}function v4({attachResizeListener:t,defaultParent:e,measureScroll:i,checkIsScrollRoot:a,resetTransform:c}){return class{constructor(d={},h=e==null?void 0:e()){this.id=vL++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(wL),this.nodes.forEach(NL),this.nodes.forEach(TL),this.nodes.forEach(_L)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=h?h.root||h:this,this.path=h?[...h.path,h]:[],this.parent=h,this.depth=h?h.depth+1:0;for(let p=0;p<this.path.length;p++)this.path[p].shouldResetTransform=!0;this.root===this&&(this.nodes=new aL)}addEventListener(d,h){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new fm),this.eventHandlers.get(d).add(h)}notifyListeners(d,...h){const p=this.eventHandlers.get(d);p&&p.notify(...h)}hasListeners(d){return this.eventHandlers.has(d)}mount(d,h=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sL(d),this.instance=d;const{layoutId:p,layout:y,visualElement:g}=this.options;if(g&&!g.current&&g.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),h&&(y||p)&&(this.isLayoutDirty=!0),t){let w;const C=()=>this.root.updateBlockedByResize=!1;t(d,()=>{this.root.updateBlockedByResize=!0,w&&w(),w=rL(C,250),Gc.hasAnimatedSinceResize&&(Gc.hasAnimatedSinceResize=!1,this.nodes.forEach(wv))})}p&&this.root.registerSharedNode(p,this),this.options.animate!==!1&&g&&(p||y)&&this.addEventListener("didUpdate",({delta:w,hasLayoutChanged:C,hasRelativeLayoutChanged:j,layout:N})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const M=this.options.transition||g.getDefaultTransition()||ML,{onLayoutAnimationStart:D,onLayoutAnimationComplete:I}=g.getProps(),V=!this.targetLayout||!p4(this.targetLayout,N),F=!C&&j;if(this.options.layoutRoot||this.resumeFrom||F||C&&(V||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(w,F);const O={...gm(M,"layout"),onPlay:D,onComplete:I};(g.shouldReduceMotion||this.options.layoutRoot)&&(O.delay=0,O.type=!1),this.startAnimation(O)}else C||wv(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=N})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Gi(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(kL),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&y4(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let g=0;g<this.path.length;g++){const w=this.path[g];w.shouldResetTransform=!0,w.updateScroll("snapshot"),w.options.layoutRoot&&w.willUpdate(!1)}const{layoutId:h,layout:p}=this.options;if(h===void 0&&!p)return;const y=this.getTransformTemplate();this.prevTransformTemplateValue=y?y(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(xv);return}this.isUpdating||this.nodes.forEach(jL),this.isUpdating=!1,this.nodes.forEach(CL),this.nodes.forEach(bL),this.nodes.forEach(xL),this.clearAllSnapshots();const h=Xs.now();On.delta=yi(0,1e3/60,h-On.timestamp),On.timestamp=h,On.isProcessing=!0,Gf.update.process(On),Gf.preRender.process(On),Gf.render.process(On),On.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,ym.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(SL),this.sharedNodes.forEach(EL)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Qt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Qt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Hn(this.snapshot.measuredBox.x)&&!Hn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let p=0;p<this.path.length;p++)this.path[p].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=fn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:h}=this.options;h&&h.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let h=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(h=!1),h){const p=a(this.instance);this.scroll={animationId:this.root.animationId,phase:d,isRoot:p,offset:i(this.instance),wasRoot:this.scroll?this.scroll.isRoot:p}}}resetTransform(){if(!c)return;const d=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,h=this.projectionDelta&&!g4(this.projectionDelta),p=this.getTransformTemplate(),y=p?p(this.latestValues,""):void 0,g=y!==this.prevTransformTemplateValue;d&&(h||va(this.latestValues)||g)&&(c(this.instance,y),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const h=this.measurePageBox();let p=this.removeElementScroll(h);return d&&(p=this.removeTransform(p)),LL(p),{animationId:this.root.animationId,measuredBox:h,layoutBox:p,latestValues:{},source:this.id}}measurePageBox(){var y;const{visualElement:d}=this.options;if(!d)return fn();const h=d.measureViewportBox();if(!(((y=this.scroll)==null?void 0:y.wasRoot)||this.path.some(OL))){const{scroll:g}=this.root;g&&(pr(h.x,g.offset.x),pr(h.y,g.offset.y))}return h}removeElementScroll(d){var p;const h=fn();if(ys(h,d),(p=this.scroll)!=null&&p.wasRoot)return h;for(let y=0;y<this.path.length;y++){const g=this.path[y],{scroll:w,options:C}=g;g!==this.root&&w&&C.layoutScroll&&(w.wasRoot&&ys(h,d),pr(h.x,w.offset.x),pr(h.y,w.offset.y))}return h}applyTransform(d,h=!1){const p=fn();ys(p,d);for(let y=0;y<this.path.length;y++){const g=this.path[y];!h&&g.options.layoutScroll&&g.scroll&&g!==g.root&&yr(p,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),va(g.latestValues)&&yr(p,g.latestValues)}return va(this.latestValues)&&yr(p,this.latestValues),p}removeTransform(d){const h=fn();ys(h,d);for(let p=0;p<this.path.length;p++){const y=this.path[p];if(!y.instance||!va(y.latestValues))continue;Oh(y.latestValues)&&y.updateSnapshot();const g=fn(),w=y.measurePageBox();ys(g,w),hv(h,y.latestValues,y.snapshot?y.snapshot.layoutBox:void 0,g)}return va(this.latestValues)&&hv(h,this.latestValues),h}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==On.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var C;const h=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=h.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=h.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=h.isSharedProjectionDirty);const p=!!this.resumingFrom||this!==h;if(!(d||p&&this.isSharedProjectionDirty||this.isProjectionDirty||(C=this.parent)!=null&&C.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:g,layoutId:w}=this.options;if(!(!this.layout||!(g||w))){if(this.resolvedRelativeTargetAt=On.timestamp,!this.targetDelta&&!this.relativeTarget){const j=this.getClosestProjectingParent();j&&j.layout&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=fn(),this.relativeTargetOrigin=fn(),Xo(this.relativeTargetOrigin,this.layout.layoutBox,j.layout.layoutBox),ys(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=fn(),this.targetWithTransforms=fn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),BM(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ys(this.target,this.layout.layoutBox),o4(this.target,this.targetDelta)):ys(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const j=this.getClosestProjectingParent();j&&!!j.resumingFrom==!!this.resumingFrom&&!j.options.layoutScroll&&j.target&&this.animationProgress!==1?(this.relativeParent=j,this.forceRelativeParentToResolveTarget(),this.relativeTarget=fn(),this.relativeTargetOrigin=fn(),Xo(this.relativeTargetOrigin,this.target,j.target),ys(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Oh(this.parent.latestValues)||r4(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var N;const d=this.getLead(),h=!!this.resumingFrom||this!==d;let p=!0;if((this.isProjectionDirty||(N=this.parent)!=null&&N.isProjectionDirty)&&(p=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(p=!1),this.resolvedRelativeTargetAt===On.timestamp&&(p=!1),p)return;const{layout:y,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(y||g))return;ys(this.layoutCorrected,this.layout.layoutBox);const w=this.treeScale.x,C=this.treeScale.y;zM(this.layoutCorrected,this.treeScale,this.path,h),d.layout&&!d.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(d.target=d.layout.layoutBox,d.targetWithTransforms=fn());const{target:j}=d;if(!j){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(uv(this.prevProjectionDelta.x,this.projectionDelta.x),uv(this.prevProjectionDelta.y,this.projectionDelta.y)),Yo(this.projectionDelta,this.layoutCorrected,j,this.latestValues),(this.treeScale.x!==w||this.treeScale.y!==C||!vv(this.projectionDelta.x,this.prevProjectionDelta.x)||!vv(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",j))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){var h;if((h=this.options.visualElement)==null||h.scheduleRender(),d){const p=this.getStack();p&&p.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=gr(),this.projectionDelta=gr(),this.projectionDeltaWithTransform=gr()}setAnimationOrigin(d,h=!1){const p=this.snapshot,y=p?p.latestValues:{},g={...this.latestValues},w=gr();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!h;const C=fn(),j=p?p.source:void 0,N=this.layout?this.layout.source:void 0,M=j!==N,D=this.getStack(),I=!D||D.members.length<=1,V=!!(M&&!I&&this.options.crossfade===!0&&!this.path.some(RL));this.animationProgress=0;let F;this.mixTargetDelta=O=>{const A=O/1e3;_v(w.x,d.x,A),_v(w.y,d.y,A),this.setTargetDelta(w),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Xo(C,this.layout.layoutBox,this.relativeParent.layout.layoutBox),AL(this.relativeTarget,this.relativeTargetOrigin,C,A),F&&mL(this.relativeTarget,F)&&(this.isProjectionDirty=!1),F||(F=fn()),ys(F,this.relativeTarget)),M&&(this.animationValues=g,lL(g,y,this.latestValues,A,V,I)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Gi(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Qt.update(()=>{Gc.hasAnimatedSinceResize=!0,this.currentAnimation=nL(0,bv,{...d,onUpdate:h=>{this.mixTargetDelta(h),d.onUpdate&&d.onUpdate(h)},onStop:()=>{},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(bv),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:h,target:p,layout:y,latestValues:g}=d;if(!(!h||!p||!y)){if(this!==d&&this.layout&&y&&b4(this.options.animationType,this.layout.layoutBox,y.layoutBox)){p=this.target||fn();const w=Hn(this.layout.layoutBox.x);p.x.min=d.target.x.min,p.x.max=p.x.min+w;const C=Hn(this.layout.layoutBox.y);p.y.min=d.target.y.min,p.y.max=p.y.min+C}ys(h,p),yr(h,g),Yo(this.projectionDeltaWithTransform,this.layoutCorrected,h,g)}}registerSharedNode(d,h){this.sharedNodes.has(d)||this.sharedNodes.set(d,new gL),this.sharedNodes.get(d).add(h);const y=h.options.initialPromotionConfig;h.promote({transition:y?y.transition:void 0,preserveFollowOpacity:y&&y.shouldPreserveFollowOpacity?y.shouldPreserveFollowOpacity(h):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var h;const{layoutId:d}=this.options;return d?((h=this.getStack())==null?void 0:h.lead)||this:this}getPrevLead(){var h;const{layoutId:d}=this.options;return d?(h=this.getStack())==null?void 0:h.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:h,preserveFollowOpacity:p}={}){const y=this.getStack();y&&y.promote(this,p),d&&(this.projectionDelta=void 0,this.needsReset=!0),h&&this.setOptions({transition:h})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetSkewAndRotation(){const{visualElement:d}=this.options;if(!d)return;let h=!1;const{latestValues:p}=d;if((p.z||p.rotate||p.rotateX||p.rotateY||p.rotateZ||p.skewX||p.skewY)&&(h=!0),!h)return;const y={};p.z&&th("z",d,y,this.animationValues);for(let g=0;g<eh.length;g++)th(`rotate${eh[g]}`,d,y,this.animationValues),th(`skew${eh[g]}`,d,y,this.animationValues);d.render();for(const g in y)d.setStaticValue(g,y[g]),this.animationValues&&(this.animationValues[g]=y[g]);d.scheduleRender()}getProjectionStyles(d){if(!this.instance||this.isSVG)return;if(!this.isVisible)return yL;const h={visibility:""},p=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,h.opacity="",h.pointerEvents=Hc(d==null?void 0:d.pointerEvents)||"",h.transform=p?p(this.latestValues,""):"none",h;const y=this.getLead();if(!this.projectionDelta||!this.layout||!y.target){const j={};return this.options.layoutId&&(j.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,j.pointerEvents=Hc(d==null?void 0:d.pointerEvents)||""),this.hasProjected&&!va(this.latestValues)&&(j.transform=p?p({},""):"none",this.hasProjected=!1),j}const g=y.animationValues||y.latestValues;this.applyTransformsToTarget(),h.transform=pL(this.projectionDeltaWithTransform,this.treeScale,g),p&&(h.transform=p(g,h.transform));const{x:w,y:C}=this.projectionDelta;h.transformOrigin=`${w.origin*100}% ${C.origin*100}% 0`,y.animationValues?h.opacity=y===this?g.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:g.opacityExit:h.opacity=y===this?g.opacity!==void 0?g.opacity:"":g.opacityExit!==void 0?g.opacityExit:0;for(const j in sl){if(g[j]===void 0)continue;const{correct:N,applyTo:M,isCSSVariable:D}=sl[j],I=h.transform==="none"?g[j]:N(g[j],y);if(M){const V=M.length;for(let F=0;F<V;F++)h[M[F]]=I}else D?this.options.visualElement.renderState.vars[j]=I:h[j]=I}return this.options.layoutId&&(h.pointerEvents=y===this?Hc(d==null?void 0:d.pointerEvents)||"":"none"),h}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var h;return(h=d.currentAnimation)==null?void 0:h.stop()}),this.root.nodes.forEach(xv),this.root.sharedNodes.clear()}}}function bL(t){t.updateLayout()}function xL(t){var i;const e=((i=t.resumeFrom)==null?void 0:i.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:c}=t.layout,{animationType:u}=t.options,d=e.source!==t.layout.source;u==="size"?vs(w=>{const C=d?e.measuredBox[w]:e.layoutBox[w],j=Hn(C);C.min=a[w].min,C.max=C.min+j}):b4(u,e.layoutBox,a)&&vs(w=>{const C=d?e.measuredBox[w]:e.layoutBox[w],j=Hn(a[w]);C.max=C.min+j,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[w].max=t.relativeTarget[w].min+j)});const h=gr();Yo(h,a,e.layoutBox);const p=gr();d?Yo(p,t.applyTransform(c,!0),e.measuredBox):Yo(p,a,e.layoutBox);const y=!g4(h);let g=!1;if(!t.resumeFrom){const w=t.getClosestProjectingParent();if(w&&!w.resumeFrom){const{snapshot:C,layout:j}=w;if(C&&j){const N=fn();Xo(N,e.layoutBox,C.layoutBox);const M=fn();Xo(M,a,j.layoutBox),p4(N,M)||(g=!0),w.options.layoutRoot&&(t.relativeTarget=M,t.relativeTargetOrigin=N,t.relativeParent=w)}}}t.notifyListeners("didUpdate",{layout:a,snapshot:e,delta:p,layoutDelta:h,hasLayoutChanged:y,hasRelativeLayoutChanged:g})}else if(t.isLead()){const{onExitComplete:a}=t.options;a&&a()}t.options.transition=void 0}function wL(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function _L(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function SL(t){t.clearSnapshot()}function xv(t){t.clearMeasurements()}function jL(t){t.isLayoutDirty=!1}function CL(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function wv(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function NL(t){t.resolveTargetDelta()}function TL(t){t.calcProjection()}function kL(t){t.resetSkewAndRotation()}function EL(t){t.removeLeadSnapshot()}function _v(t,e,i){t.translate=nn(e.translate,0,i),t.scale=nn(e.scale,1,i),t.origin=e.origin,t.originPoint=e.originPoint}function Sv(t,e,i,a){t.min=nn(e.min,i.min,a),t.max=nn(e.max,i.max,a)}function AL(t,e,i,a){Sv(t.x,e.x,i.x,a),Sv(t.y,e.y,i.y,a)}function RL(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const ML={duration:.45,ease:[.4,0,.1,1]},jv=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Cv=jv("applewebkit/")&&!jv("chrome/")?Math.round:_s;function Nv(t){t.min=Cv(t.min),t.max=Cv(t.max)}function LL(t){Nv(t.x),Nv(t.y)}function b4(t,e,i){return t==="position"||t==="preserve-aspect"&&!DM(yv(e),yv(i),.2)}function OL(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const DL=v4({attachResizeListener:(t,e)=>ol(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),nh={current:void 0},x4=v4({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!nh.current){const t=new DL({});t.mount(window),t.setOptions({layoutScroll:!0}),nh.current=t}return nh.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),BL={pan:{Feature:ZM},drag:{Feature:WM,ProjectionNode:x4,MeasureLayout:f4}};function Tv(t,e,i){const{props:a}=t;t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",i==="Start");const c="onHover"+i,u=a[c];u&&Qt.postRender(()=>u(e,ml(e)))}class zL extends Xi{mount(){const{current:e}=this.node;e&&(this.unmount=G9(e,(i,a)=>(Tv(this.node,a,"Start"),c=>Tv(this.node,c,"End"))))}unmount(){}}class PL extends Xi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=hl(ol(this.node.current,"focus",()=>this.onFocus()),ol(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function kv(t,e,i){const{props:a}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&a.whileTap&&t.animationState.setActive("whileTap",i==="Start");const c="onTap"+(i==="End"?"":i),u=a[c];u&&Qt.postRender(()=>u(e,ml(e)))}class $L extends Xi{mount(){const{current:e}=this.node;e&&(this.unmount=Q9(e,(i,a)=>(kv(this.node,a,"Start"),(c,{success:u})=>kv(this.node,c,u?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const zh=new WeakMap,sh=new WeakMap,UL=t=>{const e=zh.get(t.target);e&&e(t)},IL=t=>{t.forEach(UL)};function FL({root:t,...e}){const i=t||document;sh.has(i)||sh.set(i,{});const a=sh.get(i),c=JSON.stringify(e);return a[c]||(a[c]=new IntersectionObserver(IL,{root:t,...e})),a[c]}function qL(t,e,i){const a=FL(e);return zh.set(t,i),a.observe(t),()=>{zh.delete(t),a.unobserve(t)}}const VL={some:0,all:1};class HL extends Xi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:i,margin:a,amount:c="some",once:u}=e,d={root:i?i.current:void 0,rootMargin:a,threshold:typeof c=="number"?c:VL[c]},h=p=>{const{isIntersecting:y}=p;if(this.isInView===y||(this.isInView=y,u&&!y&&this.hasEnteredView))return;y&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",y);const{onViewportEnter:g,onViewportLeave:w}=this.node.getProps(),C=y?g:w;C&&C(p)};return qL(this.node.current,d,h)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:i}=this.node;["amount","margin","root"].some(GL(e,i))&&this.startObserver()}unmount(){}}function GL({viewport:t={}},{viewport:e={}}={}){return i=>t[i]!==e[i]}const YL={inView:{Feature:HL},tap:{Feature:$L},focus:{Feature:PL},hover:{Feature:zL}},XL={layout:{ProjectionNode:x4,MeasureLayout:f4}},Ph={current:null},w4={current:!1};function KL(){if(w4.current=!0,!!om)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ph.current=t.matches;t.addListener(e),e()}else Ph.current=!1}const QL=[...G2,zn,Yi],WL=t=>QL.find(H2(t)),ZL=new WeakMap;function JL(t,e,i){for(const a in e){const c=e[a],u=i[a];if(Un(c))t.addValue(a,c);else if(Un(u))t.addValue(a,tl(c,{owner:t}));else if(u!==c)if(t.hasValue(a)){const d=t.getValue(a);d.liveStyle===!0?d.jump(c):d.hasAnimated||d.set(c)}else{const d=t.getStaticValue(a);t.addValue(a,tl(d!==void 0?d:c,{owner:t}))}}for(const a in i)e[a]===void 0&&t.removeValue(a);return e}const Ev=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eO{scrapeMotionValuesFromProps(e,i,a){return{}}constructor({parent:e,props:i,presenceContext:a,reducedMotionConfig:c,blockInitialAnimation:u,visualState:d},h={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Bm,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const j=Xs.now();this.renderScheduledAt<j&&(this.renderScheduledAt=j,Qt.render(this.render,!1,!0))};const{latestValues:p,renderState:y,onUpdate:g}=d;this.onUpdate=g,this.latestValues=p,this.baseTarget={...p},this.initialValues=i.initial?{...p}:{},this.renderState=y,this.parent=e,this.props=i,this.presenceContext=a,this.depth=e?e.depth+1:0,this.reducedMotionConfig=c,this.options=h,this.blockInitialAnimation=!!u,this.isControllingVariants=bu(i),this.isVariantNode=l2(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:w,...C}=this.scrapeMotionValuesFromProps(i,{},this);for(const j in C){const N=C[j];p[j]!==void 0&&Un(N)&&N.set(p[j],!1)}}mount(e){this.current=e,ZL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,a)=>this.bindToMotionValue(a,i)),w4.current||KL(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ph.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Gi(this.notifyUpdate),Gi(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const i=this.features[e];i&&(i.unmount(),i.isMounted=!1)}this.current=null}bindToMotionValue(e,i){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const a=Ea.has(e);a&&this.onBindTransform&&this.onBindTransform();const c=i.on("change",h=>{this.latestValues[e]=h,this.props.onUpdate&&Qt.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0)}),u=i.on("renderRequest",this.scheduleRender);let d;window.MotionCheckAppearSync&&(d=window.MotionCheckAppearSync(this,e,i)),this.valueSubscriptions.set(e,()=>{c(),u(),d&&d(),i.owner&&i.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Er){const i=Er[e];if(!i)continue;const{isEnabled:a,Feature:c}=i;if(!this.features[e]&&c&&a(this.props)&&(this.features[e]=new c(this)),this.features[e]){const u=this.features[e];u.isMounted?u.update():(u.mount(),u.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):fn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,i){this.latestValues[e]=i}update(e,i){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let a=0;a<Ev.length;a++){const c=Ev[a];this.propEventSubscriptions[c]&&(this.propEventSubscriptions[c](),delete this.propEventSubscriptions[c]);const u="on"+c,d=e[u];d&&(this.propEventSubscriptions[c]=this.on(c,d))}this.prevMotionValues=JL(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(e),()=>i.variantChildren.delete(e)}addValue(e,i){const a=this.values.get(e);i!==a&&(a&&this.removeValue(e),this.bindToMotionValue(e,i),this.values.set(e,i),this.latestValues[e]=i.get())}removeValue(e){this.values.delete(e);const i=this.valueSubscriptions.get(e);i&&(i(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,i){if(this.props.values&&this.props.values[e])return this.props.values[e];let a=this.values.get(e);return a===void 0&&i!==void 0&&(a=tl(i===null?void 0:i,{owner:this}),this.addValue(e,a)),a}readValue(e,i){let a=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return a!=null&&(typeof a=="string"&&(q2(a)||L2(a))?a=parseFloat(a):!WL(a)&&Yi.test(i)&&(a=U2(e,i)),this.setBaseTarget(e,Un(a)?a.get():a)),Un(a)?a.get():a}setBaseTarget(e,i){this.baseTarget[e]=i}getBaseTarget(e){var u;const{initial:i}=this.props;let a;if(typeof i=="string"||typeof i=="object"){const d=Am(this.props,i,(u=this.presenceContext)==null?void 0:u.custom);d&&(a=d[e])}if(i&&a!==void 0)return a;const c=this.getBaseTargetFromProps(this.props,e);return c!==void 0&&!Un(c)?c:this.initialValues[e]!==void 0&&a===void 0?void 0:this.baseTarget[e]}on(e,i){return this.events[e]||(this.events[e]=new fm),this.events[e].add(i)}notify(e,...i){this.events[e]&&this.events[e].notify(...i)}}class _4 extends eO{constructor(){super(...arguments),this.KeyframeResolver=Y2}sortInstanceNodePosition(e,i){return e.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(e,i){return e.style?e.style[i]:void 0}removeValueFromRenderState(e,{vars:i,style:a}){delete i[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Un(e)&&(this.childSubscription=e.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}}function tO(t){return window.getComputedStyle(t)}class nO extends _4{constructor(){super(...arguments),this.type="html",this.renderInstance=b2}readValueFromInstance(e,i){if(Ea.has(i))return mR(e,i);{const a=tO(e),c=(_m(i)?a.getPropertyValue(i):a[i])||0;return typeof c=="string"?c.trim():c}}measureInstanceViewportBox(e,{transformPagePoint:i}){return l4(e,i)}build(e,i,a){Cm(e,i,a.transformTemplate)}scrapeMotionValuesFromProps(e,i,a){return Rm(e,i,a)}}class sO extends _4{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=fn,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&v2(this.current,this.renderState)}}getBaseTargetFromProps(e,i){return e[i]}readValueFromInstance(e,i){if(Ea.has(i)){const a=$2(i);return a&&a.default||0}return i=x2.has(i)?i:wm(i),e.getAttribute(i)}scrapeMotionValuesFromProps(e,i,a){return _2(e,i,a)}onBindTransform(){this.current&&!this.renderState.dimensions&&Qt.postRender(this.updateDimensions)}build(e,i,a){km(e,i,this.isSVGTag,a.transformTemplate)}renderInstance(e,i,a,c){w2(e,i,a,c)}mount(e){this.isSVGTag=Em(e.tagName),super.mount(e)}}const iO=(t,e)=>Tm(t)?new sO(e):new nO(e,{allowProjection:t!==b.Fragment}),aO=IA({...TM,...YL,...BL,...XL},iO),S4=sA(aO),rO=b.lazy(()=>Pn(()=>Promise.resolve().then(()=>Yj),void 0)),It=An.create("Messages"),oO=({searchQuery:t,onFindUsers:e,onCreateMock:i})=>o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center p-5 text-opacity-70 h-100 text-center",children:[o.jsx(f5,{size:48,className:"text-opacity-30 mb-3"}),o.jsx("p",{className:"mb-4",children:t?"No conversations match your search":"No conversations yet"}),!t&&o.jsxs("div",{className:"d-flex flex-column gap-2",children:[o.jsxs("button",{className:"btn btn-primary btn-sm d-flex align-items-center gap-2 rounded-pill shadow-sm hover-scale transition-all px-4 py-2",onClick:e,children:[o.jsx(xb,{size:12})," ",o.jsx("span",{children:"Start a Conversation"})]}),!1]})]}),lO=({isConnected:t})=>o.jsxs("div",{className:`connection-status ${t?"connected":"disconnected"} px-2 py-1 rounded-pill d-flex align-items-center gap-1`,children:[o.jsx(r5,{size:8}),o.jsx("span",{className:"text-xs",children:t?"Connected":"Offline"})]}),cO=({onToggleFilter:t,isFilterOpen:e})=>o.jsxs("button",{className:`filter-button d-flex align-items-center gap-1 text-xs bg-transparent border-0 ${e?"text-primary":"text-muted"}`,onClick:t,children:[o.jsx(Xh,{size:12}),o.jsx("span",{children:"Filter"})]}),uO=({onClose:t,onFilterChange:e,filters:i})=>o.jsxs(S4.div,{className:"filter-panel p-3 border-bottom",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:[o.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[o.jsx("h6",{className:"m-0 font-weight-bold text-sm",children:"Filter Conversations"}),o.jsx("button",{onClick:t,className:"bg-transparent border-0 text-muted",children:o.jsx(Vn,{size:14})})]}),o.jsxs("div",{className:"filter-options d-flex flex-wrap gap-2 mt-2",children:[o.jsx("button",{className:`filter-chip px-2 py-1 rounded-pill text-xs ${i.unread?"bg-primary-50 text-primary":"bg-light-subtle text-muted"}`,onClick:()=>e("unread",!i.unread),children:"Unread"}),o.jsx("button",{className:`filter-chip px-2 py-1 rounded-pill text-xs ${i.online?"bg-primary-50 text-primary":"bg-light-subtle text-muted"}`,onClick:()=>e("online",!i.online),children:"Online"})]})]}),dO=({conversation:t,isSelected:e,onSelect:i,onToggleMenu:a,menuOpen:c,onDelete:u,onToggleMute:d,formatTimestamp:h,formatPreview:p,getMessageTypeIcon:y})=>{var j,N;const g=t==null?void 0:t.user;if(!(t!=null&&t._id)||!(g!=null&&g._id))return null;const w=g._id,C=t.muted||!1;return o.jsxs("div",{className:B6("conversation-item d-flex p-3 rounded-lg mb-1 cursor-pointer transition-all hover-bg-light-subtle",e?"bg-primary-50":"",t.unreadCount>0?"font-weight-medium":""),onClick:()=>i(g),role:"button",tabIndex:0,"aria-selected":e,children:[o.jsxs("div",{className:"position-relative mr-3 flex-shrink-0",children:[((j=g==null?void 0:g.photos)==null?void 0:j.length)>0?o.jsx("img",{src:rb(g.photos[0].url)||"/placeholder.svg?height=50&width=50",alt:g.nickname||`User ${w}`,className:"w-50px h-50px rounded-circle object-cover shadow-sm",onError:M=>{M.target.onerror=null,M.target.src="/placeholder.svg?height=50&width=50"}}):o.jsx(Zo,{className:"w-50px h-50px text-opacity-60"}),(g==null?void 0:g.isOnline)&&o.jsx("span",{className:"position-absolute bottom-0 right-0 w-12px h-12px bg-success rounded-circle border-2 border-white"})]}),o.jsxs("div",{className:"flex-grow-1 overflow-hidden d-flex flex-column justify-content-center min-width-0",children:[o.jsxs("div",{className:"d-flex justify-content-between align-items-baseline mb-1",children:[o.jsx("h3",{className:"font-weight-medium font-size-sm text-truncate m-0",children:g.nickname||"User"}),o.jsx("span",{className:"text-xs text-opacity-60 ml-2 flex-shrink-0",children:h((N=t.lastMessage)==null?void 0:N.createdAt)})]}),o.jsxs("div",{className:"d-flex align-items-center gap-1 min-width-0",children:[y(t.lastMessage),o.jsx("p",{className:"text-sm text-opacity-70 text-truncate m-0 flex-grow-1",children:p(t.lastMessage)}),t.unreadCount>0&&o.jsx("span",{className:"flex-shrink-0 bg-primary text-white text-xs font-weight-bold px-2 py-1 rounded-pill ml-2",children:t.unreadCount>9?"9+":t.unreadCount})]})]}),o.jsxs("div",{className:"position-relative ml-2",children:[o.jsx("button",{className:"bg-transparent border-0 text-opacity-60 cursor-pointer p-1 rounded-circle hover-bg-light-subtle transition-all d-flex align-items-center justify-content-center w-30px h-30px",onClick:M=>{M.stopPropagation(),a(w)},"aria-label":"Conversation options",children:o.jsx(l5,{})}),c===w&&o.jsxs("div",{className:"conversation-menu position-absolute right-0 top-35px bg-white rounded-lg shadow-md z-10 overflow-hidden min-w-120px border",onClick:M=>M.stopPropagation(),children:[o.jsxs("button",{className:"d-flex align-items-center gap-2 w-100 py-2 px-3 text-left bg-transparent border-0 cursor-pointer text-sm text-opacity-70 hover-bg-light-subtle transition-all",onClick:M=>{M.stopPropagation(),d(t._id,C)},children:[C?o.jsx(Nr,{className:"text-primary"}):o.jsx(i5,{className:"text-primary"})," ",C?"Unmute":"Mute"]}),o.jsxs("button",{className:"d-flex align-items-center gap-2 w-100 py-2 px-3 text-left bg-transparent border-0 cursor-pointer text-sm text-danger hover-bg-danger-50 transition-all",onClick:M=>{M.stopPropagation(),u(w)},children:[o.jsx(B5,{})," Delete"]})]})]})]})},fO=({conversations:t,selectedRecipientId:e,onSelectConversation:i,conversationMenuOpen:a,toggleConversationMenu:c,handleDeleteConversation:u,handleToggleMute:d,formatTimestamp:h,formatPreview:p,getMessageTypeIcon:y})=>o.jsx("div",{className:"conversation-list h-100 overflow-auto",children:t.map(g=>{var w;return o.jsx(dO,{conversation:g,isSelected:e===((w=g.user)==null?void 0:w._id),onSelect:i,onToggleMenu:c,menuOpen:a,onDelete:u,onToggleMute:d,formatTimestamp:h,formatPreview:p,getMessageTypeIcon:y},g._id)})}),hO=({error:t,onRetry:e,onReset:i,onCreateMock:a})=>o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center p-5 text-danger h-100 text-center",children:[o.jsx(Kt,{className:"text-danger text-3xl mb-4"}),o.jsx("p",{className:"mb-4 max-w-80 font-weight-medium",children:t||"Failed to load conversations"}),o.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-center",children:[o.jsxs("button",{onClick:e,className:"btn btn-primary btn-sm d-flex align-items-center gap-2 rounded-pill shadow-sm hover-scale transition-all",children:[o.jsx(wb,{})," ",o.jsx("span",{children:"Retry"})]}),o.jsx("button",{onClick:i,className:"btn btn-danger btn-sm d-flex align-items-center gap-2 rounded-pill shadow-sm hover-scale transition-all",children:o.jsx("span",{children:"Reset Session"})}),!1]})]}),mO=({retryCount:t,onRetry:e,onReset:i,onCreateMock:a})=>o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center p-5 text-opacity-70 h-100 text-center",children:[o.jsx(ws,{className:"fa-spin text-primary text-xl mb-4"}),o.jsx("p",{className:"mb-2",children:"Loading conversations..."}),t>0&&o.jsxs("p",{className:"text-xs text-opacity-60 mt-2",children:["Attempt ",t," - Please wait..."]}),t>2&&o.jsxs("div",{className:"mt-5 p-4 bg-light rounded-lg shadow-sm w-90 max-w-md",children:[o.jsx("p",{className:"mb-3 font-weight-medium",children:"This is taking longer than expected."}),o.jsxs("div",{className:"d-flex gap-2 flex-wrap justify-content-center",children:[o.jsxs("button",{onClick:e,className:"btn btn-primary btn-sm d-flex align-items-center gap-2 rounded-pill shadow-sm",children:[o.jsx(wb,{})," ",o.jsx("span",{children:"Retry"})]}),o.jsx("button",{onClick:i,className:"btn btn-danger btn-sm d-flex align-items-center gap-2 rounded-pill shadow-sm",children:o.jsx("span",{children:"Reset Session"})}),!1]})]})]}),gO=()=>o.jsxs("div",{className:"d-flex flex-column align-items-center justify-content-center h-100 text-center text-opacity-70 p-5 bg-white",children:[o.jsx(Gh,{className:"text-3xl text-opacity-40 mb-4 animate-pulse"}),o.jsx("h3",{className:"font-weight-medium mb-2 text-lg",children:"Select a conversation"}),o.jsx("p",{className:"text-sm max-w-xs",children:"Choose someone from the list to start chatting."})]}),pO=({show:t,onClick:e})=>o.jsx(S4.button,{className:"scroll-top-btn position-absolute bottom-20px right-20px bg-primary text-white rounded-circle shadow-md border-0 d-flex align-items-center justify-content-center z-10 w-40px h-40px",onClick:e,initial:{opacity:0,scale:.8},animate:{opacity:t?1:0,scale:t?1:.8},exit:{opacity:0,scale:.8},whileHover:{scale:1.1},whileTap:{scale:.9},transition:{duration:.2},"aria-label":"Scroll to top",children:o.jsx(s5,{})}),Av=()=>{const{user:t,authChecked:e,isAuthenticated:i,token:a}=Sn(),c=tm(),u=In(),{userId:d}=Mv(),[h,p]=b.useState([]),[y,g]=b.useState(!0),[w,C]=b.useState(null),[j,N]=b.useState(null),[M,D]=b.useState(""),[I,V]=b.useState([]),[F,O]=b.useState(null),[A,H]=b.useState(!1),[E,L]=b.useState(null),[P,G]=b.useState(0),[Q,z]=b.useState(!1),[ae,Pe]=b.useState(!1),[Ee,K]=b.useState({unread:!1,online:!1}),[q,J]=b.useState(!1),[re,Ne]=b.useState(!1),Se=b.useRef(null),Ve=b.useRef(null),ge=b.useRef(null),ee=b.useRef(!1),Re=b.useRef(!1);b.useEffect(()=>{if(i&&(t!=null&&t._id)){It.info(`Initializing chat service for user ${t._id}`),tn.initialize(t).then(()=>{It.info("Chat service initialized successfully"),Ne(!0),J(tn.isConnected())}).catch(R=>{It.error("Failed to initialize chat service:",R),Ne(!1)});const B=tn.on("connectionChanged",({connected:R})=>{It.debug(`Connection status changed: ${R}`),J(R),R&&Re.current&&(It.info("Connection restored, refreshing conversations"),he(!0))});return()=>{typeof B=="function"&&B()}}},[i,t]);const he=b.useCallback(async(B=!1)=>{if(!i||!(t!=null&&t._id))return It.debug("Not authenticated or missing user ID, skipping conversation fetch"),g(!1),[];if(y&&!B)return It.debug("Already loading conversations, skipping duplicate fetch"),[];const R=setTimeout(()=>{It.warn("Conversation loading timeout reached, resetting loading state"),g(!1),C("Loading conversations timed out. Please try again."),ee.current=!1},15e3);g(!0),C(null);try{It.info(`Fetching conversations using ChatService for user ${t._id}`);const Y=await tn.getConversations();clearTimeout(R);const _=Array.isArray(Y)?Y:[];return It.info(`Loaded ${_.length} conversations`),p(_),Xe(_,M,Ee),g(!1),G(0),Re.current=!0,ge.current&&(clearTimeout(ge.current),ge.current=null),_}catch(Y){It.error("Error fetching conversations:",Y),clearTimeout(R);try{It.info("Falling back to direct API call for conversations");const _=await c.get("/messages/conversations");if(_&&_.success){const v=Array.isArray(_.data)?_.data:[];return It.info(`API fallback loaded ${v.length} conversations`),p(v),Xe(v,M,Ee),g(!1),G(0),Re.current=!0,v}else throw new Error((_==null?void 0:_.error)||"Failed to load conversations")}catch(_){It.error("API fallback also failed:",_),C(Y.message||_.message||"Failed to load conversations"),g(!1);const v=P+1;if(G(v),v<=3){const x=Math.min(3e3*Math.pow(1.5,v-1),1e4);It.debug(`Will retry in ${x/1e3} seconds (attempt ${v})`),ge.current=setTimeout(()=>{It.debug(`Auto-retrying conversation fetch (attempt ${v})...`),he(!0)},x)}else It.warn("Maximum retry attempts reached"),ee.current=!1}return[]}},[i,t,c,y,P,M,Ee]);b.useEffect(()=>{let B=!0;(async()=>{e&&(i&&(t!=null&&t._id)?!ee.current&&B&&(It.info(`Initial conversations load for user ${t._id}`),ee.current=!0,await new Promise(_=>setTimeout(_,500)),B&&he()):B&&g(!1))})();const Y=setTimeout(()=>{B&&y&&(It.warn("Safety timeout triggered - forcing loading state reset"),g(!1))},2e4);return()=>{B=!1,ge.current&&clearTimeout(ge.current),clearTimeout(Y)}},[e,i,t,he,y]),b.useEffect(()=>{const B=Ve.current;if(!B)return;const R=()=>{B.scrollTop>300?z(!0):z(!1)};return B.addEventListener("scroll",R),()=>{B.removeEventListener("scroll",R)}},[]);const Ue=b.useCallback(async B=>{if(!(!B||!(t!=null&&t._id)))try{await tn.markConversationRead(B),p(R=>R.map(Y=>{var v;return((v=Y.user)==null?void 0:v._id)===B?{...Y,unreadCount:0}:Y})),V(R=>R.map(Y=>{var v;return((v=Y.user)==null?void 0:v._id)===B?{...Y,unreadCount:0}:Y}))}catch(R){It.error("Error marking conversation as read:",R);try{await c.put(`/messages/conversation/${B}/read`),p(Y=>Y.map(_=>{var x;return((x=_.user)==null?void 0:x._id)===B?{..._,unreadCount:0}:_})),V(Y=>Y.map(_=>{var x;return((x=_.user)==null?void 0:x._id)===B?{..._,unreadCount:0}:_}))}catch(Y){It.error("API fallback also failed:",Y)}}},[t,c]),ze=b.useCallback(async B=>{if(B)try{const R=await c.delete(`/messages/conversation/${B}`);if(R&&R.success)return p(Y=>Y.filter(_=>_._id!==B)),V(Y=>Y.filter(_=>_._id!==B)),!0;throw new Error((R==null?void 0:R.error)||"Failed to delete conversation")}catch(R){throw It.error("Error deleting conversation:",R),ne.error("Failed to delete conversation"),R}},[c]),Xe=b.useCallback((B,R,Y)=>{if(!Array.isArray(B)){V([]);return}let _=[...B];const v=R.toLowerCase().trim();v&&(_=_.filter(x=>{var U,X,le;const T=x==null?void 0:x.user;return((U=T==null?void 0:T.nickname)==null?void 0:U.toLowerCase().includes(v))||((le=(X=x==null?void 0:x.lastMessage)==null?void 0:X.content)==null?void 0:le.toLowerCase().includes(v))})),Y.unread&&(_=_.filter(x=>x.unreadCount>0)),Y.online&&(_=_.filter(x=>{var T;return(T=x.user)==null?void 0:T.isOnline})),V(_)},[]);b.useEffect(()=>{Xe(h,M,Ee)},[M,h,Ee,Xe]),b.useEffect(()=>{if(!(!Array.isArray(h)||h.length===0))if(d){const B=h.find(R=>{var Y;return((Y=R.user)==null?void 0:Y._id)===d});if(B){const R=B.user;R&&R._id?(N(R),L(R._id),B.unreadCount>0&&Ue(R._id),H(!0)):(It.warn("Found conversation but recipient data is invalid:",B),N(null),L(null),u("/messages",{replace:!0}))}else N(null),L(null),location.pathname!=="/messages"&&u("/messages",{replace:!0})}else if(E){const B=h.find(Y=>{var _;return((_=Y.user)==null?void 0:_._id)===E}),R=B==null?void 0:B.user;R!=null&&R._id?(N(R),H(!0)):(N(null),L(null))}else N(null)},[d,h,u,Ue,E]);const Qe=b.useCallback(B=>{if(!B||!B._id){It.warn("Attempted to select conversation with invalid recipient:",B);return}N(B),L(B._id),u(`/messages/${B._id}`,{replace:!0});const R=h.find(Y=>{var _;return((_=Y.user)==null?void 0:_._id)===B._id});(R==null?void 0:R.unreadCount)>0&&Ue(B._id),H(!0),O(null)},[h,u,Ue]),Ge=B=>{D(B.target.value)},at=()=>{var B;D(""),(B=Se.current)==null||B.focus()},yt=b.useCallback(B=>{O(R=>R===B?null:B)},[]),mt=b.useCallback(async B=>{if(!B)return;const R=h.find(_=>{var v;return((v=_.user)==null?void 0:v._id)===B}),Y=R==null?void 0:R._id;if(!Y){It.error("Conversation ID not found for recipient:",B),ne.error("Could not find conversation to delete");return}if(window.confirm("Are you sure you want to delete this conversation?"))try{await ze(Y),O(null),It.info("Conversation deleted successfully"),V(_=>_.filter(v=>v._id!==Y)),(j==null?void 0:j._id)===B&&(N(null),L(null),u("/messages",{replace:!0}))}catch(_){It.error("Delete conversation error:",_),ne.error("Failed to delete conversation")}},[h,ze,u,j]),Ie=b.useCallback(async(B,R)=>{try{It.debug(`Toggling mute for ${B}. Current: ${R}`),ne.info("Mute functionality not yet implemented."),O(null)}catch(Y){It.error("Failed to update mute status:",Y),ne.error("Failed to update mute status")}},[]),qe=b.useCallback(B=>{var R;if((B==null?void 0:B.type)==="file"&&((R=B.metadata)!=null&&R.mimeType)){const Y={...B,metadata:{...B.metadata,fileType:B.metadata.mimeType}};return L0(Y,t==null?void 0:t._id)}return L0(B,t==null?void 0:t._id)},[t]),jt=b.useCallback(B=>{if(!B)return"";try{return k9(new Date(B),{addSuffix:!0})}catch(R){return It.warn("Error formatting timestamp:",B,R),""}},[]),Ct=b.useCallback(()=>{H(!1),window.innerWidth<=768&&u("/messages",{replace:!0}),L(null),N(null)},[u]),Rt=b.useCallback(B=>{var Y,_;return!B||B.sender===(t==null?void 0:t._id)?null:{wink:o.jsx("span",{className:"message-type-icon wink",title:"Wink",children:"😉"}),file:(_=(Y=B.metadata)==null?void 0:Y.mimeType)!=null&&_.startsWith("image/")?o.jsx("span",{className:"message-type-icon image",title:"Image",children:"🖼️"}):o.jsx("span",{className:"message-type-icon file",title:"File",children:"📎"}),video:o.jsx("span",{className:"message-type-icon video",title:"Video",children:"📹"})}[B.type]||null},[t]),pe=b.useCallback(()=>{he(!0)},[he]),je=b.useCallback((B,R)=>{K(Y=>({...Y,[B]:R}))},[]),Je=b.useCallback(()=>{Pe(B=>!B)},[]),_t=b.useCallback(()=>{Ve.current&&Ve.current.scrollTo({top:0,behavior:"smooth"})},[]),ke=b.useCallback(()=>{window.confirm("This will log you out. You'll need to sign in again. Continue?")&&(localStorage.clear(),sessionStorage.clear(),window.location.href="/login")},[]),Ke=b.useCallback(()=>{u("/dashboard")},[u]),ht=b.useCallback(()=>{const B=[{_id:"mock1",user:{_id:"user1",nickname:"John Doe",isOnline:!0,photos:[]},lastMessage:{content:"Hey, how are you?",createdAt:new Date(Date.now()-3e5),sender:"user1"},unreadCount:2},{_id:"mock2",user:{_id:"user2",nickname:"Jane Smith",isOnline:!1,photos:[]},lastMessage:{content:"Let's meet tomorrow",createdAt:new Date(Date.now()-72e5),sender:t==null?void 0:t._id},unreadCount:0},{_id:"mock3",user:{_id:"user3",nickname:"Test Bot",isOnline:!0,photos:[]},lastMessage:{content:"This is a test message. Click to see the full conversation.",createdAt:new Date,sender:"user3"},unreadCount:1}];p(B),V(B),g(!1),C(null),ne.info("Loaded mock conversations for testing"),Re.current=!0},[t]);return b.useEffect(()=>{},[h.length,y,w,ht]),o.jsxs("div",{className:"messages-page d-flex flex-column vh-100 overflow-hidden",children:[o.jsx(kr,{}),o.jsxs("div",{className:"messages-main-content d-flex flex-grow-1 overflow-hidden bg-light-subtle",children:[o.jsxs("div",{className:"conversations-panel flex-shrink-0 d-flex flex-column border-right bg-white",style:{transform:A&&window.innerWidth<768?"translateX(-100%)":"none",transition:"transform 0.3s ease",pointerEvents:A&&window.innerWidth<768?"none":"auto"},children:[o.jsxs("div",{className:"conversations-header p-4 border-bottom flex-shrink-0",children:[o.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[o.jsx("h2",{className:"font-weight-bold font-size-lg m-0",children:"Messages"}),o.jsx(lO,{isConnected:q})]}),o.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[o.jsxs("div",{className:"search-container position-relative flex-grow-1",children:[o.jsx(Kh,{className:"search-icon position-absolute left-3 top-50 transform-translateY--50 text-opacity-60"}),o.jsx("input",{type:"text",placeholder:"Search conversations...",value:M,onChange:Ge,ref:Se,className:"search-input w-100 py-2 px-4 pl-9 rounded-pill border focus-ring bg-light-subtle","aria-label":"Search conversations"}),M&&o.jsx("button",{className:"clear-search position-absolute right-3 top-50 transform-translateY--50 bg-transparent border-0 text-opacity-60 cursor-pointer text-lg",onClick:at,"aria-label":"Clear search",children:"×"})]}),o.jsx("div",{className:"ml-2",children:o.jsx(cO,{onToggleFilter:Je,isFilterOpen:ae})})]}),o.jsx(fy,{children:ae&&o.jsx(uO,{onClose:Je,onFilterChange:je,filters:Ee})})]}),o.jsx("div",{className:"conversations-list flex-grow-1 overflow-y-auto p-2 custom-scrollbar position-relative",ref:Ve,children:y?o.jsx(mO,{retryCount:P,onRetry:pe,onReset:ke,onCreateMock:ht}):w?o.jsx(hO,{error:w,onRetry:pe,onReset:ke,onCreateMock:ht}):I.length===0?o.jsx(oO,{searchQuery:M,onFindUsers:Ke,onCreateMock:ht}):o.jsxs(o.Fragment,{children:[I.length>5&&o.jsx(fy,{children:Q&&o.jsx(pO,{show:Q,onClick:_t})}),o.jsx(fO,{conversations:I,selectedRecipientId:j==null?void 0:j._id,onSelectConversation:Qe,conversationMenuOpen:F,toggleConversationMenu:yt,handleDeleteConversation:mt,handleToggleMute:Ie,formatTimestamp:jt,formatPreview:qe,getMessageTypeIcon:Rt})]})})]}),o.jsx("div",{className:"flex-grow-1",style:{position:"relative",height:"100%"},children:j?o.jsx(b.Suspense,{fallback:o.jsx(mu,{}),children:o.jsx(rO,{recipient:j,isOpen:!0,onClose:Ct,embedded:!1},j._id)}):o.jsx(gO,{})})]}),o.jsx("style",{jsx:"true",children:`
        .messages-page {
          --conversation-panel-width: 320px;
        }
        
        .conversations-panel {
          width: var(--conversation-panel-width);
          max-width: 100%;
        }
        
        .connection-status {
          font-size: 0.75rem;
        }
        
        .connection-status.connected {
          color: var(--bs-success);
        }
        
        .connection-status.disconnected {
          color: var(--bs-danger);
        }
        
        .filter-chip {
          border: 1px solid transparent;
          transition: all 0.2s ease;
        }
        
        .filter-chip:hover {
          background-color: var(--bs-primary-bg-subtle);
        }
        
        @media (max-width: 767.98px) {
          .conversations-panel, .chat-panel {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
            max-width: 100%;
          }
          
          .conversations-panel {
            left: 0;
            z-index: 10;
          }
          
          .chat-panel {
            right: 0;
          }
        }
        
        .custom-scrollbar::-webkit-scrollbar {
          width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
          background: transparent;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
          background-color: rgba(0, 0, 0, 0.1);
          border-radius: 20px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
          background-color: rgba(0, 0, 0, 0.2);
        }
        
        .conversation-item {
          transition: all 0.2s ease;
          border-radius: 8px;
        }
        
        .conversation-item:hover {
          background-color: rgba(0, 0, 0, 0.03);
        }
      `})]})},yO="_subscriptionContainer_n6ryy_1",vO="_gradientBar_n6ryy_18",bO="_pageTitle_n6ryy_25",xO="_subtitle_n6ryy_45",wO="_lead_n6ryy_57",_O="_pricingCards_n6ryy_69",SO="_pricingCard_n6ryy_69",jO="_premiumCard_n6ryy_102",CO="_popularBadge_n6ryy_106",NO="_cardHeader_n6ryy_119",TO="_planName_n6ryy_129",kO="_price_n6ryy_140",EO="_period_n6ryy_147",AO="_cardBody_n6ryy_157",RO="_featureList_n6ryy_164",MO="_featureItem_n6ryy_171",LO="_iconYes_n6ryy_183",OO="_iconNo_n6ryy_190",DO="_featureIcon_n6ryy_197",BO="_toggleContainer_n6ryy_202",zO="_toggleBtn_n6ryy_217",PO="_toggleBtnActive_n6ryy_233",$O="_saveBadge_n6ryy_240",UO="_buttonOutline_n6ryy_253",IO="_buttonPrimary_n6ryy_276",FO="_alreadyPremium_n6ryy_300",qO="_premiumTitle_n6ryy_316",VO="_premiumMessage_n6ryy_327",HO="_spinner_n6ryy_337",et={subscriptionContainer:yO,gradientBar:vO,pageTitle:bO,subtitle:xO,lead:wO,pricingCards:_O,pricingCard:SO,premiumCard:jO,popularBadge:CO,cardHeader:NO,planName:TO,price:kO,period:EO,cardBody:AO,featureList:RO,featureItem:MO,iconYes:LO,iconNo:OO,featureIcon:DO,toggleContainer:BO,toggleBtn:zO,toggleBtnActive:PO,saveBadge:$O,buttonOutline:UO,buttonPrimary:IO,alreadyPremium:FO,premiumTitle:qO,premiumMessage:VO,spinner:HO},GO=()=>{var C;const{user:t,getCurrentUser:e}=Sn(),i=In(),[a,c]=b.useState("monthly"),[u,d]=b.useState(!1),[h,p]=b.useState(null);b.useEffect(()=>{t?y():i("/login")},[t,i]);const y=async()=>{try{const j=await bh.getSubscriptionStatus();j.success&&p(j.data)}catch(j){console.error("Error fetching subscription status:",j),ne.error("Could not load subscription information")}},g=(t==null?void 0:t.isPaid)||(t==null?void 0:t.accountTier)==="PAID"||(t==null?void 0:t.accountTier)==="FEMALE"||(t==null?void 0:t.accountTier)==="COUPLE"||h&&(h.isPaid||h.accountTier==="PAID"||h.accountTier==="FEMALE"||h.accountTier==="COUPLE"),w=async j=>{d(!0);try{(await bh.upgradeSubscription(j)).success&&(await e(),ne.success(`Successfully subscribed to ${j} plan!`),i("/dashboard"))}catch(N){console.error("Subscription error:",N),ne.error(N.message||"Failed to process subscription. Please try again.")}finally{d(!1)}};return o.jsxs("div",{className:"modern-dashboard",children:[o.jsx("header",{className:"modern-header",children:o.jsxs("div",{className:"container d-flex justify-content-between align-items-center",children:[o.jsx("div",{className:"logo",style:{cursor:"pointer"},onClick:()=>i("/dashboard"),children:"Mandarin"}),o.jsxs("div",{className:"d-none d-md-flex main-tabs",children:[o.jsx("button",{className:"tab-button",onClick:()=>i("/dashboard"),children:"Dashboard"}),o.jsx("button",{className:"tab-button",onClick:()=>i("/messages"),children:"Messages"})]}),o.jsxs("div",{className:"header-actions d-flex align-items-center",children:[o.jsx(gu,{}),(C=t==null?void 0:t.photos)!=null&&C[0]?o.jsx("img",{src:t.photos[0].url||"/placeholder.svg",alt:t.nickname,className:"user-avatar",onClick:()=>i("/profile")}):o.jsx(Zo,{className:"user-avatar",style:{fontSize:"32px"},onClick:()=>i("/profile")})]})]})}),o.jsx("main",{className:"dashboard-content",children:o.jsxs("div",{className:et.subscriptionContainer,children:[o.jsx("div",{className:et.gradientBar}),o.jsxs("h1",{className:et.pageTitle,children:[o.jsx(gb,{})," Premium Membership"]}),g?o.jsxs("div",{className:et.alreadyPremium,children:[o.jsx("h3",{className:et.premiumTitle,children:"You already have premium access!"}),o.jsx("p",{className:et.premiumMessage,children:"Enjoy all the premium features of Mandarin."}),o.jsx("button",{className:et.buttonPrimary,onClick:()=>i("/dashboard"),children:"Return to Dashboard"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"text-center mb-5",children:[o.jsx("h2",{className:et.subtitle,children:"Unlock All Features"}),o.jsx("p",{className:et.lead,children:"Upgrade your experience and connect with more people"})]}),o.jsx("div",{className:"d-flex justify-content-center",children:o.jsxs("div",{className:et.toggleContainer,children:[o.jsx("button",{className:`${et.toggleBtn} ${a==="monthly"?et.toggleBtnActive:""}`,onClick:()=>c("monthly"),children:"Monthly"}),o.jsxs("button",{className:`${et.toggleBtn} ${a==="yearly"?et.toggleBtnActive:""}`,onClick:()=>c("yearly"),children:["Yearly",o.jsx("span",{className:et.saveBadge,children:"Save 20%"})]})]})}),o.jsxs("div",{className:et.pricingCards,children:[o.jsxs("div",{className:et.pricingCard,children:[o.jsxs("div",{className:et.cardHeader,children:[o.jsx("h3",{className:et.planName,children:"Free"}),o.jsx("p",{className:et.price,children:"$0"}),o.jsx("p",{className:et.period,children:"forever"})]}),o.jsxs("div",{className:et.cardBody,children:[o.jsxs("ul",{className:et.featureList,children:[o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," View profiles"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," Send winks"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," 3 likes per day"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," 1 story every 72 hours"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Vn,{className:et.iconNo})," Send messages"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Vn,{className:et.iconNo})," Unlimited likes"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Vn,{className:et.iconNo})," Unlimited stories"]})]}),o.jsx("button",{className:et.buttonOutline,disabled:!0,children:"Current Plan"})]})]}),o.jsxs("div",{className:`${et.pricingCard} ${et.premiumCard}`,children:[o.jsx("div",{className:et.popularBadge,children:"Most Popular"}),o.jsxs("div",{className:et.cardHeader,children:[o.jsx("h3",{className:et.planName,children:"Premium"}),o.jsxs("p",{className:et.price,children:["$",a==="monthly"?"14.99":"11.99"]}),o.jsxs("p",{className:et.period,children:["per ",a==="monthly"?"month":"month, billed yearly"]})]}),o.jsxs("div",{className:et.cardBody,children:[o.jsxs("ul",{className:et.featureList,children:[o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," View profiles"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," Send winks"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," ",o.jsx("strong",{children:"Unlimited likes"})," ",o.jsx(vi,{className:et.featureIcon})]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," ",o.jsx("strong",{children:"Unlimited stories"})," ",o.jsx(du,{className:et.featureIcon})]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," ",o.jsx("strong",{children:"Send messages"})," ",o.jsx(Ta,{className:et.featureIcon})]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," Video calls"]}),o.jsxs("li",{className:et.featureItem,children:[o.jsx(Lt,{className:et.iconYes})," Priority in search results"]})]}),o.jsx("button",{className:et.buttonPrimary,onClick:()=>w(a),disabled:u,children:u?o.jsxs(o.Fragment,{children:[o.jsx("span",{className:et.spinner}),o.jsx("span",{style:{marginLeft:"8px"},children:"Processing..."})]}):`Subscribe ${a==="monthly"?"$14.99/month":"$143.88/year"}`})]})]})]})]})]})})]})};function YO(){Ib();const[t,e]=b.useState(null),[i,a]=b.useState(!1);b.useEffect(()=>{const u=d=>{console.log("openChat event received in App.jsx",d.detail);const{recipient:h}=d.detail;h&&h._id&&(console.log("Setting chat recipient and opening chat in App.jsx"),e(h),a(!0),setTimeout(()=>{console.log("Forcing chat open state refresh"),a(!0)},50))};return window.addEventListener("openChat",u),()=>{window.removeEventListener("openChat",u)}},[]);const c=()=>{a(!1)};return o.jsx(Vb,{children:o.jsx(U5,{children:o.jsx(G6,{children:o.jsx($5,{children:o.jsx(I_,{children:o.jsx(n5,{children:o.jsx($_,{children:o.jsxs("div",{className:"app-wrapper",children:[o.jsxs(zw,{children:[o.jsx(ks,{path:"/",element:o.jsx(IE,{})}),o.jsx(ks,{path:"/login",element:o.jsx(hS,{})}),o.jsx(ks,{path:"/register",element:o.jsx(m8,{})}),o.jsx(ks,{path:"/dashboard",element:o.jsx(pa,{children:o.jsx(RT,{})})}),o.jsx(ks,{path:"/user/:id",element:o.jsx(pa,{children:o.jsx(OT,{})})}),o.jsx(ks,{path:"/profile",element:o.jsx(pa,{children:o.jsx(kk,{})})}),o.jsx(ks,{path:"/messages",element:o.jsx(pa,{children:o.jsx(Av,{})})}),o.jsx(ks,{path:"/messages/:userId",element:o.jsx(pa,{children:o.jsx(Av,{})})}),o.jsx(ks,{path:"/settings",element:o.jsx(pa,{children:o.jsx($E,{})})}),o.jsx(ks,{path:"/subscription",element:o.jsx(pa,{children:o.jsx(GO,{})})}),o.jsx(ks,{path:"*",element:o.jsx(UE,{})})]}),i&&t&&o.jsx(ul,{recipient:t,isOpen:i,onClose:c}),o.jsx($w,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,limit:5,theme:"colored"})]})})})})})})})})}typeof globalThis>"u"&&(window.global=window);Yw.createRoot(document.getElementById("root")).render(o.jsxs(ba.StrictMode,{children:[o.jsxs(Pw,{children:[" ",o.jsxs(Vb,{children:[" ",o.jsx(YO,{})]})]})," "]}));
//# sourceMappingURL=index-BjrHlaU5.js.map
